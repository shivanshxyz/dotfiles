!function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:r})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var i in t)e.d(r,i,function(e){return t[e]}.bind(null,i));return r},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=289)}([function(t,e,n){var r=n(3),i=n(34),o=n(20),a=n(21),s=n(30),u=function(t,e,n){var c,l,h,f,p=t&u.F,d=t&u.G,v=t&u.S,g=t&u.P,y=t&u.B,m=d?r:v?r[e]||(r[e]={}):(r[e]||{}).prototype,_=d?i:i[e]||(i[e]={}),b=_.prototype||(_.prototype={});for(c in d&&(n=e),n)h=((l=!p&&m&&void 0!==m[c])?m:n)[c],f=y&&l?s(h,r):g&&"function"==typeof h?s(Function.call,h):h,m&&a(m,c,h,t&u.U),_[c]!=h&&o(_,c,f),g&&b[c]!=h&&(b[c]=h)};r.core=i,u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,t.exports=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(211);e.assert=r.assert,e.assertionError=r.assertionError;var i=n(212);e.base64=i.base64,e.base64Decode=i.base64Decode,e.base64Encode=i.base64Encode;var o=n(153);e.CONSTANTS=o.CONSTANTS;var a=n(508);e.deepCopy=a.deepCopy,e.deepExtend=a.deepExtend,e.patchProperty=a.patchProperty;var s=n(509);e.Deferred=s.Deferred;var u=n(510);e.getUA=u.getUA,e.isMobileCordova=u.isMobileCordova,e.isNodeSdk=u.isNodeSdk,e.isReactNative=u.isReactNative;var c=n(511);e.ErrorFactory=c.ErrorFactory,e.FirebaseError=c.FirebaseError,e.patchCapture=c.patchCapture;var l=n(213);e.jsonEval=l.jsonEval,e.stringify=l.stringify;var h=n(512);e.decode=h.decode,e.isAdmin=h.isAdmin,e.issuedAtTime=h.issuedAtTime,e.isValidFormat=h.isValidFormat,e.isValidTimestamp=h.isValidTimestamp;var f=n(214);e.clone=f.clone,e.contains=f.contains,e.every=f.every,e.extend=f.extend,e.findKey=f.findKey,e.findValue=f.findValue,e.forEach=f.forEach,e.getAnyKey=f.getAnyKey,e.getCount=f.getCount,e.getValues=f.getValues,e.isEmpty=f.isEmpty,e.isNonNullObject=f.isNonNullObject,e.map=f.map,e.safeGet=f.safeGet;var p=n(513);e.querystring=p.querystring,e.querystringDecode=p.querystringDecode;var d=n(514);e.Sha1=d.Sha1;var v=n(516);e.async=v.async,e.createSubscribe=v.createSubscribe;var g=n(517);e.errorPrefix=g.errorPrefix,e.validateArgCount=g.validateArgCount,e.validateCallback=g.validateCallback,e.validateContextObject=g.validateContextObject,e.validateNamespace=g.validateNamespace;var y=n(518);e.stringLength=y.stringLength,e.stringToByteArray=y.stringToByteArray},function(t,e,n){var r=n(6);t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=n(1),o=n(1),a=n(1),s=n(1),u=n(1),c=n(105),l=n(1);e.LUIDGenerator=function(){var t=1;return function(){return t++}}(),e.sha1=function(t){var e=s.stringToByteArray(t),n=new a.Sha1;n.update(e);var r=n.digest();return o.base64.encodeByteArray(r)};var h=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n="",r=0;r<t.length;r++)Array.isArray(t[r])||t[r]&&"object"==typeof t[r]&&"number"==typeof t[r].length?n+=h.apply(null,t[r]):"object"==typeof t[r]?n+=u.stringify(t[r]):n+=t[r],n+=" ";return n};e.logger=null;var f=!0;e.enableLogging=function(t,n){r.assert(!n||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?("undefined"!=typeof console&&("function"==typeof console.log?e.logger=console.log.bind(console):"object"==typeof console.log&&(e.logger=function(t){console.log(t)})),n&&c.SessionStorage.set("logging_enabled",!0)):"function"==typeof t?e.logger=t:(e.logger=null,c.SessionStorage.remove("logging_enabled"))},e.log=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(!0===f&&(f=!1,null===e.logger&&!0===c.SessionStorage.get("logging_enabled")&&e.enableLogging(!0)),e.logger){var r=h.apply(null,t);e.logger(r)}},e.logWrapper=function(t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];e.log.apply(void 0,[t].concat(n))}},e.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if("undefined"!=typeof console){var n="FIREBASE INTERNAL ERROR: "+h.apply(void 0,t);void 0!==console.error?console.error(n):console.log(n)}},e.fatal=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=h.apply(void 0,t);throw new Error("FIREBASE FATAL ERROR: "+n)},e.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if("undefined"!=typeof console){var n="FIREBASE WARNING: "+h.apply(void 0,t);void 0!==console.warn?console.warn(n):console.log(n)}},e.warnIfPageIsSecure=function(){"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&e.warn("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},e.warnAboutUnsupportedMethod=function(t){e.warn(t+" is unsupported and will likely change soon.  Please do not use.")},e.isInvalidJSONNumber=function(t){return"number"==typeof t&&(t!=t||t==Number.POSITIVE_INFINITY||t==Number.NEGATIVE_INFINITY)},e.executeWhenDOMReady=function(t){if(l.isNodeSdk()||"complete"===document.readyState)t();else{var e=!1,n=function(){document.body?e||(e=!0,t()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&n()}),window.attachEvent("onload",n))}},e.MIN_NAME="[MIN_NAME]",e.MAX_NAME="[MAX_NAME]",e.nameCompare=function(t,n){if(t===n)return 0;if(t===e.MIN_NAME||n===e.MAX_NAME)return-1;if(n===e.MIN_NAME||t===e.MAX_NAME)return 1;var r=e.tryParseInt(t),i=e.tryParseInt(n);return null!==r?null!==i?r-i==0?t.length-n.length:r-i:-1:null!==i?1:t<n?-1:1},e.stringCompare=function(t,e){return t===e?0:t<e?-1:1},e.requireKey=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+u.stringify(e))},e.ObjectToUniqueKey=function(t){if("object"!=typeof t||null===t)return u.stringify(t);var n=[];for(var r in t)n.push(r);n.sort();for(var i="{",o=0;o<n.length;o++)0!==o&&(i+=","),i+=u.stringify(n[o]),i+=":",i+=e.ObjectToUniqueKey(t[n[o]]);return i+"}"},e.splitStringBySize=function(t,e){var n=t.length;if(n<=e)return[t];for(var r=[],i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r},e.each=function(t,e){if(Array.isArray(t))for(var n=0;n<t.length;++n)e(n,t[n]);else i.forEach(t,function(t,n){return e(n,t)})},e.bindCallback=function(t,e){return e?t.bind(e):t},e.doubleToIEEE754String=function(t){var n,i,o,a,s,u,c;for(r.assert(!e.isInvalidJSONNumber(t),"Invalid JSON number"),0===t?(i=0,o=0,n=1/t==-1/0?1:0):(n=t<0,(t=Math.abs(t))>=Math.pow(2,-1022)?(i=(a=Math.min(Math.floor(Math.log(t)/Math.LN2),1023))+1023,o=Math.round(t*Math.pow(2,52-a)-Math.pow(2,52))):(i=0,o=Math.round(t/Math.pow(2,-1074)))),u=[],s=52;s;s-=1)u.push(o%2?1:0),o=Math.floor(o/2);for(s=11;s;s-=1)u.push(i%2?1:0),i=Math.floor(i/2);u.push(n?1:0),u.reverse(),c=u.join("");var l="";for(s=0;s<64;s+=8){var h=parseInt(c.substr(s,8),2).toString(16);1===h.length&&(h="0"+h),l+=h}return l.toLowerCase()},e.isChromeExtensionContentScript=function(){return!("object"!=typeof window||!window.chrome||!window.chrome.extension||/^chrome/.test(window.location.href))},e.isWindowsStoreApp=function(){return"object"==typeof Windows&&"object"==typeof Windows.UI},e.errorForServerCode=function(t,e){var n="Unknown Error";"too_big"===t?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"==t?n="Client doesn't have permission to access the desired data.":"unavailable"==t&&(n="The service is unavailable");var r=new Error(t+" at "+e.path.toString()+": "+n);return r.code=t.toUpperCase(),r},e.INTEGER_REGEXP_=new RegExp("^-?\\d{1,10}$"),e.tryParseInt=function(t){if(e.INTEGER_REGEXP_.test(t)){var n=Number(t);if(n>=-2147483648&&n<=2147483647)return n}return null},e.exceptionGuard=function(t){try{t()}catch(t){setTimeout(function(){var n=t.stack||"";throw e.warn("Exception was thrown by user callback.",n),t},Math.floor(0))}},e.callUserCallback=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];"function"==typeof t&&e.exceptionGuard(function(){t.apply(void 0,n)})},e.beingCrawled=function(){return("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},e.exportPropGetter=function(t,e,n){Object.defineProperty(t,e,{get:n})},e.setTimeoutNonBlocking=function(t,e){var n=setTimeout(t,e);return"object"==typeof n&&n.unref&&n.unref(),n}},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,n){var r=n(89)("wks"),i=n(52),o=n(3).Symbol,a="function"==typeof o;(t.exports=function(t){return r[t]||(r[t]=a&&o[t]||(a?o:i)("Symbol."+t))}).store=r},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";function r(t){t&&(t.value=!0)}function i(){}function o(t){return void 0===t.size&&(t.size=t.__iterate(s)),t.size}function a(t,e){if("number"!=typeof e){var n=e>>>0;if(""+n!==e||4294967295===n)return NaN;e=n}return e<0?o(t)+e:e}function s(){return!0}function u(t,e,n){return(0===t&&!f(t)||void 0!==n&&t<=-n)&&(void 0===e||void 0!==n&&e>=n)}function c(t,e){return h(t,e,0)}function l(t,e){return h(t,e,e)}function h(t,e,n){return void 0===t?n:f(t)?e===1/0?e:0|Math.max(0,e+t):void 0===e||e===t?t:0|Math.min(e,t)}function f(t){return t<0||0===t&&1/t==-1/0}function p(t){return Boolean(t&&t[He])}function d(t){return Boolean(t&&t[Ge])}function v(t){return Boolean(t&&t[Ke])}function g(t){return d(t)||v(t)}function y(t){return Boolean(t&&t[Je])}function m(t){return Boolean(t&&t[$e])}function _(t){return p(t)||m(t)}function b(t){return Boolean(t&&t[Ze])}function E(t,e,n,r){var i=0===t?e:1===t?n:[e,n];return r?r.value=i:r={value:i,done:!1},r}function w(){return{value:void 0,done:!0}}function S(t){return!!A(t)}function T(t){return t&&"function"==typeof t.next}function I(t){var e=A(t);return e&&e.call(t)}function A(t){var e=t&&(rn&&t[rn]||t[on]);if("function"==typeof e)return e}function O(t){return!(!Array.isArray(t)&&"string"!=typeof t)||t&&"object"==typeof t&&Number.isInteger(t.length)&&t.length>=0&&(0===t.length?1===Object.keys(t).length:t.hasOwnProperty(t.length-1))}function C(){return vn||(vn=new pn([]))}function R(t){var e=Array.isArray(t)?new pn(t):S(t)?new yn(t):void 0;if(e)return e.fromEntrySeq();if("object"==typeof t)return new dn(t);throw new TypeError("Expected Array or collection object of [k, v] entries, or keyed object: "+t)}function N(t){var e=k(t);if(e)return e;throw new TypeError("Expected Array or collection object of values: "+t)}function k(t){return O(t)?new pn(t):S(t)?new yn(t):void 0}function P(t){return Boolean(t&&t[mn])}function D(t){return P(t)&&b(t)}function x(t){return Boolean(t&&"function"==typeof t.equals&&"function"==typeof t.hashCode)}function M(t,e){if(t===e||t!=t&&e!=e)return!0;if(!t||!e)return!1;if("function"==typeof t.valueOf&&"function"==typeof e.valueOf){if((t=t.valueOf())===(e=e.valueOf())||t!=t&&e!=e)return!0;if(!t||!e)return!1}return!!(x(t)&&x(e)&&t.equals(e))}function L(t){return t>>>1&1073741824|3221225471&t}function F(t){if(!1===t||null==t)return 0;if("function"==typeof t.valueOf&&(!1===(t=t.valueOf())||null==t))return 0;if(!0===t)return 1;var e=typeof t;if("number"===e){if(t!=t||t===1/0)return 0;var n=0|t;for(n!==t&&(n^=4294967295*t);t>4294967295;)n^=t/=4294967295;return L(n)}if("string"===e)return t.length>In?function(t){var e=Cn[t];return void 0===e&&(e=U(t),On===An&&(On=0,Cn={}),On++,Cn[t]=e),e}(t):U(t);if("function"==typeof t.hashCode)return L(t.hashCode());if("object"===e||"function"===e)return function(t){var e;if(wn&&void 0!==(e=gn.get(t)))return e;if(void 0!==(e=t[Tn]))return e;if(!En){if(void 0!==(e=t.propertyIsEnumerable&&t.propertyIsEnumerable[Tn]))return e;if(void 0!==(e=function(t){if(t&&t.nodeType>0)switch(t.nodeType){case 1:return t.uniqueID;case 9:return t.documentElement&&t.documentElement.uniqueID}}(t)))return e}if(e=++Sn,1073741824&Sn&&(Sn=0),wn)gn.set(t,e);else{if(void 0!==bn&&!1===bn(t))throw new Error("Non-extensible objects are not allowed as keys.");if(En)Object.defineProperty(t,Tn,{enumerable:!1,configurable:!1,writable:!1,value:e});else if(void 0!==t.propertyIsEnumerable&&t.propertyIsEnumerable===t.constructor.prototype.propertyIsEnumerable)t.propertyIsEnumerable=function(){return this.constructor.prototype.propertyIsEnumerable.apply(this,arguments)},t.propertyIsEnumerable[Tn]=e;else{if(void 0===t.nodeType)throw new Error("Unable to set a non-enumerable property on object.");t[Tn]=e}}return e}(t);if("function"==typeof t.toString)return U(t.toString());throw new Error("Value type "+e+" cannot be hashed.")}function U(t){for(var e=0,n=0;n<t.length;n++)e=31*e+t.charCodeAt(n)|0;return L(e)}function j(t){var e=Z(t);return e._iter=t,e.size=t.size,e.flip=function(){return t},e.reverse=function(){var e=t.reverse.apply(this);return e.flip=function(){return t.reverse()},e},e.has=function(e){return t.includes(e)},e.includes=function(e){return t.has(e)},e.cacheResult=tt,e.__iterateUncached=function(e,n){var r=this;return t.__iterate(function(t,n){return!1!==e(n,t,r)},n)},e.__iteratorUncached=function(e,n){if(e===nn){var r=t.__iterator(e,n);return new sn(function(){var t=r.next();if(!t.done){var e=t.value[0];t.value[0]=t.value[1],t.value[1]=e}return t})}return t.__iterator(e===en?tn:en,n)},e}function B(t,e,n){var r=Z(t);return r.size=t.size,r.has=function(e){return t.has(e)},r.get=function(r,i){var o=t.get(r,qe);return o===qe?i:e.call(n,o,r,t)},r.__iterateUncached=function(r,i){var o=this;return t.__iterate(function(t,i,a){return!1!==r(e.call(n,t,i,a),i,o)},i)},r.__iteratorUncached=function(r,i){var o=t.__iterator(nn,i);return new sn(function(){var i=o.next();if(i.done)return i;var a=i.value,s=a[0];return E(r,s,e.call(n,a[1],s,t),i)})},r}function V(t,e){var n=this,r=Z(t);return r._iter=t,r.size=t.size,r.reverse=function(){return t},t.flip&&(r.flip=function(){var e=j(t);return e.reverse=function(){return t.flip()},e}),r.get=function(n,r){return t.get(e?n:-1-n,r)},r.has=function(n){return t.has(e?n:-1-n)},r.includes=function(e){return t.includes(e)},r.cacheResult=tt,r.__iterate=function(n,r){var i=this,a=0;return r&&o(t),t.__iterate(function(t,o){return n(t,e?o:r?i.size-++a:a++,i)},!r)},r.__iterator=function(r,i){var a=0;i&&o(t);var s=t.__iterator(nn,!i);return new sn(function(){var t=s.next();if(t.done)return t;var o=t.value;return E(r,e?o[0]:i?n.size-++a:a++,o[1],t)})},r}function W(t,e,n,r){var i=Z(t);return r&&(i.has=function(r){var i=t.get(r,qe);return i!==qe&&!!e.call(n,i,r,t)},i.get=function(r,i){var o=t.get(r,qe);return o!==qe&&e.call(n,o,r,t)?o:i}),i.__iterateUncached=function(i,o){var a=this,s=0;return t.__iterate(function(t,o,u){if(e.call(n,t,o,u))return s++,i(t,r?o:s-1,a)},o),s},i.__iteratorUncached=function(i,o){var a=t.__iterator(nn,o),s=0;return new sn(function(){for(;;){var o=a.next();if(o.done)return o;var u=o.value,c=u[0],l=u[1];if(e.call(n,l,c,t))return E(i,r?c:s++,l,o)}})},i}function q(t,e,n,r){var i=t.size;if(u(e,n,i))return t;var o=c(e,i),s=l(n,i);if(o!=o||s!=s)return q(t.toSeq().cacheResult(),e,n,r);var h,f=s-o;f==f&&(h=f<0?0:f);var p=Z(t);return p.size=0===h?h:t.size&&h||void 0,!r&&y(t)&&h>=0&&(p.get=function(e,n){return(e=a(this,e))>=0&&e<h?t.get(e+o,n):n}),p.__iterateUncached=function(e,n){var i=this;if(0===h)return 0;if(n)return this.cacheResult().__iterate(e,n);var a=0,s=!0,u=0;return t.__iterate(function(t,n){if(!s||!(s=a++<o))return u++,!1!==e(t,r?n:u-1,i)&&u!==h}),u},p.__iteratorUncached=function(e,n){if(0!==h&&n)return this.cacheResult().__iterator(e,n);if(0===h)return new sn(w);var i=t.__iterator(e,n),a=0,s=0;return new sn(function(){for(;a++<o;)i.next();if(++s>h)return{value:void 0,done:!0};var t=i.next();return r||e===en||t.done?t:E(e,s-1,e===tn?void 0:t.value[1],t)})},p}function H(t,e,n,r){var i=Z(t);return i.__iterateUncached=function(i,o){var a=this;if(o)return this.cacheResult().__iterate(i,o);var s=!0,u=0;return t.__iterate(function(t,o,c){if(!s||!(s=e.call(n,t,o,c)))return u++,i(t,r?o:u-1,a)}),u},i.__iteratorUncached=function(i,o){var a=this;if(o)return this.cacheResult().__iterator(i,o);var s=t.__iterator(nn,o),u=!0,c=0;return new sn(function(){var t,o,l;do{if((t=s.next()).done)return r||i===en?t:E(i,c++,i===tn?void 0:t.value[1],t);var h=t.value;o=h[0],l=h[1],u&&(u=e.call(n,l,o,a))}while(u);return i===nn?t:E(i,o,l,t)})},i}function G(t,e,n){var r=Z(t);return r.__iterateUncached=function(i,o){if(o)return this.cacheResult().__iterate(i,o);var a=0,s=!1;return function t(u,c){u.__iterate(function(o,u){return(!e||c<e)&&p(o)?t(o,c+1):(a++,!1===i(o,n?u:a-1,r)&&(s=!0)),!s},o)}(t,0),a},r.__iteratorUncached=function(r,i){if(i)return this.cacheResult().__iterator(r,i);var o=t.__iterator(r,i),a=[],s=0;return new sn(function(){for(;o;){var t=o.next();if(!1===t.done){var u=t.value;if(r===nn&&(u=u[1]),e&&!(a.length<e)||!p(u))return n?t:E(r,s++,u,t);a.push(o),o=u.__iterator(r,i)}else o=a.pop()}return{value:void 0,done:!0}})},r}function K(t,e,n){e||(e=et);var r=d(t),i=0,o=t.toSeq().map(function(e,r){return[r,e,i++,n?n(e,r,t):e]}).valueSeq().toArray();return o.sort(function(t,n){return e(t[3],n[3])||t[2]-n[2]}).forEach(r?function(t,e){o[e].length=2}:function(t,e){o[e]=t[1]}),r?ln(o):v(t)?hn(o):fn(o)}function z(t,e,n){if(e||(e=et),n){var r=t.toSeq().map(function(e,r){return[e,n(e,r,t)]}).reduce(function(t,n){return Q(e,t[1],n[1])?n:t});return r&&r[0]}return t.reduce(function(t,n){return Q(e,t,n)?n:t})}function Q(t,e,n){var r=t(n,e);return 0===r&&n!==e&&(null==n||n!=n)||r>0}function X(t,e,n,r){var i=Z(t),o=new pn(n).map(function(t){return t.size});return i.size=r?o.max():o.min(),i.__iterate=function(t,e){for(var n,r=this.__iterator(en,e),i=0;!(n=r.next()).done&&!1!==t(n.value,i++,this););return i},i.__iteratorUncached=function(t,i){var o=n.map(function(t){return t=ze(t),I(i?t.reverse():t)}),a=0,s=!1;return new sn(function(){var n;return s||(n=o.map(function(t){return t.next()}),s=r?n.every(function(t){return t.done}):n.some(function(t){return t.done})),s?{value:void 0,done:!0}:E(t,a++,e.apply(null,n.map(function(t){return t.value})))})},i}function Y(t,e){return t===e?t:y(t)?e:t.constructor(e)}function J(t){if(t!==Object(t))throw new TypeError("Expected [K, V] tuple: "+t)}function $(t){return d(t)?Qe:v(t)?Xe:Ye}function Z(t){return Object.create((d(t)?ln:v(t)?hn:fn).prototype)}function tt(){return this._iter.cacheResult?(this._iter.cacheResult(),this.size=this._iter.size,this):cn.prototype.cacheResult.call(this)}function et(t,e){return void 0===t&&void 0===e?0:void 0===t?1:void 0===e?-1:t>e?1:t<e?-1:0}function nt(t,e){e=e||0;for(var n=Math.max(0,t.length-e),r=new Array(n),i=0;i<n;i++)r[i]=t[i+e];return r}function rt(t,e){if(!t)throw new Error(e)}function it(t){rt(t!==1/0,"Cannot perform this action with an infinite size.")}function ot(t){if(O(t)&&"string"!=typeof t)return t;if(b(t))return t.toArray();throw new TypeError("Invalid keyPath: expected Ordered Collection or Array: "+t)}function at(t){return t&&(t.constructor&&"Object"===t.constructor.name||void 0===t.constructor)}function st(t){return"object"==typeof t&&(_(t)||Array.isArray(t)||at(t))}function ut(t){try{return"string"==typeof t?JSON.stringify(t):String(t)}catch(e){return JSON.stringify(t)}}function ct(t,e){return _(t)?t.has(e):st(t)&&un.call(t,e)}function lt(t,e,n){return _(t)?t.get(e,n):ct(t,e)?"function"==typeof t.get?t.get(e):t[e]:n}function ht(t){if(Array.isArray(t))return nt(t);var e={};for(var n in t)un.call(t,n)&&(e[n]=t[n]);return e}function ft(t,e){if(!st(t))throw new TypeError("Cannot update non-data-structure value: "+t);if(_(t)){if(!t.remove)throw new TypeError("Cannot update immutable value without .remove() method: "+t);return t.remove(e)}if(!un.call(t,e))return t;var n=ht(t);return Array.isArray(n)?n.splice(e,1):delete n[e],n}function pt(t,e,n){if(!st(t))throw new TypeError("Cannot update non-data-structure value: "+t);if(_(t)){if(!t.set)throw new TypeError("Cannot update immutable value without .set() method: "+t);return t.set(e,n)}if(un.call(t,e)&&n===t[e])return t;var r=ht(t);return r[e]=n,r}function dt(t,e,n,r){r||(r=n,n=void 0);var i=function t(e,n,r,i,o,a){var s=n===qe;if(i===r.length){var u=s?o:n,c=a(u);return c===u?n:c}if(!s&&!st(n))throw new TypeError("Cannot update within non-data-structure value in path ["+r.slice(0,i).map(ut)+"]: "+n);var l=r[i],h=s?qe:lt(n,l,qe),f=t(h===qe?e:_(h),h,r,i+1,o,a);return f===h?n:f===qe?ft(n,l):pt(s?e?Wt():{}:n,l,f)}(_(t),t,ot(e),0,n,r);return i===qe?n:i}function vt(t,e,n){return dt(t,e,qe,function(){return n})}function gt(t,e){return vt(this,t,e)}function yt(t,e){return dt(t,e,function(){return qe})}function mt(t){return yt(this,t)}function _t(t,e,n,r){return dt(t,[e],n,r)}function bt(t,e,n){return 1===arguments.length?t(this):_t(this,t,e,n)}function Et(t,e,n){return dt(this,t,e,n)}function wt(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return Tt(this,t)}function St(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];if("function"!=typeof t)throw new TypeError("Invalid merger function: "+t);return Tt(this,e,t)}function Tt(t,e,n){for(var r=[],i=0;i<e.length;i++){var o=Qe(e[i]);0!==o.size&&r.push(o)}return 0===r.length?t:0!==t.toSeq().size||t.__ownerID||1!==r.length?t.withMutations(function(t){for(var e=n?function(e,r){_t(t,r,qe,function(t){return t===qe?e:n(t,e,r)})}:function(e,n){t.set(n,e)},i=0;i<r.length;i++)r[i].forEach(e)}):t.constructor(r[0])}function It(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];return Nt(t,e)}function At(t,e){for(var n=[],r=arguments.length-2;r-- >0;)n[r]=arguments[r+2];return Nt(e,n,t)}function Ot(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];return Rt(t,e)}function Ct(t,e){for(var n=[],r=arguments.length-2;r-- >0;)n[r]=arguments[r+2];return Rt(e,n,t)}function Rt(t,e,n){return Nt(t,e,function(t){return function e(n,r,i){return st(n)&&st(r)?Nt(n,[r],e):t?t(n,r,i):r}}(n))}function Nt(t,e,n){if(!st(t))throw new TypeError("Cannot merge into non-data-structure value: "+t);if(_(t))return"function"==typeof n&&t.mergeWith?t.mergeWith.apply(t,[n].concat(e)):t.merge?t.merge.apply(t,e):t.concat.apply(t,e);for(var r=Array.isArray(t),i=t,o=r?Xe:Qe,a=r?function(e){i===t&&(i=ht(i)),i.push(e)}:function(e,r){var o=un.call(i,r),a=o&&n?n(i[r],e,r):e;o&&a===i[r]||(i===t&&(i=ht(i)),i[r]=a)},s=0;s<e.length;s++)o(e[s]).forEach(a);return i}function kt(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return Rt(this,t)}function Pt(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];return Rt(this,e,t)}function Dt(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];return dt(this,t,Wt(),function(t){return Nt(t,e)})}function xt(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];return dt(this,t,Wt(),function(t){return Rt(t,e)})}function Mt(t){var e=this.asMutable();return t(e),e.wasAltered()?e.__ensureOwner(this.__ownerID):this}function Lt(){return this.__ownerID?this:this.__ensureOwner(new i)}function Ft(){return this.__ensureOwner()}function Ut(){return this.__altered}function jt(t,e){return E(t,e[0],e[1])}function Bt(t,e){return{node:t,index:0,__prev:e}}function Vt(t,e,n,r){var i=Object.create(xn);return i.size=t,i._root=e,i.__ownerID=n,i.__hash=r,i.__altered=!1,i}function Wt(){return Bn||(Bn=Vt(0))}function qt(t,e,n){var r,i;if(t._root){var o={value:!1},a={value:!1};if(r=Ht(t._root,t.__ownerID,0,void 0,e,n,o,a),!a.value)return t;i=t.size+(o.value?n===qe?-1:1:0)}else{if(n===qe)return t;i=1,r=new Mn(t.__ownerID,[[e,n]])}return t.__ownerID?(t.size=i,t._root=r,t.__hash=void 0,t.__altered=!0,t):r?Vt(i,r):Wt()}function Ht(t,e,n,i,o,a,s,u){return t?t.update(e,n,i,o,a,s,u):a===qe?t:(r(u),r(s),new jn(e,i,[o,a]))}function Gt(t){return t.constructor===jn||t.constructor===Un}function Kt(t,e,n,r,i){if(t.keyHash===r)return new Un(e,r,[t.entry,i]);var o,a=(0===n?t.keyHash:t.keyHash>>>n)&We,s=(0===n?r:r>>>n)&We,u=a===s?[Kt(t,e,n+Be,r,i)]:(o=new jn(e,r,i),a<s?[t,o]:[o,t]);return new Ln(e,1<<a|1<<s,u)}function zt(t,e,n,r){t||(t=new i);for(var o=new jn(t,F(n),[n,r]),a=0;a<e.length;a++){var s=e[a];o=o.update(t,0,void 0,s[0],s[1])}return o}function Qt(t){return t=(t=(858993459&(t-=t>>1&1431655765))+(t>>2&858993459))+(t>>4)&252645135,127&(t+=t>>8)+(t>>16)}function Xt(t,e,n,r){var i=r?t:nt(t);return i[e]=n,i}function Yt(t){return Boolean(t&&t[Gn])}function Jt(t,e){function n(t,e,n){return 0===e?r(t,n):i(t,e,n)}function r(t,n){var r=n===s?u&&u.array:t&&t.array,i=n>o?0:o-n,c=a-n;return c>Ve&&(c=Ve),function(){if(i===c)return Yn;var t=e?--c:i++;return r&&r[t]}}function i(t,r,i){var s,u=t&&t.array,c=i>o?0:o-i>>r,l=1+(a-i>>r);return l>Ve&&(l=Ve),function(){for(;;){if(s){var t=s();if(t!==Yn)return t;s=null}if(c===l)return Yn;var o=e?--l:c++;s=n(u&&u[o],r-Be,i+(o<<r))}}}var o=t._origin,a=t._capacity,s=ie(a),u=t._tail;return n(t._root,t._level,0)}function $t(t,e,n,r,i,o,a){var s=Object.create(zn);return s.size=e-t,s._origin=t,s._capacity=e,s._level=n,s._root=r,s._tail=i,s.__ownerID=o,s.__hash=a,s.__altered=!1,s}function Zt(){return Xn||(Xn=$t(0,0,Be))}function te(t,e,n,i,o,a){var s,u=i>>>n&We,c=t&&u<t.array.length;if(!c&&void 0===o)return t;if(n>0){var l=t&&t.array[u],h=te(l,e,n-Be,i,o,a);return h===l?t:((s=ee(t,e)).array[u]=h,s)}return c&&t.array[u]===o?t:(a&&r(a),s=ee(t,e),void 0===o&&u===s.array.length-1?s.array.pop():s.array[u]=o,s)}function ee(t,e){return e&&t&&e===t.ownerID?t:new Qn(t?t.array.slice():[],e)}function ne(t,e){if(e>=ie(t._capacity))return t._tail;if(e<1<<t._level+Be){for(var n=t._root,r=t._level;n&&r>0;)n=n.array[e>>>r&We],r-=Be;return n}}function re(t,e,n){void 0!==e&&(e|=0),void 0!==n&&(n|=0);var r=t.__ownerID||new i,o=t._origin,a=t._capacity,s=o+e,u=void 0===n?a:n<0?a+n:o+n;if(s===o&&u===a)return t;if(s>=u)return t.clear();for(var c=t._level,l=t._root,h=0;s+h<0;)l=new Qn(l&&l.array.length?[void 0,l]:[],r),h+=1<<(c+=Be);h&&(s+=h,o+=h,u+=h,a+=h);for(var f=ie(a),p=ie(u);p>=1<<c+Be;)l=new Qn(l&&l.array.length?[l]:[],r),c+=Be;var d=t._tail,v=p<f?ne(t,u-1):p>f?new Qn([],r):d;if(d&&p>f&&s<a&&d.array.length){for(var g=l=ee(l,r),y=c;y>Be;y-=Be){var m=f>>>y&We;g=g.array[m]=ee(g.array[m],r)}g.array[f>>>Be&We]=d}if(u<a&&(v=v&&v.removeAfter(r,0,u)),s>=p)s-=p,u-=p,c=Be,l=null,v=v&&v.removeBefore(r,0,s);else if(s>o||p<f){for(h=0;l;){var _=s>>>c&We;if(_!==p>>>c&We)break;_&&(h+=(1<<c)*_),c-=Be,l=l.array[_]}l&&s>o&&(l=l.removeBefore(r,c,s-h)),l&&p<f&&(l=l.removeAfter(r,c,p-h)),h&&(s-=h,u-=h)}return t.__ownerID?(t.size=u-s,t._origin=s,t._capacity=u,t._level=c,t._root=l,t._tail=v,t.__hash=void 0,t.__altered=!0,t):$t(s,u,c,l,v)}function ie(t){return t<Ve?0:t-1>>>Be<<Be}function oe(t,e,n,r){var i=Object.create(Jn.prototype);return i.size=t?t.size:0,i._map=t,i._list=e,i.__ownerID=n,i.__hash=r,i}function ae(){return $n||($n=oe(Wt(),Zt()))}function se(t,e,n){var r,i,o=t._map,a=t._list,s=o.get(e),u=void 0!==s;if(n===qe){if(!u)return t;a.size>=Ve&&a.size>=2*o.size?(r=(i=a.filter(function(t,e){return void 0!==t&&s!==e})).toKeyedSeq().map(function(t){return t[0]}).flip().toMap(),t.__ownerID&&(r.__ownerID=i.__ownerID=t.__ownerID)):(r=o.remove(e),i=s===a.size-1?a.pop():a.set(s,void 0))}else if(u){if(n===a.get(s)[1])return t;r=o,i=a.set(s,[e,n])}else r=o.set(e,a.size),i=a.set(a.size,[e,n]);return t.__ownerID?(t.size=r.size,t._map=r,t._list=i,t.__hash=void 0,t):oe(r,i)}function ue(t){return Boolean(t&&t[Zn])}function ce(t,e,n,r){var i=Object.create(er);return i.size=t,i._head=e,i.__ownerID=n,i.__hash=r,i.__altered=!1,i}function le(){return nr||(nr=ce(0))}function he(t){return Boolean(t&&t[rr])}function fe(t){return he(t)&&b(t)}function pe(t,e){if(t===e)return!0;if(!p(e)||void 0!==t.size&&void 0!==e.size&&t.size!==e.size||void 0!==t.__hash&&void 0!==e.__hash&&t.__hash!==e.__hash||d(t)!==d(e)||v(t)!==v(e)||b(t)!==b(e))return!1;if(0===t.size&&0===e.size)return!0;var n=!g(t);if(b(t)){var r=t.entries();return e.every(function(t,e){var i=r.next().value;return i&&M(i[1],t)&&(n||M(i[0],e))})&&r.next().done}var i=!1;if(void 0===t.size)if(void 0===e.size)"function"==typeof t.cacheResult&&t.cacheResult();else{i=!0;var o=t;t=e,e=o}var a=!0,s=e.__iterate(function(e,r){if(n?!t.has(e):i?!M(e,t.get(r,qe)):!M(t.get(r,qe),e))return a=!1,!1});return a&&t.size===s}function de(t,e){var n=function(n){t.prototype[n]=e[n]};return Object.keys(e).forEach(n),Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(e).forEach(n),t}function ve(t){if(!t||"object"!=typeof t)return t;if(!p(t)){if(!st(t))return t;t=cn(t)}if(d(t)){var e={};return t.__iterate(function(t,n){e[n]=ve(t)}),e}var n=[];return t.__iterate(function(t){n.push(ve(t))}),n}function ge(t,e){return t.__ownerID?(t.size=e.size,t._map=e,t):e===t._map?t:0===e.size?t.__empty():t.__make(e)}function ye(t,e){var n=Object.create(or);return n.size=t?t.size:0,n._map=t,n.__ownerID=e,n}function me(){return ar||(ar=ye(Wt()))}function _e(t,e,n){for(var r=ot(e),i=0;i!==r.length;)if((t=lt(t,r[i++],qe))===qe)return n;return t}function be(t,e){return _e(this,t,e)}function Ee(t,e){return _e(t,e,qe)!==qe}function we(){it(this.size);var t={};return this.__iterate(function(e,n){t[n]=e}),t}function Se(t,e,n,r,i,o){return it(t.size),t.__iterate(function(t,o,a){i?(i=!1,n=t):n=e.call(r,n,t,o,a)},o),n}function Te(t,e){return e}function Ie(t,e){return[e,t]}function Ae(t){return function(){return!t.apply(this,arguments)}}function Oe(t){return function(){return-t.apply(this,arguments)}}function Ce(){return nt(arguments)}function Re(t,e){return t<e?1:t>e?-1:0}function Ne(t){if(t.size===1/0)return 0;var e=b(t),n=d(t),r=e?1:0;return function(t,e){return e=_n(e,3432918353),e=_n(e<<15|e>>>-15,461845907),e=_n(e<<13|e>>>-13,5),e=_n((e=(e+3864292196|0)^t)^e>>>16,2246822507),e=L((e=_n(e^e>>>13,3266489909))^e>>>16)}(t.__iterate(n?e?function(t,e){r=31*r+ke(F(t),F(e))|0}:function(t,e){r=r+ke(F(t),F(e))|0}:e?function(t){r=31*r+F(t)|0}:function(t){r=r+F(t)|0}),r)}function ke(t,e){return t^e+2654435769+(t<<6)+(t>>2)|0}function Pe(t,e){var n=Object.create(pr);return n.size=t?t.size:0,n._map=t,n.__ownerID=e,n}function De(){return dr||(dr=Pe(ae()))}function xe(t,e,n){var r=Object.create(Object.getPrototypeOf(t));return r._values=e,r.__ownerID=n,r}function Me(t){return t._name||t.constructor.name||"Record"}function Le(t){return R(t._keys.map(function(e){return[e,t.get(e)]}))}function Fe(t,e){try{Object.defineProperty(t,e,{get:function(){return this.get(e)},set:function(t){rt(this.__ownerID,"Cannot set on an immutable record."),this.set(e,t)}})}catch(t){}}function Ue(t,e){return function t(e,n,r,i,o,a){var s=Array.isArray(r)?hn:at(r)?ln:null;if(s){if(~e.indexOf(r))throw new TypeError("Cannot convert circular structure to Immutable");e.push(r),o&&""!==i&&o.push(i);var u=n.call(a,i,s(r).map(function(i,a){return t(e,n,i,a,o,r)}),o&&o.slice());return e.pop(),o&&o.pop(),u}return r}([],e||je,t,"",e&&e.length>2?[]:void 0,{"":t})}function je(t,e){return d(e)?e.toMap():e.toList()}n.r(e),n.d(e,"version",function(){return _r}),n.d(e,"Collection",function(){return ze}),n.d(e,"Iterable",function(){return Er}),n.d(e,"Seq",function(){return cn}),n.d(e,"Map",function(){return Dn}),n.d(e,"OrderedMap",function(){return Jn}),n.d(e,"List",function(){return Kn}),n.d(e,"Stack",function(){return tr}),n.d(e,"Set",function(){return ir}),n.d(e,"OrderedSet",function(){return fr}),n.d(e,"Record",function(){return vr}),n.d(e,"Range",function(){return ur}),n.d(e,"Repeat",function(){return mr}),n.d(e,"is",function(){return M}),n.d(e,"fromJS",function(){return Ue}),n.d(e,"hash",function(){return F}),n.d(e,"isImmutable",function(){return _}),n.d(e,"isCollection",function(){return p}),n.d(e,"isKeyed",function(){return d}),n.d(e,"isIndexed",function(){return v}),n.d(e,"isAssociative",function(){return g}),n.d(e,"isOrdered",function(){return b}),n.d(e,"isValueObject",function(){return x}),n.d(e,"get",function(){return lt}),n.d(e,"getIn",function(){return _e}),n.d(e,"has",function(){return ct}),n.d(e,"hasIn",function(){return Ee}),n.d(e,"merge",function(){return It}),n.d(e,"mergeDeep",function(){return Ot}),n.d(e,"mergeWith",function(){return At}),n.d(e,"mergeDeepWith",function(){return Ct}),n.d(e,"remove",function(){return ft}),n.d(e,"removeIn",function(){return yt}),n.d(e,"set",function(){return pt}),n.d(e,"setIn",function(){return vt}),n.d(e,"update",function(){return _t}),n.d(e,"updateIn",function(){return dt});var Be=5,Ve=1<<Be,We=Ve-1,qe={},He="@@__IMMUTABLE_ITERABLE__@@",Ge="@@__IMMUTABLE_KEYED__@@",Ke="@@__IMMUTABLE_INDEXED__@@",ze=function(t){return p(t)?t:cn(t)},Qe=function(t){function e(t){return d(t)?t:ln(t)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(ze),Xe=function(t){function e(t){return v(t)?t:hn(t)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(ze),Ye=function(t){function e(t){return p(t)&&!g(t)?t:fn(t)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(ze);ze.Keyed=Qe,ze.Indexed=Xe,ze.Set=Ye;var Je="@@__IMMUTABLE_SEQ__@@",$e="@@__IMMUTABLE_RECORD__@@",Ze="@@__IMMUTABLE_ORDERED__@@",tn=0,en=1,nn=2,rn="function"==typeof Symbol&&Symbol.iterator,on="@@iterator",an=rn||on,sn=function(t){this.next=t};sn.prototype.toString=function(){return"[Iterator]"},sn.KEYS=tn,sn.VALUES=en,sn.ENTRIES=nn,sn.prototype.inspect=sn.prototype.toSource=function(){return this.toString()},sn.prototype[an]=function(){return this};var un=Object.prototype.hasOwnProperty,cn=function(t){function e(t){return null==t?C():_(t)?t.toSeq():function(t){var e=k(t);if(e)return e;if("object"==typeof t)return new dn(t);throw new TypeError("Expected Array or collection object of values, or keyed object: "+t)}(t)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.toSeq=function(){return this},e.prototype.toString=function(){return this.__toString("Seq {","}")},e.prototype.cacheResult=function(){return!this._cache&&this.__iterateUncached&&(this._cache=this.entrySeq().toArray(),this.size=this._cache.length),this},e.prototype.__iterate=function(t,e){var n=this._cache;if(n){for(var r=n.length,i=0;i!==r;){var o=n[e?r-++i:i++];if(!1===t(o[1],o[0],this))break}return i}return this.__iterateUncached(t,e)},e.prototype.__iterator=function(t,e){var n=this._cache;if(n){var r=n.length,i=0;return new sn(function(){if(i===r)return{value:void 0,done:!0};var o=n[e?r-++i:i++];return E(t,o[0],o[1])})}return this.__iteratorUncached(t,e)},e}(ze),ln=function(t){function e(t){return null==t?C().toKeyedSeq():p(t)?d(t)?t.toSeq():t.fromEntrySeq():m(t)?t.toSeq():R(t)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.toKeyedSeq=function(){return this},e}(cn),hn=function(t){function e(t){return null==t?C():p(t)?d(t)?t.entrySeq():t.toIndexedSeq():m(t)?t.toSeq().entrySeq():N(t)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.of=function(){return e(arguments)},e.prototype.toIndexedSeq=function(){return this},e.prototype.toString=function(){return this.__toString("Seq [","]")},e}(cn),fn=function(t){function e(t){return(p(t)&&!g(t)?t:hn(t)).toSetSeq()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.of=function(){return e(arguments)},e.prototype.toSetSeq=function(){return this},e}(cn);cn.isSeq=y,cn.Keyed=ln,cn.Set=fn,cn.Indexed=hn,cn.prototype[Je]=!0;var pn=function(t){function e(t){this._array=t,this.size=t.length}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t,e){return this.has(t)?this._array[a(this,t)]:e},e.prototype.__iterate=function(t,e){for(var n=this._array,r=n.length,i=0;i!==r;){var o=e?r-++i:i++;if(!1===t(n[o],o,this))break}return i},e.prototype.__iterator=function(t,e){var n=this._array,r=n.length,i=0;return new sn(function(){if(i===r)return{value:void 0,done:!0};var o=e?r-++i:i++;return E(t,o,n[o])})},e}(hn),dn=function(t){function e(t){var e=Object.keys(t);this._object=t,this._keys=e,this.size=e.length}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t,e){return void 0===e||this.has(t)?this._object[t]:e},e.prototype.has=function(t){return un.call(this._object,t)},e.prototype.__iterate=function(t,e){for(var n=this._object,r=this._keys,i=r.length,o=0;o!==i;){var a=r[e?i-++o:o++];if(!1===t(n[a],a,this))break}return o},e.prototype.__iterator=function(t,e){var n=this._object,r=this._keys,i=r.length,o=0;return new sn(function(){if(o===i)return{value:void 0,done:!0};var a=r[e?i-++o:o++];return E(t,a,n[a])})},e}(ln);dn.prototype[Ze]=!0;var vn,gn,yn=function(t){function e(t){this._collection=t,this.size=t.length||t.size}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.__iterateUncached=function(t,e){if(e)return this.cacheResult().__iterate(t,e);var n=I(this._collection),r=0;if(T(n))for(var i;!(i=n.next()).done&&!1!==t(i.value,r++,this););return r},e.prototype.__iteratorUncached=function(t,e){if(e)return this.cacheResult().__iterator(t,e);var n=I(this._collection);if(!T(n))return new sn(w);var r=0;return new sn(function(){var e=n.next();return e.done?e:E(t,r++,e.value)})},e}(hn),mn="@@__IMMUTABLE_MAP__@@",_n="function"==typeof Math.imul&&-2===Math.imul(4294967295,2)?Math.imul:function(t,e){var n=65535&(t|=0),r=65535&(e|=0);return n*r+((t>>>16)*r+n*(e>>>16)<<16>>>0)|0},bn=Object.isExtensible,En=function(){try{return Object.defineProperty({},"@",{}),!0}catch(t){return!1}}(),wn="function"==typeof WeakMap;wn&&(gn=new WeakMap);var Sn=0,Tn="__immutablehash__";"function"==typeof Symbol&&(Tn=Symbol(Tn));var In=16,An=255,On=0,Cn={},Rn=function(t){function e(t,e){this._iter=t,this._useKeys=e,this.size=t.size}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t,e){return this._iter.get(t,e)},e.prototype.has=function(t){return this._iter.has(t)},e.prototype.valueSeq=function(){return this._iter.valueSeq()},e.prototype.reverse=function(){var t=this,e=V(this,!0);return this._useKeys||(e.valueSeq=function(){return t._iter.toSeq().reverse()}),e},e.prototype.map=function(t,e){var n=this,r=B(this,t,e);return this._useKeys||(r.valueSeq=function(){return n._iter.toSeq().map(t,e)}),r},e.prototype.__iterate=function(t,e){var n=this;return this._iter.__iterate(function(e,r){return t(e,r,n)},e)},e.prototype.__iterator=function(t,e){return this._iter.__iterator(t,e)},e}(ln);Rn.prototype[Ze]=!0;var Nn=function(t){function e(t){this._iter=t,this.size=t.size}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.includes=function(t){return this._iter.includes(t)},e.prototype.__iterate=function(t,e){var n=this,r=0;return e&&o(this),this._iter.__iterate(function(i){return t(i,e?n.size-++r:r++,n)},e)},e.prototype.__iterator=function(t,e){var n=this,r=this._iter.__iterator(en,e),i=0;return e&&o(this),new sn(function(){var o=r.next();return o.done?o:E(t,e?n.size-++i:i++,o.value,o)})},e}(hn),kn=function(t){function e(t){this._iter=t,this.size=t.size}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.has=function(t){return this._iter.includes(t)},e.prototype.__iterate=function(t,e){var n=this;return this._iter.__iterate(function(e){return t(e,e,n)},e)},e.prototype.__iterator=function(t,e){var n=this._iter.__iterator(en,e);return new sn(function(){var e=n.next();return e.done?e:E(t,e.value,e.value,e)})},e}(fn),Pn=function(t){function e(t){this._iter=t,this.size=t.size}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.entrySeq=function(){return this._iter.toSeq()},e.prototype.__iterate=function(t,e){var n=this;return this._iter.__iterate(function(e){if(e){J(e);var r=p(e);return t(r?e.get(1):e[1],r?e.get(0):e[0],n)}},e)},e.prototype.__iterator=function(t,e){var n=this._iter.__iterator(en,e);return new sn(function(){for(;;){var e=n.next();if(e.done)return e;var r=e.value;if(r){J(r);var i=p(r);return E(t,i?r.get(0):r[0],i?r.get(1):r[1],e)}}})},e}(ln);Nn.prototype.cacheResult=Rn.prototype.cacheResult=kn.prototype.cacheResult=Pn.prototype.cacheResult=tt;var Dn=function(t){function e(e){return null==e?Wt():P(e)&&!b(e)?e:Wt().withMutations(function(n){var r=t(e);it(r.size),r.forEach(function(t,e){return n.set(e,t)})})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.of=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return Wt().withMutations(function(e){for(var n=0;n<t.length;n+=2){if(n+1>=t.length)throw new Error("Missing value for key: "+t[n]);e.set(t[n],t[n+1])}})},e.prototype.toString=function(){return this.__toString("Map {","}")},e.prototype.get=function(t,e){return this._root?this._root.get(0,void 0,t,e):e},e.prototype.set=function(t,e){return qt(this,t,e)},e.prototype.remove=function(t){return qt(this,t,qe)},e.prototype.deleteAll=function(t){var e=ze(t);return 0===e.size?this:this.withMutations(function(t){e.forEach(function(e){return t.remove(e)})})},e.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._root=null,this.__hash=void 0,this.__altered=!0,this):Wt()},e.prototype.sort=function(t){return Jn(K(this,t))},e.prototype.sortBy=function(t,e){return Jn(K(this,e,t))},e.prototype.map=function(t,e){return this.withMutations(function(n){n.forEach(function(r,i){n.set(i,t.call(e,r,i,n))})})},e.prototype.__iterator=function(t,e){return new Vn(this,t,e)},e.prototype.__iterate=function(t,e){var n=this,r=0;return this._root&&this._root.iterate(function(e){return r++,t(e[1],e[0],n)},e),r},e.prototype.__ensureOwner=function(t){return t===this.__ownerID?this:t?Vt(this.size,this._root,t,this.__hash):0===this.size?Wt():(this.__ownerID=t,this.__altered=!1,this)},e}(Qe);Dn.isMap=P;var xn=Dn.prototype;xn[mn]=!0,xn.delete=xn.remove,xn.removeAll=xn.deleteAll,xn.setIn=gt,xn.removeIn=xn.deleteIn=mt,xn.update=bt,xn.updateIn=Et,xn.merge=xn.concat=wt,xn.mergeWith=St,xn.mergeDeep=kt,xn.mergeDeepWith=Pt,xn.mergeIn=Dt,xn.mergeDeepIn=xt,xn.withMutations=Mt,xn.wasAltered=Ut,xn.asImmutable=Ft,xn["@@transducer/init"]=xn.asMutable=Lt,xn["@@transducer/step"]=function(t,e){return t.set(e[0],e[1])},xn["@@transducer/result"]=function(t){return t.asImmutable()};var Mn=function(t,e){this.ownerID=t,this.entries=e};Mn.prototype.get=function(t,e,n,r){for(var i=this.entries,o=0,a=i.length;o<a;o++)if(M(n,i[o][0]))return i[o][1];return r},Mn.prototype.update=function(t,e,n,i,o,a,s){for(var u=o===qe,c=this.entries,l=0,h=c.length;l<h&&!M(i,c[l][0]);l++);var f=l<h;if(f?c[l][1]===o:u)return this;if(r(s),(u||!f)&&r(a),!u||1!==c.length){if(!f&&!u&&c.length>=Wn)return zt(t,c,i,o);var p=t&&t===this.ownerID,d=p?c:nt(c);return f?u?l===h-1?d.pop():d[l]=d.pop():d[l]=[i,o]:d.push([i,o]),p?(this.entries=d,this):new Mn(t,d)}};var Ln=function(t,e,n){this.ownerID=t,this.bitmap=e,this.nodes=n};Ln.prototype.get=function(t,e,n,r){void 0===e&&(e=F(n));var i=1<<((0===t?e:e>>>t)&We),o=this.bitmap;return 0==(o&i)?r:this.nodes[Qt(o&i-1)].get(t+Be,e,n,r)},Ln.prototype.update=function(t,e,n,r,i,o,a){void 0===n&&(n=F(r));var s=(0===e?n:n>>>e)&We,u=1<<s,c=this.bitmap,l=0!=(c&u);if(!l&&i===qe)return this;var h=Qt(c&u-1),f=this.nodes,p=l?f[h]:void 0,d=Ht(p,t,e+Be,n,r,i,o,a);if(d===p)return this;if(!l&&d&&f.length>=qn)return function(t,e,n,r,i){for(var o=0,a=new Array(Ve),s=0;0!==n;s++,n>>>=1)a[s]=1&n?e[o++]:void 0;return a[r]=i,new Fn(t,o+1,a)}(t,f,c,s,d);if(l&&!d&&2===f.length&&Gt(f[1^h]))return f[1^h];if(l&&d&&1===f.length&&Gt(d))return d;var v=t&&t===this.ownerID,g=l?d?c:c^u:c|u,y=l?d?Xt(f,h,d,v):function(t,e,n){var r=t.length-1;if(n&&e===r)return t.pop(),t;for(var i=new Array(r),o=0,a=0;a<r;a++)a===e&&(o=1),i[a]=t[a+o];return i}(f,h,v):function(t,e,n,r){var i=t.length+1;if(r&&e+1===i)return t[e]=n,t;for(var o=new Array(i),a=0,s=0;s<i;s++)s===e?(o[s]=n,a=-1):o[s]=t[s+a];return o}(f,h,d,v);return v?(this.bitmap=g,this.nodes=y,this):new Ln(t,g,y)};var Fn=function(t,e,n){this.ownerID=t,this.count=e,this.nodes=n};Fn.prototype.get=function(t,e,n,r){void 0===e&&(e=F(n));var i=(0===t?e:e>>>t)&We,o=this.nodes[i];return o?o.get(t+Be,e,n,r):r},Fn.prototype.update=function(t,e,n,r,i,o,a){void 0===n&&(n=F(r));var s=(0===e?n:n>>>e)&We,u=i===qe,c=this.nodes,l=c[s];if(u&&!l)return this;var h=Ht(l,t,e+Be,n,r,i,o,a);if(h===l)return this;var f=this.count;if(l){if(!h&&--f<Hn)return function(t,e,n,r){for(var i=0,o=0,a=new Array(n),s=0,u=1,c=e.length;s<c;s++,u<<=1){var l=e[s];void 0!==l&&s!==r&&(i|=u,a[o++]=l)}return new Ln(t,i,a)}(t,c,f,s)}else f++;var p=t&&t===this.ownerID,d=Xt(c,s,h,p);return p?(this.count=f,this.nodes=d,this):new Fn(t,f,d)};var Un=function(t,e,n){this.ownerID=t,this.keyHash=e,this.entries=n};Un.prototype.get=function(t,e,n,r){for(var i=this.entries,o=0,a=i.length;o<a;o++)if(M(n,i[o][0]))return i[o][1];return r},Un.prototype.update=function(t,e,n,i,o,a,s){void 0===n&&(n=F(i));var u=o===qe;if(n!==this.keyHash)return u?this:(r(s),r(a),Kt(this,t,e,n,[i,o]));for(var c=this.entries,l=0,h=c.length;l<h&&!M(i,c[l][0]);l++);var f=l<h;if(f?c[l][1]===o:u)return this;if(r(s),(u||!f)&&r(a),u&&2===h)return new jn(t,this.keyHash,c[1^l]);var p=t&&t===this.ownerID,d=p?c:nt(c);return f?u?l===h-1?d.pop():d[l]=d.pop():d[l]=[i,o]:d.push([i,o]),p?(this.entries=d,this):new Un(t,this.keyHash,d)};var jn=function(t,e,n){this.ownerID=t,this.keyHash=e,this.entry=n};jn.prototype.get=function(t,e,n,r){return M(n,this.entry[0])?this.entry[1]:r},jn.prototype.update=function(t,e,n,i,o,a,s){var u=o===qe,c=M(i,this.entry[0]);return(c?o===this.entry[1]:u)?this:(r(s),u?void r(a):c?t&&t===this.ownerID?(this.entry[1]=o,this):new jn(t,this.keyHash,[i,o]):(r(a),Kt(this,t,e,F(i),[i,o])))},Mn.prototype.iterate=Un.prototype.iterate=function(t,e){for(var n=this.entries,r=0,i=n.length-1;r<=i;r++)if(!1===t(n[e?i-r:r]))return!1},Ln.prototype.iterate=Fn.prototype.iterate=function(t,e){for(var n=this.nodes,r=0,i=n.length-1;r<=i;r++){var o=n[e?i-r:r];if(o&&!1===o.iterate(t,e))return!1}},jn.prototype.iterate=function(t,e){return t(this.entry)};var Bn,Vn=function(t){function e(t,e,n){this._type=e,this._reverse=n,this._stack=t._root&&Bt(t._root)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.next=function(){for(var t=this,e=this._type,n=this._stack;n;){var r=n.node,i=n.index++,o=void 0;if(r.entry){if(0===i)return jt(e,r.entry)}else if(r.entries){if(i<=(o=r.entries.length-1))return jt(e,r.entries[t._reverse?o-i:i])}else if(i<=(o=r.nodes.length-1)){var a=r.nodes[t._reverse?o-i:i];if(a){if(a.entry)return jt(e,a.entry);n=t._stack=Bt(a,n)}continue}n=t._stack=t._stack.__prev}return{value:void 0,done:!0}},e}(sn),Wn=Ve/4,qn=Ve/2,Hn=Ve/4,Gn="@@__IMMUTABLE_LIST__@@",Kn=function(t){function e(e){var n=Zt();if(null==e)return n;if(Yt(e))return e;var r=t(e),i=r.size;return 0===i?n:(it(i),i>0&&i<Ve?$t(0,i,Be,null,new Qn(r.toArray())):n.withMutations(function(t){t.setSize(i),r.forEach(function(e,n){return t.set(n,e)})}))}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.of=function(){return this(arguments)},e.prototype.toString=function(){return this.__toString("List [","]")},e.prototype.get=function(t,e){if((t=a(this,t))>=0&&t<this.size){var n=ne(this,t+=this._origin);return n&&n.array[t&We]}return e},e.prototype.set=function(t,e){return function(t,e,n){if((e=a(t,e))!==e)return t;if(e>=t.size||e<0)return t.withMutations(function(t){e<0?re(t,e).set(0,n):re(t,0,e+1).set(e,n)});e+=t._origin;var r=t._tail,i=t._root,o={value:!1};return e>=ie(t._capacity)?r=te(r,t.__ownerID,0,e,n,o):i=te(i,t.__ownerID,t._level,e,n,o),o.value?t.__ownerID?(t._root=i,t._tail=r,t.__hash=void 0,t.__altered=!0,t):$t(t._origin,t._capacity,t._level,i,r):t}(this,t,e)},e.prototype.remove=function(t){return this.has(t)?0===t?this.shift():t===this.size-1?this.pop():this.splice(t,1):this},e.prototype.insert=function(t,e){return this.splice(t,0,e)},e.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=this._origin=this._capacity=0,this._level=Be,this._root=this._tail=null,this.__hash=void 0,this.__altered=!0,this):Zt()},e.prototype.push=function(){var t=arguments,e=this.size;return this.withMutations(function(n){re(n,0,e+t.length);for(var r=0;r<t.length;r++)n.set(e+r,t[r])})},e.prototype.pop=function(){return re(this,0,-1)},e.prototype.unshift=function(){var t=arguments;return this.withMutations(function(e){re(e,-t.length);for(var n=0;n<t.length;n++)e.set(n,t[n])})},e.prototype.shift=function(){return re(this,1)},e.prototype.concat=function(){for(var e=arguments,n=[],r=0;r<arguments.length;r++){var i=e[r],o=t("string"!=typeof i&&S(i)?i:[i]);0!==o.size&&n.push(o)}return 0===n.length?this:0!==this.size||this.__ownerID||1!==n.length?this.withMutations(function(t){n.forEach(function(e){return e.forEach(function(e){return t.push(e)})})}):this.constructor(n[0])},e.prototype.setSize=function(t){return re(this,0,t)},e.prototype.map=function(t,e){var n=this;return this.withMutations(function(r){for(var i=0;i<n.size;i++)r.set(i,t.call(e,r.get(i),i,r))})},e.prototype.slice=function(t,e){var n=this.size;return u(t,e,n)?this:re(this,c(t,n),l(e,n))},e.prototype.__iterator=function(t,e){var n=e?this.size:0,r=Jt(this,e);return new sn(function(){var i=r();return i===Yn?{value:void 0,done:!0}:E(t,e?--n:n++,i)})},e.prototype.__iterate=function(t,e){for(var n,r=e?this.size:0,i=Jt(this,e);(n=i())!==Yn&&!1!==t(n,e?--r:r++,this););return r},e.prototype.__ensureOwner=function(t){return t===this.__ownerID?this:t?$t(this._origin,this._capacity,this._level,this._root,this._tail,t,this.__hash):0===this.size?Zt():(this.__ownerID=t,this.__altered=!1,this)},e}(Xe);Kn.isList=Yt;var zn=Kn.prototype;zn[Gn]=!0,zn.delete=zn.remove,zn.merge=zn.concat,zn.setIn=gt,zn.deleteIn=zn.removeIn=mt,zn.update=bt,zn.updateIn=Et,zn.mergeIn=Dt,zn.mergeDeepIn=xt,zn.withMutations=Mt,zn.wasAltered=Ut,zn.asImmutable=Ft,zn["@@transducer/init"]=zn.asMutable=Lt,zn["@@transducer/step"]=function(t,e){return t.push(e)},zn["@@transducer/result"]=function(t){return t.asImmutable()};var Qn=function(t,e){this.array=t,this.ownerID=e};Qn.prototype.removeBefore=function(t,e,n){if(n===e?1<<e:0===this.array.length)return this;var r=n>>>e&We;if(r>=this.array.length)return new Qn([],t);var i,o=0===r;if(e>0){var a=this.array[r];if((i=a&&a.removeBefore(t,e-Be,n))===a&&o)return this}if(o&&!i)return this;var s=ee(this,t);if(!o)for(var u=0;u<r;u++)s.array[u]=void 0;return i&&(s.array[r]=i),s},Qn.prototype.removeAfter=function(t,e,n){if(n===(e?1<<e:0)||0===this.array.length)return this;var r,i=n-1>>>e&We;if(i>=this.array.length)return this;if(e>0){var o=this.array[i];if((r=o&&o.removeAfter(t,e-Be,n))===o&&i===this.array.length-1)return this}var a=ee(this,t);return a.array.splice(i+1),r&&(a.array[i]=r),a};var Xn,Yn={},Jn=function(t){function e(t){return null==t?ae():D(t)?t:ae().withMutations(function(e){var n=Qe(t);it(n.size),n.forEach(function(t,n){return e.set(n,t)})})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.of=function(){return this(arguments)},e.prototype.toString=function(){return this.__toString("OrderedMap {","}")},e.prototype.get=function(t,e){var n=this._map.get(t);return void 0!==n?this._list.get(n)[1]:e},e.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._map.clear(),this._list.clear(),this):ae()},e.prototype.set=function(t,e){return se(this,t,e)},e.prototype.remove=function(t){return se(this,t,qe)},e.prototype.wasAltered=function(){return this._map.wasAltered()||this._list.wasAltered()},e.prototype.__iterate=function(t,e){var n=this;return this._list.__iterate(function(e){return e&&t(e[1],e[0],n)},e)},e.prototype.__iterator=function(t,e){return this._list.fromEntrySeq().__iterator(t,e)},e.prototype.__ensureOwner=function(t){if(t===this.__ownerID)return this;var e=this._map.__ensureOwner(t),n=this._list.__ensureOwner(t);return t?oe(e,n,t,this.__hash):0===this.size?ae():(this.__ownerID=t,this._map=e,this._list=n,this)},e}(Dn);Jn.isOrderedMap=D,Jn.prototype[Ze]=!0,Jn.prototype.delete=Jn.prototype.remove;var $n,Zn="@@__IMMUTABLE_STACK__@@",tr=function(t){function e(t){return null==t?le():ue(t)?t:le().pushAll(t)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.of=function(){return this(arguments)},e.prototype.toString=function(){return this.__toString("Stack [","]")},e.prototype.get=function(t,e){var n=this._head;for(t=a(this,t);n&&t--;)n=n.next;return n?n.value:e},e.prototype.peek=function(){return this._head&&this._head.value},e.prototype.push=function(){var t=arguments;if(0===arguments.length)return this;for(var e=this.size+arguments.length,n=this._head,r=arguments.length-1;r>=0;r--)n={value:t[r],next:n};return this.__ownerID?(this.size=e,this._head=n,this.__hash=void 0,this.__altered=!0,this):ce(e,n)},e.prototype.pushAll=function(e){if(0===(e=t(e)).size)return this;if(0===this.size&&ue(e))return e;it(e.size);var n=this.size,r=this._head;return e.__iterate(function(t){n++,r={value:t,next:r}},!0),this.__ownerID?(this.size=n,this._head=r,this.__hash=void 0,this.__altered=!0,this):ce(n,r)},e.prototype.pop=function(){return this.slice(1)},e.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._head=void 0,this.__hash=void 0,this.__altered=!0,this):le()},e.prototype.slice=function(e,n){if(u(e,n,this.size))return this;var r=c(e,this.size);if(l(n,this.size)!==this.size)return t.prototype.slice.call(this,e,n);for(var i=this.size-r,o=this._head;r--;)o=o.next;return this.__ownerID?(this.size=i,this._head=o,this.__hash=void 0,this.__altered=!0,this):ce(i,o)},e.prototype.__ensureOwner=function(t){return t===this.__ownerID?this:t?ce(this.size,this._head,t,this.__hash):0===this.size?le():(this.__ownerID=t,this.__altered=!1,this)},e.prototype.__iterate=function(t,e){var n=this;if(e)return new pn(this.toArray()).__iterate(function(e,r){return t(e,r,n)},e);for(var r=0,i=this._head;i&&!1!==t(i.value,r++,n);)i=i.next;return r},e.prototype.__iterator=function(t,e){if(e)return new pn(this.toArray()).__iterator(t,e);var n=0,r=this._head;return new sn(function(){if(r){var e=r.value;return r=r.next,E(t,n++,e)}return{value:void 0,done:!0}})},e}(Xe);tr.isStack=ue;var er=tr.prototype;er[Zn]=!0,er.shift=er.pop,er.unshift=er.push,er.unshiftAll=er.pushAll,er.withMutations=Mt,er.wasAltered=Ut,er.asImmutable=Ft,er["@@transducer/init"]=er.asMutable=Lt,er["@@transducer/step"]=function(t,e){return t.unshift(e)},er["@@transducer/result"]=function(t){return t.asImmutable()};var nr,rr="@@__IMMUTABLE_SET__@@",ir=function(t){function e(e){return null==e?me():he(e)&&!b(e)?e:me().withMutations(function(n){var r=t(e);it(r.size),r.forEach(function(t){return n.add(t)})})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.of=function(){return this(arguments)},e.fromKeys=function(t){return this(Qe(t).keySeq())},e.intersect=function(t){return(t=ze(t).toArray()).length?or.intersect.apply(e(t.pop()),t):me()},e.union=function(t){return(t=ze(t).toArray()).length?or.union.apply(e(t.pop()),t):me()},e.prototype.toString=function(){return this.__toString("Set {","}")},e.prototype.has=function(t){return this._map.has(t)},e.prototype.add=function(t){return ge(this,this._map.set(t,t))},e.prototype.remove=function(t){return ge(this,this._map.remove(t))},e.prototype.clear=function(){return ge(this,this._map.clear())},e.prototype.map=function(t,e){var n=this;return ge(this,this._map.map(function(e){return t(e,e,n)},e))},e.prototype.union=function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];return 0===(e=e.filter(function(t){return 0!==t.size})).length?this:0!==this.size||this.__ownerID||1!==e.length?this.withMutations(function(n){for(var r=0;r<e.length;r++)t(e[r]).forEach(function(t){return n.add(t)})}):this.constructor(e[0])},e.prototype.intersect=function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];if(0===e.length)return this;e=e.map(function(e){return t(e)});var r=[];return this.forEach(function(t){e.every(function(e){return e.includes(t)})||r.push(t)}),this.withMutations(function(t){r.forEach(function(e){t.remove(e)})})},e.prototype.subtract=function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];if(0===e.length)return this;e=e.map(function(e){return t(e)});var r=[];return this.forEach(function(t){e.some(function(e){return e.includes(t)})&&r.push(t)}),this.withMutations(function(t){r.forEach(function(e){t.remove(e)})})},e.prototype.sort=function(t){return fr(K(this,t))},e.prototype.sortBy=function(t,e){return fr(K(this,e,t))},e.prototype.wasAltered=function(){return this._map.wasAltered()},e.prototype.__iterate=function(t,e){var n=this;return this._map.__iterate(function(e){return t(e,e,n)},e)},e.prototype.__iterator=function(t,e){return this._map.__iterator(t,e)},e.prototype.__ensureOwner=function(t){if(t===this.__ownerID)return this;var e=this._map.__ensureOwner(t);return t?this.__make(e,t):0===this.size?this.__empty():(this.__ownerID=t,this._map=e,this)},e}(Ye);ir.isSet=he;var or=ir.prototype;or[rr]=!0,or.delete=or.remove,or.merge=or.concat=or.union,or.withMutations=Mt,or.asImmutable=Ft,or["@@transducer/init"]=or.asMutable=Lt,or["@@transducer/step"]=function(t,e){return t.add(e)},or["@@transducer/result"]=function(t){return t.asImmutable()},or.__empty=me,or.__make=ye;var ar,sr,ur=function(t){function e(t,n,r){if(!(this instanceof e))return new e(t,n,r);if(rt(0!==r,"Cannot step a Range by 0"),t=t||0,void 0===n&&(n=1/0),r=void 0===r?1:Math.abs(r),n<t&&(r=-r),this._start=t,this._end=n,this._step=r,this.size=Math.max(0,Math.ceil((n-t)/r-1)+1),0===this.size){if(sr)return sr;sr=this}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.toString=function(){return 0===this.size?"Range []":"Range [ "+this._start+"..."+this._end+(1!==this._step?" by "+this._step:"")+" ]"},e.prototype.get=function(t,e){return this.has(t)?this._start+a(this,t)*this._step:e},e.prototype.includes=function(t){var e=(t-this._start)/this._step;return e>=0&&e<this.size&&e===Math.floor(e)},e.prototype.slice=function(t,n){return u(t,n,this.size)?this:(t=c(t,this.size),(n=l(n,this.size))<=t?new e(0,0):new e(this.get(t,this._end),this.get(n,this._end),this._step))},e.prototype.indexOf=function(t){var e=t-this._start;if(e%this._step==0){var n=e/this._step;if(n>=0&&n<this.size)return n}return-1},e.prototype.lastIndexOf=function(t){return this.indexOf(t)},e.prototype.__iterate=function(t,e){for(var n=this.size,r=this._step,i=e?this._start+(n-1)*r:this._start,o=0;o!==n&&!1!==t(i,e?n-++o:o++,this);)i+=e?-r:r;return o},e.prototype.__iterator=function(t,e){var n=this.size,r=this._step,i=e?this._start+(n-1)*r:this._start,o=0;return new sn(function(){if(o===n)return{value:void 0,done:!0};var a=i;return i+=e?-r:r,E(t,e?n-++o:o++,a)})},e.prototype.equals=function(t){return t instanceof e?this._start===t._start&&this._end===t._end&&this._step===t._step:pe(this,t)},e}(hn);ze.isIterable=p,ze.isKeyed=d,ze.isIndexed=v,ze.isAssociative=g,ze.isOrdered=b,ze.Iterator=sn,de(ze,{toArray:function(){it(this.size);var t=new Array(this.size||0),e=d(this),n=0;return this.__iterate(function(r,i){t[n++]=e?[i,r]:r}),t},toIndexedSeq:function(){return new Nn(this)},toJS:function(){return ve(this)},toKeyedSeq:function(){return new Rn(this,!0)},toMap:function(){return Dn(this.toKeyedSeq())},toObject:we,toOrderedMap:function(){return Jn(this.toKeyedSeq())},toOrderedSet:function(){return fr(d(this)?this.valueSeq():this)},toSet:function(){return ir(d(this)?this.valueSeq():this)},toSetSeq:function(){return new kn(this)},toSeq:function(){return v(this)?this.toIndexedSeq():d(this)?this.toKeyedSeq():this.toSetSeq()},toStack:function(){return tr(d(this)?this.valueSeq():this)},toList:function(){return Kn(d(this)?this.valueSeq():this)},toString:function(){return"[Collection]"},__toString:function(t,e){return 0===this.size?t+e:t+" "+this.toSeq().map(this.__toStringMapper).join(", ")+" "+e},concat:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return Y(this,function(t,e){var n=d(t),r=[t].concat(e).map(function(t){return p(t)?n&&(t=Qe(t)):t=n?R(t):N(Array.isArray(t)?t:[t]),t}).filter(function(t){return 0!==t.size});if(0===r.length)return t;if(1===r.length){var i=r[0];if(i===t||n&&d(i)||v(t)&&v(i))return i}var o=new pn(r);return n?o=o.toKeyedSeq():v(t)||(o=o.toSetSeq()),(o=o.flatten(!0)).size=r.reduce(function(t,e){if(void 0!==t){var n=e.size;if(void 0!==n)return t+n}},0),o}(this,t))},includes:function(t){return this.some(function(e){return M(e,t)})},entries:function(){return this.__iterator(nn)},every:function(t,e){it(this.size);var n=!0;return this.__iterate(function(r,i,o){if(!t.call(e,r,i,o))return n=!1,!1}),n},filter:function(t,e){return Y(this,W(this,t,e,!0))},find:function(t,e,n){var r=this.findEntry(t,e);return r?r[1]:n},forEach:function(t,e){return it(this.size),this.__iterate(e?t.bind(e):t)},join:function(t){it(this.size),t=void 0!==t?""+t:",";var e="",n=!0;return this.__iterate(function(r){n?n=!1:e+=t,e+=null!=r?r.toString():""}),e},keys:function(){return this.__iterator(tn)},map:function(t,e){return Y(this,B(this,t,e))},reduce:function(t,e,n){return Se(this,t,e,n,arguments.length<2,!1)},reduceRight:function(t,e,n){return Se(this,t,e,n,arguments.length<2,!0)},reverse:function(){return Y(this,V(this,!0))},slice:function(t,e){return Y(this,q(this,t,e,!0))},some:function(t,e){return!this.every(Ae(t),e)},sort:function(t){return Y(this,K(this,t))},values:function(){return this.__iterator(en)},butLast:function(){return this.slice(0,-1)},isEmpty:function(){return void 0!==this.size?0===this.size:!this.some(function(){return!0})},count:function(t,e){return o(t?this.toSeq().filter(t,e):this)},countBy:function(t,e){return function(t,e,n){var r=Dn().asMutable();return t.__iterate(function(i,o){r.update(e.call(n,i,o,t),0,function(t){return t+1})}),r.asImmutable()}(this,t,e)},equals:function(t){return pe(this,t)},entrySeq:function(){var t=this;if(t._cache)return new pn(t._cache);var e=t.toSeq().map(Ie).toIndexedSeq();return e.fromEntrySeq=function(){return t.toSeq()},e},filterNot:function(t,e){return this.filter(Ae(t),e)},findEntry:function(t,e,n){var r=n;return this.__iterate(function(n,i,o){if(t.call(e,n,i,o))return r=[i,n],!1}),r},findKey:function(t,e){var n=this.findEntry(t,e);return n&&n[0]},findLast:function(t,e,n){return this.toKeyedSeq().reverse().find(t,e,n)},findLastEntry:function(t,e,n){return this.toKeyedSeq().reverse().findEntry(t,e,n)},findLastKey:function(t,e){return this.toKeyedSeq().reverse().findKey(t,e)},first:function(t){return this.find(s,null,t)},flatMap:function(t,e){return Y(this,function(t,e,n){var r=$(t);return t.toSeq().map(function(i,o){return r(e.call(n,i,o,t))}).flatten(!0)}(this,t,e))},flatten:function(t){return Y(this,G(this,t,!0))},fromEntrySeq:function(){return new Pn(this)},get:function(t,e){return this.find(function(e,n){return M(n,t)},void 0,e)},getIn:be,groupBy:function(t,e){return function(t,e,n){var r=d(t),i=(b(t)?Jn():Dn()).asMutable();t.__iterate(function(o,a){i.update(e.call(n,o,a,t),function(t){return(t=t||[]).push(r?[a,o]:o),t})});var o=$(t);return i.map(function(e){return Y(t,o(e))}).asImmutable()}(this,t,e)},has:function(t){return this.get(t,qe)!==qe},hasIn:function(t){return Ee(this,t)},isSubset:function(t){return t="function"==typeof t.includes?t:ze(t),this.every(function(e){return t.includes(e)})},isSuperset:function(t){return(t="function"==typeof t.isSubset?t:ze(t)).isSubset(this)},keyOf:function(t){return this.findKey(function(e){return M(e,t)})},keySeq:function(){return this.toSeq().map(Te).toIndexedSeq()},last:function(t){return this.toSeq().reverse().first(t)},lastKeyOf:function(t){return this.toKeyedSeq().reverse().keyOf(t)},max:function(t){return z(this,t)},maxBy:function(t,e){return z(this,e,t)},min:function(t){return z(this,t?Oe(t):Re)},minBy:function(t,e){return z(this,e?Oe(e):Re,t)},rest:function(){return this.slice(1)},skip:function(t){return 0===t?this:this.slice(Math.max(0,t))},skipLast:function(t){return 0===t?this:this.slice(0,-Math.max(0,t))},skipWhile:function(t,e){return Y(this,H(this,t,e,!0))},skipUntil:function(t,e){return this.skipWhile(Ae(t),e)},sortBy:function(t,e){return Y(this,K(this,e,t))},take:function(t){return this.slice(0,Math.max(0,t))},takeLast:function(t){return this.slice(-Math.max(0,t))},takeWhile:function(t,e){return Y(this,function(t,e,n){var r=Z(t);return r.__iterateUncached=function(r,i){var o=this;if(i)return this.cacheResult().__iterate(r,i);var a=0;return t.__iterate(function(t,i,s){return e.call(n,t,i,s)&&++a&&r(t,i,o)}),a},r.__iteratorUncached=function(r,i){var o=this;if(i)return this.cacheResult().__iterator(r,i);var a=t.__iterator(nn,i),s=!0;return new sn(function(){if(!s)return{value:void 0,done:!0};var t=a.next();if(t.done)return t;var i=t.value,u=i[0],c=i[1];return e.call(n,c,u,o)?r===nn?t:E(r,u,c,t):(s=!1,{value:void 0,done:!0})})},r}(this,t,e))},takeUntil:function(t,e){return this.takeWhile(Ae(t),e)},update:function(t){return t(this)},valueSeq:function(){return this.toIndexedSeq()},hashCode:function(){return this.__hash||(this.__hash=Ne(this))}});var cr=ze.prototype;cr[He]=!0,cr[an]=cr.values,cr.toJSON=cr.toArray,cr.__toStringMapper=ut,cr.inspect=cr.toSource=function(){return this.toString()},cr.chain=cr.flatMap,cr.contains=cr.includes,de(Qe,{flip:function(){return Y(this,j(this))},mapEntries:function(t,e){var n=this,r=0;return Y(this,this.toSeq().map(function(i,o){return t.call(e,[o,i],r++,n)}).fromEntrySeq())},mapKeys:function(t,e){var n=this;return Y(this,this.toSeq().flip().map(function(r,i){return t.call(e,r,i,n)}).flip())}});var lr=Qe.prototype;lr[Ge]=!0,lr[an]=cr.entries,lr.toJSON=we,lr.__toStringMapper=function(t,e){return ut(e)+": "+ut(t)},de(Xe,{toKeyedSeq:function(){return new Rn(this,!1)},filter:function(t,e){return Y(this,W(this,t,e,!1))},findIndex:function(t,e){var n=this.findEntry(t,e);return n?n[0]:-1},indexOf:function(t){var e=this.keyOf(t);return void 0===e?-1:e},lastIndexOf:function(t){var e=this.lastKeyOf(t);return void 0===e?-1:e},reverse:function(){return Y(this,V(this,!1))},slice:function(t,e){return Y(this,q(this,t,e,!1))},splice:function(t,e){var n=arguments.length;if(e=Math.max(e||0,0),0===n||2===n&&!e)return this;t=c(t,t<0?this.count():this.size);var r=this.slice(0,t);return Y(this,1===n?r:r.concat(nt(arguments,2),this.slice(t+e)))},findLastIndex:function(t,e){var n=this.findLastEntry(t,e);return n?n[0]:-1},first:function(t){return this.get(0,t)},flatten:function(t){return Y(this,G(this,t,!1))},get:function(t,e){return(t=a(this,t))<0||this.size===1/0||void 0!==this.size&&t>this.size?e:this.find(function(e,n){return n===t},void 0,e)},has:function(t){return(t=a(this,t))>=0&&(void 0!==this.size?this.size===1/0||t<this.size:-1!==this.indexOf(t))},interpose:function(t){return Y(this,function(t,e){var n=Z(t);return n.size=t.size&&2*t.size-1,n.__iterateUncached=function(n,r){var i=this,o=0;return t.__iterate(function(t){return(!o||!1!==n(e,o++,i))&&!1!==n(t,o++,i)},r),o},n.__iteratorUncached=function(n,r){var i,o=t.__iterator(en,r),a=0;return new sn(function(){return(!i||a%2)&&(i=o.next()).done?i:a%2?E(n,a++,e):E(n,a++,i.value,i)})},n}(this,t))},interleave:function(){var t=[this].concat(nt(arguments)),e=X(this.toSeq(),hn.of,t),n=e.flatten(!0);return e.size&&(n.size=e.size*t.length),Y(this,n)},keySeq:function(){return ur(0,this.size)},last:function(t){return this.get(-1,t)},skipWhile:function(t,e){return Y(this,H(this,t,e,!1))},zip:function(){return Y(this,X(this,Ce,[this].concat(nt(arguments))))},zipAll:function(){return Y(this,X(this,Ce,[this].concat(nt(arguments)),!0))},zipWith:function(t){var e=nt(arguments);return e[0]=this,Y(this,X(this,t,e))}});var hr=Xe.prototype;hr[Ke]=!0,hr[Ze]=!0,de(Ye,{get:function(t,e){return this.has(t)?t:e},includes:function(t){return this.has(t)},keySeq:function(){return this.valueSeq()}}),Ye.prototype.has=cr.includes,Ye.prototype.contains=Ye.prototype.includes,de(ln,Qe.prototype),de(hn,Xe.prototype),de(fn,Ye.prototype);var fr=function(t){function e(t){return null==t?De():fe(t)?t:De().withMutations(function(e){var n=Ye(t);it(n.size),n.forEach(function(t){return e.add(t)})})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.of=function(){return this(arguments)},e.fromKeys=function(t){return this(Qe(t).keySeq())},e.prototype.toString=function(){return this.__toString("OrderedSet {","}")},e}(ir);fr.isOrderedSet=fe;var pr=fr.prototype;pr[Ze]=!0,pr.zip=hr.zip,pr.zipWith=hr.zipWith,pr.__empty=De,pr.__make=Pe;var dr,vr=function(t,e){var n,r=function(o){var a=this;if(o instanceof r)return o;if(!(this instanceof r))return new r(o);if(!n){n=!0;var s=Object.keys(t),u=i._indices={};i._name=e,i._keys=s,i._defaultValues=t;for(var c=0;c<s.length;c++){var l=s[c];u[l]=c,i[l]?"object"==typeof console&&console.warn&&console.warn("Cannot define "+Me(a)+' with property "'+l+'" since that property name is part of the Record API.'):Fe(i,l)}}this.__ownerID=void 0,this._values=Kn().withMutations(function(t){t.setSize(a._keys.length),Qe(o).forEach(function(e,n){t.set(a._indices[n],e===a._defaultValues[n]?void 0:e)})})},i=r.prototype=Object.create(gr);return i.constructor=r,r};vr.prototype.toString=function(){for(var t,e=Me(this)+" { ",n=this._keys,r=0,i=n.length;r!==i;r++)e+=(r?", ":"")+(t=n[r])+": "+ut(this.get(t));return e+" }"},vr.prototype.equals=function(t){return this===t||t&&this._keys===t._keys&&Le(this).equals(Le(t))},vr.prototype.hashCode=function(){return Le(this).hashCode()},vr.prototype.has=function(t){return this._indices.hasOwnProperty(t)},vr.prototype.get=function(t,e){if(!this.has(t))return e;var n=this._indices[t],r=this._values.get(n);return void 0===r?this._defaultValues[t]:r},vr.prototype.set=function(t,e){if(this.has(t)){var n=this._values.set(this._indices[t],e===this._defaultValues[t]?void 0:e);if(n!==this._values&&!this.__ownerID)return xe(this,n)}return this},vr.prototype.remove=function(t){return this.set(t)},vr.prototype.clear=function(){var t=this._values.clear().setSize(this._keys.length);return this.__ownerID?this:xe(this,t)},vr.prototype.wasAltered=function(){return this._values.wasAltered()},vr.prototype.toSeq=function(){return Le(this)},vr.prototype.toJS=function(){return ve(this)},vr.prototype.entries=function(){return this.__iterator(nn)},vr.prototype.__iterator=function(t,e){return Le(this).__iterator(t,e)},vr.prototype.__iterate=function(t,e){return Le(this).__iterate(t,e)},vr.prototype.__ensureOwner=function(t){if(t===this.__ownerID)return this;var e=this._values.__ensureOwner(t);return t?xe(this,e,t):(this.__ownerID=t,this._values=e,this)},vr.isRecord=m,vr.getDescriptiveName=Me;var gr=vr.prototype;gr[$e]=!0,gr.delete=gr.remove,gr.deleteIn=gr.removeIn=mt,gr.getIn=be,gr.hasIn=cr.hasIn,gr.merge=wt,gr.mergeWith=St,gr.mergeIn=Dt,gr.mergeDeep=kt,gr.mergeDeepWith=Pt,gr.mergeDeepIn=xt,gr.setIn=gt,gr.update=bt,gr.updateIn=Et,gr.withMutations=Mt,gr.asMutable=Lt,gr.asImmutable=Ft,gr[an]=gr.entries,gr.toJSON=gr.toObject=cr.toObject,gr.inspect=gr.toSource=function(){return this.toString()};var yr,mr=function(t){function e(t,n){if(!(this instanceof e))return new e(t,n);if(this._value=t,this.size=void 0===n?1/0:Math.max(0,n),0===this.size){if(yr)return yr;yr=this}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.toString=function(){return 0===this.size?"Repeat []":"Repeat [ "+this._value+" "+this.size+" times ]"},e.prototype.get=function(t,e){return this.has(t)?this._value:e},e.prototype.includes=function(t){return M(this._value,t)},e.prototype.slice=function(t,n){var r=this.size;return u(t,n,r)?this:new e(this._value,l(n,r)-c(t,r))},e.prototype.reverse=function(){return this},e.prototype.indexOf=function(t){return M(this._value,t)?0:-1},e.prototype.lastIndexOf=function(t){return M(this._value,t)?this.size:-1},e.prototype.__iterate=function(t,e){for(var n=this.size,r=0;r!==n&&!1!==t(this._value,e?n-++r:r++,this););return r},e.prototype.__iterator=function(t,e){var n=this,r=this.size,i=0;return new sn(function(){return i===r?{value:void 0,done:!0}:E(t,e?r-++i:i++,n._value)})},e.prototype.equals=function(t){return t instanceof e?M(this._value,t._value):pe(t)},e}(hn),_r="4.0.0-rc.10",br={version:_r,Collection:ze,Iterable:ze,Seq:cn,Map:Dn,OrderedMap:Jn,List:Kn,Stack:tr,Set:ir,OrderedSet:fr,Record:vr,Range:ur,Repeat:mr,is:M,fromJS:Ue,hash:F,isImmutable:_,isCollection:p,isKeyed:d,isIndexed:v,isAssociative:g,isOrdered:b,isValueObject:x,isSeq:y,isList:Yt,isMap:P,isOrderedMap:D,isStack:ue,isSet:he,isOrderedSet:fe,isRecord:m,get:lt,getIn:_e,has:ct,hasIn:Ee,merge:It,mergeDeep:Ot,mergeWith:At,mergeDeepWith:Ct,remove:ft,removeIn:yt,set:pt,setIn:vt,update:_t,updateIn:dt},Er=ze;e.default=br},function(t,e,n){t.exports=!n(5)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e,n){var r=n(2),i=n(177),o=n(35),a=Object.defineProperty;e.f=n(10)?Object.defineProperty:function(t,e,n){if(r(t),e=o(e,!0),r(n),i)try{return a(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){var r=n(37),i=Math.min;t.exports=function(t){return t>0?i(r(t),9007199254740991):0}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(4),i=n(1),o=function(){function t(t,e){if(void 0===e){this.pieces_=t.split("/");for(var n=0,r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[n]=this.pieces_[r],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=e}return Object.defineProperty(t,"Empty",{get:function(){return new t("")},enumerable:!0,configurable:!0}),t.prototype.getFront=function(){return this.pieceNum_>=this.pieces_.length?null:this.pieces_[this.pieceNum_]},t.prototype.getLength=function(){return this.pieces_.length-this.pieceNum_},t.prototype.popFront=function(){var e=this.pieceNum_;return e<this.pieces_.length&&e++,new t(this.pieces_,e)},t.prototype.getBack=function(){return this.pieceNum_<this.pieces_.length?this.pieces_[this.pieces_.length-1]:null},t.prototype.toString=function(){for(var t="",e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+this.pieces_[e]);return t||"/"},t.prototype.toUrlEncodedString=function(){for(var t="",e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+encodeURIComponent(String(this.pieces_[e])));return t||"/"},t.prototype.slice=function(t){return void 0===t&&(t=0),this.pieces_.slice(this.pieceNum_+t)},t.prototype.parent=function(){if(this.pieceNum_>=this.pieces_.length)return null;for(var e=[],n=this.pieceNum_;n<this.pieces_.length-1;n++)e.push(this.pieces_[n]);return new t(e,0)},t.prototype.child=function(e){for(var n=[],r=this.pieceNum_;r<this.pieces_.length;r++)n.push(this.pieces_[r]);if(e instanceof t)for(r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{var i=e.split("/");for(r=0;r<i.length;r++)i[r].length>0&&n.push(i[r])}return new t(n,0)},t.prototype.isEmpty=function(){return this.pieceNum_>=this.pieces_.length},t.relativePath=function(e,n){var r=e.getFront(),i=n.getFront();if(null===r)return n;if(r===i)return t.relativePath(e.popFront(),n.popFront());throw new Error("INTERNAL ERROR: innerPath ("+n+") is not within outerPath ("+e+")")},t.comparePaths=function(t,e){for(var n=t.slice(),i=e.slice(),o=0;o<n.length&&o<i.length;o++){var a=r.nameCompare(n[o],i[o]);if(0!==a)return a}return n.length===i.length?0:n.length<i.length?-1:1},t.prototype.equals=function(t){if(this.getLength()!==t.getLength())return!1;for(var e=this.pieceNum_,n=t.pieceNum_;e<=this.pieces_.length;e++,n++)if(this.pieces_[e]!==t.pieces_[n])return!1;return!0},t.prototype.contains=function(t){var e=this.pieceNum_,n=t.pieceNum_;if(this.getLength()>t.getLength())return!1;for(;e<this.pieces_.length;){if(this.pieces_[e]!==t.pieces_[n])return!1;++e,++n}return!0},t}();e.Path=o;var a=function(){function t(t,e){this.errorPrefix_=e,this.parts_=t.slice(),this.byteLength_=Math.max(1,this.parts_.length);for(var n=0;n<this.parts_.length;n++)this.byteLength_+=i.stringLength(this.parts_[n]);this.checkValid_()}return Object.defineProperty(t,"MAX_PATH_DEPTH",{get:function(){return 32},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MAX_PATH_LENGTH_BYTES",{get:function(){return 768},enumerable:!0,configurable:!0}),t.prototype.push=function(t){this.parts_.length>0&&(this.byteLength_+=1),this.parts_.push(t),this.byteLength_+=i.stringLength(t),this.checkValid_()},t.prototype.pop=function(){var t=this.parts_.pop();this.byteLength_-=i.stringLength(t),this.parts_.length>0&&(this.byteLength_-=1)},t.prototype.checkValid_=function(){if(this.byteLength_>t.MAX_PATH_LENGTH_BYTES)throw new Error(this.errorPrefix_+"has a key path longer than "+t.MAX_PATH_LENGTH_BYTES+" bytes ("+this.byteLength_+").");if(this.parts_.length>t.MAX_PATH_DEPTH)throw new Error(this.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+t.MAX_PATH_DEPTH+") or object contains a cycle "+this.toErrorString())},t.prototype.toErrorString=function(){return 0==this.parts_.length?"":"in property '"+this.parts_.join(".")+"'"},t}();e.ValidationPath=a},function(t,e,n){var r=n(36);t.exports=function(t){return Object(r(t))}},function(t,e,n){var r=n(500);n(154),n(215),n(554),n(555),t.exports=r},function(t,e,n){"use strict";function r(t,e){throw c.create(t,e)}n.r(e);var i=n(1),o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a="[DEFAULT]",s=[],u=function(){function t(t,e,n){this.firebase_=n,this.isDeleted_=!1,this.services_={},this.name_=e,this.options_=Object(i.deepCopy)(t),this.INTERNAL={getUid:function(){return null},getToken:function(){return Promise.resolve(null)},addAuthTokenListener:function(t){s.push(t),setTimeout(function(){return t(null)},0)},removeAuthTokenListener:function(t){s=s.filter(function(e){return e!==t})}}}return Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise(function(e){t.checkDestroyed_(),e()}).then(function(){t.firebase_.INTERNAL.removeApp(t.name_);var e=[];return Object.keys(t.services_).forEach(function(n){Object.keys(t.services_[n]).forEach(function(r){e.push(t.services_[n][r])})}),Promise.all(e.map(function(t){return t.INTERNAL.delete()}))}).then(function(){t.isDeleted_=!0,t.services_={}})},t.prototype._getService=function(t,e){if(void 0===e&&(e=a),this.checkDestroyed_(),this.services_[t]||(this.services_[t]={}),!this.services_[t][e]){var n=e!==a?e:void 0,r=this.firebase_.INTERNAL.factories[t](this,this.extendApp.bind(this),n);this.services_[t][e]=r}return this.services_[t][e]},t.prototype.extendApp=function(t){var e=this;Object(i.deepExtend)(this,t),t.INTERNAL&&t.INTERNAL.addAuthTokenListener&&(s.forEach(function(t){e.INTERNAL.addAuthTokenListener(t)}),s=[])},t.prototype.checkDestroyed_=function(){this.isDeleted_&&r("app-deleted",{name:this.name_})},t}();u.prototype.name&&u.prototype.options||u.prototype.delete||console.log("dc");var c=new i.ErrorFactory("app","Firebase",{"no-app":"No Firebase App '{$name}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$name}","duplicate-app":"Firebase App named '{$name}' already exists","app-deleted":"Firebase App named '{$name}' already deleted","duplicate-service":"Firebase service named '{$name}' already registered","sa-not-supported":"Initializing the Firebase SDK with a service account is only allowed in a Node.js environment. On client devices, you should instead initialize the SDK with an api key and auth domain","invalid-app-argument":"firebase.{$name}() takes either no argument or a Firebase App instance."});n.d(e,"firebase",function(){return l});var l=function t(){function e(t){return o(l,t=t||a)||r("no-app",{name:t}),l[t]}function n(){return Object.keys(l).map(function(t){return l[t]})}function s(t,e){Object.keys(h).forEach(function(n){var r=c(t,n);null!==r&&f[r]&&f[r](e,t)})}function c(t,e){if("serverAuth"===e)return null;var n=e;return t.options,n}var l={},h={},f={},p={__esModule:!0,initializeApp:function(t,e){void 0===e?e=a:"string"==typeof e&&""!==e||r("bad-app-name",{name:e+""}),o(l,e)&&r("duplicate-app",{name:e});var n=new u(t,e,p);return l[e]=n,s(n,"create"),n},app:e,apps:null,Promise:Promise,SDK_VERSION:"4.9.1",INTERNAL:{registerService:function(t,o,a,s,c){h[t]&&r("duplicate-service",{name:t}),h[t]=o,s&&(f[t]=s,n().forEach(function(t){s("create",t)}));var l=function(n){return void 0===n&&(n=e()),"function"!=typeof n[t]&&r("invalid-app-argument",{name:t}),n[t]()};return void 0!==a&&Object(i.deepExtend)(l,a),p[t]=l,u.prototype[t]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return this._getService.bind(this,t).apply(this,c?e:[])},l},createFirebaseNamespace:t,extendNamespace:function(t){Object(i.deepExtend)(p,t)},createSubscribe:i.createSubscribe,ErrorFactory:i.ErrorFactory,removeApp:function(t){s(l[t],"delete"),delete l[t]},factories:h,useAsService:c,Promise:Promise,deepExtend:i.deepExtend}};return Object(i.patchProperty)(p,"default",p),Object.defineProperty(p,"apps",{get:n}),Object(i.patchProperty)(e,"App",u),p}();e.default=l},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,n){"use strict";var r=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});var i=n(112),o=n(49);e.TrackerActions={userProfile:{},app:"",enableTracking:!1,trackUserId:function(t){return function(n){e.TrackerActions.enableTracking&&i.TrackerAsyncFunction.trackUserId(t)}},trackBasicUserProfile:function(t){return function(n){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(e.TrackerActions.enableTracking){n.next=2;break}return n.abrupt("return");case 2:e.TrackerActions.userProfile=t,amplitude.getInstance().setUserProperties(t),ga("set","profile",t),ga("set","dimension1",t.uid),ga("set","dimension2",t.email),ga("set","dimension3",t.displayName),mixpanel.people.set(t),mixpanel.identify(t.uid);case 10:case"end":return n.stop()}},n,this)}))}},trackIsAnonymous:function(t){return function(n){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(e.TrackerActions.enableTracking){n.next=2;break}return n.abrupt("return");case 2:amplitude.getInstance().setUserProperties({isAnonymous:t});case 3:case"end":return n.stop()}},n,this)}))}},trackQuestionnaireV1:function(t){return function(n){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(e.TrackerActions.enableTracking){n.next=2;break}return n.abrupt("return");case 2:e.TrackerActions.userProfile.purpose=t.purpose,e.TrackerActions.userProfile.userRole=t.userRole,e.TrackerActions.userProfile.expertField=t.expertField,e.TrackerActions.userProfile.nameOfSchool=t.nameOfSchool,mixpanel.people.set(e.TrackerActions.userProfile),mixpanel.identify(e.TrackerActions.userProfile.uid),amplitude.getInstance().setUserProperties(e.TrackerActions.userProfile);case 9:case"end":return n.stop()}},n,this)}))}},trackChannels:function(t){return function(n){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function n(){var r,i,o,a,s,u,c;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(e.TrackerActions.enableTracking){n.next=2;break}return n.abrupt("return");case 2:for(r=Object.keys(t),i=!0,o=!1,a=void 0,n.prev=6,s=r[Symbol.iterator]();!(i=(u=s.next()).done);i=!0)c=u.value,e.TrackerActions.userProfile["HEAR_US_FROM_"+c]=t[c];n.next=14;break;case 10:n.prev=10,n.t0=n.catch(6),o=!0,a=n.t0;case 14:n.prev=14,n.prev=15,!i&&s.return&&s.return();case 17:if(n.prev=17,!o){n.next=20;break}throw a;case 20:return n.finish(17);case 21:return n.finish(14);case 22:mixpanel.people.set(e.TrackerActions.userProfile),mixpanel.identify(e.TrackerActions.userProfile.uid),amplitude.getInstance().setUserProperties(e.TrackerActions.userProfile);case 25:case"end":return n.stop()}},n,this,[[6,10,14,22],[15,,17,21]])}))}},trackUserABTest:function(t,n){return function(i){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(e.TrackerActions.enableTracking){r.next=2;break}return r.abrupt("return");case 2:e.TrackerActions.userProfile[t]=n,mixpanel.people.set(e.TrackerActions.userProfile),mixpanel.identify(e.TrackerActions.userProfile.uid),amplitude.getInstance().setUserProperties(e.TrackerActions.userProfile);case 6:case"end":return r.stop()}},r,this)}))}},trackStripeData:function(t){return function(n){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=["annual","annaul","monthly","early"],e.TrackerActions.userProfile.subscriptionPlan=t,i=!1,r.forEach(function(e){-1!==t.toLocaleLowerCase().indexOf(e)&&(i=!0)}),e.TrackerActions.userProfile.paid=i,console.log("track stripe data",e.TrackerActions.userProfile),e.TrackerActions.enableTracking){n.next=8;break}return n.abrupt("return");case 8:mixpanel.people.set(e.TrackerActions.userProfile),mixpanel.identify(e.TrackerActions.userProfile.uid),amplitude.getInstance().setUserProperties(e.TrackerActions.userProfile);case 11:case"end":return n.stop()}},n,this)}))}},trackLoginData:function(t){return function(n){e.TrackerActions.enableTracking&&(e.TrackerActions.userProfile.createdAt=t.createdAt,e.TrackerActions.userProfile.lastSignedInAt=t.lastSignedInAt,e.TrackerActions.userProfile.$email=e.TrackerActions.userProfile.email,e.TrackerActions.userProfile.$timezone="UTC",mixpanel.people.set(e.TrackerActions.userProfile),mixpanel.identify(e.TrackerActions.userProfile.uid))}},trackEvent:function(t,n){return function(r){t?(o.weavaLogger.log("Tracker","grey","white",t,n),e.TrackerActions.enableTracking&&i.TrackerAsyncFunction.trackEvent(t,n,e.TrackerActions.app)):console.error("Event is undefined!")}}}},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i,o,a=n(107),s=n(4),u=n(29),c=n(108);e.setNodeFromJSON=function(t){i=t},e.setMaxNode=function(t){o=t};var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.compare=function(t,e){var n=t.node.getPriority(),r=e.node.getPriority(),i=n.compareTo(r);return 0===i?s.nameCompare(t.name,e.name):i},e.prototype.isDefinedOn=function(t){return!t.getPriority().isEmpty()},e.prototype.indexedValueChanged=function(t,e){return!t.getPriority().equals(e.getPriority())},e.prototype.minPost=function(){return u.NamedNode.MIN},e.prototype.maxPost=function(){return new u.NamedNode(s.MAX_NAME,new c.LeafNode("[PRIORITY-POST]",o))},e.prototype.makePost=function(t,e){var n=i(t);return new u.NamedNode(e,new c.LeafNode("[PRIORITY-POST]",n))},e.prototype.toString=function(){return".priority"},e}(a.Index);e.PriorityIndex=l,e.PRIORITY_INDEX=new l},function(t,e,n){var r=n(11),i=n(51);t.exports=n(10)?function(t,e,n){return r.f(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){var r=n(3),i=n(20),o=n(25),a=n(52)("src"),s=Function.toString,u=(""+s).split("toString");n(34).inspectSource=function(t){return s.call(t)},(t.exports=function(t,e,n,s){var c="function"==typeof n;c&&(o(n,"name")||i(n,"name",e)),t[e]!==n&&(c&&(o(n,a)||i(n,a,t[e]?""+t[e]:u.join(String(e)))),t===r?t[e]=n:s?t[e]?t[e]=n:i(t,e,n):(delete t[e],i(t,e,n)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[a]||s.call(this)})},function(t,e,n){var r=n(0),i=n(5),o=n(36),a=/"/g,s=function(t,e,n,r){var i=String(o(t)),s="<"+e;return""!==n&&(s+=" "+n+'="'+String(r).replace(a,"&quot;")+'"'),s+">"+i+"</"+e+">"};t.exports=function(t,e){var n={};n[t]=e(s),r(r.P+r.F*i(function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3}),"String",n)}},function(t,e,n){"use strict";t.exports=function(t){var e,n={};if(!(t instanceof Object)||Array.isArray(t))throw new Error("keyMirror(...): Argument must be an object.");for(e in t)t.hasOwnProperty(e)&&(n[e]=e);return n}},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i,o=n(1),a=n(4),s=n(109),u=n(29),c=n(221),l=n(19),h=n(81),f=n(223),p=n(108),d=n(225),v=function(){function t(t,e,n){this.children_=t,this.priorityNode_=e,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&c.validatePriorityNode(this.priorityNode_),this.children_.isEmpty()&&o.assert(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(t,"EMPTY_NODE",{get:function(){return i||(i=new t(new s.SortedMap(d.NAME_COMPARATOR),null,f.IndexMap.Default))},enumerable:!0,configurable:!0}),t.prototype.isLeafNode=function(){return!1},t.prototype.getPriority=function(){return this.priorityNode_||i},t.prototype.updatePriority=function(e){return this.children_.isEmpty()?this:new t(this.children_,e,this.indexMap_)},t.prototype.getImmediateChild=function(t){if(".priority"===t)return this.getPriority();var e=this.children_.get(t);return null===e?i:e},t.prototype.getChild=function(t){var e=t.getFront();return null===e?this:this.getImmediateChild(e).getChild(t.popFront())},t.prototype.hasChild=function(t){return null!==this.children_.get(t)},t.prototype.updateImmediateChild=function(e,n){if(o.assert(n,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(n);var r,a=new u.NamedNode(e,n),s=void 0,c=void 0;return n.isEmpty()?(s=this.children_.remove(e),c=this.indexMap_.removeFromIndexes(a,this.children_)):(s=this.children_.insert(e,n),c=this.indexMap_.addToIndexes(a,this.children_)),r=s.isEmpty()?i:this.priorityNode_,new t(s,r,c)},t.prototype.updateChild=function(t,e){var n=t.getFront();if(null===n)return e;o.assert(".priority"!==t.getFront()||1===t.getLength(),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(t.popFront(),e);return this.updateImmediateChild(n,r)},t.prototype.isEmpty=function(){return this.children_.isEmpty()},t.prototype.numChildren=function(){return this.children_.count()},t.prototype.val=function(e){if(this.isEmpty())return null;var n={},r=0,i=0,o=!0;if(this.forEachChild(l.PRIORITY_INDEX,function(a,s){n[a]=s.val(e),r++,o&&t.INTEGER_REGEXP_.test(a)?i=Math.max(i,Number(a)):o=!1}),!e&&o&&i<2*r){var a=[];for(var s in n)a[s]=n[s];return a}return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.getPriority().isEmpty()||(t+="priority:"+c.priorityHashText(this.getPriority().val())+":"),this.forEachChild(l.PRIORITY_INDEX,function(e,n){var r=n.hash();""!==r&&(t+=":"+e+":"+r)}),this.lazyHash_=""===t?"":a.sha1(t)}return this.lazyHash_},t.prototype.getPredecessorChildName=function(t,e,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new u.NamedNode(t,e));return i?i.name:null}return this.children_.getPredecessorKey(t)},t.prototype.getFirstChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.minKey();return n&&n.name}return this.children_.minKey()},t.prototype.getFirstChild=function(t){var e=this.getFirstChildName(t);return e?new u.NamedNode(e,this.children_.get(e)):null},t.prototype.getLastChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.maxKey();return n&&n.name}return this.children_.maxKey()},t.prototype.getLastChild=function(t){var e=this.getLastChildName(t);return e?new u.NamedNode(e,this.children_.get(e)):null},t.prototype.forEachChild=function(t,e){var n=this.resolveIndex_(t);return n?n.inorderTraversal(function(t){return e(t.name,t.node)}):this.children_.inorderTraversal(e)},t.prototype.getIterator=function(t){return this.getIteratorFrom(t.minPost(),t)},t.prototype.getIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getIteratorFrom(t,function(t){return t});for(var r=this.children_.getIteratorFrom(t.name,u.NamedNode.Wrap),i=r.peek();null!=i&&e.compare(i,t)<0;)r.getNext(),i=r.peek();return r},t.prototype.getReverseIterator=function(t){return this.getReverseIteratorFrom(t.maxPost(),t)},t.prototype.getReverseIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getReverseIteratorFrom(t,function(t){return t});for(var r=this.children_.getReverseIteratorFrom(t.name,u.NamedNode.Wrap),i=r.peek();null!=i&&e.compare(i,t)>0;)r.getNext(),i=r.peek();return r},t.prototype.compareTo=function(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===e.MAX_NODE?-1:0},t.prototype.withIndex=function(e){if(e===h.KEY_INDEX||this.indexMap_.hasIndex(e))return this;var n=this.indexMap_.addIndex(e,this.children_);return new t(this.children_,this.priorityNode_,n)},t.prototype.isIndexed=function(t){return t===h.KEY_INDEX||this.indexMap_.hasIndex(t)},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode())return!1;var e=t;if(this.getPriority().equals(e.getPriority())){if(this.children_.count()===e.children_.count()){for(var n=this.getIterator(l.PRIORITY_INDEX),r=e.getIterator(l.PRIORITY_INDEX),i=n.getNext(),o=r.getNext();i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=n.getNext(),o=r.getNext()}return null===i&&null===o}return!1}return!1},t.prototype.resolveIndex_=function(t){return t===h.KEY_INDEX?null:this.indexMap_.get(t.toString())},t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t}();e.ChildrenNode=v;var g=function(t){function e(){return t.call(this,new s.SortedMap(d.NAME_COMPARATOR),v.EMPTY_NODE,f.IndexMap.Default)||this}return r(e,t),e.prototype.compareTo=function(t){return t===this?0:1},e.prototype.equals=function(t){return t===this},e.prototype.getPriority=function(){return this},e.prototype.getImmediateChild=function(t){return v.EMPTY_NODE},e.prototype.isEmpty=function(){return!1},e}(v);e.MaxNode=g,e.MAX_NODE=new g,Object.defineProperties(u.NamedNode,{MIN:{value:new u.NamedNode(a.MIN_NAME,v.EMPTY_NODE)},MAX:{value:new u.NamedNode(a.MAX_NAME,e.MAX_NODE)}}),h.KeyIndex.__EMPTY_NODE=v.EMPTY_NODE,p.LeafNode.__childrenNodeConstructor=v,c.setMaxNode(e.MAX_NODE),l.setMaxNode(e.MAX_NODE)},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){var r=n(76),i=n(36);t.exports=function(t){return r(i(t))}},function(t,e,n){var r=n(77),i=n(51),o=n(26),a=n(35),s=n(25),u=n(177),c=Object.getOwnPropertyDescriptor;e.f=n(10)?c:function(t,e){if(t=o(t),e=a(e,!0),u)try{return c(t,e)}catch(t){}if(s(t,e))return i(!r.f.call(t,e),t[e])}},function(t,e,n){var r=n(25),i=n(14),o=n(126)("IE_PROTO"),a=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),r(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?a:null}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){this.name=t,this.node=e}return t.Wrap=function(e,n){return new t(e,n)},t}();e.NamedNode=r},function(t,e,n){var r=n(17);t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}}},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e,n){"use strict";var r=n(5);t.exports=function(t,e){return!!t&&r(function(){e?t.call(null,function(){},1):t.call(null)})}},function(module,exports,__webpack_require__){(function(global){(function(){function l(t){return"string"==typeof t}function aa(){}function ba(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function n(t){return"array"==ba(t)}function ca(t){var e=ba(t);return"array"==e||"object"==e&&"number"==typeof t.length}function da(t){return"function"==ba(t)}function p(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function fa(t,e,n){return t.call.apply(t.bind,arguments)}function ha(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function r(t,e,n){return(r=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?fa:ha).apply(null,arguments)}function ia(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function u(t,e){function n(){}n.prototype=e.prototype,t.H=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Cb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function ja(t){if(Error.captureStackTrace)Error.captureStackTrace(this,ja);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function ka(t,e){for(var n=t.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")}function ma(t,e){return t<e?-1:t>e?1:0}function na(t,e){e.unshift(t),ja.call(this,ka.apply(null,e)),e.shift()}function oa(t,e){throw new na("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}function w(){0!=qa&&(ra[this[q]||(this[q]=++ea)]=this),this.i=this.i,this.w=this.w}function ua(t){t:{for(var e=va,n=t.length,r=l(t)?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:l(t)?t.charAt(e):t[e]}function wa(t){if(!n(t))for(var e=t.length-1;0<=e;e--)delete t[e];t.length=0}function xa(t){return Array.prototype.concat.apply([],arguments)}function ya(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function y(t){return-1!=x.indexOf(t)}function Ba(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Ca(t){var e,n=[],r=0;for(e in t)n[r++]=t[e];return n}function Da(t){var e,n=[],r=0;for(e in t)n[r++]=e;return n}function Ea(t){var e,n={};for(e in t)n[e]=t[e];return n}function Ga(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<Fa.length;o++)n=Fa[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function Ha(t){return Ha[" "](t),t}function Ia(t,e){var n=Ja;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}function Oa(){var t=k.document;return t?t.documentMode:void 0}function Ta(t){return Ia(t,function(){for(var e=0,n=la(String(Pa)).split("."),r=la(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=ma(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||ma(0==a[2].length,0==s[2].length)||ma(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e})}function A(t,e){this.type=t,this.a=this.target=e,this.Pa=!0}function $a(t,e){if(A.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(Ma){t:{try{Ha(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,null===r?(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0):(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=l(t.pointerType)?t.pointerType:ab[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}function cb(t){return!(!t||!t[bb])}function eb(t,e,n,r,i){this.listener=t,this.a=null,this.src=e,this.type=n,this.capture=!!r,this.ga=i,this.key=++db,this.Y=this.ca=!1}function fb(t){t.Y=!0,t.listener=null,t.a=null,t.src=null,t.ga=null}function gb(t){this.src=t,this.a={},this.b=0}function ib(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=sa(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(fb(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function jb(t,e,n,r,i){return t=t.a[e.toString()],e=-1,t&&(e=hb(t,n,r,i)),-1<e?t[e]:null}function hb(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ga==r)return i}return-1}function nb(t,e,r,i,o){if(i&&i.once)return ob(t,e,r,i,o);if(n(e)){for(var a=0;a<e.length;a++)nb(t,e[a],r,i,o);return null}return r=pb(r),cb(t)?t.aa(e,r,p(i)?!!i.capture:!!i,o):qb(t,e,r,!1,i,o)}function qb(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a=p(i)?!!i.capture:!!i,s=rb(t);if(s||(t[kb]=s=new gb(t)),(n=s.add(e,n,r,a,o)).a)return n;if(r=sb(),n.a=r,r.src=t,r.listener=n,t.addEventListener)Za||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(tb(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return mb++,n}function sb(){var t=ub,e=Xa?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}function ob(t,e,r,i,o){if(n(e)){for(var a=0;a<e.length;a++)ob(t,e[a],r,i,o);return null}return r=pb(r),cb(t)?t.Ha(e,r,p(i)?!!i.capture:!!i,o):qb(t,e,r,!0,i,o)}function vb(t,e,r,i,o){if(n(e))for(var a=0;a<e.length;a++)vb(t,e[a],r,i,o);else i=p(i)?!!i.capture:!!i,r=pb(r),cb(t)?t.va(e,r,i,o):t&&(t=rb(t))&&(e=jb(t,e,r,i,o))&&wb(e)}function wb(t){if("number"!=typeof t&&t&&!t.Y){var e=t.src;if(cb(e))ib(e.c,t);else{var n=t.type,r=t.a;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(tb(n),r):e.addListener&&e.removeListener&&e.removeListener(r),mb--,(n=rb(e))?(ib(n,t),0==n.b&&(n.src=null,e[kb]=null)):fb(t)}}}function tb(t){return t in lb?lb[t]:lb[t]="on"+t}function xb(t,e,n,r){var i=!0;if((t=rb(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==n&&!o.Y&&(o=yb(o,r),i=i&&!1!==o)}return i}function yb(t,e){var n=t.listener,r=t.ga||t.src;return t.ca&&wb(t),n.call(r,e)}function ub(t,e){if(t.Y)return!0;if(!Xa){if(!e)t:{e=["window","event"];for(var n=k,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}if(e=new $a(r=e,this),n=!0,!(0>r.keyCode||null!=r.returnValue)){t:{var i=!1;if(0==r.keyCode)try{r.keyCode=-1;break t}catch(t){i=!0}(i||null==r.returnValue)&&(r.returnValue=!0)}for(r=[],i=e.a;i;i=i.parentNode)r.push(i);for(t=t.type,i=r.length-1;0<=i;i--){e.a=r[i];var o=xb(r[i],t,!0,e);n=n&&o}for(i=0;i<r.length;i++)e.a=r[i],o=xb(r[i],t,!1,e),n=n&&o}return n}return yb(t,new $a(e,this))}function rb(t){return(t=t[kb])instanceof gb?t:null}function pb(t){return da(t)?t:(t[zb]||(t[zb]=function(e){return t.handleEvent(e)}),t[zb])}function B(){w.call(this),this.c=new gb(this),this.P=this,this.K=null}function Ab(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.Y&&a.capture==n){var s=a.listener,u=a.ga||a.src;a.ca&&ib(t.c,a),i=!1!==s.call(u,r)&&i}}return i&&0!=r.Pa}function Bb(t){return!/^\s*$/.test(t)&&/^[\],:{}\s\u2028\u2029]*$/.test(t.replace(/\\["\\\/bfnrtu]/g,"@").replace(/(?:"[^"\\\n\r\u2028\u2029\x00-\x08\x0a-\x1f]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)[\s\u2028\u2029]*(?=:|,|]|}|$)/g,"]").replace(/(?:^|:|,)(?:[\s\u2028\u2029]*\[)+/g,""))}function Cb(a){if(a=String(a),Bb(a))try{return eval("("+a+")")}catch(t){}throw Error("Invalid JSON string: "+a)}function Db(t){var e=[];return Eb(new Fb,t,e),e.join("")}function Fb(){}function Eb(t,e,r){if(null==e)r.push("null");else{if("object"==typeof e){if(n(e)){var i=e;e=i.length,r.push("[");for(var o="",a=0;a<e;a++)r.push(o),Eb(t,i[a],r),o=",";return void r.push("]")}if(!(e instanceof String||e instanceof Number||e instanceof Boolean)){for(i in r.push("{"),o="",e)Object.prototype.hasOwnProperty.call(e,i)&&"function"!=typeof(a=e[i])&&(r.push(o),Gb(i,r),r.push(":"),Eb(t,a,r),o=",");return void r.push("}")}e=e.valueOf()}switch(typeof e){case"string":Gb(e,r);break;case"number":r.push(isFinite(e)&&!isNaN(e)?String(e):"null");break;case"boolean":r.push(String(e));break;case"function":r.push("null");break;default:throw Error("Unknown type: "+typeof e)}}}function Gb(t,e){e.push('"',t.replace(Ib,function(t){var e=Hb[t];return e||(e="\\u"+(65536|t.charCodeAt(0)).toString(16).substr(1),Hb[t]=e),e}),'"')}function Jb(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Kb(){this.b=this.a=null}function Ob(){var t=Pb,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function Lb(){this.next=this.b=this.a=null}function Qb(t){k.setTimeout(function(){throw t},0)}function Sb(){var t=k.MessageChannel;if(void 0===t&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!y("Presto")&&(t=function(){var t=document.createElement("IFRAME");t.style.display="none",t.src="",document.documentElement.appendChild(t);var e=t.contentWindow;(t=e.document).open(),t.write(""),t.close();var n="callImmediate"+Math.random(),i="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host;t=r(function(t){"*"!=i&&t.origin!=i||t.data!=n||this.port1.onmessage()},this),e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(n,i)}}}),void 0!==t&&!y("Trident")&&!y("MSIE")){var e=new t,n={},i=n;return e.port1.onmessage=function(){if(void 0!==n.next){var t=(n=n.next).za;n.za=null,t()}},function(t){i.next={za:t},i=i.next,e.port2.postMessage(0)}}return"undefined"!=typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(t){var e=document.createElement("SCRIPT");e.onreadystatechange=function(){e.onreadystatechange=null,e.parentNode.removeChild(e),e=null,t(),t=null},document.documentElement.appendChild(e)}:function(t){k.setTimeout(t,0)}}function Ub(){if(-1!=String(k.Promise).indexOf("[native code]")){var t=k.Promise.resolve(void 0);Tb=function(){t.then(Vb)}}else Tb=function(){var t=Vb;!da(k.setImmediate)||k.Window&&k.Window.prototype&&!y("Edge")&&k.Window.prototype.setImmediate==k.setImmediate?(Rb||(Rb=Sb()),Rb(t)):k.setImmediate(t)}}function Vb(){for(var t;t=Ob();){try{t.a.call(t.b)}catch(t){Qb(t)}var e=Nb;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}Wb=!1}function Xb(e,n){B.call(this),this.b=e||1,this.a=n||k,this.f=r(this.kb,this),this.g=t()}function Yb(t){t.$=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function Zb(t,e,n){if(da(t))n&&(t=r(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=r(t.handleEvent,t)}return 2147483647<Number(e)?-1:k.setTimeout(t,e||0)}function $b(t,e,n){w.call(this),this.f=null!=n?r(t,n):t,this.c=e,this.b=r(this.eb,this),this.a=[]}function ac(t){t.X=Zb(t.b,t.c),t.f.apply(null,t.a)}function C(t){w.call(this),this.b=t,this.a={}}function cc(t){Ba(t.a,function(t,e){this.a.hasOwnProperty(e)&&wb(t)},t),t.a={}}function dc(t,e,n){this.reset(t,e,n,void 0,void 0)}function fc(t){this.f=t,this.b=this.c=this.a=null}function D(t,e){this.name=t,this.value=e}function lc(t){return t.c?t.c:t.a?lc(t.a):(oa("Root logger has no level set."),null)}function oc(t){var e;if(nc||(nc=new fc(""),mc[""]=nc,nc.c=jc),!(e=mc[t])){e=new fc(t);var n=t.lastIndexOf("."),r=t.substr(n+1);(n=oc(t.substr(0,n))).b||(n.b={}),n.b[r]=e,e.a=n,mc[t]=e}return e}function E(t,e){t&&t.log(hc,e,void 0)}function pc(t,e){t&&t.log(ic,e,void 0)}function F(t,e){t&&t.log(kc,e,void 0)}function qc(){this.a=oc("goog.labs.net.webChannel.WebChannelDebug"),this.b=!0}function rc(t,e,n,r,i,o){H(t,function(){if(t.b)if(o)for(var a="",s=o.split("&"),u=0;u<s.length;u++){var c=s[u].split("=");if(1<c.length){var l=c[0];c=c[1];var h=l.split("_");a=2<=h.length&&"type"==h[1]?a+(l+"=")+c+"&":a+(l+"=redacted&")}}else a=null;else a=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+a})}function sc(t,e,n,r,i,o,a){H(t,function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+a})}function tc(t,e,n,r){H(t,function(){return"XMLHTTP TEXT ("+e+"): "+uc(t,n)+(r?" "+r:"")})}function vc(t,e){H(t,function(){return"TIMEOUT: "+e})}function I(t,e){F(t.a,e)}function wc(t,e,n){(t=t.a)&&t.log(gc,n||"Exception",e)}function H(t,e){pc(t.a,e)}function xc(t,e){(t=t.a)&&t.log(gc,e,void 0)}function uc(t,e){if(!t.b)return e;if(!e)return null;try{var r=JSON.parse(e);if(r)for(var i=0;i<r.length;i++)if(n(r[i])){var o=r[i];if(!(2>o.length)){var a=o[1];if(n(a)&&!(1>a.length)){var s=a[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var u=1;u<a.length;u++)a[u]=""}}}return Db(r)}catch(n){return I(t,"Exception parsing expected JS array - probably was not JS"),e}}function zc(t){A.call(this,"serverreachability",t)}function Ac(t){yc.dispatchEvent(new zc(yc,t))}function Bc(t){A.call(this,"statevent",t)}function J(t){yc.dispatchEvent(new Bc(yc,t))}function Cc(t){A.call(this,"timingevent",t)}function Dc(t,e,n){yc.dispatchEvent(new Cc(yc,t,e,n))}function Ec(t,e){if(!da(t))throw Error("Fn must not be null and must be a function");return k.setTimeout(function(){t()},e)}function Hc(){}function Ic(t){var e;return(e=t.a)||(e={},Jc(t)&&(e[0]=!0,e[1]=!0),e=t.a=e),e}function Lc(){}function Mc(t){return(t=Jc(t))?new ActiveXObject(t):new XMLHttpRequest}function Jc(t){if(!t.b&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<e.length;n++){var r=e[n];try{return new ActiveXObject(r),t.b=r}catch(t){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return t.b}function K(t,e,n,r){this.i=t,this.b=e,this.f=n,this.T=r||1,this.N=new C(this),this.S=Nc,(t=this.I=new Xb).b=Oc,t.L&&t.$?(Yb(t),t.start()):t.L&&Yb(t),this.j=null,this.c=!1,this.m=this.g=this.h=this.K=this.D=this.U=this.w=null,this.u=[],this.a=null,this.F=0,this.l=this.o=null,this.C=-1,this.B=!1,this.P=0,this.J=null,this.M=!1}function Pc(t,e){switch(t){case 0:return"Non-200 return code ("+e+")";case 1:return"XMLHTTP failure (no data)";case 2:return"HttpConnection timeout";default:return"Unknown error"}}function Sc(t,e,n){t.K=1,t.h=Tc(L(e)),t.m=n,t.M=!0,Uc(t,null)}function Vc(t,e,n,r){t.K=1,t.h=Tc(L(e)),t.m=null,t.M=n,Uc(t,r)}function Uc(e,n){e.D=t(),Wc(e),e.g=L(e.h),Xc(e.g,"t",e.T),e.F=0,e.a=e.i.da(e.i.ia()?n:null),0<e.P&&(e.J=new $b(r(e.Qa,e,e.a),e.P)),e.N.aa(e.a,"readystatechange",e.hb),n=e.j?Ea(e.j):{},e.m?(e.o||(e.o="POST"),n["Content-Type"]="application/x-www-form-urlencoded",e.a.fa(e.g,e.o,e.m,n)):(e.o="GET",e.a.fa(e.g,e.o,null,n)),Ac(1),rc(e.b,e.o,e.g,e.f,e.T,e.m)}function Yc(t){var e=M(t.a),n=t.a.Fa(),r=t.a.W();if(!(3>e||3==e&&!Ka&&!t.a.V())){t.B||4!=e||7==n||Ac(8==n||0>=r?3:2),Zc(t);var i=t.a.W();t.C=i,(n=t.a.V())||I(t.b,function(){return"No response text for uri "+t.g+" status "+i}),t.c=200==i,sc(t.b,t.o,t.g,t.f,t.T,e,i),t.c?(t.M?($c(t,e,n),Ka&&t.c&&3==e&&ad(t)):(tc(t.b,t.f,n,null),bd(t,n)),4==e&&cd(t),t.c&&!t.B&&(4==e?t.i.ua(t):(t.c=!1,Wc(t)))):(400==i&&0<n.indexOf("Unknown SID")?(t.l=3,J(12),E(t.b.a,"XMLHTTP Unknown SID ("+t.f+")")):(t.l=0,J(13),E(t.b.a,"XMLHTTP Bad status "+i+" ("+t.f+")")),cd(t),dd(t))}}function $c(t,e,n){for(var r=!0;!t.B&&t.F<n.length;){var i=ed(t,n);if(i==Rc){4==e&&(t.l=4,J(14),r=!1),tc(t.b,t.f,null,"[Incomplete Response]");break}if(i==Qc){t.l=4,J(15),tc(t.b,t.f,n,"[Invalid Chunk]"),r=!1;break}tc(t.b,t.f,i,null),bd(t,i)}4==e&&0==n.length&&(t.l=1,J(16),r=!1),t.c=t.c&&r,r||(tc(t.b,t.f,n,"[Invalid Chunked Response]"),cd(t),dd(t))}function ad(t){t.N.aa(t.I,"tick",t.gb),t.I.start()}function ed(t,e){var n=t.F,r=e.indexOf("\n",n);return-1==r?Rc:(n=Number(e.substring(n,r)),isNaN(n)?Qc:(r+=1)+n>e.length?Rc:(e=e.substr(r,n),t.F=r+n,e))}function Wc(e){e.U=t()+e.S,fd(e,e.S)}function fd(t,e){if(null!=t.w)throw Error("WatchDog timer not null");t.w=Ec(r(t.fb,t),e)}function Zc(t){t.w&&(k.clearTimeout(t.w),t.w=null)}function dd(t){t.i.Ja()||t.B||t.i.ua(t)}function cd(t){Zc(t);var e=t.J;e&&"function"==typeof e.Z&&e.Z(),t.J=null,Yb(t.I),cc(t.N),t.a&&(e=t.a,t.a=null,e.abort(),e.Z())}function bd(t,e){try{t.i.Ma(t,e),Ac(4)}catch(e){wc(t.b,e,"Error in httprequest callback")}}function gd(t){if(t.v&&"function"==typeof t.v)return t.v();if(l(t))return t.split("");if(ca(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}return Ca(t)}function hd(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(ca(t)||l(t))ta(t,e,void 0);else{if(t.O&&"function"==typeof t.O)var n=t.O();else if(t.v&&"function"==typeof t.v)n=void 0;else if(ca(t)||l(t)){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else n=Da(t);i=(r=gd(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function N(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t){t instanceof N?(n=t.O(),r=t.v()):(n=Da(t),r=Ca(t));for(var i=0;i<n.length;i++)this.set(n[i],r[i])}}function jd(t){t.b={},t.a.length=0,t.c=0}function kd(t,e){return!!O(t.b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&id(t),!0)}function id(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];O(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)O(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function O(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function md(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function P(t,e){var n;this.b=this.j=this.f="",this.i=null,this.g=this.a="",this.h=!1,t instanceof P?(this.h=void 0!==e?e:t.h,nd(this,t.f),this.j=t.j,od(this,t.b),pd(this,t.i),this.a=t.a,qd(this,rd(t.c)),this.g=t.g):t&&(n=String(t).match(ld))?(this.h=!!e,nd(this,n[1]||"",!0),this.j=sd(n[2]||""),od(this,n[3]||"",!0),pd(this,n[4]),this.a=sd(n[5]||"",!0),qd(this,n[6]||"",!0),this.g=sd(n[7]||"")):(this.h=!!e,this.c=new td(null,this.h))}function L(t){return new P(t)}function nd(t,e,n){t.f=n?sd(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function od(t,e,n){t.b=n?sd(e,!0):e}function pd(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.i=e}else t.i=null}function qd(t,e,n){e instanceof td?(t.c=e,zd(t.c,t.h)):(n||(e=ud(e,Ad)),t.c=new td(e,t.h))}function Q(t,e,n){t.c.set(e,n)}function Xc(t,e,r){n(r)||(r=[String(r)]),Bd(t.c,e,r)}function Tc(e){return Q(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^t()).toString(36)),e}function Cd(t){return t instanceof P?L(t):new P(t,void 0)}function Dd(t,e,n,r){var i=new P(null,void 0);return t&&nd(i,t),e&&od(i,e),n&&pd(i,n),r&&(i.a=r),i}function sd(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function ud(t,e,n){return l(t)?(t=encodeURI(t).replace(e,Ed),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Ed(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}function td(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function R(t){t.a||(t.a=new N,t.b=0,t.c&&md(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function Gd(t,e){R(t),e=Fd(t,e),O(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,kd(t.a,e))}function Hd(t,e){return R(t),e=Fd(t,e),O(t.a.b,e)}function Bd(t,e,n){Gd(t,e),0<n.length&&(t.c=null,t.a.set(Fd(t,e),ya(n)),t.b+=n.length)}function rd(t){var e=new td;return e.c=t.c,t.a&&(e.a=new N(t.a),e.b=t.b),e}function Fd(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function zd(t,e){e&&!t.f&&(R(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(Gd(this,e),Bd(this,n,t))},t)),t.f=e}function Id(){this.a=t()}function Kd(){Jd||(Jd=new Id)}function Ld(){Jd||(Jd=new Id)}function Md(){}function Od(){A.call(this,"d")}function Pd(){A.call(this,"c")}function Qd(t,e){this.a=t,this.b=e,this.c=this.i=null,this.h=!1,this.l=null,this.f=-1,this.m=this.g=null}function Rd(t){I(t.b,"TestConnection: starting stage 2");var e=t.a.I.a;if(null!=e)I(t.b,function(){return"Buffered"}),J(4),e?(J(10),Sd(t.a,t,!1)):(J(11),Sd(t.a,t,!0));else{t.c=new K(t,t.b,void 0,void 0),t.c.j=t.i;var n=Td(t.a,t.g,t.l);J(4),Xc(n,"TYPE","xmlhttp");var r=t.a.j,i=t.a.K;r&&i&&Q(n,r,i),Vc(t.c,n,!1,t.g)}}function Vd(){this.a=this.b=null}function S(){this.a=new N}function Wd(t){var e=typeof t;return"object"==e&&t||"function"==e?"o"+(t[q]||(t[q]=++ea)):e.charAt(0)+t}function Xd(t,e){this.a=t,this.b=e}function Yd(t){this.g=t||Zd,this.f=k.pa&&k.pa.Ka&&k.pa.Ka()&&k.pa.Ka().Db?this.g:1,this.a=null,1<this.f&&(this.a=new S),this.b=null,this.c=[]}function $d(t,e){t.a||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(t.f=t.g,t.a=new S,t.b&&(ae(t,t.b),t.b=null))}function be(t){return!!t.b||!!t.a&&t.a.s()>=t.f}function ce(t,e){return t.b?t.b==e:!!t.a&&t.a.contains(e)}function ae(t,e){t.a?t.a.add(e):t.b=e}function de(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.contains(e)&&kd(t.a.a,Wd(e))}function ee(t){if(null!=t.b)return t.c.concat(t.b.u);if(null!=t.a&&0!=t.a.a.c){var e=t.c;return ta(t.a.v(),function(t){e=e.concat(t.u)}),e}return ya(t.c)}function fe(t,e){t.c=t.c.concat(e)}function ge(){}function he(){this.a=new ge}function ie(t,e,n){var r=n||"";try{hd(t,function(t,n){var i=t;p(t)&&(i=Db(t)),e.push(r+n+"="+encodeURIComponent(i))})}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function je(t,e){var n=new qc;I(n,"TestLoadImage: loading "+t);var r=new Image;r.onload=ia(ke,n,r,"TestLoadImage: loaded",!0,e),r.onerror=ia(ke,n,r,"TestLoadImage: error",!1,e),r.onabort=ia(ke,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=ia(ke,n,r,"TestLoadImage: timeout",!1,e),k.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}function ke(t,e,n,r,i){try{I(t,n),e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(e){wc(t,e)}}function T(t){B.call(this),this.headers=new N,this.F=t||null,this.f=!1,this.D=this.a=null,this.M=this.u="",this.j=0,this.g="",this.h=this.J=this.o=this.I=!1,this.l=0,this.B=null,this.N=le,this.C=this.m=!1}function qe(t){return z&&Ta(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}function va(t){return"content-type"==t.toLowerCase()}function oe(t,e){t.f=!1,t.a&&(t.h=!0,t.a.abort(),t.h=!1),t.g=e,t.j=5,re(t),se(t)}function re(t){t.I||(t.I=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function te(t){if(t.f&&void 0!==goog)if(t.D[1]&&4==M(t)&&2==t.W())F(t.b,U(t,"Local request error detected and ignored"));else if(t.o&&4==M(t))Zb(t.La,0,t);else if(t.dispatchEvent("readystatechange"),4==M(t)){F(t.b,U(t,"Request complete")),t.f=!1;try{var e,n=t.W();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.u).match(ld)[1]||null;if(!o&&k.self&&k.self.location){var a=k.self.location.protocol;o=a.substr(0,a.length-1)}i=!me.test(o?o.toLowerCase():"")}e=i}e?(t.dispatchEvent("complete"),t.dispatchEvent("success")):(t.j=6,t.g=t.Ga()+" ["+t.W()+"]",re(t))}finally{se(t)}}}function se(t,e){if(t.a){pe(t);var n=t.a,r=t.D[0]?aa:null;t.a=null,t.D=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(e){(t=t.b)&&t.log(gc,"Problem encountered resetting onreadystatechange: "+e.message,void 0)}}}function pe(t){t.a&&t.C&&(t.a.ontimeout=null),t.B&&(k.clearTimeout(t.B),t.B=null)}function M(t){return t.a?t.a.readyState:0}function U(t,e){return e+" ["+t.M+" "+t.u+" "+t.W()+"]"}function ue(t){var e="";return Ba(t,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}function ve(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}if(r)return t;if(n=ue(n),l(t)){if(e=encodeURIComponent(String(e)),e+=n=null!=n?"="+encodeURIComponent(String(n)):""){if(0>(n=t.indexOf("#"))&&(n=t.length),0>(r=t.indexOf("?"))||r>n){r=n;var i=""}else i=t.substring(r+1,n);n=(t=[t.substr(0,r),i,t.substr(n)])[1],t[1]=e?n?n+"&"+e:e:n,t=t[0]+(t[1]?"?"+t[1]:"")+t[2]}return t}return Q(t,e,n),t}function we(t){this.ya=0,this.g=[],this.a=new qc,this.I=new Vd,this.ja=this.wa=this.F=this.ka=this.b=this.K=this.j=this.U=this.h=this.M=this.i=null,this.Ua=this.P=0,this.la=this.B=this.o=this.m=this.l=this.f=null,this.u=this.xa=this.N=-1,this.T=this.w=this.C=0,this.S=t&&t.supportsCrossDomainXhr||!1,this.J="",this.c=new Yd(t&&t.concurrentRequestLimit),this.ma=new he,this.D=!t||void 0===t.backgroundChannelTest||t.backgroundChannelTest,this.Ta=t&&t.fastHandshake||!1,t&&t.Ea&&this.a.Ea()}function xe(e){if(I(e.a,"disconnect()"),ye(e),3==e.G){var n=e.P++,r=L(e.F);Q(r,"SID",e.J),Q(r,"RID",n),Q(r,"TYPE","terminate"),ze(e,r),(n=new K(e,e.a,n,void 0)).K=2,n.h=Tc(L(r)),r=!1,k.navigator&&k.navigator.sendBeacon&&(r=k.navigator.sendBeacon(n.h.toString(),"")),!r&&k.Image&&((new Image).src=n.h,r=!0),r||(n.a=n.i.da(null),n.a.fa(n.h)),n.D=t(),Wc(n)}Ae(e)}function ye(t){t.B&&(t.B.abort(),t.B=null),t.b&&(t.b.cancel(),t.b=null),t.m&&(k.clearTimeout(t.m),t.m=null),Be(t),t.c.cancel(),t.l&&(k.clearTimeout(t.l),t.l=null)}function Ce(t,e){1e3==t.g.length&&xc(t.a,function(){return"Already have 1000 queued maps upon queueing "+Db(e)}),t.g.push(new Xd(t.Ua++,e)),3==t.G&&De(t)}function De(t){be(t.c)||t.l||(t.l=Ec(r(t.Oa,t),0),t.C=0)}function Ee(t,e){var n=t.c;return(n.b?1:n.a?n.a.s():0)>=t.c.f-(t.l?1:0)?(xc(t.a,"Unexpected retry request is scheduled."),!1):t.l?(I(t.a,"Use the retry request that is already scheduled."),t.g=e.u.concat(t.g),!0):!(1==t.G||2==t.G||2<=t.C||(I(t.a,"Going to retry POST"),t.l=Ec(r(t.Oa,t,e),Fe(t,t.C)),t.C++,0))}function He(t,e){var n;n=e?e.f:t.P++;var r=L(t.F);Q(r,"SID",t.J),Q(r,"RID",n),Q(r,"AID",t.N),ze(t,r),t.h&&t.i&&ve(r,t.h,t.i),n=new K(t,t.a,n,t.C+1),null===t.h&&(n.j=t.i),e&&(t.g=e.u.concat(t.g)),e=Ge(t,n),n.setTimeout(1e4+Math.round(1e4*Math.random())),ae(t.c,n),Sc(n,r,e)}function ze(t,e){t.f&&hd({},function(t,n){Q(e,n,t)})}function Ge(t,e){var n=Math.min(t.g.length,1e3),i=t.f?r(t.f.Va,t.f,t):null;t:for(var o=t.g,a=-1;;){var s=["count="+n];-1==a?0<n?(a=o[0].a,s.push("ofs="+a)):a=0:s.push("ofs="+a);for(var u=!0,c=0;c<n;c++){var l=o[c].a,h=o[c].b;if(0>(l-=a))a=Math.max(0,o[c].a-100),u=!1;else try{ie(h,s,"req"+l+"_")}catch(t){i&&i(h)}}if(u){i=s.join("&");break t}}return t=t.g.splice(0,n),e.u=t,i}function Ie(t){if(!t.b&&!t.m){t.T=1;var e=t.Na;Tb||Ub(),Wb||(Tb(),Wb=!0),Pb.add(e,t),t.w=0}}function Je(t){return t.b||t.m?(xc(t.a,"Request already in progress"),!1):!(3<=t.w||(I(t.a,"Going to retry GET"),t.T++,t.m=Ec(r(t.Na,t),Fe(t,t.w)),t.w++,0))}function Sd(t,e,n){I(t.a,"Test Connection Finished");var r=e.m;r&&$d(t.c,r),t.la=n,t.u=e.f,I(t.a,"connectChannel_()"),t.F=Ke(t,t.ka),De(t)}function Ud(t,e){I(t.a,"Test Connection Failed"),t.u=e.f,V(t,2)}function Be(t){null!=t.o&&(k.clearTimeout(t.o),t.o=null)}function Fe(t,e){var n=5e3+Math.floor(1e4*Math.random());return t.ra()||(I(t.a,"Inactive channel"),n*=2),n*e}function V(t,e){if(H(t.a,"Error code "+e),2==e){var n=null;t.f&&(n=null);var i=r(t.jb,t);n||(n=new P("//www.google.com/images/cleardot.gif"),k.location&&"http"==k.location.protocol||nd(n,"https"),Tc(n)),je(n.toString(),i)}else J(2);I(t.a,"HttpChannel: error - "+e),t.G=0,t.f&&t.f.Ba(e),Ae(t),ye(t)}function Ae(t){if(t.G=0,t.u=-1,t.f){var e=ee(t.c);0==e.length&&0==t.g.length||(I(t.a,function(){return"Number of undelivered maps, pending: "+e.length+", outgoing: "+t.g.length}),t.c.c.length=0,ya(t.g),t.g.length=0),t.f.Aa()}}function Ke(t,e){return e=Le(t,null,e),I(t.a,"GetForwardChannelUri: "+e),e}function Td(t,e,n){return e=Le(t,t.ia()?e:null,n),I(t.a,"GetBackChannelUri: "+e),e}function Le(t,e,n){var r=Cd(n);if(""!=r.b)e&&od(r,e+"."+r.b),pd(r,r.i);else{var i,o=k.location;i=e?e+"."+o.hostname:o.hostname,r=Dd(o.protocol,i,o.port,n)}return t.U&&Ba(t.U,function(t,e){Q(r,e,t)}),e=t.j,n=t.K,e&&n&&Q(r,e,n),Q(r,"VER",t.oa),ze(t,r),r}function Me(){}function Ne(t){for(var e=arguments[0],n=1;n<arguments.length;n++){var r,i=arguments[n];if(0==i.lastIndexOf("/",0))e=i;else(r=""==e)||(r=0<=(r=e.length-1)&&e.indexOf("/",r)==r),e+=r?i:"/"+i}return e}function Oe(){if(z&&!(10<=Number(Ua)))throw Error("Environmental error: no available transport.")}function W(t,e){B.call(this),this.a=new we(e),this.b=t,this.m=e&&e.testUrl?e.testUrl:Ne(this.b,"test"),this.f=oc("goog.labs.net.webChannel.WebChannelBaseTransport"),this.g=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.i=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),this.a.M=t,(t=e&&e.httpHeadersOverwriteParam)&&!/^[\s\xa0]*$/.test(t)&&(this.a.h=t),this.l=e&&e.supportsCrossDomainXhr||!1,this.j=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!/^[\s\xa0]*$/.test(e)&&(this.a.j=e,null!==(t=this.g)&&e in t&&(e in(t=this.g)&&delete t[e],E(this.f,"Ignore httpSessionIdParam also specified with messageUrlParams: "+e))),this.h=new Pe(this)}function Qe(t){Od.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function Re(){Pd.call(this),this.status=1}function Pe(t){this.a=t}function Te(){this.b=[],this.a=[]}function Ue(t){return 0==t.b.length&&(t.b=t.a,t.b.reverse(),t.a=[]),t.b.pop()}function Ve(t,e){if(w.call(this),this.h=t||0,this.c=e||10,this.h>this.c)throw Error(We);this.a=new Te,this.b=new S,this.g=null,this.ba()}function Xe(t){if("function"==typeof t.Z)t.Z();else for(var e in t)t[e]=null}function Ye(t,e){this.a=t,this.b=e}function Ze(t){if(this.a=[],t)t:{if(t instanceof Ze){var e=t.O();if(t=t.v(),0>=this.s()){for(var n=this.a,r=0;r<e.length;r++)n.push(new Ye(e[r],t[r]));break t}}else e=Da(t),t=Ca(t);for(r=0;r<e.length;r++)$e(this,e[r],t[r])}}function $e(t,e,n){var r=t.a;for(r.push(new Ye(e,n)),e=r.length-1,n=(t=t.a)[e];0<e&&t[r=e-1>>1].a>n.a;)t[e]=t[r],e=r;t[e]=n}function af(){Ze.call(this)}function X(t,e){this.f=new af,Ve.call(this,t,e)}function Y(t,e,n,r){this.l=t,this.j=!!r,X.call(this,e,n)}var g,goog=goog||{},k=this,q="closure_uid_"+(1e9*Math.random()>>>0),ea=0,t=Date.now||function(){return+new Date};u(ja,Error),ja.prototype.name="CustomError";var la=String.prototype.trim?function(t){return t.trim()}:function(t){return t.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")};u(na,ja),na.prototype.name="AssertionError";var qa=0,ra={};w.prototype.i=!1,w.prototype.Z=function(){if(!this.i&&(this.i=!0,this.A(),0!=qa)){var t=this[q]||(this[q]=++ea);delete ra[t]}},w.prototype.A=function(){if(this.w)for(;this.w.length;)this.w.shift()()};var sa=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(l(t))return l(e)&&1==e.length?t.indexOf(e,0):-1;for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},ta=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i=l(t)?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)},x;t:{var za=k.navigator;if(za){var Aa=za.userAgent;if(Aa){x=Aa;break t}}x=""}var Fa="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");Ha[" "]=aa;var Ka=y("Opera"),z=y("Trident")||y("MSIE"),La=y("Edge"),Ma=y("Gecko")&&!(-1!=x.toLowerCase().indexOf("webkit")&&!y("Edge"))&&!(y("Trident")||y("MSIE"))&&!y("Edge"),Na=-1!=x.toLowerCase().indexOf("webkit")&&!y("Edge"),Pa;t:{var Qa="",Ra=function(){var t=x;return Ma?/rv:([^\);]+)(\)|;)/.exec(t):La?/Edge\/([\d\.]+)/.exec(t):z?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):Na?/WebKit\/(\S+)/.exec(t):Ka?/(?:Version)[ \/]?(\S+)/.exec(t):void 0}();if(Ra&&(Qa=Ra?Ra[1]:""),z){var Sa=Oa();if(null!=Sa&&Sa>parseFloat(Qa)){Pa=String(Sa);break t}}Pa=Qa}var Ja={},Ua,Va=k.document;Ua=Va&&z?Oa()||("CSS1Compat"==Va.compatMode?parseInt(Pa,10):5):void 0;var Wa=Object.freeze||function(t){return t},Xa=!z||9<=Number(Ua),Ya=z&&!Ta("9"),Za=function(){if(!k.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});return k.addEventListener("test",aa,e),k.removeEventListener("test",aa,e),t}();A.prototype.b=function(){this.Pa=!1},u($a,A);var ab=Wa({2:"touch",3:"pen",4:"mouse"});$a.prototype.b=function(){$a.H.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Ya)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}};var bb="closure_listenable_"+(1e6*Math.random()|0),db=0;gb.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var a=hb(t,e,r,i);return-1<a?(e=t[a],n||(e.ca=!1)):((e=new eb(e,this.src,o,!!r,i)).ca=n,t.push(e)),e};var kb="closure_lm_"+(1e6*Math.random()|0),lb={},mb=0,zb="__closure_events_fn_"+(1e9*Math.random()>>>0);u(B,w),B.prototype[bb]=!0,g=B.prototype,g.addEventListener=function(t,e,n,r){nb(this,t,e,n,r)},g.removeEventListener=function(t,e,n,r){vb(this,t,e,n,r)},g.dispatchEvent=function(t){var e,n=this.K;if(n)for(e=[];n;n=n.K)e.push(n);n=this.P;var r=t.type||t;if(l(t))t=new A(t,n);else if(t instanceof A)t.target=t.target||n;else{var i=t;Ga(t=new A(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var a=t.a=e[o];i=Ab(a,r,!0,t)&&i}if(i=Ab(a=t.a=n,r,!0,t)&&i,i=Ab(a,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=Ab(a=t.a=e[o],r,!1,t)&&i;return i},g.A=function(){if(B.H.A.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)0,fb(n[r]);delete e.a[t],e.b--}}this.K=null},g.aa=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},g.Ha=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)},g.va=function(t,e,n,r){var i=this.c;if((t=String(t).toString())in i.a){var o=i.a[t];-1<(e=hb(o,e,n,r))&&(fb(o[e]),Array.prototype.splice.call(o,e,1),0==o.length&&(delete i.a[t],i.b--))}};var Hb={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},Ib=/\uffff/.test("￿")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;Jb.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var Nb=new Jb(function(){return new Lb},function(t){t.reset()});Kb.prototype.add=function(t,e){var n=Nb.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Lb.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},Lb.prototype.reset=function(){this.next=this.b=this.a=null};var Rb,Tb,Wb=!1,Pb=new Kb;u(Xb,B),g=Xb.prototype,g.$=!1,g.L=null,g.kb=function(){if(this.$){var e=t()-this.g;0<e&&e<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-e):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.$&&(this.L=this.a.setTimeout(this.f,this.b),this.g=t()))}},g.start=function(){this.$=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=t())},g.A=function(){Xb.H.A.call(this),Yb(this),delete this.a},u($b,w),g=$b.prototype,g.ha=!1,g.X=null,g.Xa=function(t){this.a=arguments,this.X?this.ha=!0:ac(this)},g.A=function(){$b.H.A.call(this),this.X&&(k.clearTimeout(this.X),this.X=null,this.ha=!1,this.a=[])},g.eb=function(){this.X=null,this.ha&&(this.ha=!1,ac(this))},u(C,w);var bc=[];C.prototype.aa=function(t,e,r,i){n(e)||(e&&(bc[0]=e.toString()),e=bc);for(var o=0;o<e.length;o++){var a=nb(t,e[o],r||this.handleEvent,i||!1,this.b||this);if(!a)break;this.a[a.key]=a}return this},C.prototype.va=function(t,e,r,i,o){if(n(e))for(var a=0;a<e.length;a++)this.va(t,e[a],r,i,o);else r=r||this.handleEvent,i=p(i)?!!i.capture:!!i,o=o||this.b||this,r=pb(r),i=!!i,(e=cb(t)?jb(t.c,String(e),r,i,o):t&&(t=rb(t))?jb(t,e,r,i,o):null)&&(wb(e),delete this.a[e.key])},C.prototype.A=function(){C.H.A.call(this),cc(this)},C.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},dc.prototype.a=null;var ec=0;dc.prototype.reset=function(e,n,r,i,o){"number"==typeof o||ec++,i||t(),delete this.a},D.prototype.toString=function(){return this.name};var gc=new D("SEVERE",1e3),hc=new D("WARNING",900),ic=new D("INFO",800),jc=new D("CONFIG",700),kc=new D("FINE",500);fc.prototype.log=function(t,e,n){if(t.value>=lc(this).value)for(da(e)&&(e=e()),t=new dc(t,String(e),this.f),n&&(t.a=n),n=this;n;)n=n.a};var mc={},nc=null;qc.prototype.Ea=function(){this.b=!1};var yc=new B;u(zc,A),u(Bc,A),u(Cc,A);var Fc={NO_ERROR:0,lb:1,sb:2,rb:3,ob:4,qb:5,tb:6,Ra:7,TIMEOUT:8,wb:9},Gc={nb:"complete",Ab:"success",Sa:"error",Ra:"abort",yb:"ready",zb:"readystatechange",TIMEOUT:"timeout",ub:"incrementaldata",xb:"progress",pb:"downloadprogress",Bb:"uploadprogress"},Kc;Hc.prototype.a=null,u(Lc,Hc),Kc=new Lc;var Nc=45e3,Oc=250,Qc={},Rc={};g=K.prototype,g.setTimeout=function(t){this.S=t},g.hb=function(t){t=t.target;var e=this.J;e&&3==M(t)?(I(this.b,"Throttling readystatechange."),e.Xa()):this.Qa(t)},g.Qa=function(t){try{t==this.a?Yc(this):E(this.b.a,"Called back with an unexpected xmlhttp")}catch(t){if(I(this.b,"Failed call to OnXmlHttpReadyStateChanged_"),this.a&&this.a.V()){var e=this;wc(this.b,t,function(){return"ResponseText: "+e.a.V()})}else wc(this.b,t,"No response text")}},g.gb=function(){var t=M(this.a),e=this.a.V();this.F<e.length&&(Zc(this),$c(this,t,e),this.c&&4!=t&&Wc(this))},g.cancel=function(){this.B=!0,cd(this)},g.fb=function(){this.w=null;var e=t();0<=e-this.U?(this.c&&xc(this.b,"Received watchdog timeout even though request loaded successfully"),vc(this.b,this.g),2!=this.K&&(Ac(3),J(17)),cd(this),this.l=2,dd(this)):(E(this.b.a,"WatchDog timer called too early"),fd(this,this.U-e))},g=N.prototype,g.s=function(){return this.c},g.v=function(){id(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},g.O=function(){return id(this),this.a.concat()},g.get=function(t,e){return O(this.b,t)?this.b[t]:e},g.set=function(t,e){O(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},g.forEach=function(t,e){for(var n=this.O(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var ld=/^(?:([^:\/?#.]+):)?(?:\/\/(?:([^\/?#]*)@)?([^\/#?]*?)(?::([0-9]+))?(?=[\/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;P.prototype.toString=function(){var t=[],e=this.f;e&&t.push(ud(e,vd,!0),":");var n=this.b;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(ud(e,vd,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.i)&&t.push(":",String(n))),(n=this.a)&&(this.b&&"/"!=n.charAt(0)&&t.push("/"),t.push(ud(n,"/"==n.charAt(0)?wd:xd,!0))),(n=this.c.toString())&&t.push("?",n),(n=this.g)&&t.push("#",ud(n,yd)),t.join("")},P.prototype.resolve=function(t){var e=L(this),n=!!t.f;n?nd(e,t.f):n=!!t.j,n?e.j=t.j:n=!!t.b,n?od(e,t.b):n=null!=t.i;var r=t.a;if(n)pd(e,t.i);else if(n=!!t.a){if("/"!=r.charAt(0))if(this.b&&!this.a)r="/"+r;else{var i=e.a.lastIndexOf("/");-1!=i&&(r=e.a.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(-1!=i.indexOf("./")||-1!=i.indexOf("/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],a=0;a<i.length;){var s=i[a++];"."==s?r&&a==i.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&a==i.length&&o.push("")):(o.push(s),r=!0)}r=o.join("/")}else r=i}return n?e.a=r:n=""!==t.c.toString(),n?qd(e,rd(t.c)):n=!!t.g,n&&(e.g=t.g),e};var vd=/[#\/\?@]/g,xd=/[#\?:]/g,wd=/[#\?]/g,Ad=/[#\?@]/g,yd=/#/g;g=td.prototype,g.s=function(){return R(this),this.b},g.add=function(t,e){R(this),this.c=null,t=Fd(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},g.forEach=function(t,e){R(this),this.a.forEach(function(n,r){ta(n,function(n){t.call(e,n,r,this)},this)},this)},g.O=function(){R(this);for(var t=this.a.v(),e=this.a.O(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},g.v=function(t){R(this);var e=[];if(l(t))Hd(this,t)&&(e=xa(e,this.a.get(Fd(this,t))));else{t=this.a.v();for(var n=0;n<t.length;n++)e=xa(e,t[n])}return e},g.set=function(t,e){return R(this),this.c=null,Hd(this,t=Fd(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},g.get=function(t,e){return 0<(t=t?this.v(t):[]).length?String(t[0]):e},g.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.O(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.v(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),t.push(a)}}return this.c=t.join("&")};var Jd=null;Id.prototype.set=function(t){this.a=t},Id.prototype.reset=function(){this.set(t())},Id.prototype.get=function(){return this.a},u(Ld,Kd);var Nd={OPEN:"a",mb:"b",Sa:"c",vb:"d"};u(Od,A),u(Pd,A),g=Qd.prototype,g.R=null,g.da=function(t){return this.a.da(t)},g.abort=function(){this.c&&(this.c.cancel(),this.c=null),this.f=-1},g.Ja=function(){return!1},g.Ma=function(t,e){if(this.f=t.C,0==this.R){if(I(this.b,"TestConnection: Got data for stage 1"),!this.a.D&&(t=t.a)){var n=t.a?t.a.getResponseHeader("X-Client-Wire-Protocol"):null;this.m=n||null,this.a.j&&((t=t.a?t.a.getResponseHeader("X-HTTP-Session-Id"):null)?this.a.K=t:E(this.b.a,"Missing X_HTTP_SESSION_ID in the handshake response"))}if(e){try{var r=this.a.ma.a.parse(e)}catch(t){return wc(this.b,t),void Ud(this.a,this)}this.g=r[0]}else I(this.b,"TestConnection: Null responseText"),Ud(this.a,this)}else 1==this.R&&(this.h?J(6):"11111"==e?(J(5),this.h=!0,(!z||10<=Number(Ua))&&(this.f=200,this.c.cancel(),I(this.b,"Test connection succeeded; using streaming connection"),J(11),Sd(this.a,this,!0))):(J(7),this.h=!1))},g.ua=function(){this.f=this.c.C,this.c.c?0==this.R?(this.R=1,I(this.b,"TestConnection: request complete for initial check"),Rd(this)):1==this.R&&(I(this.b,"TestConnection: request complete for stage 2"),this.h?(I(this.b,"Test connection succeeded; using streaming connection"),J(11),Sd(this.a,this,!0)):(I(this.b,"Test connection failed; not using streaming"),J(10),Sd(this.a,this,!1))):(I(this.b,"TestConnection: request failed, in state "+this.R),0==this.R?J(8):1==this.R&&J(9),Ud(this.a,this))},g.ia=function(){return this.a.ia()},g.ra=function(){return this.a.ra()},S.prototype.s=function(){return this.a.s()},S.prototype.add=function(t){this.a.set(Wd(t),t)},S.prototype.contains=function(t){return t=Wd(t),O(this.a.b,t)},S.prototype.v=function(){return this.a.v()};var Zd=10;Yd.prototype.cancel=function(){this.c=ee(this),this.b?(this.b.cancel(),this.b=null):this.a&&0!=this.a.a.c&&(ta(this.a.v(),function(t){t.cancel()}),jd(this.a.a))},ge.prototype.stringify=function(t){return k.JSON.stringify(t,void 0)},ge.prototype.parse=function(t){return k.JSON.parse(t,void 0)},u(T,B);var le="";T.prototype.b=oc("goog.net.XhrIo");var me=/^https?$/i,ne=["POST","PUT"];g=T.prototype,g.fa=function(t,e,n,i){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.u+"; newUri="+t);e=e?e.toUpperCase():"GET",this.u=t,this.g="",this.j=0,this.M=e,this.I=!1,this.f=!0,this.a=Mc(this.F?this.F:Kc),this.D=Ic(this.F?this.F:Kc),this.a.onreadystatechange=r(this.La,this);try{F(this.b,U(this,"Opening Xhr")),this.J=!0,this.a.open(e,String(t),!0),this.J=!1}catch(t){return F(this.b,U(this,"Error opening Xhr: "+t.message)),void oe(this,t)}t=n||"";var o=new N(this.headers);i&&hd(i,function(t,e){o.set(e,t)}),i=ua(o.O()),n=k.FormData&&t instanceof k.FormData,!(0<=sa(ne,e))||i||n||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.N&&(this.a.responseType=this.N),"withCredentials"in this.a&&this.a.withCredentials!==this.m&&(this.a.withCredentials=this.m);try{pe(this),0<this.l&&(this.C=qe(this.a),F(this.b,U(this,"Will abort after "+this.l+"ms if incomplete, xhr2 "+this.C)),this.C?(this.a.timeout=this.l,this.a.ontimeout=r(this.Ia,this)):this.B=Zb(this.Ia,this.l,this)),F(this.b,U(this,"Sending request")),this.o=!0,this.a.send(t),this.o=!1}catch(t){F(this.b,U(this,"Send error: "+t.message)),oe(this,t)}},g.Ia=function(){void 0!==goog&&this.a&&(this.g="Timed out after "+this.l+"ms, aborting",this.j=8,F(this.b,U(this,this.g)),this.dispatchEvent("timeout"),this.abort(8))},g.abort=function(t){this.a&&this.f&&(F(this.b,U(this,"Aborting")),this.f=!1,this.h=!0,this.a.abort(),this.h=!1,this.j=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),se(this))},g.A=function(){this.a&&(this.f&&(this.f=!1,this.h=!0,this.a.abort(),this.h=!1),se(this,!0)),T.H.A.call(this)},g.La=function(){this.i||(this.J||this.o||this.h?te(this):this.cb())},g.cb=function(){te(this)},g.W=function(){try{return 2<M(this)?this.a.status:-1}catch(t){return-1}},g.Ga=function(){try{return 2<M(this)?this.a.statusText:""}catch(t){return F(this.b,"Can not get status: "+t.message),""}},g.V=function(){try{return this.a?this.a.responseText:""}catch(t){return F(this.b,"Can not get responseText: "+t.message),""}},g.Ya=function(t){if(this.a){var e=this.a.responseText;t&&0==e.indexOf(t)&&(e=e.substring(t.length));t:{if(t=e,k.JSON)try{var n=k.JSON.parse(t);break t}catch(t){}n=Cb(t)}return n}},g.Fa=function(){return this.j},g.ab=function(){return l(this.g)?this.g:String(this.g)},g=we.prototype,g.oa=8,g.G=1,g.Ja=function(){return 0==this.G},g.Oa=function(t){if(this.l=null,I(this.a,"startForwardChannel_"),1==this.G)if(t)xc(this.a,"Not supposed to retry the open");else{I(this.a,"open_()"),this.P=Math.floor(1e5*Math.random()),t=this.P++;var e=new K(this,this.a,t,void 0),n=this.i;this.M&&(n?Ga(n=Ea(n),this.M):n=this.M),null===this.h&&(e.j=n);var r=Ge(this,e),i=L(this.F);Q(i,"RID",t),Q(i,"CVER",21),this.D&&this.j&&Q(i,"X-HTTP-Session-Id",this.j),ze(this,i),this.h&&n&&ve(i,this.h,n),ae(this.c,e),this.Ta?(Q(i,"$req",r),Sc(e,i,null)):Sc(e,i,r),this.G=2}else 3==this.G&&(t?He(this,t):0==this.g.length?I(this.a,"startForwardChannel_ returned: nothing to send"):be(this.c)?xc(this.a,"startForwardChannel_ returned: connection already in progress"):(He(this),I(this.a,"startForwardChannel_ finished, sent request")))},g.Na=function(){this.m=null,I(this.a,"Creating new HttpRequest"),this.b=new K(this,this.a,"rpc",this.T),null===this.h&&(this.b.j=this.i),this.b.P=0;var t=L(this.wa);Q(t,"RID","rpc"),Q(t,"SID",this.J),Q(t,"CI",this.la?"0":"1"),Q(t,"AID",this.N),ze(this,t),Q(t,"TYPE","xmlhttp"),this.h&&this.i&&ve(t,this.h,this.i),Vc(this.b,t,!0,this.ja),I(this.a,"New Request created")},g.Ma=function(t,e){if(0!=this.G&&(this.b==t||ce(this.c,t)))if(this.u=t.C,ce(this.c,t)&&3==this.G){try{var i=this.ma.a.parse(e)}catch(t){i=null}if(n(i)&&3==i.length)if(0==(e=i)[0])t:if(I(this.a,"Server claims our backchannel is missing."),this.m)I(this.a,"But we are currently starting the request.");else{if(this.b){if(!(this.b.D+3e3<t.D))break t;Be(this),this.b.cancel(),this.b=null}else E(this.a.a,"We do not have a BackChannel established");Je(this),J(18)}else this.xa=e[1],0<(t=this.xa-this.N)&&(e=e[2],I(this.a,e+" bytes (in "+t+" arrays) are outstanding on the BackChannel"),37500>e&&this.la&&0==this.w&&!this.o&&(this.o=Ec(r(this.bb,this),6e3)));else I(this.a,"Bad POST response data returned"),V(this,11)}else if(this.b==t&&Be(this),!/^[\s\xa0]*$/.test(e))for(e=i=this.ma.a.parse(e),i=0;i<e.length;i++){var o=e[i];if(this.N=o[0],o=o[1],2==this.G)if("c"==o[0]){this.J=o[1],this.ja=o[2];var a=o[3];null!=a&&(this.oa=a,H(this.a,"VER="+this.oa)),null!=(o=o[4])&&(this.ya=o,H(this.a,"SVER="+this.ya)),this.D&&(o=t.a)&&((a=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)&&$d(this.c,a),this.j&&((o=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)?(this.K=o,Q(this.F,this.j,o)):E(this.a.a,"Missing X_HTTP_SESSION_ID in the handshake response"))),this.G=3,this.f&&this.f.Da(),this.wa=Td(this,this.ja,this.ka),Ie(this)}else"stop"!=o[0]&&"close"!=o[0]||V(this,7);else 3==this.G&&("stop"==o[0]||"close"==o[0]?"stop"==o[0]?V(this,7):xe(this):"noop"!=o[0]&&this.f&&this.f.Ca(o),this.w=0)}},g.bb=function(){null!=this.o&&(this.o=null,this.b.cancel(),this.b=null,Je(this),J(19))},g.ua=function(e){I(this.a,"Request complete");var n=null;if(this.b==e){Be(this),this.b=null;var r=2}else{if(!ce(this.c,e))return;n=e.u,de(this.c,e),r=1}if(this.u=e.C,0!=this.G)if(e.c)1==r?(Dc(e.m?e.m.length:0,t()-e.D,this.C),De(this)):Ie(this);else{var i=e.l;if(3==i||0==i&&0<this.u)I(this.a,"Not retrying due to error type");else{var o=this;if(I(this.a,function(){return"Maybe retrying, last error: "+Pc(i,o.u)}),1==r&&Ee(this,e)||2==r&&Je(this))return;I(this.a,"Exceeded max number of retries")}switch(n&&0<n.length&&fe(this.c,n),I(this.a,"Error: HTTP request failed"),i){case 1:V(this,5);break;case 4:V(this,10);break;case 3:V(this,6);break;default:V(this,2)}}},g.jb=function(t){t?(H(this.a,"Successfully pinged google.com"),J(2)):(H(this.a,"Failed to ping google.com"),J(1))},g.da=function(t){if(t&&!this.S)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new T).m=this.S,t},g.ra=function(){return!!this.f&&!0},g.ia=function(){return this.S},new Ld,g=Me.prototype,g.Da=function(){},g.Ca=function(){},g.Ba=function(){},g.Aa=function(){},g.Va=function(){},Oe.prototype.a=function(t,e){return new W(t,e)},u(W,B),g=W.prototype,g.addEventListener=function(t,e,n,r){W.H.addEventListener.call(this,t,e,n,r)},g.removeEventListener=function(t,e,n,r){W.H.removeEventListener.call(this,t,e,n,r)},g.Za=function(){this.a.f=this.h,this.l&&(this.a.S=!0);var t=this.a,e=this.m,n=this.b,r=this.g||void 0;I(t.a,"connect()"),J(0),t.ka=n,t.U=r||{},t.D&&(I(t.a,"connect() bypassed channel-test."),t.I.b=[],t.I.a=!1),I(t.a,"connectTest_()"),t.B=new Qd(t,t.a),null===t.h&&(t.B.i=t.i),n=e,t.h&&t.i&&(n=ve(e,t.h,t.i)),(t=t.B).l=n,e=Ke(t.a,t.l),J(3),null!=(n=t.a.I.b)?(t.g=n[0],t.R=1,Rd(t)):(Xc(e,"MODE","init"),!t.a.D&&t.a.j&&Xc(e,"X-HTTP-Session-Id",t.a.j),t.c=new K(t,t.b,void 0,void 0),t.c.j=t.i,Vc(t.c,e,!1,null),t.R=0)},g.close=function(){xe(this.a)},g.$a=function(t){if(l(t)){var e={};e.__data__=t,Ce(this.a,e)}else this.j?((e={}).__data__=Db(t),Ce(this.a,e)):Ce(this.a,t)},g.A=function(){this.a.f=null,delete this.h,xe(this.a),delete this.a,W.H.A.call(this)},u(Qe,Od),u(Re,Pd),u(Pe,Me),Pe.prototype.Da=function(){pc(this.a.f,"WebChannel opened on "+this.a.b),this.a.dispatchEvent("a")},Pe.prototype.Ca=function(t){this.a.dispatchEvent(new Qe(t))},Pe.prototype.Ba=function(t){pc(this.a.f,"WebChannel aborted on "+this.a.b+" due to channel error: "+t),this.a.dispatchEvent(new Re(t))},Pe.prototype.Aa=function(){pc(this.a.f,"WebChannel closed on "+this.a.b),this.a.dispatchEvent("b")};var Se=ia(function(t,e){function n(){}n.prototype=t.prototype;var r=new n;return t.apply(r,Array.prototype.slice.call(arguments,1)),r},Oe);Te.prototype.s=function(){return this.b.length+this.a.length},Te.prototype.contains=function(t){return 0<=sa(this.b,t)||0<=sa(this.a,t)},Te.prototype.v=function(){for(var t=[],e=this.b.length-1;0<=e;--e)t.push(this.b[e]);var n=this.a.length;for(e=0;e<n;++e)t.push(this.a[e]);return t},u(Ve,w);var We="[goog.structs.Pool] Min can not be greater than max";g=Ve.prototype,g.ea=function(){var e=t();if(!(null!=this.g&&0>e-this.g)){for(var n;0<this.a.s()&&(n=Ue(this.a),!this.ta(n));)this.ba();return!n&&this.s()<this.c&&(n=this.qa()),n&&(this.g=e,this.b.add(n)),n}},g.ib=function(t){return!!kd(this.b.a,Wd(t))&&(this.na(t),!0)},g.na=function(t){kd(this.b.a,Wd(t)),this.ta(t)&&this.s()<this.c?this.a.a.push(t):Xe(t)},g.ba=function(){for(var t=this.a;this.s()<this.h;){var e=this.qa();t.a.push(e)}for(;this.s()>this.c&&0<this.a.s();)Xe(Ue(t))},g.qa=function(){return{}},g.ta=function(t){return"function"!=typeof t.Wa||t.Wa()},g.contains=function(t){return this.a.contains(t)||this.b.contains(t)},g.s=function(){return this.a.s()+this.b.s()},g.A=function(){if(Ve.H.A.call(this),0<this.b.s())throw Error("[goog.structs.Pool] Objects not released");delete this.b;for(var t=this.a;0!=t.b.length||0!=t.a.length;)Xe(Ue(t));delete this.a},Ze.prototype.v=function(){for(var t=this.a,e=[],n=t.length,r=0;r<n;r++)e.push(t[r].b);return e},Ze.prototype.O=function(){for(var t=this.a,e=[],n=t.length,r=0;r<n;r++)e.push(t[r].a);return e},Ze.prototype.s=function(){return this.a.length},u(af,Ze),u(X,Ve),g=X.prototype,g.ea=function(t,e){if(!t)return X.H.ea.call(this);$e(this.f,void 0!==e?e:100,t),this.sa()},g.sa=function(){for(var t=this.f;0<t.s();){var e=this.ea();if(!e)break;var n=t,r=n.a,i=r.length,o=r[0];if(0>=i)o=void 0;else{if(1==i)wa(r);else{r[0]=r.pop(),r=0,i=(n=n.a).length;for(var a=n[r];r<i>>1;){var s=2*r+1,u=2*r+2;if(n[s=u<i&&n[u].a<n[s].a?u:s].a>a.a)break;n[r]=n[s],r=s}n[r]=a}o=o.b}o.apply(this,[e])}},g.na=function(t){X.H.na.call(this,t),this.sa()},g.ba=function(){X.H.ba.call(this),this.sa()},g.A=function(){X.H.A.call(this),k.clearTimeout(void 0),wa(this.f.a),this.f=null},u(Y,X),Y.prototype.qa=function(){var t=new T,e=this.l;return e&&e.forEach(function(e,n){t.headers.set(n,e)}),this.j&&(t.m=!0),t},Y.prototype.ta=function(t){return!t.i&&!t.a},Oe.prototype.createWebChannel=Oe.prototype.a,W.prototype.send=W.prototype.$a,W.prototype.open=W.prototype.Za,W.prototype.close=W.prototype.close,Fc.NO_ERROR=0,Fc.TIMEOUT=8,Fc.HTTP_ERROR=6,Gc.COMPLETE="complete",Md.EventType=Nd,Nd.OPEN="a",Nd.CLOSE="b",Nd.ERROR="c",Nd.MESSAGE="d",B.prototype.listen=B.prototype.aa,Y.prototype.getObject=Y.prototype.ea,Y.prototype.releaseObject=Y.prototype.ib,T.prototype.listenOnce=T.prototype.Ha,T.prototype.getLastError=T.prototype.ab,T.prototype.getLastErrorCode=T.prototype.Fa,T.prototype.getStatus=T.prototype.W,T.prototype.getStatusText=T.prototype.Ga,T.prototype.getResponseJson=T.prototype.Ya,T.prototype.getResponseText=T.prototype.V,T.prototype.getResponseText=T.prototype.V,T.prototype.send=T.prototype.fa,module.exports={createWebChannelTransport:Se,ErrorCode:Fc,EventType:Gc,WebChannel:Md,XhrIoPool:Y}}).call(void 0!==global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})}).call(this,__webpack_require__(8))},function(t,e){var n=t.exports={version:"2.5.5"};"number"==typeof __e&&(__e=n)},function(t,e,n){var r=n(6);t.exports=function(t,e){if(!r(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!r(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e){var n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:n)(t)}},function(t,e,n){var r=n(0),i=n(34),o=n(5);t.exports=function(t,e){var n=(i.Object||{})[t]||Object[t],a={};a[t]=e(n),r(r.S+r.F*o(function(){n(1)}),"Object",a)}},function(t,e,n){var r=n(30),i=n(76),o=n(14),a=n(12),s=n(143);t.exports=function(t,e){var n=1==t,u=2==t,c=3==t,l=4==t,h=6==t,f=5==t||h,p=e||s;return function(e,s,d){for(var v,g,y=o(e),m=i(y),_=r(s,d,3),b=a(m.length),E=0,w=n?p(e,b):u?p(e,0):void 0;b>E;E++)if((f||E in m)&&(g=_(v=m[E],E,y),t))if(n)w[E]=g;else if(g)switch(t){case 3:return!0;case 5:return v;case 6:return E;case 2:w.push(v)}else if(l)return!1;return h?-1:c||l?l:w}}},function(t,e,n){n(556),t.exports=self.fetch.bind(self)},function(t,e,n){"use strict";if(n(10)){var r=n(53),i=n(3),o=n(5),a=n(0),s=n(99),u=n(149),c=n(30),l=n(59),h=n(51),f=n(20),p=n(61),d=n(37),v=n(12),g=n(203),y=n(55),m=n(35),_=n(25),b=n(78),E=n(6),w=n(14),S=n(140),T=n(56),I=n(28),A=n(57).f,O=n(142),C=n(52),R=n(7),N=n(39),k=n(90),P=n(97),D=n(145),x=n(71),M=n(94),L=n(58),F=n(144),U=n(193),j=n(11),B=n(27),V=j.f,W=B.f,q=i.RangeError,H=i.TypeError,G=i.Uint8Array,K=Array.prototype,z=u.ArrayBuffer,Q=u.DataView,X=N(0),Y=N(2),J=N(3),$=N(4),Z=N(5),tt=N(6),et=k(!0),nt=k(!1),rt=D.values,it=D.keys,ot=D.entries,at=K.lastIndexOf,st=K.reduce,ut=K.reduceRight,ct=K.join,lt=K.sort,ht=K.slice,ft=K.toString,pt=K.toLocaleString,dt=R("iterator"),vt=R("toStringTag"),gt=C("typed_constructor"),yt=C("def_constructor"),mt=s.CONSTR,_t=s.TYPED,bt=s.VIEW,Et=N(1,function(t,e){return At(P(t,t[yt]),e)}),wt=o(function(){return 1===new G(new Uint16Array([1]).buffer)[0]}),St=!!G&&!!G.prototype.set&&o(function(){new G(1).set({})}),Tt=function(t,e){var n=d(t);if(n<0||n%e)throw q("Wrong offset!");return n},It=function(t){if(E(t)&&_t in t)return t;throw H(t+" is not a typed array!")},At=function(t,e){if(!(E(t)&&gt in t))throw H("It is not a typed array constructor!");return new t(e)},Ot=function(t,e){return Ct(P(t,t[yt]),e)},Ct=function(t,e){for(var n=0,r=e.length,i=At(t,r);r>n;)i[n]=e[n++];return i},Rt=function(t,e,n){V(t,e,{get:function(){return this._d[n]}})},Nt=function(t){var e,n,r,i,o,a,s=w(t),u=arguments.length,l=u>1?arguments[1]:void 0,h=void 0!==l,f=O(s);if(null!=f&&!S(f)){for(a=f.call(s),r=[],e=0;!(o=a.next()).done;e++)r.push(o.value);s=r}for(h&&u>2&&(l=c(l,arguments[2],2)),e=0,n=v(s.length),i=At(this,n);n>e;e++)i[e]=h?l(s[e],e):s[e];return i},kt=function(){for(var t=0,e=arguments.length,n=At(this,e);e>t;)n[t]=arguments[t++];return n},Pt=!!G&&o(function(){pt.call(new G(1))}),Dt=function(){return pt.apply(Pt?ht.call(It(this)):It(this),arguments)},xt={copyWithin:function(t,e){return U.call(It(this),t,e,arguments.length>2?arguments[2]:void 0)},every:function(t){return $(It(this),t,arguments.length>1?arguments[1]:void 0)},fill:function(t){return F.apply(It(this),arguments)},filter:function(t){return Ot(this,Y(It(this),t,arguments.length>1?arguments[1]:void 0))},find:function(t){return Z(It(this),t,arguments.length>1?arguments[1]:void 0)},findIndex:function(t){return tt(It(this),t,arguments.length>1?arguments[1]:void 0)},forEach:function(t){X(It(this),t,arguments.length>1?arguments[1]:void 0)},indexOf:function(t){return nt(It(this),t,arguments.length>1?arguments[1]:void 0)},includes:function(t){return et(It(this),t,arguments.length>1?arguments[1]:void 0)},join:function(t){return ct.apply(It(this),arguments)},lastIndexOf:function(t){return at.apply(It(this),arguments)},map:function(t){return Et(It(this),t,arguments.length>1?arguments[1]:void 0)},reduce:function(t){return st.apply(It(this),arguments)},reduceRight:function(t){return ut.apply(It(this),arguments)},reverse:function(){for(var t,e=this,n=It(e).length,r=Math.floor(n/2),i=0;i<r;)t=e[i],e[i++]=e[--n],e[n]=t;return e},some:function(t){return J(It(this),t,arguments.length>1?arguments[1]:void 0)},sort:function(t){return lt.call(It(this),t)},subarray:function(t,e){var n=It(this),r=n.length,i=y(t,r);return new(P(n,n[yt]))(n.buffer,n.byteOffset+i*n.BYTES_PER_ELEMENT,v((void 0===e?r:y(e,r))-i))}},Mt=function(t,e){return Ot(this,ht.call(It(this),t,e))},Lt=function(t){It(this);var e=Tt(arguments[1],1),n=this.length,r=w(t),i=v(r.length),o=0;if(i+e>n)throw q("Wrong length!");for(;o<i;)this[e+o]=r[o++]},Ft={entries:function(){return ot.call(It(this))},keys:function(){return it.call(It(this))},values:function(){return rt.call(It(this))}},Ut=function(t,e){return E(t)&&t[_t]&&"symbol"!=typeof e&&e in t&&String(+e)==String(e)},jt=function(t,e){return Ut(t,e=m(e,!0))?h(2,t[e]):W(t,e)},Bt=function(t,e,n){return!(Ut(t,e=m(e,!0))&&E(n)&&_(n,"value"))||_(n,"get")||_(n,"set")||n.configurable||_(n,"writable")&&!n.writable||_(n,"enumerable")&&!n.enumerable?V(t,e,n):(t[e]=n.value,t)};mt||(B.f=jt,j.f=Bt),a(a.S+a.F*!mt,"Object",{getOwnPropertyDescriptor:jt,defineProperty:Bt}),o(function(){ft.call({})})&&(ft=pt=function(){return ct.call(this)});var Vt=p({},xt);p(Vt,Ft),f(Vt,dt,Ft.values),p(Vt,{slice:Mt,set:Lt,constructor:function(){},toString:ft,toLocaleString:Dt}),Rt(Vt,"buffer","b"),Rt(Vt,"byteOffset","o"),Rt(Vt,"byteLength","l"),Rt(Vt,"length","e"),V(Vt,vt,{get:function(){return this[_t]}}),t.exports=function(t,e,n,u){var c=t+((u=!!u)?"Clamped":"")+"Array",h="get"+t,p="set"+t,d=i[c],y=d||{},m=d&&I(d),_=!d||!s.ABV,w={},S=d&&d.prototype,O=function(t,n){var r=t._d;return r.v[h](n*e+r.o,wt)},C=function(t,n,r){var i=t._d;u&&(r=(r=Math.round(r))<0?0:r>255?255:255&r),i.v[p](n*e+i.o,r,wt)},R=function(t,e){V(t,e,{get:function(){return O(this,e)},set:function(t){return C(this,e,t)},enumerable:!0})};_?(d=n(function(t,n,r,i){l(t,d,c,"_d");var o,a,s,u,h=0,p=0;if(E(n)){if(!(n instanceof z||"ArrayBuffer"==(u=b(n))||"SharedArrayBuffer"==u))return _t in n?Ct(d,n):Nt.call(d,n);o=n,p=Tt(r,e);var y=n.byteLength;if(void 0===i){if(y%e)throw q("Wrong length!");if((a=y-p)<0)throw q("Wrong length!")}else if((a=v(i)*e)+p>y)throw q("Wrong length!");s=a/e}else s=g(n),o=new z(a=s*e);for(f(t,"_d",{b:o,o:p,l:a,e:s,v:new Q(o)});h<s;)R(t,h++)}),S=d.prototype=T(Vt),f(S,"constructor",d)):o(function(){d(1)})&&o(function(){new d(-1)})&&M(function(t){new d,new d(null),new d(1.5),new d(t)},!0)||(d=n(function(t,n,r,i){var o;return l(t,d,c),E(n)?n instanceof z||"ArrayBuffer"==(o=b(n))||"SharedArrayBuffer"==o?void 0!==i?new y(n,Tt(r,e),i):void 0!==r?new y(n,Tt(r,e)):new y(n):_t in n?Ct(d,n):Nt.call(d,n):new y(g(n))}),X(m!==Function.prototype?A(y).concat(A(m)):A(y),function(t){t in d||f(d,t,y[t])}),d.prototype=S,r||(S.constructor=d));var N=S[dt],k=!!N&&("values"==N.name||null==N.name),P=Ft.values;f(d,gt,!0),f(S,_t,c),f(S,bt,!0),f(S,yt,d),(u?new d(1)[vt]==c:vt in S)||V(S,vt,{get:function(){return c}}),w[c]=d,a(a.G+a.W+a.F*(d!=y),w),a(a.S,c,{BYTES_PER_ELEMENT:e}),a(a.S+a.F*o(function(){y.of.call(d,1)}),c,{from:Nt,of:kt}),"BYTES_PER_ELEMENT"in S||f(S,"BYTES_PER_ELEMENT",e),a(a.P,c,xt),L(c),a(a.P+a.F*St,c,{set:Lt}),a(a.P+a.F*!k,c,Ft),r||S.toString==ft||(S.toString=ft),a(a.P+a.F*o(function(){new d(1).slice()}),c,{slice:Mt}),a(a.P+a.F*(o(function(){return[1,2].toLocaleString()!=new d([1,2]).toLocaleString()})||!o(function(){S.toLocaleString.call([1,2])})),c,{toLocaleString:Dt}),x[c]=k?N:P,r||k||f(S,dt,P)}}else t.exports=function(){}},function(t,e,n){var r=n(198),i=n(0),o=n(89)("metadata"),a=o.store||(o.store=new(n(201))),s=function(t,e,n){var i=a.get(t);if(!i){if(!n)return;a.set(t,i=new r)}var o=i.get(e);if(!o){if(!n)return;i.set(e,o=new r)}return o};t.exports={store:a,map:s,has:function(t,e,n){var r=s(e,n,!1);return void 0!==r&&r.has(t)},get:function(t,e,n){var r=s(e,n,!1);return void 0===r?void 0:r.get(t)},set:function(t,e,n,r){s(n,r,!0).set(t,e)},keys:function(t,e){var n=s(t,e,!1),r=[];return n&&n.forEach(function(t,e){r.push(e)}),r},key:function(t){return void 0===t||"symbol"==typeof t?t:String(t)},exp:function(t){i(i.S,"Reflect",t)}}},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.store=null,this.unBindStore=null,this.store=e,this.currentState=this.store.getState()}return r(t,[{key:"bindStore",value:function(){var t=this;this.unBindStore=this.store.subscribe(function(){var e=t.store.getState();t.previousState=t.currentState,t.currentState=e,t.handleStoreChange()})}}]),t}();e.BaseView=i},function(t,e,n){(function(t,n){var r;!function(){var i="object"==typeof self&&self.self===self&&self||"object"==typeof t&&t.global===t&&t||this||{},o=i._,a=Array.prototype,s=Object.prototype,u="undefined"!=typeof Symbol?Symbol.prototype:null,c=a.push,l=a.slice,h=s.toString,f=s.hasOwnProperty,p=Array.isArray,d=Object.keys,v=Object.create,g=function(){},y=function(t){return t instanceof y?t:this instanceof y?void(this._wrapped=t):new y(t)};e.nodeType?i._=y:(!n.nodeType&&n.exports&&(e=n.exports=y),e._=y),y.VERSION="1.9.1";var m,_=function(t,e,n){if(void 0===e)return t;switch(null==n?3:n){case 1:return function(n){return t.call(e,n)};case 3:return function(n,r,i){return t.call(e,n,r,i)};case 4:return function(n,r,i,o){return t.call(e,n,r,i,o)}}return function(){return t.apply(e,arguments)}},b=function(t,e,n){return y.iteratee!==m?y.iteratee(t,e):null==t?y.identity:y.isFunction(t)?_(t,e,n):y.isObject(t)&&!y.isArray(t)?y.matcher(t):y.property(t)};y.iteratee=m=function(t,e){return b(t,e,1/0)};var E=function(t,e){return e=null==e?t.length-1:+e,function(){for(var n=Math.max(arguments.length-e,0),r=Array(n),i=0;i<n;i++)r[i]=arguments[i+e];switch(e){case 0:return t.call(this,r);case 1:return t.call(this,arguments[0],r);case 2:return t.call(this,arguments[0],arguments[1],r)}var o=Array(e+1);for(i=0;i<e;i++)o[i]=arguments[i];return o[e]=r,t.apply(this,o)}},w=function(t){if(!y.isObject(t))return{};if(v)return v(t);g.prototype=t;var e=new g;return g.prototype=null,e},S=function(t){return function(e){return null==e?void 0:e[t]}},T=function(t,e){return null!=t&&f.call(t,e)},I=function(t,e){for(var n=e.length,r=0;r<n;r++){if(null==t)return;t=t[e[r]]}return n?t:void 0},A=Math.pow(2,53)-1,O=S("length"),C=function(t){var e=O(t);return"number"==typeof e&&e>=0&&e<=A};y.each=y.forEach=function(t,e,n){var r,i;if(e=_(e,n),C(t))for(r=0,i=t.length;r<i;r++)e(t[r],r,t);else{var o=y.keys(t);for(r=0,i=o.length;r<i;r++)e(t[o[r]],o[r],t)}return t},y.map=y.collect=function(t,e,n){e=b(e,n);for(var r=!C(t)&&y.keys(t),i=(r||t).length,o=Array(i),a=0;a<i;a++){var s=r?r[a]:a;o[a]=e(t[s],s,t)}return o};var R=function(t){var e=function(e,n,r,i){var o=!C(e)&&y.keys(e),a=(o||e).length,s=t>0?0:a-1;for(i||(r=e[o?o[s]:s],s+=t);s>=0&&s<a;s+=t){var u=o?o[s]:s;r=n(r,e[u],u,e)}return r};return function(t,n,r,i){var o=arguments.length>=3;return e(t,_(n,i,4),r,o)}};y.reduce=y.foldl=y.inject=R(1),y.reduceRight=y.foldr=R(-1),y.find=y.detect=function(t,e,n){var r=(C(t)?y.findIndex:y.findKey)(t,e,n);if(void 0!==r&&-1!==r)return t[r]},y.filter=y.select=function(t,e,n){var r=[];return e=b(e,n),y.each(t,function(t,n,i){e(t,n,i)&&r.push(t)}),r},y.reject=function(t,e,n){return y.filter(t,y.negate(b(e)),n)},y.every=y.all=function(t,e,n){e=b(e,n);for(var r=!C(t)&&y.keys(t),i=(r||t).length,o=0;o<i;o++){var a=r?r[o]:o;if(!e(t[a],a,t))return!1}return!0},y.some=y.any=function(t,e,n){e=b(e,n);for(var r=!C(t)&&y.keys(t),i=(r||t).length,o=0;o<i;o++){var a=r?r[o]:o;if(e(t[a],a,t))return!0}return!1},y.contains=y.includes=y.include=function(t,e,n,r){return C(t)||(t=y.values(t)),("number"!=typeof n||r)&&(n=0),y.indexOf(t,e,n)>=0},y.invoke=E(function(t,e,n){var r,i;return y.isFunction(e)?i=e:y.isArray(e)&&(r=e.slice(0,-1),e=e[e.length-1]),y.map(t,function(t){var o=i;if(!o){if(r&&r.length&&(t=I(t,r)),null==t)return;o=t[e]}return null==o?o:o.apply(t,n)})}),y.pluck=function(t,e){return y.map(t,y.property(e))},y.where=function(t,e){return y.filter(t,y.matcher(e))},y.findWhere=function(t,e){return y.find(t,y.matcher(e))},y.max=function(t,e,n){var r,i,o=-1/0,a=-1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t)for(var s=0,u=(t=C(t)?t:y.values(t)).length;s<u;s++)null!=(r=t[s])&&r>o&&(o=r);else e=b(e,n),y.each(t,function(t,n,r){((i=e(t,n,r))>a||i===-1/0&&o===-1/0)&&(o=t,a=i)});return o},y.min=function(t,e,n){var r,i,o=1/0,a=1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t)for(var s=0,u=(t=C(t)?t:y.values(t)).length;s<u;s++)null!=(r=t[s])&&r<o&&(o=r);else e=b(e,n),y.each(t,function(t,n,r){((i=e(t,n,r))<a||i===1/0&&o===1/0)&&(o=t,a=i)});return o},y.shuffle=function(t){return y.sample(t,1/0)},y.sample=function(t,e,n){if(null==e||n)return C(t)||(t=y.values(t)),t[y.random(t.length-1)];var r=C(t)?y.clone(t):y.values(t),i=O(r);e=Math.max(Math.min(e,i),0);for(var o=i-1,a=0;a<e;a++){var s=y.random(a,o),u=r[a];r[a]=r[s],r[s]=u}return r.slice(0,e)},y.sortBy=function(t,e,n){var r=0;return e=b(e,n),y.pluck(y.map(t,function(t,n,i){return{value:t,index:r++,criteria:e(t,n,i)}}).sort(function(t,e){var n=t.criteria,r=e.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(n<r||void 0===r)return-1}return t.index-e.index}),"value")};var N=function(t,e){return function(n,r,i){var o=e?[[],[]]:{};return r=b(r,i),y.each(n,function(e,i){var a=r(e,i,n);t(o,e,a)}),o}};y.groupBy=N(function(t,e,n){T(t,n)?t[n].push(e):t[n]=[e]}),y.indexBy=N(function(t,e,n){t[n]=e}),y.countBy=N(function(t,e,n){T(t,n)?t[n]++:t[n]=1});var k=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;y.toArray=function(t){return t?y.isArray(t)?l.call(t):y.isString(t)?t.match(k):C(t)?y.map(t,y.identity):y.values(t):[]},y.size=function(t){return null==t?0:C(t)?t.length:y.keys(t).length},y.partition=N(function(t,e,n){t[n?0:1].push(e)},!0),y.first=y.head=y.take=function(t,e,n){return null==t||t.length<1?null==e?void 0:[]:null==e||n?t[0]:y.initial(t,t.length-e)},y.initial=function(t,e,n){return l.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))},y.last=function(t,e,n){return null==t||t.length<1?null==e?void 0:[]:null==e||n?t[t.length-1]:y.rest(t,Math.max(0,t.length-e))},y.rest=y.tail=y.drop=function(t,e,n){return l.call(t,null==e||n?1:e)},y.compact=function(t){return y.filter(t,Boolean)};var P=function(t,e,n,r){for(var i=(r=r||[]).length,o=0,a=O(t);o<a;o++){var s=t[o];if(C(s)&&(y.isArray(s)||y.isArguments(s)))if(e)for(var u=0,c=s.length;u<c;)r[i++]=s[u++];else P(s,e,n,r),i=r.length;else n||(r[i++]=s)}return r};y.flatten=function(t,e){return P(t,e,!1)},y.without=E(function(t,e){return y.difference(t,e)}),y.uniq=y.unique=function(t,e,n,r){y.isBoolean(e)||(r=n,n=e,e=!1),null!=n&&(n=b(n,r));for(var i=[],o=[],a=0,s=O(t);a<s;a++){var u=t[a],c=n?n(u,a,t):u;e&&!n?(a&&o===c||i.push(u),o=c):n?y.contains(o,c)||(o.push(c),i.push(u)):y.contains(i,u)||i.push(u)}return i},y.union=E(function(t){return y.uniq(P(t,!0,!0))}),y.intersection=function(t){for(var e=[],n=arguments.length,r=0,i=O(t);r<i;r++){var o=t[r];if(!y.contains(e,o)){var a;for(a=1;a<n&&y.contains(arguments[a],o);a++);a===n&&e.push(o)}}return e},y.difference=E(function(t,e){return e=P(e,!0,!0),y.filter(t,function(t){return!y.contains(e,t)})}),y.unzip=function(t){for(var e=t&&y.max(t,O).length||0,n=Array(e),r=0;r<e;r++)n[r]=y.pluck(t,r);return n},y.zip=E(y.unzip),y.object=function(t,e){for(var n={},r=0,i=O(t);r<i;r++)e?n[t[r]]=e[r]:n[t[r][0]]=t[r][1];return n};var D=function(t){return function(e,n,r){n=b(n,r);for(var i=O(e),o=t>0?0:i-1;o>=0&&o<i;o+=t)if(n(e[o],o,e))return o;return-1}};y.findIndex=D(1),y.findLastIndex=D(-1),y.sortedIndex=function(t,e,n,r){for(var i=(n=b(n,r,1))(e),o=0,a=O(t);o<a;){var s=Math.floor((o+a)/2);n(t[s])<i?o=s+1:a=s}return o};var x=function(t,e,n){return function(r,i,o){var a=0,s=O(r);if("number"==typeof o)t>0?a=o>=0?o:Math.max(o+s,a):s=o>=0?Math.min(o+1,s):o+s+1;else if(n&&o&&s)return r[o=n(r,i)]===i?o:-1;if(i!=i)return(o=e(l.call(r,a,s),y.isNaN))>=0?o+a:-1;for(o=t>0?a:s-1;o>=0&&o<s;o+=t)if(r[o]===i)return o;return-1}};y.indexOf=x(1,y.findIndex,y.sortedIndex),y.lastIndexOf=x(-1,y.findLastIndex),y.range=function(t,e,n){null==e&&(e=t||0,t=0),n||(n=e<t?-1:1);for(var r=Math.max(Math.ceil((e-t)/n),0),i=Array(r),o=0;o<r;o++,t+=n)i[o]=t;return i},y.chunk=function(t,e){if(null==e||e<1)return[];for(var n=[],r=0,i=t.length;r<i;)n.push(l.call(t,r,r+=e));return n};var M=function(t,e,n,r,i){if(!(r instanceof e))return t.apply(n,i);var o=w(t.prototype),a=t.apply(o,i);return y.isObject(a)?a:o};y.bind=E(function(t,e,n){if(!y.isFunction(t))throw new TypeError("Bind must be called on a function");var r=E(function(i){return M(t,r,e,this,n.concat(i))});return r}),y.partial=E(function(t,e){var n=y.partial.placeholder,r=function(){for(var i=0,o=e.length,a=Array(o),s=0;s<o;s++)a[s]=e[s]===n?arguments[i++]:e[s];for(;i<arguments.length;)a.push(arguments[i++]);return M(t,r,this,this,a)};return r}),y.partial.placeholder=y,y.bindAll=E(function(t,e){var n=(e=P(e,!1,!1)).length;if(n<1)throw new Error("bindAll must be passed function names");for(;n--;){var r=e[n];t[r]=y.bind(t[r],t)}}),y.memoize=function(t,e){var n=function(r){var i=n.cache,o=""+(e?e.apply(this,arguments):r);return T(i,o)||(i[o]=t.apply(this,arguments)),i[o]};return n.cache={},n},y.delay=E(function(t,e,n){return setTimeout(function(){return t.apply(null,n)},e)}),y.defer=y.partial(y.delay,y,1),y.throttle=function(t,e,n){var r,i,o,a,s=0;n||(n={});var u=function(){s=!1===n.leading?0:y.now(),r=null,a=t.apply(i,o),r||(i=o=null)},c=function(){var c=y.now();s||!1!==n.leading||(s=c);var l=e-(c-s);return i=this,o=arguments,l<=0||l>e?(r&&(clearTimeout(r),r=null),s=c,a=t.apply(i,o),r||(i=o=null)):r||!1===n.trailing||(r=setTimeout(u,l)),a};return c.cancel=function(){clearTimeout(r),s=0,r=i=o=null},c},y.debounce=function(t,e,n){var r,i,o=function(e,n){r=null,n&&(i=t.apply(e,n))},a=E(function(a){if(r&&clearTimeout(r),n){var s=!r;r=setTimeout(o,e),s&&(i=t.apply(this,a))}else r=y.delay(o,e,this,a);return i});return a.cancel=function(){clearTimeout(r),r=null},a},y.wrap=function(t,e){return y.partial(e,t)},y.negate=function(t){return function(){return!t.apply(this,arguments)}},y.compose=function(){var t=arguments,e=t.length-1;return function(){for(var n=e,r=t[e].apply(this,arguments);n--;)r=t[n].call(this,r);return r}},y.after=function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},y.before=function(t,e){var n;return function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=null),n}},y.once=y.partial(y.before,2),y.restArguments=E;var L=!{toString:null}.propertyIsEnumerable("toString"),F=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],U=function(t,e){var n=F.length,r=t.constructor,i=y.isFunction(r)&&r.prototype||s,o="constructor";for(T(t,o)&&!y.contains(e,o)&&e.push(o);n--;)(o=F[n])in t&&t[o]!==i[o]&&!y.contains(e,o)&&e.push(o)};y.keys=function(t){if(!y.isObject(t))return[];if(d)return d(t);var e=[];for(var n in t)T(t,n)&&e.push(n);return L&&U(t,e),e},y.allKeys=function(t){if(!y.isObject(t))return[];var e=[];for(var n in t)e.push(n);return L&&U(t,e),e},y.values=function(t){for(var e=y.keys(t),n=e.length,r=Array(n),i=0;i<n;i++)r[i]=t[e[i]];return r},y.mapObject=function(t,e,n){e=b(e,n);for(var r=y.keys(t),i=r.length,o={},a=0;a<i;a++){var s=r[a];o[s]=e(t[s],s,t)}return o},y.pairs=function(t){for(var e=y.keys(t),n=e.length,r=Array(n),i=0;i<n;i++)r[i]=[e[i],t[e[i]]];return r},y.invert=function(t){for(var e={},n=y.keys(t),r=0,i=n.length;r<i;r++)e[t[n[r]]]=n[r];return e},y.functions=y.methods=function(t){var e=[];for(var n in t)y.isFunction(t[n])&&e.push(n);return e.sort()};var j=function(t,e){return function(n){var r=arguments.length;if(e&&(n=Object(n)),r<2||null==n)return n;for(var i=1;i<r;i++)for(var o=arguments[i],a=t(o),s=a.length,u=0;u<s;u++){var c=a[u];e&&void 0!==n[c]||(n[c]=o[c])}return n}};y.extend=j(y.allKeys),y.extendOwn=y.assign=j(y.keys),y.findKey=function(t,e,n){e=b(e,n);for(var r,i=y.keys(t),o=0,a=i.length;o<a;o++)if(e(t[r=i[o]],r,t))return r};var B,V,W=function(t,e,n){return e in n};y.pick=E(function(t,e){var n={},r=e[0];if(null==t)return n;y.isFunction(r)?(e.length>1&&(r=_(r,e[1])),e=y.allKeys(t)):(r=W,e=P(e,!1,!1),t=Object(t));for(var i=0,o=e.length;i<o;i++){var a=e[i],s=t[a];r(s,a,t)&&(n[a]=s)}return n}),y.omit=E(function(t,e){var n,r=e[0];return y.isFunction(r)?(r=y.negate(r),e.length>1&&(n=e[1])):(e=y.map(P(e,!1,!1),String),r=function(t,n){return!y.contains(e,n)}),y.pick(t,r,n)}),y.defaults=j(y.allKeys,!0),y.create=function(t,e){var n=w(t);return e&&y.extendOwn(n,e),n},y.clone=function(t){return y.isObject(t)?y.isArray(t)?t.slice():y.extend({},t):t},y.tap=function(t,e){return e(t),t},y.isMatch=function(t,e){var n=y.keys(e),r=n.length;if(null==t)return!r;for(var i=Object(t),o=0;o<r;o++){var a=n[o];if(e[a]!==i[a]||!(a in i))return!1}return!0},B=function(t,e,n,r){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return!1;if(t!=t)return e!=e;var i=typeof t;return("function"===i||"object"===i||"object"==typeof e)&&V(t,e,n,r)},V=function(t,e,n,r){t instanceof y&&(t=t._wrapped),e instanceof y&&(e=e._wrapped);var i=h.call(t);if(i!==h.call(e))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!=+t?+e!=+e:0==+t?1/+t==1/e:+t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object Symbol]":return u.valueOf.call(t)===u.valueOf.call(e)}var o="[object Array]"===i;if(!o){if("object"!=typeof t||"object"!=typeof e)return!1;var a=t.constructor,s=e.constructor;if(a!==s&&!(y.isFunction(a)&&a instanceof a&&y.isFunction(s)&&s instanceof s)&&"constructor"in t&&"constructor"in e)return!1}r=r||[];for(var c=(n=n||[]).length;c--;)if(n[c]===t)return r[c]===e;if(n.push(t),r.push(e),o){if((c=t.length)!==e.length)return!1;for(;c--;)if(!B(t[c],e[c],n,r))return!1}else{var l,f=y.keys(t);if(c=f.length,y.keys(e).length!==c)return!1;for(;c--;)if(l=f[c],!T(e,l)||!B(t[l],e[l],n,r))return!1}return n.pop(),r.pop(),!0},y.isEqual=function(t,e){return B(t,e)},y.isEmpty=function(t){return null==t||(C(t)&&(y.isArray(t)||y.isString(t)||y.isArguments(t))?0===t.length:0===y.keys(t).length)},y.isElement=function(t){return!(!t||1!==t.nodeType)},y.isArray=p||function(t){return"[object Array]"===h.call(t)},y.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},y.each(["Arguments","Function","String","Number","Date","RegExp","Error","Symbol","Map","WeakMap","Set","WeakSet"],function(t){y["is"+t]=function(e){return h.call(e)==="[object "+t+"]"}}),y.isArguments(arguments)||(y.isArguments=function(t){return T(t,"callee")});var q=i.document&&i.document.childNodes;"object"!=typeof Int8Array&&"function"!=typeof q&&(y.isFunction=function(t){return"function"==typeof t||!1}),y.isFinite=function(t){return!y.isSymbol(t)&&isFinite(t)&&!isNaN(parseFloat(t))},y.isNaN=function(t){return y.isNumber(t)&&isNaN(t)},y.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"===h.call(t)},y.isNull=function(t){return null===t},y.isUndefined=function(t){return void 0===t},y.has=function(t,e){if(!y.isArray(e))return T(t,e);for(var n=e.length,r=0;r<n;r++){var i=e[r];if(null==t||!f.call(t,i))return!1;t=t[i]}return!!n},y.noConflict=function(){return i._=o,this},y.identity=function(t){return t},y.constant=function(t){return function(){return t}},y.noop=function(){},y.property=function(t){return y.isArray(t)?function(e){return I(e,t)}:S(t)},y.propertyOf=function(t){return null==t?function(){}:function(e){return y.isArray(e)?I(t,e):t[e]}},y.matcher=y.matches=function(t){return t=y.extendOwn({},t),function(e){return y.isMatch(e,t)}},y.times=function(t,e,n){var r=Array(Math.max(0,t));e=_(e,n,1);for(var i=0;i<t;i++)r[i]=e(i);return r},y.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},y.now=Date.now||function(){return(new Date).getTime()};var H={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},G=y.invert(H),K=function(t){var e=function(e){return t[e]},n="(?:"+y.keys(t).join("|")+")",r=RegExp(n),i=RegExp(n,"g");return function(t){return t=null==t?"":""+t,r.test(t)?t.replace(i,e):t}};y.escape=K(H),y.unescape=K(G),y.result=function(t,e,n){y.isArray(e)||(e=[e]);var r=e.length;if(!r)return y.isFunction(n)?n.call(t):n;for(var i=0;i<r;i++){var o=null==t?void 0:t[e[i]];void 0===o&&(o=n,i=r),t=y.isFunction(o)?o.call(t):o}return t};var z=0;y.uniqueId=function(t){var e=++z+"";return t?t+e:e},y.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var Q=/(.)^/,X={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},Y=/\\|'|\r|\n|\u2028|\u2029/g,J=function(t){return"\\"+X[t]};y.template=function(t,e,n){!e&&n&&(e=n),e=y.defaults({},e,y.templateSettings);var r,i=RegExp([(e.escape||Q).source,(e.interpolate||Q).source,(e.evaluate||Q).source].join("|")+"|$","g"),o=0,a="__p+='";t.replace(i,function(e,n,r,i,s){return a+=t.slice(o,s).replace(Y,J),o=s+e.length,n?a+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?a+="'+\n((__t=("+r+"))==null?'':__t)+\n'":i&&(a+="';\n"+i+"\n__p+='"),e}),a+="';\n",e.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{r=new Function(e.variable||"obj","_",a)}catch(t){throw t.source=a,t}var s=function(t){return r.call(this,t,y)};return s.source="function("+(e.variable||"obj")+"){\n"+a+"}",s},y.chain=function(t){var e=y(t);return e._chain=!0,e};var $=function(t,e){return t._chain?y(e).chain():e};y.mixin=function(t){return y.each(y.functions(t),function(e){var n=y[e]=t[e];y.prototype[e]=function(){var t=[this._wrapped];return c.apply(t,arguments),$(this,n.apply(y,t))}}),y},y.mixin(y),y.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=a[t];y.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!==t&&"splice"!==t||0!==n.length||delete n[0],$(this,n)}}),y.each(["concat","join","slice"],function(t){var e=a[t];y.prototype[t]=function(){return $(this,e.apply(this._wrapped,arguments))}}),y.prototype.value=function(){return this._wrapped},y.prototype.valueOf=y.prototype.toJSON=y.prototype.value,y.prototype.toString=function(){return String(this._wrapped)},void 0!==(r=function(){return y}.apply(e,[]))&&(n.exports=r)}()}).call(this,n(8),n(113)(t))},function(t,e,n){var r=n(262),i="object"==typeof self&&self&&self.Object===Object&&self,o=r||i||Function("return this")();t.exports=o},function(t,e){var n=Array.isArray;t.exports=n},function(t,e,n){var r=n(52)("meta"),i=n(6),o=n(25),a=n(11).f,s=0,u=Object.isExtensible||function(){return!0},c=!n(5)(function(){return u(Object.preventExtensions({}))}),l=function(t){a(t,r,{value:{i:"O"+ ++s,w:{}}})},h=t.exports={KEY:r,NEED:!1,fastKey:function(t,e){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,r)){if(!u(t))return"F";if(!e)return"E";l(t)}return t[r].i},getWeak:function(t,e){if(!o(t,r)){if(!u(t))return!0;if(!e)return!1;l(t)}return t[r].w},onFreeze:function(t){return c&&h.NEED&&u(t)&&!o(t,r)&&l(t),t}}},function(t,e,n){var r=n(7)("unscopables"),i=Array.prototype;null==i[r]&&n(20)(i,r,{}),t.exports=function(t){i[r][t]=!0}},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.logEnabled=!1}return r(t,[{key:"log",value:function(t,e,n,r){if(this.logEnabled){for(var i=arguments.length,o=Array(i>4?i-4:0),a=4;a<i;a++)o[a-4]=arguments[a];console.log("%c [ "+t+" ] %c "+r,"background-color: "+e+"; color: "+n,"color:black;font-weight:bold;",o)}}},{key:"logFirebaseIO",value:function(t,e,n,r,i,o){if(this.logEnabled){var a=o||"",s=this.formatBytes((new TextEncoder).encode(JSON.stringify(a)).length);console.log("%c [ Firebase IO ] %c "+t+" %c "+(e?"==> App":"<== App")+" %c "+i,"background-color: orange; color: white","background-color: "+n+"; color: "+r,"background-color: grey; color: white","color:black;font-weight:bold;",a,s)}}},{key:"formatBytes",value:function(t){for(var e=0;t/1024>1;)t/=1024,e++;return 0===e?t+" B":1===e?t+" KB":2===e?t+" MB":void 0}}]),t}();e.Logger=i,e.weavaLogger=new i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(9),i=n(242),o=n(44);e.handleFirebaseFolderUpdateNewState=function(t,e,n,o){var a=t,s=t.activeFolderMap.keySeq().first()||"";a=a.set("folderMetaMap",n);var u=function(){a=(a=(a=(a=a.set("activeWebsiteIdList",r.List([]))).set("activeWebsiteBodyMap",r.Map({}))).set("nonActiveWebsiteBodyMap",r.Map({}))).set("searchState",new i.SearchStateRecord)},c=o.first(null);if(c&&c.websiteIds)if(s===o.keySeq().first()){var l=c.websiteIds.keySeq(),h=a.activeWebsiteIdList,f=a.activeWebsiteBodyMap;f.keySeq().forEach(function(t){l.includes(t)||(console.log("delete active website",t),f=f.delete(t),h=h.filter(function(e){return e!==t}).toList(),a=(a=a.set("activeWebsiteBodyMap",f)).set("activeWebsiteIdList",h))});var p=a.nonActiveWebsiteBodyMap;p.keySeq().forEach(function(t){l.includes(t)||(console.log("delete list website",t),p=p.delete(t),a=a.set("nonActiveWebsiteBodyMap",p))})}else u();else u();return a=a.set("activeFolderMap",o)},e.getActiveFolderIdFromState=function(t){return t.activeFolderMap.keySeq().first()||null},e.switchFolderNewState=function(t){var e=t,n=(e=(e=(e=(e=(e=e.set("nonActiveWebsiteBodyMap",r.Map({}))).set("websiteListPaginationMap",r.Map({endAt:20,step:5,orderBy:"date",ascending:!1}))).set("activeFolderMap",r.Map({}))).set("activeWebsiteIdList",r.List([]))).set("activeWebsiteBodyMap",r.Map({}))).searchState.set("searching",!1);return n=n.set("searchResult",r.fromJS({})),(e=e.set("searchState",n)).set("activeFolderUserMeta",null)},e.addToActiveWebsiteIdsNewState=function(t,n){var i=t;if(!e.getWebsiteIdsState(i))return i;var o=i.activeWebsiteIdList,a=r.List([]);n.forEach(function(n){var r=e.getWebsiteFromStateByUrl(t,n);r&&(o.includes(r),a=a.push(r))});var s=o.toSet().subtract(a.toSet()),u=i.activeWebsiteBodyMap;return s.forEach(function(t){u=u.delete(t)}),(i=i.set("activeWebsiteBodyMap",u)).set("activeWebsiteIdList",a)},e.handleFirebaseWebsiteUpdateNewState=function(t,e,n){var r=t,i=r.activeFolderMap.first(null);if(i&&i.websiteIds&&i.websiteIds.keySeq().includes(e)&&n){var o=function(t){r=r.setIn([t,e],n)};r.activeWebsiteIdList.includes(e)&&o("activeWebsiteBodyMap"),o("nonActiveWebsiteBodyMap")}return r},e.websiteListNextPageNewState=function(t){var n=t,r=e.getActiveFolderIdFromState(t);return r&&n.getIn(["activeFolderMap",r,"websiteIds"])?n=n.getIn(["websiteListPaginationMap","endAt"])+n.getIn(["websiteListPaginationMap","step"])<n.getIn(["activeFolderMap",r,"websiteIds"]).size?n.setIn(["websiteListPaginationMap","endAt"],n.getIn(["websiteListPaginationMap","endAt"])+n.getIn(["websiteListPaginationMap","step"])):n.setIn(["websiteListPaginationMap","endAt"],n.getIn(["activeFolderMap",r,"websiteIds"]).size-1):n},e.getWebsiteIdsState=function(t){var n=e.getActiveFolderIdFromState(t)||null;if(!n||!t.activeFolderMap)return null;var r=t.activeFolderMap.get(n);if(!r)return null;var i=r.websiteIds;if(!i){var o=t.activeFolderMap.get(n);o&&(i=o.websiteIds)}return i},e.getWebsiteFromStateByUrl=function(t,n){var r=e.getWebsiteIdsState(t);if(r){var i=r.findKey(function(t,e){return UrlUtil.getOriginalUrlForPDF(t.get("url"))===UrlUtil.getOriginalUrlForPDF(n)});return i||(i=r.findKey(function(t,e){return t.get("localUrls")&&t.get("localUrls").includes(UrlUtil.getOriginalUrlForPDF(n))})),i}return null},e.objectUndefinedToNull=function(t){return function t(e){o.forEach(e,function(n,r){void 0===n&&(e[r]=null),(n instanceof Array||n instanceof Object)&&t(n||{})})}(t),t};e.getPathFromFolderTree=function(t,e){var n=function(t,e){return console.log("searching for",e),function t(n,r,i){if(r=r.add(n[0]),n[0]===e)return i;var o=n[1].folderMetaMap;if(o){var a=o.keySeq().toSet().subtract(r).toArray(),s=!0,u=!1,c=void 0;try{for(var l,h=a[Symbol.iterator]();!(s=(l=h.next()).done);s=!0){var f=l.value,p=t([f,o.get(f)],r,i.push(f));if(p)return p}}catch(t){u=!0,c=t}finally{try{!s&&h.return&&h.return()}finally{if(u)throw c}}}return null}(["~",{folderMetaMap:t}],r.Set([]),r.List(["~"]))}(t,e);if(!n)return null;n=n.delete(0);var i=r.List([]);return n.forEach(function(t){i=(i=i.push("folderMetaMap")).push(t)}),i},e.searchFolderTitlePath=function(t,e){return function t(n,r,i){if(r=r.add(n[0]),n[0]===e)return i;var o=n[1].folderMetaMap;if(o){var a=o.keySeq().toSet().subtract(r).toArray(),s=!0,u=!1,c=void 0;try{for(var l,h=a[Symbol.iterator]();!(s=(l=h.next()).done);s=!0){var f=l.value,p=o.get(f);if(p){var d=t([f,p],r,i.push({title:p.title,folderId:f}));if(d)return d}}}catch(t){u=!0,c=t}finally{try{!s&&h.return&&h.return()}finally{if(u)throw c}}}return null}(["~",{folderMetaMap:t}],r.Set([]),r.List(["~"]))},e.getAllFolderIds=function(t){return function t(e,n){n=n.add(e[0]);var r=e[1].folderMetaMap;if(r){var i=r.keySeq().toSet().subtract(n).toArray(),o=!0,a=!1,s=void 0;try{for(var u,c=i[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var l=u.value,h=t([l,r.get(l)],n);n=n.union(h)}}catch(t){a=!0,s=t}finally{try{!o&&c.return&&c.return()}finally{if(a)throw s}}return n}return n}(["~",{folderMetaMap:t}],r.Set([]))},e.getAllNestedFolderIds=function(t){var n=t.keySeq(),i=e.getAllFolderIds(t);return r.List(i.filter(function(t){return!n.includes(t)&&"~"!==t}))}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e){var n=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+r).toString(36))}},function(t,e){t.exports=!1},function(t,e,n){var r=n(179),i=n(127);t.exports=Object.keys||function(t){return r(t,i)}},function(t,e,n){var r=n(37),i=Math.max,o=Math.min;t.exports=function(t,e){return(t=r(t))<0?i(t+e,0):o(t,e)}},function(t,e,n){var r=n(2),i=n(180),o=n(127),a=n(126)("IE_PROTO"),s=function(){},u=function(){var t,e=n(124)("iframe"),r=o.length;for(e.style.display="none",n(128).appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),u=t.F;r--;)delete u.prototype[o[r]];return u()};t.exports=Object.create||function(t,e){var n;return null!==t?(s.prototype=r(t),n=new s,s.prototype=null,n[a]=t):n=u(),void 0===e?n:i(n,e)}},function(t,e,n){var r=n(179),i=n(127).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,i)}},function(t,e,n){"use strict";var r=n(3),i=n(11),o=n(10),a=n(7)("species");t.exports=function(t){var e=r[t];o&&e&&!e[a]&&i.f(e,a,{configurable:!0,get:function(){return this}})}},function(t,e){t.exports=function(t,e,n,r){if(!(t instanceof e)||void 0!==r&&r in t)throw TypeError(n+": incorrect invocation!");return t}},function(t,e,n){var r=n(30),i=n(191),o=n(140),a=n(2),s=n(12),u=n(142),c={},l={};(e=t.exports=function(t,e,n,h,f){var p,d,v,g,y=f?function(){return t}:u(t),m=r(n,h,e?2:1),_=0;if("function"!=typeof y)throw TypeError(t+" is not iterable!");if(o(y)){for(p=s(t.length);p>_;_++)if((g=e?m(a(d=t[_])[0],d[1]):m(t[_]))===c||g===l)return g}else for(v=y.call(t);!(d=v.next()).done;)if((g=i(v,m,d.value,e))===c||g===l)return g}).BREAK=c,e.RETURN=l},function(t,e,n){var r=n(21);t.exports=function(t,e,n){for(var i in e)r(t,i,e[i],n);return t}},function(t,e,n){"use strict";var r=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});var i=n(499),o=n(15);n(154),n(241);var a=n(65),s=n(18),u=n(85),c=n(114),l=(n(569).Base64,n(23)),h=n(40);e.firebaseAuthActionsConstants=l({TRIGGERING:null,SIGN_OUT:null,USER_CHANGED:null,SET_TOKEN:null,SET_CUSTOM_TOKEN:null,ON_SIGNUP_LOGIN_ERROR:null,ON_SIGNUP_ERROR:null,ON_LOGIN_ERROR:null,FETCHING_GMAILS:null,FETCHING_GMAILS_DONE:null}),e.firebaseAuthStatusOption=l({NOT_AUTHORIZED:null,TRIGGERING:null,AUTHORIZED:null}),e.triggering=function(){return{type:e.firebaseAuthActionsConstants.TRIGGERING}},e.userChange=function(t){return{type:e.firebaseAuthActionsConstants.USER_CHANGED,user:t}},e.setToken=function(t){return{type:e.firebaseAuthActionsConstants.SET_TOKEN,token:t}},e.onSignUpError=function(t){return{type:e.firebaseAuthActionsConstants.ON_SIGNUP_ERROR,error:t}},e.onLoginError=function(t){return{type:e.firebaseAuthActionsConstants.ON_LOGIN_ERROR,error:t}},e.onSignUpLoginError=function(t){return{type:e.firebaseAuthActionsConstants.ON_SIGNUP_LOGIN_ERROR,error:t}},e.setCustomToken=function(t,n){return{type:e.firebaseAuthActionsConstants.SET_CUSTOM_TOKEN,customToken:t.customToken,isAnonymous:n}},e.emitCustomToken=function(t,e,n){return function(r){r(i.onAddExternalMessage({id:"SIGN_IN",uid:t,customToken:e,isAnonymous:n}))}},e.queryCustomToken=function(t,n,r,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return function(a){var u=n+"apis/users/customToken?token="+r;a(s.TrackerActions.trackEvent("QUERYING_CUSTOM_TOKEN")),h(u).then(function(t){return t.json()}).then(function(n){a(s.TrackerActions.trackEvent("SUCCESSFUL_QUERYING_CUSTOM_TOKEN")),a(e.emitCustomToken(t,n.customToken,i)),a(e.setCustomToken(n,i))}).catch(function(u){a(s.TrackerActions.trackEvent("FAILED_QUERYING_CUSTOM_TOKEN",{error:u})),console.log(u),o<10&&setTimeout(function(){console.log("Retry reaching remote server ... ("+o+")"),a(e.onSignUpLoginError("Retry reaching remote server ... ("+o+")")),a(e.queryCustomToken(t,n,r,i,o+1))},3e3)})}},e.firebaseLoginWithGoogleAuthToken=function(t){return function(n){var r={provider:u.MetaConstants.AUTH_PROVIDER_CONSTANTS.GOOGLE},i=o.auth.GoogleAuthProvider.credential(t);o.auth().signInWithCredential(i).then(function(){n(s.TrackerActions.trackEvent("SUCCESSFUL_SIGN_IN",r))}).catch(function(t){console.error("Sign in error happens",t),r.errorCode=t.code,n(s.TrackerActions.trackEvent("SIGN_IN_ERROR",r)),n(e.userChange(null)),n(f(t,e.onSignUpLoginError))})}},e.grantGmailScopeAndGetMails=function(){return function(t){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function n(){var r,i,a,s,u;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=gapi.auth2.getAuthInstance(),!(i=r.currentUser.get())){n.next=13;break}return(a=new gapi.auth2.SigninOptionsBuilder).setPrompt("select_account consent"),a.setScope("https://www.googleapis.com/auth/gmail.metadata"),n.next=8,i.grantOfflineAccess(a);case 8:s=n.sent,t({type:e.firebaseAuthActionsConstants.FETCHING_GMAILS}),(u=o.auth().currentUser)&&o.firestore().collection("gmail-scope-status").doc(u.uid).set({gmail:s.getBasicProfile().getEmail(),status:"PENDING",authResponse:s.getAuthResponse()}),t({type:e.firebaseAuthActionsConstants.FETCHING_GMAILS_DONE});case 13:case"end":return n.stop()}},n,this)}))}},e.googleLoginGAPI=function(){return function(t){t(e.triggering());var n=gapi.auth2.getAuthInstance();n.signOut(),n.isSignedIn.listen(function(r){if(r){var i=n.currentUser.get();t(e.firebaseLoginWithGoogleAuthToken(i.getAuthResponse().id_token))}});var r=new gapi.auth2.SigninOptionsBuilder;r.setPrompt("select_account"),r.setScope("profile").setScope("email"),n.signIn(r).catch(function(n){t(e.userChange(null)),t(f({message:n.error},e.onSignUpLoginError))})}},e.googleLogin=function(){return function(t){t(e.triggering());var n=new o.auth.GoogleAuthProvider;n.setCustomParameters({prompt:"select_account"});var r={provider:u.MetaConstants.AUTH_PROVIDER_CONSTANTS.GOOGLE};o.auth().signInWithPopup(n).then(function(e){t(s.TrackerActions.trackEvent("SUCCESSFUL_SIGN_IN",r))}).catch(function(n){r.errorCode=n.code,t(s.TrackerActions.trackEvent("SIGN_IN_ERROR",r)),console.error("Sign in error happens",n),t(e.userChange(null)),t(f(n,e.onSignUpLoginError))})}},e.facebookLogin=function(){return function(t){t(e.triggering());var n=new o.auth.FacebookAuthProvider,r={provider:u.MetaConstants.AUTH_PROVIDER_CONSTANTS.FACEBOOK};o.auth().signInWithPopup(n).then(function(e){t(s.TrackerActions.trackEvent("SUCCESSFUL_SIGN_IN",r))}).catch(function(n){r.errorCode=n.code,t(s.TrackerActions.trackEvent("SIGN_IN_ERROR",r)),console.error("Sign in error happens",n),t(e.userChange(null)),t(f(n,e.onSignUpLoginError))})}},e.firebaseLoginWithFacebookAuthToken=function(t){return function(n){var r={provider:u.MetaConstants.AUTH_PROVIDER_CONSTANTS.FACEBOOK},i=o.auth.FacebookAuthProvider.credential(t);o.auth().signInWithCredential(i).then(function(){n(s.TrackerActions.trackEvent("SUCCESSFUL_SIGN_IN",r))}).catch(function(t){console.error("Sign in error happens",t),r.errorCode=t.code,n(s.TrackerActions.trackEvent("SIGN_IN_ERROR",r)),n(e.userChange(null)),n(f(t,e.onSignUpLoginError))})}},e.linkWithGoogle=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(n){t||n(e.triggering());var r=new o.auth.GoogleAuthProvider;r.setCustomParameters({prompt:"select_account"});var i={provider:u.MetaConstants.AUTH_PROVIDER_CONSTANTS.GOOGLE},a=o.auth().currentUser;a&&a.linkWithPopup(r).then(function(e){n(s.TrackerActions.trackEvent("SUCCESSFUL_LINK_ACCOUNT",i)),t?(chrome.tabs.query({url:"chrome-extension://cbnaodkpfinfiipjblikofhlhlcickei/src/auth_page/link.html*"},function(t){console.log(t);var e=!0,n=!1,r=void 0;try{for(var i,o=t[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;chrome.tabs.remove(a.id)}}catch(t){n=!0,r=t}finally{try{!e&&o.return&&o.return()}finally{if(n)throw r}}}),chrome.storage.local.set({isAnonymous:!1})):location.href="/app/dashboard"}).catch(function(r){i.errorCode=r.code,n(s.TrackerActions.trackEvent("LINK_ACCOUNT_ERROR",i)),console.error("Sign in error happens",r),t?f(r,function(t){return alert(r)}):n(f(r,e.onSignUpLoginError))})}},e.linkWithFacebook=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(n){t||n(e.triggering());var r=new o.auth.FacebookAuthProvider,i={provider:u.MetaConstants.AUTH_PROVIDER_CONSTANTS.FACEBOOK};r.addScope("user_friends");var a=o.auth().currentUser;a&&a.linkWithPopup(r).then(function(e){n(s.TrackerActions.trackEvent("SUCCESSFUL_LINK_ACCOUNT",i)),t?(chrome.tabs.query({url:"chrome-extension://cbnaodkpfinfiipjblikofhlhlcickei/src/auth_page/link.html*"},function(t){console.log(t);var e=!0,n=!1,r=void 0;try{for(var i,o=t[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;chrome.tabs.remove(a.id)}}catch(t){n=!0,r=t}finally{try{!e&&o.return&&o.return()}finally{if(n)throw r}}}),chrome.storage.local.set({isAnonymous:!1})):location.href="/app/dashboard"}).catch(function(r){i.errorCode=r.code,n(s.TrackerActions.trackEvent("LINK_ACCOUNT_ERROR",i)),console.error("Sign in error happens",r),t?f(r,function(t){return alert(r)}):n(f(r,e.onSignUpLoginError))})}},e.linkWithEmail=function(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return function(a){i||a(e.triggering());var c={provider:u.MetaConstants.AUTH_PROVIDER_CONSTANTS.EMAIL},l=o.auth.EmailAuthProvider.credential(t,n),h=o.auth().currentUser;h&&h.linkWithCredential(l).then(function(t){a(s.TrackerActions.trackEvent("SUCCESSFUL_LINK_ACCOUNT",c)),h.updateProfile({displayName:r,photoURL:null}),i?(chrome.tabs.query({url:"chrome-extension://cbnaodkpfinfiipjblikofhlhlcickei/src/auth_page/link.html*"},function(t){console.log(t);var e=!0,n=!1,r=void 0;try{for(var i,o=t[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;chrome.tabs.remove(a.id)}}catch(t){n=!0,r=t}finally{try{!e&&o.return&&o.return()}finally{if(n)throw r}}}),chrome.storage.local.set({isAnonymous:!1})):location.href="/app/dashboard"},function(t){console.error("Sign in error happens",t);var n=t.code;c.errorCode=n,a(s.TrackerActions.trackEvent("LINK_ACCOUNT_ERROR",c));var r=e.onSignUpError;switch(i&&(r=function(t){return alert(t)}),n){case"auth/email-already-in-use":a(r("The email is in use."));break;case"auth/invalid-email":a(r("The email is not valid."));break;case"auth/operation-not-allowed":a(r("Something wrong happened."));break;case"auth/weak-password":a(r("Password has to be more than 6 characters."));break;default:a(r(t.message))}})}},e.anonymousLogin=function(t,n){return function(i){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function a(){var l,h=this;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:i(e.triggering()),l={provider:u.MetaConstants.AUTH_PROVIDER_CONSTANTS.ANONYMOUS},o.auth().signInAnonymously().then(function(){return r(h,void 0,void 0,regeneratorRuntime.mark(function e(){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i(s.TrackerActions.trackEvent("SUCCESSFUL_SIGN_IN",l)),!n){e.next=12;break}if(!(r=o.auth().currentUser)){e.next=12;break}return e.t0=i,e.t1=c,e.t2=t,e.next=9,r.getIdToken(!0);case 9:e.t3=e.sent,e.t4=e.t1.createFolder.call(e.t1,e.t2,e.t3,"My Research Folder"),(0,e.t0)(e.t4);case 12:case"end":return e.stop()}},e,this)}))}).catch(function(t){l.errorCode=t.code,i(s.TrackerActions.trackEvent("SIGN_IN_ERROR",l))});case 3:case"end":return a.stop()}},a,this)}))}},e.emailLogin=function(t,n){return function(r){r(e.triggering());var i={provider:u.MetaConstants.AUTH_PROVIDER_CONSTANTS.EMAIL};o.auth().signInWithEmailAndPassword(t,n).then(function(){r(s.TrackerActions.trackEvent("SUCCESSFUL_SIGN_IN",i))}).catch(function(t){console.error("Sign in error happens",t);var n=t.code;switch(i.errorCode=n,r(s.TrackerActions.trackEvent("SIGN_IN_ERROR",i)),r(e.userChange(null)),n){case"auth/invalid-email":r(e.onLoginError("The email is not valid."));break;case"auth/user-disabled":r(e.onLoginError("The account is disabled."));break;case"auth/user-not-found":case"auth/wrong-password":r(e.onLoginError("The email/password is not correct."));break;default:r(e.onLoginError("Something wrong happened."))}})}},e.emailSignup=function(t,n,r){return function(i){i(e.triggering());var a={provider:u.MetaConstants.AUTH_PROVIDER_CONSTANTS.EMAIL};o.auth().createUserWithEmailAndPassword(t,n).then(function(t){i(s.TrackerActions.trackEvent("SUCCESSFUL_SIGN_IN",a));var e=o.auth().currentUser;e&&e.updateProfile({displayName:r,photoURL:null})}).catch(function(t){console.error("Sign in error happens",t);var n=t.code;switch(a.errorCode=n,i(s.TrackerActions.trackEvent("SIGN_IN_ERROR",a)),i(e.userChange(null)),n){case"auth/email-already-in-use":i(e.onSignUpError("The email is in use."));break;case"auth/invalid-email":i(e.onSignUpError("The email is not valid."));break;case"auth/operation-not-allowed":i(e.onSignUpError("Something wrong happened."));break;case"auth/weak-password":i(e.onSignUpError("Password has to be more than 6 characters."));break;default:i(e.onSignUpError("Something wrong happened."))}})}},e.signout=function(){return function(t){o.auth().signOut().then(function(){t({type:e.firebaseAuthActionsConstants.SIGN_OUT}),t(i.onAddExternalMessage({id:"SIGN_OUT"}))}).catch(function(t){console.log(t)})}},e.loginWithCustomToken=function(t,n){return function(r){return o.auth().signOut().then(function(){return r({type:e.firebaseAuthActionsConstants.SIGN_OUT}),r(s.TrackerActions.trackEvent("TRIGGERING_CUSTOM_TOKEN_LOGIN")),o.auth().signInWithCustomToken(t).then(function(){r(s.TrackerActions.trackEvent("LOGIN_WITH_CUSTOM_TOKEN")),r(e.setCustomToken(t,n))}).catch(function(t){r(s.TrackerActions.trackEvent("LOGIN_WITH_CUSTOM_TOKEN_FAIL",{error:t})),console.log(t)})}).catch(function(t){r(s.TrackerActions.trackEvent("SIGNOUT_ERROR",{error:t})),console.log(t)})}},e.forgetPassword=function(t){return function(e){o.auth().sendPasswordResetEmail(t).then(function(){alert("Password recovery method is sent to your email.")}).catch(function(t){switch(t.code){case"auth/invalid-email":alert("The email is not valid.");break;case"auth/user-not-found":alert("The account does not exist.");break;default:alert("Something wrong happened.")}})}},e.subscribeAuthChange=function(t){return function(n){o.auth().onAuthStateChanged(function(r){r?(-1!==document.URL.indexOf("chrome-extension")&&o.database().ref("/users/"+r.uid+"/meta/installedExtension").set(!0),console.log("user",r),n(e.userChange(r)),n(a.updateUserProfile(r)),n(s.TrackerActions.trackUserId(r.uid)),r&&-1===location.href.indexOf("signout")&&r.getIdToken(!0).then(function(i){n(e.setToken(i)),i&&(n(s.TrackerActions.trackIsAnonymous(r.isAnonymous)),setTimeout(function(){n(e.queryCustomToken(r.uid,t,i,r.isAnonymous))},2e3))})):n(e.userChange(null))})}};var f=function(t,e){switch(t.code){case"auth/account-exists-with-different-credential":case"auth/credential-already-in-use":return e("The email is in use. You have registered the account with another login method.");case"auth/auth-domain-config-required":return e("Something wrong happened.");case"auth/web-storage-unsupported":return e("Please enable third-party cookies in the browser setting.");case"auth/popup-closed-by-user":case"auth/cancelled-popup-request":return e("Login page closed by user.");case"auth/popup-blocked":return e("Login page blocked by browser.");default:return console.log(t),e("Something wrong happened, please contact support.\n("+t.message+")")}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(13),i=n(1),o=n(4),a=n(1),s=n(1);e.INVALID_KEY_REGEX_=/[\[\].#$\/\u0000-\u001F\u007F]/,e.INVALID_PATH_REGEX_=/[\[\].#$\u0000-\u001F\u007F]/,e.MAX_LEAF_SIZE_=10485760,e.isValidKey=function(t){return"string"==typeof t&&0!==t.length&&!e.INVALID_KEY_REGEX_.test(t)},e.isValidPathString=function(t){return"string"==typeof t&&0!==t.length&&!e.INVALID_PATH_REGEX_.test(t)},e.isValidRootPathString=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),e.isValidPathString(t)},e.isValidPriority=function(t){return null===t||"string"==typeof t||"number"==typeof t&&!o.isInvalidJSONNumber(t)||t&&"object"==typeof t&&i.contains(t,".sv")},e.validateFirebaseDataArg=function(t,n,r,i,o){o&&void 0===r||e.validateFirebaseData(a.errorPrefix(t,n,o),r,i)},e.validateFirebaseData=function(t,n,a){var u=a instanceof r.Path?new r.ValidationPath(a,t):a;if(void 0===n)throw new Error(t+"contains undefined "+u.toErrorString());if("function"==typeof n)throw new Error(t+"contains a function "+u.toErrorString()+" with contents = "+n.toString());if(o.isInvalidJSONNumber(n))throw new Error(t+"contains "+n.toString()+" "+u.toErrorString());if("string"==typeof n&&n.length>e.MAX_LEAF_SIZE_/3&&s.stringLength(n)>e.MAX_LEAF_SIZE_)throw new Error(t+"contains a string greater than "+e.MAX_LEAF_SIZE_+" utf8 bytes "+u.toErrorString()+" ('"+n.substring(0,50)+"...')");if(n&&"object"==typeof n){var c=!1,l=!1;if(i.forEach(n,function(n,r){if(".value"===n)c=!0;else if(".priority"!==n&&".sv"!==n&&(l=!0,!e.isValidKey(n)))throw new Error(t+" contains an invalid key ("+n+") "+u.toErrorString()+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');u.push(n),e.validateFirebaseData(t,r,u),u.pop()}),c&&l)throw new Error(t+' contains ".value" child '+u.toErrorString()+" in addition to actual children.")}},e.validateFirebaseMergePaths=function(t,n){var i,o;for(i=0;i<n.length;i++)for(var a=(o=n[i]).slice(),s=0;s<a.length;s++)if(".priority"===a[s]&&s===a.length-1);else if(!e.isValidKey(a[s]))throw new Error(t+"contains an invalid key ("+a[s]+") in path "+o.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');n.sort(r.Path.comparePaths);var u=null;for(i=0;i<n.length;i++){if(o=n[i],null!==u&&u.contains(o))throw new Error(t+"contains a path "+u.toString()+" that is ancestor of another path "+o.toString());u=o}},e.validateFirebaseMergeDataArg=function(t,n,o,s,u){if(!u||void 0!==o){var c=a.errorPrefix(t,n,u);if(!o||"object"!=typeof o||Array.isArray(o))throw new Error(c+" must be an object containing the children to replace.");var l=[];i.forEach(o,function(t,n){var i=new r.Path(t);if(e.validateFirebaseData(c,n,s.child(i)),".priority"===i.getBack()&&!e.isValidPriority(n))throw new Error(c+"contains an invalid value for '"+i.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");l.push(i)}),e.validateFirebaseMergePaths(c,l)}},e.validatePriority=function(t,n,r,i){if(!i||void 0!==r){if(o.isInvalidJSONNumber(r))throw new Error(a.errorPrefix(t,n,i)+"is "+r.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!e.isValidPriority(r))throw new Error(a.errorPrefix(t,n,i)+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},e.validateEventType=function(t,e,n,r){if(!r||void 0!==n)switch(n){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(a.errorPrefix(t,e,r)+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},e.validateKey=function(t,n,r,i){if(!(i&&void 0===r||e.isValidKey(r)))throw new Error(a.errorPrefix(t,n,i)+'was an invalid key = "'+r+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},e.validatePathString=function(t,n,r,i){if(!(i&&void 0===r||e.isValidPathString(r)))throw new Error(a.errorPrefix(t,n,i)+'was an invalid path = "'+r+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},e.validateRootPathString=function(t,n,r,i){r&&(r=r.replace(/^\/*\.info(\/|$)/,"/")),e.validatePathString(t,n,r,i)},e.validateWritablePath=function(t,e){if(".info"===e.getFront())throw new Error(t+" failed = Can't modify data under /.info/")},e.validateUrl=function(t,n,r){var i=r.path.toString();if("string"!=typeof r.repoInfo.host||0===r.repoInfo.host.length||!e.isValidKey(r.repoInfo.namespace)&&"localhost"!==r.repoInfo.host.split(":")[0]||0!==i.length&&!e.isValidRootPathString(i))throw new Error(a.errorPrefix(t,n,!1)+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},e.validateCredential=function(t,e,n,r){if((!r||void 0!==n)&&"string"!=typeof n)throw new Error(a.errorPrefix(t,e,r)+"must be a valid credential (a string).")},e.validateBoolean=function(t,e,n,r){if((!r||void 0!==n)&&"boolean"!=typeof n)throw new Error(a.errorPrefix(t,e,r)+"must be a boolean.")},e.validateString=function(t,e,n,r){if((!r||void 0!==n)&&"string"!=typeof n)throw new Error(a.errorPrefix(t,e,r)+"must be a valid string.")},e.validateObject=function(t,e,n,r){if(!(r&&void 0===n||n&&"object"==typeof n&&null!==n))throw new Error(a.errorPrefix(t,e,r)+"must be a valid object.")},e.validateObjectContainsKey=function(t,e,n,r,o,s){if(!n||"object"!=typeof n||!i.contains(n,r)){if(o)return;throw new Error(a.errorPrefix(t,e,o)+'must contain the key "'+r+'"')}if(s){var u=i.safeGet(n,r);if("number"===s&&"number"!=typeof u||"string"===s&&"string"!=typeof u||"boolean"===s&&"boolean"!=typeof u||"function"===s&&"function"!=typeof u||"object"===s&&"object"!=typeof u&&u)throw o?new Error(a.errorPrefix(t,e,o)+'contains invalid value for key "'+r+'" (must be of type "'+s+'")'):new Error(a.errorPrefix(t,e,o)+'must contain the key "'+r+'" with type "'+s+'"')}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1);!function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(e.OperationType||(e.OperationType={}));var i=function(){function t(t,e,n,i){this.fromUser=t,this.fromServer=e,this.queryId=n,this.tagged=i,r.assert(!i||e,"Tagged queries must be from server.")}return t.User=new t(!0,!1,null,!1),t.Server=new t(!1,!0,null,!1),t.forServerTaggedQuery=function(e){return new t(!1,!0,e,!0)},t}();e.OperationSource=i},function(t,e,n){"use strict";var r=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});var i=n(83),o=n(15),a=n(18),s=n(557),u=n(103),c=n(84),l=n(23);e.userActionConstants=l({USER_META_UPDATED:null,SEARCH_USER_PROFILE_RESPONSE:null,INVITATION_COUNT_UPDATED:null,COLLABORATION_INVITATIONS_INFO:null,BLOCK_COLLABORATION_INVITATION:null,USER_ADMIN_META_UPDATED:null}),e.setFreePremium=function(t,e,n){return function(i){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:s.UserAsyncFunction.setFreePremiumAsync(t,e,n);case 1:case"end":return r.stop()}},r,this)}))}},e.updateUserProfile=function(t){return function(e){var n={};n[""+("users/"+t.uid+"/profile/")]=t.toJSON(),o.database().ref("/").update(n).then(function(){e(i.startVersionCheck())}).catch(function(t){console.log(t)})}},e.subscribeUserProfile=function(t,e){return function(n){try{var r="users/"+e.uid+"/profile/";o.database().ref(r).on("value",function(e){if(console.log("### Firebase ==> UserProfileModel ###",e.val()),e.val()){n(a.TrackerActions.trackUserId(e.val().uid));var r={extensionVersion:chrome.runtime.getManifest().version,userAgent:window.navigator.userAgent,providerId:e.val().providerId,uid:e.val().uid||"Anonymous",displayName:e.val().displayName||"Anonymous",email:e.val().email||"Anonymous",photoURL:e.val().photoURL};chrome.runtime.setUninstallURL(t+"app/log-redirect;email="+r.email+";name="+r.displayName+";uid="+r.uid+";version="+r.extensionVersion),n(a.TrackerActions.trackBasicUserProfile(r))}})}catch(t){}}},e.unSubscribeUserProfile=function(t){return function(e){var n="users/"+t.uid+"/profile/";o.database().ref(n).off()}},e.subscribeUserMeta=function(t){return function(n){o.database().ref("users/"+t.uid+"/meta").on("value",function(t){t.val()&&n({type:e.userActionConstants.USER_META_UPDATED,userMeta:t.val()})})}},e.unSubscribeUserMeta=function(t){return function(e){var n="users/"+t.uid+"/meta";o.database().ref(n).off()}},e.sendInvitation=function(t,e,n,i,o,a){return function(u){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,s.UserAsyncFunction.sendCollaborationInvitationAsync(t,e,n,i,o,a);case 2:403===r.sent.status&&alert("Fail to invite");case 4:case"end":return r.stop()}},r,this)}))}},e.cancelInvitations=function(t,e,n,i){return function(o){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:o(a.TrackerActions.trackEvent(c.collaborationEventConstants.DELETE_INVITATIONS_SUBMITTED)),s.UserAsyncFunction.cancelCollaborationInvitationsAsync(t,e,n,i);case 2:case"end":return r.stop()}},r,this)}))}},e.removeCollaborators=function(t,e,n,i){return function(o){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:o(a.TrackerActions.trackEvent(c.collaborationEventConstants.REMOVE_USERS_SUBMITTED)),s.UserAsyncFunction.removeCollaboratorsAsync(t,e,n,i);case 2:case"end":return r.stop()}},r,this)}))}},e.subscribeUserNotifications=function(t,n){return function(r){try{var i="users/"+n.uid+"/properties/notifications/"+t+"/count";o.database().ref(i).on("value",function(t){var n=t.val()||0;u.weavaFirebaseLogger.notificationsLog(n),r({type:e.userActionConstants.INVITATION_COUNT_UPDATED,count:n})})}catch(t){}}},e.unSubscribeUserNotifications=function(t,e){return function(n){var r="users/"+e.uid+"/properties/notifications/"+t+"/count";o.database().ref(r).off()}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(15),i=n(73);e.workspaceActionsConstants=i({SIDEBAR_PINNED:null,BODY_CLICKED:null,AUTO_PDF_SETTING:null,SHOW_ALL_SIDEBAR:null,WORKSPACE_UPDATED:null,HIDE_PAYMENT_MODAL:null,UPDATE_LOCAL_WORKSPACE:null}),e.hidePaymentModal=function(){return{type:e.workspaceActionsConstants.HIDE_PAYMENT_MODAL}},e.pinSideBar=function(t){return{type:e.workspaceActionsConstants.SIDEBAR_PINNED,tabId:t}},e.clickBody=function(t){return{type:e.workspaceActionsConstants.BODY_CLICKED,tabId:t}},e.showAllSidebars=function(){return{type:e.workspaceActionsConstants.SHOW_ALL_SIDEBAR}},e.updateUserSetting=function(t,n){return{type:e.workspaceActionsConstants.UPDATE_LOCAL_WORKSPACE,highlightMode:t,autoPdf:n}},e.updateHighlightModeSetting=function(t,n){return function(i){if(t){var o="users/"+t.uid+"/usersWorkSpace/extensionHighlightModeSettings/highlighter";r.database().ref(o).set(n)}i({type:e.workspaceActionsConstants.WORKSPACE_UPDATED,workspace:{highlighter:n}})}},e.updateAutoPdfSetting=function(t,n){return function(i){if(t){var o="users/"+t.uid+"/usersWorkSpace/extensionHighlightModeSettings/pdf";r.database().ref(o).set(n)}i({type:e.workspaceActionsConstants.WORKSPACE_UPDATED,workspace:{pdf:n}})}},e.subscribeWorkspace=function(t){return function(n){var i="users/"+t.uid+"/usersWorkSpace/extensionHighlightModeSettings";r.database().ref(i).on("value",function(t){console.log("### Firebase ==> WorkSpaceModel ###",t.val()),t.val()&&n({type:e.workspaceActionsConstants.WORKSPACE_UPDATED,workspace:t.val()})})}},e.unSubscribeWorkspace=function(t){return function(e){var n="users/"+t.uid+"/usersWorkSpace/extensionHighlightModeSettings";r.database().ref(n).off()}}},function(t,e,n){var r=n(621),i=n(626);t.exports=function(t,e){var n=i(t,e);return r(n)?n:void 0}},function(t,e){t.exports=function(t){return null!=t&&"object"==typeof t}},function(t,e,n){var r=n(11).f,i=n(25),o=n(7)("toStringTag");t.exports=function(t,e,n){t&&!i(t=n?t:t.prototype,o)&&r(t,o,{configurable:!0,value:e})}},function(t,e,n){var r=n(0),i=n(36),o=n(5),a=n(130),s="["+a+"]",u=RegExp("^"+s+s+"*"),c=RegExp(s+s+"*$"),l=function(t,e,n){var i={},s=o(function(){return!!a[t]()||"​"!="​"[t]()}),u=i[t]=s?e(h):a[t];n&&(i[n]=u),r(r.P+r.F*s,"String",i)},h=l.trim=function(t,e){return t=String(i(t)),1&e&&(t=t.replace(u,"")),2&e&&(t=t.replace(c,"")),t};t.exports=l},function(t,e){t.exports={}},function(t,e,n){var r=n(6);t.exports=function(t,e){if(!r(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},function(t,e,n){"use strict";t.exports=function(t){var e,n={};if(t&&"object"==typeof t)for(e in t)t.hasOwnProperty(e)&&(n[e]=e);return n}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e,n,r,i){this.type=t,this.snapshotNode=e,this.childName=n,this.oldSnap=r,this.prevName=i}return t.valueChange=function(e){return new t(t.VALUE,e)},t.childAddedChange=function(e,n){return new t(t.CHILD_ADDED,n,e)},t.childRemovedChange=function(e,n){return new t(t.CHILD_REMOVED,n,e)},t.childChangedChange=function(e,n,r){return new t(t.CHILD_CHANGED,n,e,r)},t.childMovedChange=function(e,n){return new t(t.CHILD_MOVED,n,e)},t.CHILD_ADDED="child_added",t.CHILD_REMOVED="child_removed",t.CHILD_CHANGED="child_changed",t.CHILD_MOVED="child_moved",t.VALUE="value",t}();e.Change=r},function(t,e,n){var r=n(88),i=n(622),o=n(623),a="[object Null]",s="[object Undefined]",u=r?r.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?s:a:u&&u in Object(t)?i(t):o(t)}},function(t,e,n){var r=n(31);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,n){var r=n(31),i=n(7)("toStringTag"),o="Arguments"==r(function(){return arguments}());t.exports=function(t){var e,n,a;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),i))?n:o?r(e):"Object"==(a=r(e))&&"function"==typeof e.callee?"Arguments":a}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(73);e.chromeTabActionsConstants=r({ON_TAB_ACTIVATED:null,ON_CONTENT_SCRIPT_READY:null}),e.tabStatusOptions=r({INVITED:null,UNLOADED:null,RELOAD:null,CONNECTED:null}),e.onTabActivated=function(t){return{type:e.chromeTabActionsConstants.ON_TAB_ACTIVATED,tabs:t}},e.onContentScriptReady=function(t,n,r,i){return{type:e.chromeTabActionsConstants.ON_CONTENT_SCRIPT_READY,tabId:t,url:n,active:r,isIframe:i}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(497);!function(t){t.sendInitStoreMessage=function(t){return function(e){r.MessageAsyncFunction.sendMessage({id:ChromeBackgroundMessageIds.INIT_STORES},t)}},t.sendNestedCollectionLimitMessage=function(t){return function(e){r.MessageAsyncFunction.sendMessage({id:ChromeBackgroundMessageIds.NESTED_COLLECTION_LIMITED},t)}},t.sendShowNotificationMessage=function(t,e){return function(n){r.MessageAsyncFunction.sendMessage({id:ChromeBackgroundMessageIds.SHOW_NOTIFICATION,message:t},e)}},t.sendScrollToHighlightMessage=function(t,e,n){return function(i){r.MessageAsyncFunction.sendMessage({id:ChromeBackgroundMessageIds.SCROLL_TO_HIGHLIGHT,highlightId:t,pdfPageNumber:e},n)}},t.sendUnloadMessage=function(t){return function(e){r.MessageAsyncFunction.sendMessage({id:ChromeBackgroundMessageIds.UNLOAD},t)}},t.sendReloadMessage=function(t){return function(e){r.MessageAsyncFunction.sendMessage({id:ChromeBackgroundMessageIds.RELOAD},t)}},t.sendContextMenuCreateHighlightMessage=function(t,e){return function(n){r.MessageAsyncFunction.sendMessage({id:ChromeBackgroundMessageIds.CONTEXT_MENU_CREATE_HIGHLIGHT,colorNum:e},t)}},t.sendPromptLoginMessage=function(t){return function(e){r.MessageAsyncFunction.sendMessage({id:ChromeBackgroundMessageIds.PROMPT_LOGIN},t)}},t.sendCustomTokenExternalMessage=function(t,e){return function(n){r.MessageAsyncFunction.sendExternalMessage({id:"SIGN_IN",uid:t,customToken:e})}},t.sendSignoutExternalMessage=function(){return function(t){r.MessageAsyncFunction.sendExternalMessage({id:"SIGN_OUT"})}}}(e.ChromeMessageAction||(e.ChromeMessageAction={}))},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i,o=n(107),a=n(29),s=n(4),u=n(1),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),Object.defineProperty(e,"__EMPTY_NODE",{get:function(){return i},set:function(t){i=t},enumerable:!0,configurable:!0}),e.prototype.compare=function(t,e){return s.nameCompare(t.name,e.name)},e.prototype.isDefinedOn=function(t){throw u.assertionError("KeyIndex.isDefinedOn not expected to be called.")},e.prototype.indexedValueChanged=function(t,e){return!1},e.prototype.minPost=function(){return a.NamedNode.MIN},e.prototype.maxPost=function(){return new a.NamedNode(s.MAX_NAME,i)},e.prototype.makePost=function(t,e){return u.assert("string"==typeof t,"KeyIndex indexValue must always be a string."),new a.NamedNode(t,i)},e.prototype.toString=function(){return".key"},e}(o.Index);e.KeyIndex=c,e.KEY_INDEX=new c},function(t,e,n){"use strict";function r(t,e){if(void 0===e&&(e=null),null===t)return i.ChildrenNode.EMPTY_NODE;if("object"==typeof t&&".priority"in t&&(e=t[".priority"]),u.assert(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof t&&".value"in t&&null!==t[".value"]&&(t=t[".value"]),"object"!=typeof t||".sv"in t){var n=t;return new o.LeafNode(n,r(e))}if(t instanceof Array||!p){var d=i.ChildrenNode.EMPTY_NODE,v=t;return s.forEach(v,function(t,e){if(s.contains(v,t)&&"."!==t.substring(0,1)){var n=r(e);!n.isLeafNode()&&n.isEmpty()||(d=d.updateImmediateChild(t,n))}}),d.updatePriority(r(e))}var g=[],y=!1,m=t;if(s.forEach(m,function(t,e){if("string"!=typeof t||"."!==t.substring(0,1)){var n=r(m[t]);n.isEmpty()||(y=y||!n.getPriority().isEmpty(),g.push(new a.NamedNode(t,n)))}}),0==g.length)return i.ChildrenNode.EMPTY_NODE;var _=c.buildChildSet(g,l.NAME_ONLY_COMPARATOR,function(t){return t.name},l.NAME_COMPARATOR);if(y){var b=c.buildChildSet(g,f.PRIORITY_INDEX.getCompare());return new i.ChildrenNode(_,r(e),new h.IndexMap({".priority":b},{".priority":f.PRIORITY_INDEX}))}return new i.ChildrenNode(_,r(e),h.IndexMap.Default)}Object.defineProperty(e,"__esModule",{value:!0});var i=n(24),o=n(108),a=n(29),s=n(1),u=n(1),c=n(224),l=n(225),h=n(223),f=n(19),p=!0;e.nodeFromJSON=r,f.setNodeFromJSON(r)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(15),i=n(9),o=n(23),a=n(40);e.syncProcessActionsConstants=o({START_VERSION_CHECK:null,VERSION_CHECK_DONE:null,VERSION_CHECK_FAIL:null,MIGRATION_DONE:null,OFFLINE:null,RECONNECT:null,LATEST_VERSION_UPDATED:null}),e.syncProcessStatusOption=o({STOP:null,VERSION_CHECK:null,MIGRATING:null,START:null,ERROR:null,RETRY:null}),e.offline=function(){return{type:e.syncProcessActionsConstants.OFFLINE}},e.reconnect=function(){return{type:e.syncProcessActionsConstants.RECONNECT}},e.versionCheckDone=function(t){return{type:e.syncProcessActionsConstants.VERSION_CHECK_DONE,response:t}},e.versionCheckFail=function(t){return{type:e.syncProcessActionsConstants.VERSION_CHECK_FAIL,error:t}},e.migrationDone=function(){return{type:e.syncProcessActionsConstants.MIGRATION_DONE}},e.startVersionCheck=function(){return{type:e.syncProcessActionsConstants.START_VERSION_CHECK}},e.versionCheckRequest=function(t,n){return function(r){var i="token="+t+"&runningversion="+n,o=StaticConstants.SERVER_BASE_PATH+"apis/versioncheck?"+i;console.log(o),a(o).then(function(t){return t.json()}).then(function(t){return r(e.versionCheckDone(t))}).catch(function(t){return r(e.versionCheckFail("Fail to connect to the server"))})}},e.notificationRequest=function(t){return function(){var e="token="+t+"&environment="+StaticConstants.ENVIRONMENT,n=StaticConstants.SERVER_BASE_PATH+"apis/users/notifications/count?"+e;console.log(n),a(n).then(function(t){return t.json()}).catch(function(t){return console.error("Error in updating notification count:",t)})}},e.subscriptLatestVersion=function(){return function(t){r.database().ref("latestVersions").on("value",function(n){t({type:e.syncProcessActionsConstants.LATEST_VERSION_UPDATED,versions:i.fromJS(n.val())})})}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(23);e.folderEventConstants=r({BG_CREATE_FOLDER:null,BG_TRY_CREATE_NESTED_FOLDER:null,BG_CREATE_NESTED_FOLDER:null,BG_CREATE_NESTED_FOLDER_FAIL_UNPAID:null,CREATE_DEFAUTL_FOLDER:null,DELETE_FOLDER:null,EDIT_FOLDER:null,EDIT_FOLDER_ORDERS:null,DRAG_FOLDER:null,DROP_FOLDER:null,FOLDER_MOVE_FAIL_UNPAID:null,DROP_ROOT_FOLDER:null,FOLDER_MOVED:null,SWITCH_FOLDER:null}),e.colorEventConstants=r({TRY_ADD_COLOR:null,ADD_COLOR:null,ADD_COLOR_UNPAID:null,TRY_EDIT_COLOR:null,EDIT_COLOR:null,EDIT_COLOR_UNPAID:null,DELETE_COLOR:null}),e.searchEventConstants=r({SHOW_COLOR_FILTER:null,FILTER_BY_COLOR:null,SEARCH_IN_FOLDER:null,CLEAR_SEARCH:null}),e.referralEventConstants=r({VISIT_REFERRAL_PAGE:null,VERIFY_INVITER:null,SUCCESSFUL_VERIFY_INVITER:null,FAIL_VERIFY_INVITER:null,SUBMIT_INVITER:null,REFERRAL_VIA_SOCIAL_MEDIA:null,REFERRAL_COPY_LINK:null,REFERRAL_SIGNUP_DUE_TO_COLLABORATION:null}),e.onboardingEventConstants=r({INSTALL_EXTENSION_ON_BOARDING:null,SUBMIT_QUESTIONNAIRE:null,ANONYMOUS_BLOCK:null}),e.collaborationEventConstants={INVITE_USER:"[COLLABORATION] INVITE_USER",INVITE_USER_SUCCEED:"[COLLABORATION] INVITE_USER_SUCCEED",INVITE_USER_UNPAID:"[COLLABORATION] INVITE_USER_FAILED_UNPAID",REMOVE_USER_CLICKED:"[COLLABORATION] REMOVE_USER_CLICKED",REMOVE_USERS_SUBMITTED:"[COLLABORATION] REMOVE_USERS_SUBMITTED",DELETE_INVITATION_CLICKED:"[COLLABORATION] DELETE_INVITATION_CLICKED",DELETE_INVITATIONS_SUBMITTED:"[COLLABORATION] DELETE_INVITATIONS_SUBMITTED",ACCEPT_INVITATION:"[COLLABORATION] ACCEPT_INVITATION",ACCEPT_INVITATION_VIA_SHARE_LINK_UNPAID:"[COLLABORATION] ACCEPT_INVITATION_VIA_SHARE_LINK_UNPAID",ACCEPT_INVITATION_VIA_SHARE_LINK:"[COLLABORATION] ACCEPT_INVITATION_VIA_SHARE_LINK",DECLINE_INVITATION:"[COLLABORATION] DECLINE_INVITATION",COPY_SHARE_LINK:"[COLLABORATION] COPY_SHARE_LINK",SHOW_FOLDER_SHARING_PANEL:"[COLLABORATION] SHOW_FOLDER_SHARING_PANEL",HIDE_FOLDER_SHARING_PANEL:"[COLLABORATION] HIDE_FOLDER_SHARING_PANEL",SHOW_INVITATION_MODAL:"[COLLABORATION] SHOW_INVITATION_MODAL"},e.PDFStorageEventConstants={UPLOAD_PDFS_CLICKED_VIA_HEADER_BUTTON:"[PDF Storage] UPLOAD_PDFS_CLICKED_VIA_HEADER_BUTTON",UPLOAD_PDFS_CLICKED_VIA_WEBSITE_LIST_BUTTON:"[PDF Storage] UPLOAD_PDFS_CLICKED_VIA_WEBSITE_LIST_BUTTON",UPLOAD_PDFS_CLICKED_VIA_EMPTY_STATE:"[PDF Storage] UPLOAD_PDFS_CLICKED_VIA_EMPTY_STATE",SIGNED_UPLOAD_URL_FAILED:"[PDF Storage] SIGNED_UPLOAD_URL_FAILED",SIGNED_UPLOAD_URL_SUCCEED:"[PDF Storage] SIGNED_UPLOAD_URL_SUCCEED",UPLOAD_PDF_FAILED:"[PDF Storage] UPLOAD_PDF_FAILED",UPLOAD_PDF_SUCCEED:"[PDF Storage] UPLOAD_PDF_SUCCEED"},e.organizeResearchEventConstants=r({START_DRAG_HIGHLIGHTS:null,START_DRAG_HIGHLIGHT:null,START_DRAG_WEBSITE:null,START_DRAG_IMAGE:null,DROP_WEBSITE:null,DROP_HIGHLIGHT:null,DROP_HIGHLIGHTS:null,VISIT_HIGHLIGHTED_SITE:null}),e.webappUIEventConstants=r({HIDE_FOLDER_EDIT_PANEL:null,SHOW_DELETE_FOLDER_MODAL:null,CANCEL_DELETE_FOLDER:null,CONFIRM_DELETE_FOLDER:null}),e.premiumEventConstants=r({REDEEM_CODE:null,VISIT_PREMIUM_PAGE:null,GO_TO_PREMIUM_PAGE:null,VISIT_SUBSCRIPTION_PAGE:null,SUBSCRIBE_BUTTON_CLICKED:null,GO_TO_STUDENT_VERIFICATION_PAGE:null,VISIT_STUDENT_VERIFICATION_PAGE:null,SUBMIT_STUDENT_EMAIL:null,STUDENT_EMAIL_SENT:null}),e.generalEventConstants=r({INSTALL_EXTENSION:null,UNINSTALL_EXTENSION:null,VISIT_ONBOARDING_PAGE:null,VISIT_DASHBOARD:null,VISIT_SIGNUP_PAGE:null}),e.editorEventConstants={EDITOR_APP_CLICKED:"[Editor] EDITOR_APP_CLICKED",CLOSE_EDITOR:"[Editor] CLOSE_EDITOR"},e.browseEventConstants={BROWSE_CLICKED:"[Browse] BROWSE_CLICKED",EXPAND_WEBVIEW:"[Browse] EXPAND_WEBVIEW",CONTRACT_WEBVIEW:"[Browse] CONTRACT_WEBVIEW",CLOSE_WEBVIEW:"[Browse] CLOSE_WEBVIEW",BACK:"[Browse] BACK",FORWARD:"[Browse] FORWARD",RELOAD:"[Browse] RELOAD",LOCATION_CLICKED:"[Browse] LOCATION_CLICKED",LOCATION_SUBMIT:"[Browse] LOCATION_SUBMIT",WEBSITE_CLICKED:"[Browse] WEBSITE_CLICKED",HIGHLIGHT_CLICKED:"[Browse] HIGHLIGHT_CLICKED"}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(23);e.MetaConstants={SOURCE_CONSTANTS:r({MAIN_PANEL:null,NAV_BAR:null,MENU_PANEL:null,LOGIN_PAGE:null,SIGN_UP_PAGE:null,PAYMENT_MODAL:null,EXTENSION_ICON:null,SHORTCUT:null,EXTENSION_CONTEXT_MENU:null,EMPTY_STATE:null,APP_COLUMN:null,WEBVIEW_NAV_BAR:null,EXTENSION_BACKGROUND:null}),CREATE_WEBSITE_REASON:r({FIRST_HIGHLIGHT:null,MOVE_WEBSITE:null}),AUTH_PROVIDER_CONSTANTS:r({GOOGLE:null,FACEBOOK:null,ANONYMOUS:null,EMAIL:null}),FILE_FORMAT_CONSTANTS:r({TXT:null,PDF:null,MSWord:null,CSV:null,XLSX:null}),ANONYMOUS_BLOCK_REASON:r({CREATE_FOLDER:null,CREATE_NESTED_FOLDER:null,SHOW_FOLDER_SHARING_PANEL:null,UPLOAD_PDF:null,NUMBER_HIGHLIGHTS:null})}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(73);e.chromeIconActionConstants=r({ICON_CLICKED:null,UPDATE_ICON:null,REMOVE_ICON_STATUS:null}),e.onIconClicked=function(t){return{type:e.chromeIconActionConstants.ICON_CLICKED,activeTabs:t}},e.updateIcon=function(t,n,r){return{type:e.chromeIconActionConstants.UPDATE_ICON,tabId:t,banned:n,highlightMode:r}},e.removeIconStatus=function(t){return{type:e.chromeIconActionConstants.REMOVE_ICON_STATUS,tabId:t}}},function(t,e,n){"use strict";var r=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});var i=n(15),o=n(9),a=n(246),s=n(23);e.onboardingActionConstant=s({ONBOARDING_UPDATED:null}),e.closeExtensionNotificationModal=function(t,e){return function(n){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:a.closeExtensionNotificationModalAsync(t,e);case 1:case"end":return n.stop()}},n,this)}))}},e.updateExtensionGuideState=function(t,e){return function(n){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:a.updateExtensionGuideStateAsync(t,e);case 1:case"end":return n.stop()}},n,this)}))}},e.subscribeOnboarding=function(t){return function(n){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){var a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:a="users/"+t.uid+"/onboarding",i.database().ref(a).on("value",function(t){console.log("### Firebase ==> Onboarding Model ###",t.val()),!t.val()||t.val().extensionGuideState,n({type:e.onboardingActionConstant.ONBOARDING_UPDATED,onboarding:o.fromJS(t.val())})});case 2:case"end":return r.stop()}},r,this)}))}},e.unSubscribeOnboarding=function(t){return function(e){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n="users/"+t.uid+"/onboarding",i.database().ref(n).off();case 2:case"end":return e.stop()}},e,this)}))}};var u=null;e.writeInstallUserReport=function(t){return function(e){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function e(){var n,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=(new Date).toDateString(),r="installReports/"+n,e.next=4,i.database().ref(r).push(t);case 4:o=e.sent,u=o.key;case 6:case"end":return e.stop()}},e,this)}))}},e.moveUserReportToHighlighted=function(){return function(t){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function t(){var e,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=(new Date).toDateString(),u){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,i.database().ref("installReports/"+e+"/"+u).once("value");case 5:return t.next=7,t.sent.val();case 7:n=t.sent,i.database().ref("installReports/"+e+"/"+u).set(null),n&&i.database().ref("installReports/"+e+"-highlighted/"+u).set(n),u=null;case 11:case"end":return t.stop()}},t,this)}))}}},function(t,e,n){var r=n(45).Symbol;t.exports=r},function(t,e,n){var r=n(3),i=r["__core-js_shared__"]||(r["__core-js_shared__"]={});t.exports=function(t){return i[t]||(i[t]={})}},function(t,e,n){var r=n(26),i=n(12),o=n(55);t.exports=function(t){return function(e,n,a){var s,u=r(e),c=i(u.length),l=o(a,c);if(t&&n!=n){for(;c>l;)if((s=u[l++])!=s)return!0}else for(;c>l;l++)if((t||l in u)&&u[l]===n)return t||l||0;return!t&&-1}}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){var r=n(31);t.exports=Array.isArray||function(t){return"Array"==r(t)}},function(t,e,n){var r=n(6),i=n(31),o=n(7)("match");t.exports=function(t){var e;return r(t)&&(void 0!==(e=t[o])?!!e:"RegExp"==i(t))}},function(t,e,n){var r=n(7)("iterator"),i=!1;try{var o=[7][r]();o.return=function(){i=!0},Array.from(o,function(){throw 2})}catch(t){}t.exports=function(t,e){if(!e&&!i)return!1;var n=!1;try{var o=[7],a=o[r]();a.next=function(){return{done:n=!0}},o[r]=function(){return a},t(o)}catch(t){}return n}},function(t,e,n){"use strict";var r=n(2);t.exports=function(){var t=r(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},function(t,e,n){"use strict";var r=n(20),i=n(21),o=n(5),a=n(36),s=n(7);t.exports=function(t,e,n){var u=s(t),c=n(a,u,""[t]),l=c[0],h=c[1];o(function(){var e={};return e[u]=function(){return 7},7!=""[t](e)})&&(i(String.prototype,t,l),r(RegExp.prototype,u,2==e?function(t,e){return h.call(t,this,e)}:function(t){return h.call(t,this)}))}},function(t,e,n){var r=n(2),i=n(17),o=n(7)("species");t.exports=function(t,e){var n,a=r(t).constructor;return void 0===a||null==(n=r(a)[o])?e:i(n)}},function(t,e,n){"use strict";var r=n(3),i=n(0),o=n(21),a=n(61),s=n(47),u=n(60),c=n(59),l=n(6),h=n(5),f=n(94),p=n(69),d=n(131);t.exports=function(t,e,n,v,g,y){var m=r[t],_=m,b=g?"set":"add",E=_&&_.prototype,w={},S=function(t){var e=E[t];o(E,t,"delete"==t?function(t){return!(y&&!l(t))&&e.call(this,0===t?0:t)}:"has"==t?function(t){return!(y&&!l(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return y&&!l(t)?void 0:e.call(this,0===t?0:t)}:"add"==t?function(t){return e.call(this,0===t?0:t),this}:function(t,n){return e.call(this,0===t?0:t,n),this})};if("function"==typeof _&&(y||E.forEach&&!h(function(){(new _).entries().next()}))){var T=new _,I=T[b](y?{}:-0,1)!=T,A=h(function(){T.has(1)}),O=f(function(t){new _(t)}),C=!y&&h(function(){for(var t=new _,e=5;e--;)t[b](e,e);return!t.has(-0)});O||((_=e(function(e,n){c(e,_,t);var r=d(new m,e,_);return null!=n&&u(n,g,r[b],r),r})).prototype=E,E.constructor=_),(A||C)&&(S("delete"),S("has"),g&&S("get")),(C||I)&&S(b),y&&E.clear&&delete E.clear}else _=v.getConstructor(e,t,g,b),a(_.prototype,n),s.NEED=!0;return p(_,t),w[t]=_,i(i.G+i.W+i.F*(_!=m),w),y||v.setStrong(_,t,g),_}},function(t,e,n){for(var r,i=n(3),o=n(20),a=n(52),s=a("typed_array"),u=a("view"),c=!(!i.ArrayBuffer||!i.DataView),l=c,h=0,f="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");h<9;)(r=i[f[h++]])?(o(r.prototype,s,!0),o(r.prototype,u,!0)):l=!1;t.exports={ABV:c,CONSTR:l,TYPED:s,VIEW:u}},function(t,e,n){"use strict";t.exports=n(53)||!n(5)(function(){var t=Math.random();__defineSetter__.call(null,t,function(){}),delete n(3)[t]})},function(t,e,n){"use strict";var r=n(0);t.exports=function(t){r(r.S,t,{of:function(){for(var t=arguments.length,e=new Array(t);t--;)e[t]=arguments[t];return new this(e)}})}},function(t,e,n){"use strict";var r=n(0),i=n(17),o=n(30),a=n(60);t.exports=function(t){r(r.S,t,{from:function(t){var e,n,r,s,u=arguments[1];return i(this),(e=void 0!==u)&&i(u),null==t?new this:(n=[],e?(r=0,s=o(u,arguments[2],2),a(t,!1,function(t){n.push(s(t,r++))})):a(t,!1,n.push,n),new this(n))}})}},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n(49),o=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var t=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.configs={folder:{backgroundColor:"red",textColor:"white"},website:{backgroundColor:"blue",textColor:"white"},highlight:{backgroundColor:"green",textColor:"white"},meta:{backgroundColor:"yellow",textColor:"black"},size:{backgroundColor:"cyan",textColor:"black"}},t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i.Logger),r(e,[{key:"subscribeActiveFolderLog",value:function(t){this.logFirebaseIO("Folder",!0,this.configs.folder.backgroundColor,this.configs.folder.textColor,"Subscribe Folder",t)}},{key:"unSubscribeActiveFolderLog",value:function(t){this.logFirebaseIO("Folder",!0,this.configs.folder.backgroundColor,this.configs.folder.textColor,"unSubscribe Folder",t)}},{key:"subscribeFolderIdsLog",value:function(){this.logFirebaseIO("Folder",!0,this.configs.folder.backgroundColor,this.configs.folder.textColor,"Subscribe FolderIds","")}},{key:"unSubscribeFolderIdsLog",value:function(){this.logFirebaseIO("Folder",!0,this.configs.folder.backgroundColor,this.configs.folder.textColor,"Unsubscribe FolderIds","")}},{key:"moveFolderLog",value:function(t){this.logFirebaseIO("Folder",!1,this.configs.folder.backgroundColor,this.configs.folder.textColor,"Move Folder",t)}},{key:"createFolderLog",value:function(t){this.logFirebaseIO("Folder",!1,this.configs.folder.backgroundColor,this.configs.folder.textColor,"Create Folder",t)}},{key:"createDefaultFolderLog",value:function(t){this.logFirebaseIO("Folder",!1,this.configs.folder.backgroundColor,this.configs.folder.textColor,"Create Default Folder",t)}},{key:"switchFolderLog",value:function(t){this.logFirebaseIO("Folder",!1,this.configs.folder.backgroundColor,this.configs.folder.textColor,"Switch Folder",t)}},{key:"updateFolderOrderingLog",value:function(t){this.logFirebaseIO("Folder",!1,this.configs.folder.backgroundColor,this.configs.folder.textColor,"Update Folder Ordering",t)}},{key:"editFolderLog",value:function(t){this.logFirebaseIO("Folder",!1,this.configs.folder.backgroundColor,this.configs.folder.textColor,"Edit Folder",t)}},{key:"deleteFolderLog",value:function(t){this.logFirebaseIO("Folder",!1,this.configs.folder.backgroundColor,this.configs.folder.textColor,"Delete Folder",t)}},{key:"folderIdsUpdatedLog",value:function(t){this.logFirebaseIO("Folder",!0,this.configs.folder.backgroundColor,this.configs.folder.textColor,"FolderIds",t)}},{key:"activeFolderUpdatedLog",value:function(t){this.logFirebaseIO("Folder",!0,this.configs.folder.backgroundColor,this.configs.folder.textColor,"Active Folder",t)}},{key:"websiteUpdatedLog",value:function(t,e){this.logFirebaseIO("Website",!0,this.configs.website.backgroundColor,this.configs.website.textColor,"Website Meta "+t,e)}},{key:"subscribeActiveWebsiteLog",value:function(t){this.logFirebaseIO("Website",!0,this.configs.website.backgroundColor,this.configs.website.textColor,"Subscribe Active Website",t)}},{key:"subscribeListWebsiteLog",value:function(t){this.logFirebaseIO("Website",!0,this.configs.website.backgroundColor,this.configs.website.textColor,"Subscribe List Website",t)}},{key:"unSubscribeWebsiteLog",value:function(t){this.logFirebaseIO("Website",!0,this.configs.website.backgroundColor,this.configs.website.textColor,"Unsubscribe Website",t)}},{key:"unSubscribeAllWebsitesLog",value:function(){this.logFirebaseIO("Website",!0,this.configs.website.backgroundColor,this.configs.website.textColor,"Trying to unsubscribe All Websites","")}},{key:"moveWebsiteLog",value:function(t){this.logFirebaseIO("Website",!1,this.configs.website.backgroundColor,this.configs.website.textColor,"Move Website",t)}},{key:"createWebsiteLog",value:function(t){this.logFirebaseIO("Website",!1,this.configs.website.backgroundColor,this.configs.website.textColor,"Create Website",t)}},{key:"deleteWebsiteLog",value:function(t){this.logFirebaseIO("Website",!1,this.configs.website.backgroundColor,this.configs.website.textColor,"Delete Website",t)}},{key:"highlightAddedLog",value:function(t,e){this.logFirebaseIO("Highlight",!0,this.configs.highlight.backgroundColor,this.configs.highlight.textColor,"Highlight Added "+t,e)}},{key:"highlightUpdatedLog",value:function(t,e){this.logFirebaseIO("Highlight",!0,this.configs.highlight.backgroundColor,this.configs.highlight.textColor,"Highlight Updated "+t,e)}},{key:"highlightDeletedLog",value:function(t,e){this.logFirebaseIO("Highlight",!0,this.configs.highlight.backgroundColor,this.configs.highlight.textColor,"Highlight Deleted "+t,e)}},{key:"notificationsLog",value:function(t){this.logFirebaseIO("Notifications",!0,this.configs.meta.backgroundColor,this.configs.meta.textColor,"",t)}},{key:"logSize",value:function(t){this.logFirebaseIO("SIZE",!0,this.configs.size.backgroundColor,this.configs.size.textColor,"",t)}}]),e}();e.weavaFirebaseLogger=new o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(23);e.firebaseDatabaseActionConstants=r({ON_ACTIVE_URLS:null}),e.onActiveURLs=function(t){return{type:e.firebaseDatabaseActionConstants.ON_ACTIVE_URLS,urls:t}},e.syncActiveUrls=function(t,n){return function(r){chrome.tabs.query({},function(i){var o=[];i.forEach(function(e){o.push(e.url||""),t[e.id]&&(o=o.concat(t[e.id]))}),n.forEach(function(t){t&&o.push(t)}),r(e.onActiveURLs(o))})}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(521),i=n(522),o=function(t){try{if("undefined"!=typeof window&&void 0!==window[t]){var e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new r.DOMStorageWrapper(e)}}catch(t){}return new i.MemoryStorage};e.PersistentStorage=o("localStorage"),e.SessionStorage=o("sessionStorage")},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PROTOCOL_VERSION="5",e.VERSION_PARAM="v",e.TRANSPORT_SESSION_PARAM="s",e.REFERER_PARAM="r",e.FORGE_REF="f",e.FORGE_DOMAIN="firebaseio.com",e.LAST_SESSION_PARAM="ls",e.WEBSOCKET="websocket",e.LONG_POLLING="long_polling"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(29),i=n(4),o=function(){function t(){}return t.prototype.getCompare=function(){return this.compare.bind(this)},t.prototype.indexedValueChanged=function(t,e){var n=new r.NamedNode(i.MIN_NAME,t),o=new r.NamedNode(i.MIN_NAME,e);return 0!==this.compare(n,o)},t.prototype.minPost=function(){return r.NamedNode.MIN},t}();e.Index=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(1),o=n(4),a=n(221),s=function(){function t(e,n){void 0===n&&(n=t.__childrenNodeConstructor.EMPTY_NODE),this.value_=e,this.priorityNode_=n,this.lazyHash_=null,i.assert(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),a.validatePriorityNode(this.priorityNode_)}return Object.defineProperty(t,"__childrenNodeConstructor",{get:function(){return r},set:function(t){r=t},enumerable:!0,configurable:!0}),t.prototype.isLeafNode=function(){return!0},t.prototype.getPriority=function(){return this.priorityNode_},t.prototype.updatePriority=function(e){return new t(this.value_,e)},t.prototype.getImmediateChild=function(e){return".priority"===e?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.getChild=function(e){return e.isEmpty()?this:".priority"===e.getFront()?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.hasChild=function(){return!1},t.prototype.getPredecessorChildName=function(t,e){return null},t.prototype.updateImmediateChild=function(e,n){return".priority"===e?this.updatePriority(n):n.isEmpty()&&".priority"!==e?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)},t.prototype.updateChild=function(e,n){var r=e.getFront();return null===r?n:n.isEmpty()&&".priority"!==r?this:(i.assert(".priority"!==r||1===e.getLength(),".priority must be the last token in a path"),this.updateImmediateChild(r,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(e.popFront(),n)))},t.prototype.isEmpty=function(){return!1},t.prototype.numChildren=function(){return 0},t.prototype.forEachChild=function(t,e){return!1},t.prototype.val=function(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.priorityNode_.isEmpty()||(t+="priority:"+a.priorityHashText(this.priorityNode_.val())+":");var e=typeof this.value_;t+=e+":",t+="number"===e?o.doubleToIEEE754String(this.value_):this.value_,this.lazyHash_=o.sha1(t)}return this.lazyHash_},t.prototype.getValue=function(){return this.value_},t.prototype.compareTo=function(e){return e===t.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof t.__childrenNodeConstructor?-1:(i.assert(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))},t.prototype.compareToLeafNode_=function(e){var n=typeof e.value_,r=typeof this.value_,o=t.VALUE_TYPE_ORDER.indexOf(n),a=t.VALUE_TYPE_ORDER.indexOf(r);return i.assert(o>=0,"Unknown leaf type: "+n),i.assert(a>=0,"Unknown leaf type: "+r),o===a?"object"===r?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:a-o},t.prototype.withIndex=function(){return this},t.prototype.isIndexed=function(){return!0},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode()){var e=t;return this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_)}return!1},t.VALUE_TYPE_ORDER=["object","boolean","number","string"],t}();e.LeafNode=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e,n,r,i){void 0===i&&(i=null),this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];for(var o=1;!t.isEmpty();)if(t=t,o=e?n(t.key,e):1,r&&(o*=-1),o<0)t=this.isReverse_?t.left:t.right;else{if(0===o){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}return t.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t},t.prototype.hasNext=function(){return this.nodeStack_.length>0},t.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}},t}();e.SortedMapIterator=r;var i=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:a.EMPTY_NODE,this.right=null!=o?o:a.EMPTY_NODE}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.count=function(){return this.left.count()+1+this.right.count()},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},t.prototype.minKey=function(){return this.min_().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r,i;return(i=(r=n(t,(i=this).key))<0?i.copy(null,null,null,i.left.insert(t,e,n),null):0===r?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n))).fixUp_()},t.prototype.removeMin_=function(){if(this.left.isEmpty())return a.EMPTY_NODE;var t=this;return t.left.isRed_()||t.left.left.isRed_()||(t=t.moveRedLeft_()),(t=t.copy(null,null,null,t.left.removeMin_(),null)).fixUp_()},t.prototype.remove=function(t,e){var n,r;if(e(t,(n=this).key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(t,e),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===e(t,n.key)){if(n.right.isEmpty())return a.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(t,e))}return n.fixUp_()},t.prototype.isRed_=function(){return this.color},t.prototype.fixUp_=function(){var t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t},t.prototype.moveRedLeft_=function(){var t=this.colorFlip_();return t.right.left.isRed_()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight_())).rotateLeft_()).colorFlip_()),t},t.prototype.moveRedRight_=function(){var t=this.colorFlip_();return t.left.left.isRed_()&&(t=(t=t.rotateRight_()).colorFlip_()),t},t.prototype.rotateLeft_=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight_=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip_=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth_=function(){var t=this.check_();return Math.pow(2,t)<=this.count()+1},t.prototype.check_=function(){var t;if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");if((t=this.left.check_())!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)},t.RED=!0,t.BLACK=!1,t}();e.LLRBNode=i;var o=function(){function t(){}return t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new i(t,e,null)},t.prototype.remove=function(t,e){return this},t.prototype.count=function(){return 0},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.check_=function(){return 0},t.prototype.isRed_=function(){return!1},t}();e.LLRBEmptyNode=o;var a=function(){function t(e,n){void 0===n&&(n=t.EMPTY_NODE),this.comparator_=e,this.root_=n}return t.prototype.insert=function(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,i.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,i.BLACK,null,null))},t.prototype.get=function(t){for(var e,n=this.root_;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key)))return n.value;e<0?n=n.left:e>0&&(n=n.right)}return null},t.prototype.getPredecessorKey=function(t){for(var e,n=this.root_,r=null;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}e<0?n=n.left:e>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},t.prototype.isEmpty=function(){return this.root_.isEmpty()},t.prototype.count=function(){return this.root_.count()},t.prototype.minKey=function(){return this.root_.minKey()},t.prototype.maxKey=function(){return this.root_.maxKey()},t.prototype.inorderTraversal=function(t){return this.root_.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.root_.reverseTraversal(t)},t.prototype.getIterator=function(t){return new r(this.root_,null,this.comparator_,!1,t)},t.prototype.getIteratorFrom=function(t,e){return new r(this.root_,t,this.comparator_,!1,e)},t.prototype.getReverseIteratorFrom=function(t,e){return new r(this.root_,t,this.comparator_,!0,e)},t.prototype.getReverseIterator=function(t){return new r(this.root_,null,this.comparator_,!0,t)},t.EMPTY_NODE=new o,t}();e.SortedMap=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(227),i=n(82),o=n(13),a=n(228),s=n(527),u=n(538),c=n(1),l=n(4),h=n(1),f=n(539),p=n(159),d=n(541),v=n(233),g=n(542),y=n(234),m=n(547),_=n(216),b=function(){function t(t,e,n){var r=this;this.repoInfo_=t,this.app=n,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new g.EventQueue,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=new a.SparseSnapshotTree,this.persistentConnection_=null;var i=new f.AuthTokenProvider(n);if(this.stats_=p.StatsManager.getCollection(t),e||l.beingCrawled())this.server_=new m.ReadonlyRestClient(this.repoInfo_,this.onDataUpdate_.bind(this),i),setTimeout(this.onConnectStatus_.bind(this,!0),0);else{var o=n.options.databaseAuthVariableOverride;if(null!=o){if("object"!=typeof o)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{c.stringify(o)}catch(t){throw new Error("Invalid authOverride provided: "+t)}}this.persistentConnection_=new y.PersistentConnection(this.repoInfo_,this.onDataUpdate_.bind(this),this.onConnectStatus_.bind(this),this.onServerInfoUpdate_.bind(this),i,o),this.server_=this.persistentConnection_}i.addTokenChangeListener(function(t){r.server_.refreshAuthToken(t)}),this.statsReporter_=p.StatsManager.getOrCreateReporter(t,function(){return new d.StatsReporter(r.stats_,r.server_)}),this.transactions_init_(),this.infoData_=new u.SnapshotHolder,this.infoSyncTree_=new s.SyncTree({startListening:function(t,e,n,i){var o=[],a=r.infoData_.getNode(t.path);return a.isEmpty()||(o=r.infoSyncTree_.applyServerOverwrite(t.path,a),setTimeout(function(){i("ok")},0)),o},stopListening:function(){}}),this.updateInfo_("connected",!1),this.serverSyncTree_=new s.SyncTree({startListening:function(t,e,n,i){return r.server_.listen(t,n,e,function(e,n){var o=i(e,n);r.eventQueue_.raiseEventsForChangedPath(t.path,o)}),[]},stopListening:function(t,e){r.server_.unlisten(t,e)}})}return t.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},t.prototype.name=function(){return this.repoInfo_.namespace},t.prototype.serverTime=function(){var t=this.infoData_.getNode(new o.Path(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t},t.prototype.generateServerValues=function(){return r.generateWithValues({timestamp:this.serverTime()})},t.prototype.onDataUpdate_=function(t,e,n,r){this.dataUpdateCount++;var a=new o.Path(t);e=this.interceptServerDataCallback_?this.interceptServerDataCallback_(t,e):e;var s=[];if(r)if(n){var u=h.map(e,function(t){return i.nodeFromJSON(t)});s=this.serverSyncTree_.applyTaggedQueryMerge(a,u,r)}else{var c=i.nodeFromJSON(e);s=this.serverSyncTree_.applyTaggedQueryOverwrite(a,c,r)}else if(n){var l=h.map(e,function(t){return i.nodeFromJSON(t)});s=this.serverSyncTree_.applyServerMerge(a,l)}else{var f=i.nodeFromJSON(e);s=this.serverSyncTree_.applyServerOverwrite(a,f)}var p=a;s.length>0&&(p=this.rerunTransactions_(a)),this.eventQueue_.raiseEventsForChangedPath(p,s)},t.prototype.interceptServerData_=function(t){this.interceptServerDataCallback_=t},t.prototype.onConnectStatus_=function(t){this.updateInfo_("connected",t),!1===t&&this.runOnDisconnectEvents_()},t.prototype.onServerInfoUpdate_=function(t){var e=this;l.each(t,function(t,n){e.updateInfo_(n,t)})},t.prototype.updateInfo_=function(t,e){var n=new o.Path("/.info/"+t),r=i.nodeFromJSON(e);this.infoData_.updateSnapshot(n,r);var a=this.infoSyncTree_.applyServerOverwrite(n,r);this.eventQueue_.raiseEventsForChangedPath(n,a)},t.prototype.getNextWriteId_=function(){return this.nextWriteId_++},t.prototype.setWithPriority=function(t,e,n,o){var a=this;this.log_("set",{path:t.toString(),value:e,priority:n});var s=this.generateServerValues(),u=i.nodeFromJSON(e,n),c=r.resolveDeferredValueSnapshot(u,s),h=this.getNextWriteId_(),f=this.serverSyncTree_.applyUserOverwrite(t,c,h,!0);this.eventQueue_.queueEvents(f),this.server_.put(t.toString(),u.val(!0),function(e,n){var r="ok"===e;r||l.warn("set at "+t+" failed: "+e);var i=a.serverSyncTree_.ackUserWrite(h,!r);a.eventQueue_.raiseEventsForChangedPath(t,i),a.callOnCompleteCallback(o,e,n)});var p=this.abortTransactions_(t);this.rerunTransactions_(p),this.eventQueue_.raiseEventsForChangedPath(p,[])},t.prototype.update=function(t,e,n){var o=this;this.log_("update",{path:t.toString(),value:e});var a=!0,s=this.generateServerValues(),u={};if(h.forEach(e,function(t,e){a=!1;var n=i.nodeFromJSON(e);u[t]=r.resolveDeferredValueSnapshot(n,s)}),a)l.log("update() called with empty data.  Don't do anything."),this.callOnCompleteCallback(n,"ok");else{var c=this.getNextWriteId_(),f=this.serverSyncTree_.applyUserMerge(t,u,c);this.eventQueue_.queueEvents(f),this.server_.merge(t.toString(),e,function(e,r){var i="ok"===e;i||l.warn("update at "+t+" failed: "+e);var a=o.serverSyncTree_.ackUserWrite(c,!i),s=a.length>0?o.rerunTransactions_(t):t;o.eventQueue_.raiseEventsForChangedPath(s,a),o.callOnCompleteCallback(n,e,r)}),h.forEach(e,function(e){var n=o.abortTransactions_(t.child(e));o.rerunTransactions_(n)}),this.eventQueue_.raiseEventsForChangedPath(t,[])}},t.prototype.runOnDisconnectEvents_=function(){var t=this;this.log_("onDisconnectEvents");var e=this.generateServerValues(),n=r.resolveDeferredValueTree(this.onDisconnect_,e),i=[];n.forEachTree(o.Path.Empty,function(e,n){i=i.concat(t.serverSyncTree_.applyServerOverwrite(e,n));var r=t.abortTransactions_(e);t.rerunTransactions_(r)}),this.onDisconnect_=new a.SparseSnapshotTree,this.eventQueue_.raiseEventsForChangedPath(o.Path.Empty,i)},t.prototype.onDisconnectCancel=function(t,e){var n=this;this.server_.onDisconnectCancel(t.toString(),function(r,i){"ok"===r&&n.onDisconnect_.forget(t),n.callOnCompleteCallback(e,r,i)})},t.prototype.onDisconnectSet=function(t,e,n){var r=this,o=i.nodeFromJSON(e);this.server_.onDisconnectPut(t.toString(),o.val(!0),function(e,i){"ok"===e&&r.onDisconnect_.remember(t,o),r.callOnCompleteCallback(n,e,i)})},t.prototype.onDisconnectSetWithPriority=function(t,e,n,r){var o=this,a=i.nodeFromJSON(e,n);this.server_.onDisconnectPut(t.toString(),a.val(!0),function(e,n){"ok"===e&&o.onDisconnect_.remember(t,a),o.callOnCompleteCallback(r,e,n)})},t.prototype.onDisconnectUpdate=function(t,e,n){var r=this;if(h.isEmpty(e))return l.log("onDisconnect().update() called with empty data.  Don't do anything."),void this.callOnCompleteCallback(n,"ok");this.server_.onDisconnectMerge(t.toString(),e,function(o,a){"ok"===o&&h.forEach(e,function(e,n){var o=i.nodeFromJSON(n);r.onDisconnect_.remember(t.child(e),o)}),r.callOnCompleteCallback(n,o,a)})},t.prototype.addEventCallbackForQuery=function(t,e){var n;n=".info"===t.path.getFront()?this.infoSyncTree_.addEventRegistration(t,e):this.serverSyncTree_.addEventRegistration(t,e),this.eventQueue_.raiseEventsAtPath(t.path,n)},t.prototype.removeEventCallbackForQuery=function(t,e){var n;n=".info"===t.path.getFront()?this.infoSyncTree_.removeEventRegistration(t,e):this.serverSyncTree_.removeEventRegistration(t,e),this.eventQueue_.raiseEventsAtPath(t.path,n)},t.prototype.interrupt=function(){this.persistentConnection_&&this.persistentConnection_.interrupt("repo_interrupt")},t.prototype.resume=function(){this.persistentConnection_&&this.persistentConnection_.resume("repo_interrupt")},t.prototype.stats=function(t){if(void 0===t&&(t=!1),"undefined"!=typeof console){var e;t?(this.statsListener_||(this.statsListener_=new v.StatsListener(this.stats_)),e=this.statsListener_.get()):e=this.stats_.get();var n=Object.keys(e).reduce(function(t,e){return Math.max(e.length,t)},0);h.forEach(e,function(t,e){for(var r=t.length;r<n+2;r++)t+=" ";console.log(t+e)})}},t.prototype.statsIncrementCounter=function(t){this.stats_.incrementCounter(t),this.statsReporter_.includeStat(t)},t.prototype.log_=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="";this.persistentConnection_&&(n=this.persistentConnection_.id+":"),l.log.apply(void 0,[n].concat(t))},t.prototype.callOnCompleteCallback=function(t,e,n){t&&l.exceptionGuard(function(){if("ok"==e)t(null);else{var r=(e||"error").toUpperCase(),i=r;n&&(i+=": "+n);var o=new Error(i);o.code=r,t(o)}})},Object.defineProperty(t.prototype,"database",{get:function(){return this.__database||(this.__database=new _.Database(this))},enumerable:!0,configurable:!0}),t}();e.Repo=b},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e,n){this.node_=t,this.fullyInitialized_=e,this.filtered_=n}return t.prototype.isFullyInitialized=function(){return this.fullyInitialized_},t.prototype.isFiltered=function(){return this.filtered_},t.prototype.isCompleteForPath=function(t){if(t.isEmpty())return this.isFullyInitialized()&&!this.filtered_;var e=t.getFront();return this.isCompleteForChild(e)},t.prototype.isCompleteForChild=function(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)},t.prototype.getNode=function(){return this.node_},t}();e.CacheNode=r},function(t,e,n){"use strict";var r=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});var i=n(50),o=n(49),a=n(15);e.TrackerAsyncFunction={trackUserId:function(t){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:amplitude.getInstance().setUserId(t),ga("set","userId",t),mixpanel.alias(t);case 3:case"end":return e.stop()}},e,this)}))},trackEvent:function(t,e,n){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:(e=e||{}).app=n,amplitude.getInstance().logEvent(t,e),ga("send","event",n,t),mixpanel.track(t,e),"undefined"!=typeof fbq&&fbq("track",t,e);case 6:case"end":return r.stop()}},r,this)}))},trackUsageStat:function(t,e){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function n(){var r,s,u,c,l;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=a.auth().currentUser)){n.next=15;break}return o.weavaLogger.log("Statistic","grey","white",t,e),n.next=5,a.database().ref("/users/"+r.uid+"/meta/"+t).once("value");case 5:return s=n.sent,u=s.val()?s.val()+e:e,(c={})["users/"+r.uid+"/meta/highlightCount"]=u,c["users/"+r.uid+"/meta/lastSeen"]=a.database.ServerValue.TIMESTAMP,(l={})[t]=u,amplitude.getInstance().setUserProperties(l),c=i.objectUndefinedToNull(c),n.abrupt("return",a.database().ref("/").update(c));case 15:case"end":return n.stop()}},n,this)}))}}},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,n){"use strict";var r=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});var i=n(9),o=n(558),a=n(161),s=n(18),u=n(84),c=n(50),l=n(567),h=n(568),f=n(246),p=n(23);n(44),e.folderActionConstants=p({SWITCH_FOLDER:null,SEARCH_IN_FOLDER_RESULT:null,RESET_SEARCH_STATE:null,FOLDER_UPDATED:null,FOLDER_COLLABORATION_INFO:null,ACCEPT_FOLDER_COLLABORATION:null,DECLINE_FOLDER_COLLABORATION:null,ADD_INVITED:null,REMOVE_INVITED:null,REMOVE_COLLABORATOR:null,RESET_SHARING_FOLDER_USER_META:null,RESET_ACTIVE_FOLDER_USER_META:null}),e.folderConstants={destinationOpts:p({SHARING_FOLDER:null,ACTIVE_FOLDER:null})},e.queryFolderCollaborationInfo=function(t,n,i,a){return function(s){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){var u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,o.queryFolderCollaborationInfoAsync(t,n,i);case 2:u=r.sent,s({type:e.folderActionConstants.FOLDER_COLLABORATION_INFO,info:u,destination:a});case 4:case"end":return r.stop()}},r,this)}))}},e.editFolderOrders=function(t,e,n){return function(i){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:o.editFolderOrdersAsync(t,e,n);case 1:case"end":return r.stop()}},r,this)}))}},e.editFolder=function(t,e,n,i,a,c){return function(l){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:l(s.TrackerActions.trackEvent(u.folderEventConstants.EDIT_FOLDER)),o.editFolderAsync(t,e,n,i,a,c);case 2:case"end":return r.stop()}},r,this)}))}},e.switchFolder=function(t,n,i){return function(a){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:a({type:e.folderActionConstants.SWITCH_FOLDER,folderId:i}),o.switchFolderAsync(t,n,i);case 2:case"end":return r.stop()}},r,this)}))}},e.deleteFolder=function(t,e,n){return function(i){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:i(s.TrackerActions.trackEvent(u.folderEventConstants.DELETE_FOLDER)),o.deleteFolderAsync(t,e,n);case 2:case"end":return r.stop()}},r,this)}))}},e.createDefaultFolder=function(t,e,n,i){return function(a){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){var c;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return f.updateExtensionGuideStateAsync(n,1),a(s.TrackerActions.trackEvent(u.folderEventConstants.CREATE_DEFAUTL_FOLDER)),r.next=4,o.createDefaultFolderAsync(t,e);case 4:return c=r.sent,r.next=7,o.switchFolderAsync(n,i,c);case 7:return r.next=9,o.createSampleFolderAsync(t,e,n);case 9:case"end":return r.stop()}},r,this)}))}},e.createFolder=function(t,e,n,i){return function(a){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:a(i?s.TrackerActions.trackEvent(u.folderEventConstants.BG_CREATE_NESTED_FOLDER):s.TrackerActions.trackEvent(u.folderEventConstants.BG_CREATE_FOLDER)),o.createFolderAsync(t,e,n,i);case 2:case"end":return r.stop()}},r,this)}))}},e.searchInFolderResult=function(t){return{type:e.folderActionConstants.SEARCH_IN_FOLDER_RESULT,result:t}},e.resetSearchState=function(){return a.unsubscribeAllWebsitesAndHighlights(),{type:e.folderActionConstants.RESET_SEARCH_STATE}},e.searchInFolderRequest=function(t,n,s,u,c){return function(l){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){var h;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,o.searchInFolderAsync(t,n,s,u,c);case 2:h=r.sent,a.unsubscribeAllWebsitesAndHighlights(),l(e.searchInFolderResult(i.fromJS(h)));case 5:case"end":return r.stop()}},r,this)}))}},e.folderUpdated=function(t,n,r){return{type:e.folderActionConstants.FOLDER_UPDATED,uid:t,folderIds:n,activeFolderPayload:r}},e.subscribeFolderIds=function(t,n,a){var s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return function(u){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:o.subscribeFolderIdsAsync(a,function(r){var c="";r&&(r.activeFolderPath&&(c=r.activeFolderPath.replace(/folderIds/g,"folderMetaMap")||""),delete r.activeFolderPath,delete r.rootFolderOrdering),o.updateRootFolderOrderingAsync(a,null);var f=i.List(c.split("/")),p=l.folderMetaTreeJsonToRecord(r,f.last()||null);if(p.getIn(f)){var d=f.last(null);d&&o.subscribeActiveFolderAsync(a,d,function(t){var n=t;delete n.websites;var r=i.fromJS({});r=r.set(d,h.folderBodyJsonToRecord(n)),u(e.folderUpdated(a.uid,p,r))})}else if(0!==p.size){var v=p.keySeq().first(null);v&&u(e.switchFolder(a,p,v))}else 0===p.size&&s&&(console.log("create default folder"),u(e.createDefaultFolder(t,n,a,p)))});case 1:case"end":return r.stop()}},r,this)}))}},e.unSubscribeFolderIds=function(t){return function(e){o.unSubscribeFolderIdsAsync(t),o.unSubscribeActiveFolderAsync(),a.unsubscribeAllWebsitesAndHighlights()}},e.acceptCollaborationInvitation=function(t,n,i,a){return function(c){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:c(s.TrackerActions.trackEvent(u.collaborationEventConstants.ACCEPT_INVITATION)),c({type:e.folderActionConstants.ACCEPT_FOLDER_COLLABORATION,folderId:i,invitationIndex:a}),o.acceptFolderInvitationAsync(t,n,i);case 3:case"end":return r.stop()}},r,this)}))}},e.declineCollaborationInvitation=function(t,n,i,a){return function(c){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:c(s.TrackerActions.trackEvent(u.collaborationEventConstants.DECLINE_INVITATION)),c({type:e.folderActionConstants.DECLINE_FOLDER_COLLABORATION,folderId:i,invitationIndex:a}),o.declineFolderInvitationAsync(t,n,i);case 3:case"end":return r.stop()}},r,this)}))}},e.addInvited=function(t){return{type:e.folderActionConstants.ADD_INVITED,email:t}},e.removeInvited=function(t){return{type:e.folderActionConstants.REMOVE_INVITED,invitedEmails:t}},e.removeCollaborator=function(t){return{type:e.folderActionConstants.REMOVE_COLLABORATOR,uids:t}},e.resetSharingFolderUserMeta=function(){return{type:e.folderActionConstants.RESET_SHARING_FOLDER_USER_META}},e.resetActiveFolderUserMeta=function(){return{type:e.folderActionConstants.RESET_ACTIVE_FOLDER_USER_META}},e.requestFolderId=function(t,n,i,a,l){return function(h){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!c.getPathFromFolderTree(a,l)){r.next=5;break}h(e.switchFolder(i,a,l)),r.next=9;break;case 5:return r.next=7,o.requestFolderIdAsync(t,n,i,l);case 7:200!==r.sent.status?(h(s.TrackerActions.trackEvent(u.collaborationEventConstants.ACCEPT_INVITATION_VIA_SHARE_LINK_UNPAID)),alert("You cannot access the requested folder.")):h(s.TrackerActions.trackEvent(u.collaborationEventConstants.ACCEPT_INVITATION_VIA_SHARE_LINK));case 9:case"end":return r.stop()}},r,this)}))}},e.moveFolder=function(t,e,n,i,a){return function(c){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:c(s.TrackerActions.trackEvent(u.folderEventConstants.FOLDER_MOVED)),o.moveFolderAsync(t,e,n,i,a);case 2:case"end":return r.stop()}},r,this)}))}}},function(t,e,n){function r(t){if(t)return function(t){for(var e in r.prototype)t[e]=r.prototype[e];return t}(t)}t.exports=r,r.prototype.on=r.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},r.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks["$"+t];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var r,i=0;i<n.length;i++)if((r=n[i])===e||r.fn===e){n.splice(i,1);break}return this},r.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),n=this._callbacks["$"+t];if(n)for(var r=0,i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,e);return this},r.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},r.prototype.hasListeners=function(t){return!!this.listeners(t).length}},function(t,e,n){function r(t,e){this.name="AuthTokenExpiredError",this.message=t,this.expiry=e,Error.captureStackTrace&&!w?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function i(t){this.name="AuthTokenInvalidError",this.message=t,Error.captureStackTrace&&!w?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function o(t,e){this.name="AuthTokenNotBeforeError",this.message=t,this.date=e,Error.captureStackTrace&&!w?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function a(t){this.name="AuthTokenError",this.message=t,Error.captureStackTrace&&!w?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function s(t,e){this.name="SilentMiddlewareBlockedError",this.message=t,this.type=e,Error.captureStackTrace&&!w?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function u(t){this.name="InvalidActionError",this.message=t,Error.captureStackTrace&&!w?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function c(t){this.name="InvalidArgumentsError",this.message=t,Error.captureStackTrace&&!w?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function l(t){this.name="InvalidOptionsError",this.message=t,Error.captureStackTrace&&!w?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function h(t){this.name="InvalidMessageError",this.message=t,Error.captureStackTrace&&!w?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function f(t,e){this.name="SocketProtocolError",this.message=t,this.code=e,Error.captureStackTrace&&!w?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function p(t){this.name="ServerProtocolError",this.message=t,Error.captureStackTrace&&!w?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function d(t){this.name="HTTPServerError",this.message=t,Error.captureStackTrace&&!w?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function v(t){this.name="ResourceLimitError",this.message=t,Error.captureStackTrace&&!w?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function g(t){this.name="TimeoutError",this.message=t,Error.captureStackTrace&&!w?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function y(t,e){this.name="BadConnectionError",this.message=t,this.type=e,Error.captureStackTrace&&!w?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function m(t){this.name="BrokerError",this.message=t,Error.captureStackTrace&&!w?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function _(t,e){this.name="ProcessExitError",this.message=t,this.code=e,Error.captureStackTrace&&!w?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function b(t){this.name="UnknownError",this.message=t,Error.captureStackTrace&&!w?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}var E=n(599),w=function(){return!this}();r.prototype=Object.create(Error.prototype),i.prototype=Object.create(Error.prototype),o.prototype=Object.create(Error.prototype),a.prototype=Object.create(Error.prototype),s.prototype=Object.create(Error.prototype),u.prototype=Object.create(Error.prototype),c.prototype=Object.create(Error.prototype),l.prototype=Object.create(Error.prototype),h.prototype=Object.create(Error.prototype),f.prototype=Object.create(Error.prototype),p.prototype=Object.create(Error.prototype),d.prototype=Object.create(Error.prototype),v.prototype=Object.create(Error.prototype),g.prototype=Object.create(Error.prototype),y.prototype=Object.create(Error.prototype),m.prototype=Object.create(Error.prototype),_.prototype=Object.create(Error.prototype),b.prototype=Object.create(Error.prototype),t.exports={AuthTokenExpiredError:r,AuthTokenInvalidError:i,AuthTokenNotBeforeError:o,AuthTokenError:a,SilentMiddlewareBlockedError:s,InvalidActionError:u,InvalidArgumentsError:c,InvalidOptionsError:l,InvalidMessageError:h,SocketProtocolError:f,ServerProtocolError:p,HTTPServerError:d,ResourceLimitError:v,TimeoutError:g,BadConnectionError:y,BrokerError:m,ProcessExitError:_,UnknownError:b},t.exports.socketProtocolErrorStatuses={1001:"Socket was disconnected",1002:"A WebSocket protocol error was encountered",1003:"Server terminated socket because it received invalid data",1005:"Socket closed without status code",1006:"Socket hung up",1007:"Message format was incorrect",1008:"Encountered a policy violation",1009:"Message was too big to process",1010:"Client ended the connection because the server did not comply with extension requirements",1011:"Server encountered an unexpected fatal condition",4000:"Server ping timed out",4001:"Client pong timed out",4002:"Server failed to sign auth token",4003:"Failed to complete handshake",4004:"Client failed to save auth token",4005:"Did not receive #handshake from client before timeout",4006:"Failed to bind socket to message broker",4007:"Client connection establishment timed out",4008:"Server rejected handshake from client"},t.exports.socketProtocolIgnoreStatuses={1000:"Socket closed normally",1001:"Socket hung up"};var S={domain:1,domainEmitter:1,domainThrown:1};t.exports.dehydrateError=function(t,e){var n;if(t&&"object"==typeof t)for(var r in n={message:t.message},e&&(n.stack=t.stack),t)S[r]||(n[r]=t[r]);else n="function"==typeof t?"[function "+(t.name||"anonymous")+"]":t;return E(n)},t.exports.hydrateError=function(t){var e=null;if(null!=t)if("object"==typeof t)for(var n in e=new Error(t.message),t)t.hasOwnProperty(n)&&(e[n]=t[n]);else e=t;return e},t.exports.decycle=E},function(t,e,n){var r=n(67)(Object,"create");t.exports=r},function(t,e,n){function r(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}var i=n(631),o=n(632),a=n(633),s=n(634),u=n(635);r.prototype.clear=i,r.prototype.delete=o,r.prototype.get=a,r.prototype.has=s,r.prototype.set=u,t.exports=r},function(t,e,n){var r=n(264);t.exports=function(t,e){for(var n=t.length;n--;)if(r(t[n][0],e))return n;return-1}},function(t,e,n){var r=n(637);t.exports=function(t,e){var n=t.__data__;return r(e)?n["string"==typeof e?"string":"hash"]:n.map}},function(t,e,n){"use strict";function r(){u=!1}function i(t){if(t){if(t!==a){if(t.length!==l.length)throw new Error("Custom alphabet for shortid must be "+l.length+" unique characters. You submitted "+t.length+" characters: "+t);var e=t.split("").filter(function(t,e,n){return e!==n.lastIndexOf(t)});if(e.length)throw new Error("Custom alphabet for shortid must be "+l.length+" unique characters. These characters were not unique: "+e.join(", "));a=t,r()}}else a!==l&&(a=l,r())}function o(){return u||(u=function(){a||i(l);for(var t,e=a.split(""),n=[],r=c.nextValue();e.length>0;)r=c.nextValue(),t=Math.floor(r*e.length),n.push(e.splice(t,1)[0]);return n.join("")}())}var a,s,u,c=n(667),l="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_-";t.exports={get:function(){return a||l},characters:function(t){return i(t),a},seed:function(t){c.seed(t),s!==t&&(r(),s=t)},lookup:function(t){return o()[t]},shuffled:o}},function(t,e,n){var r=n(176),i=1/0;t.exports=function(t){if("string"==typeof t||r(t))return t;var e=t+"";return"0"==e&&1/t==-i?"-0":e}},function(t,e,n){"use strict";n.r(e),function(t,r){var i,o=n(287);i="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:r;var a=Object(o.a)(i);e.default=a}.call(this,n(8),n(492)(t))},function(t,e,n){var r=n(6),i=n(3).document,o=r(i)&&r(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,e,n){var r=n(3),i=n(34),o=n(53),a=n(178),s=n(11).f;t.exports=function(t){var e=i.Symbol||(i.Symbol=o?{}:r.Symbol||{});"_"==t.charAt(0)||t in e||s(e,t,{value:a.f(t)})}},function(t,e,n){var r=n(89)("keys"),i=n(52);t.exports=function(t){return r[t]||(r[t]=i(t))}},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,n){var r=n(3).document;t.exports=r&&r.documentElement},function(t,e,n){var r=n(6),i=n(2),o=function(t,e){if(i(t),!r(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,r){try{(r=n(30)(Function.call,n(27).f(Object.prototype,"__proto__").set,2))(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,n){return o(t,n),e?t.__proto__=n:r(t,n),t}}({},!1):void 0),check:o}},function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(t,e,n){var r=n(6),i=n(129).set;t.exports=function(t,e,n){var o,a=e.constructor;return a!==n&&"function"==typeof a&&(o=a.prototype)!==n.prototype&&r(o)&&i&&i(t,o),t}},function(t,e,n){"use strict";var r=n(37),i=n(36);t.exports=function(t){var e=String(i(this)),n="",o=r(t);if(o<0||o==1/0)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(e+=e))1&o&&(n+=e);return n}},function(t,e){t.exports=Math.sign||function(t){return 0==(t=+t)||t!=t?t:t<0?-1:1}},function(t,e){var n=Math.expm1;t.exports=!n||n(10)>22025.465794806718||n(10)<22025.465794806718||-2e-17!=n(-2e-17)?function(t){return 0==(t=+t)?t:t>-1e-6&&t<1e-6?t+t*t/2:Math.exp(t)-1}:n},function(t,e,n){var r=n(37),i=n(36);t.exports=function(t){return function(e,n){var o,a,s=String(i(e)),u=r(n),c=s.length;return u<0||u>=c?t?"":void 0:(o=s.charCodeAt(u))<55296||o>56319||u+1===c||(a=s.charCodeAt(u+1))<56320||a>57343?t?s.charAt(u):o:t?s.slice(u,u+2):a-56320+(o-55296<<10)+65536}}},function(t,e,n){"use strict";var r=n(53),i=n(0),o=n(21),a=n(20),s=n(71),u=n(137),c=n(69),l=n(28),h=n(7)("iterator"),f=!([].keys&&"next"in[].keys()),p=function(){return this};t.exports=function(t,e,n,d,v,g,y){u(n,e,d);var m,_,b,E=function(t){if(!f&&t in I)return I[t];switch(t){case"keys":case"values":return function(){return new n(this,t)}}return function(){return new n(this,t)}},w=e+" Iterator",S="values"==v,T=!1,I=t.prototype,A=I[h]||I["@@iterator"]||v&&I[v],O=A||E(v),C=v?S?E("entries"):O:void 0,R="Array"==e&&I.entries||A;if(R&&(b=l(R.call(new t)))!==Object.prototype&&b.next&&(c(b,w,!0),r||"function"==typeof b[h]||a(b,h,p)),S&&A&&"values"!==A.name&&(T=!0,O=function(){return A.call(this)}),r&&!y||!f&&!T&&I[h]||a(I,h,O),s[e]=O,s[w]=p,v)if(m={values:S?O:E("values"),keys:g?O:E("keys"),entries:C},y)for(_ in m)_ in I||o(I,_,m[_]);else i(i.P+i.F*(f||T),e,m);return m}},function(t,e,n){"use strict";var r=n(56),i=n(51),o=n(69),a={};n(20)(a,n(7)("iterator"),function(){return this}),t.exports=function(t,e,n){t.prototype=r(a,{next:i(1,n)}),o(t,e+" Iterator")}},function(t,e,n){var r=n(93),i=n(36);t.exports=function(t,e,n){if(r(e))throw TypeError("String#"+n+" doesn't accept regex!");return String(i(t))}},function(t,e,n){var r=n(7)("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[r]=!1,!"/./"[t](e)}catch(t){}}return!0}},function(t,e,n){var r=n(71),i=n(7)("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(r.Array===t||o[i]===t)}},function(t,e,n){"use strict";var r=n(11),i=n(51);t.exports=function(t,e,n){e in t?r.f(t,e,i(0,n)):t[e]=n}},function(t,e,n){var r=n(78),i=n(7)("iterator"),o=n(71);t.exports=n(34).getIteratorMethod=function(t){if(null!=t)return t[i]||t["@@iterator"]||o[r(t)]}},function(t,e,n){var r=n(382);t.exports=function(t,e){return new(r(t))(e)}},function(t,e,n){"use strict";var r=n(14),i=n(55),o=n(12);t.exports=function(t){for(var e=r(this),n=o(e.length),a=arguments.length,s=i(a>1?arguments[1]:void 0,n),u=a>2?arguments[2]:void 0,c=void 0===u?n:i(u,n);c>s;)e[s++]=t;return e}},function(t,e,n){"use strict";var r=n(48),i=n(194),o=n(71),a=n(26);t.exports=n(136)(Array,"Array",function(t,e){this._t=a(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,i(1)):i(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])},"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},function(t,e,n){var r,i,o,a=n(30),s=n(184),u=n(128),c=n(124),l=n(3),h=l.process,f=l.setImmediate,p=l.clearImmediate,d=l.MessageChannel,v=l.Dispatch,g=0,y={},m=function(){var t=+this;if(y.hasOwnProperty(t)){var e=y[t];delete y[t],e()}},_=function(t){m.call(t.data)};f&&p||(f=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return y[++g]=function(){s("function"==typeof t?t:Function(t),e)},r(g),g},p=function(t){delete y[t]},"process"==n(31)(h)?r=function(t){h.nextTick(a(m,t,1))}:v&&v.now?r=function(t){v.now(a(m,t,1))}:d?(o=(i=new d).port2,i.port1.onmessage=_,r=a(o.postMessage,o,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(r=function(t){l.postMessage(t+"","*")},l.addEventListener("message",_,!1)):r="onreadystatechange"in c("script")?function(t){u.appendChild(c("script")).onreadystatechange=function(){u.removeChild(this),m.call(t)}}:function(t){setTimeout(a(m,t,1),0)}),t.exports={set:f,clear:p}},function(t,e,n){var r=n(3),i=n(146).set,o=r.MutationObserver||r.WebKitMutationObserver,a=r.process,s=r.Promise,u="process"==n(31)(a);t.exports=function(){var t,e,n,c=function(){var r,i;for(u&&(r=a.domain)&&r.exit();t;){i=t.fn,t=t.next;try{i()}catch(r){throw t?n():e=void 0,r}}e=void 0,r&&r.enter()};if(u)n=function(){a.nextTick(c)};else if(!o||r.navigator&&r.navigator.standalone)if(s&&s.resolve){var l=s.resolve();n=function(){l.then(c)}}else n=function(){i.call(r,c)};else{var h=!0,f=document.createTextNode("");new o(c).observe(f,{characterData:!0}),n=function(){f.data=h=!h}}return function(r){var i={fn:r,next:void 0};e&&(e.next=i),t||(t=i,n()),e=i}}},function(t,e,n){"use strict";function r(t){var e,n;this.promise=new t(function(t,r){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=r}),this.resolve=i(e),this.reject=i(n)}var i=n(17);t.exports.f=function(t){return new r(t)}},function(t,e,n){"use strict";function r(t,e,n){var r,i,o,a=new Array(n),s=8*n-e-1,u=(1<<s)-1,c=u>>1,l=23===e?U(2,-24)-U(2,-77):0,h=0,f=t<0||0===t&&1/t<0?1:0;for((t=F(t))!=t||t===M?(i=t!=t?1:0,r=u):(r=j(B(t)/V),t*(o=U(2,-r))<1&&(r--,o*=2),(t+=r+c>=1?l/o:l*U(2,1-c))*o>=2&&(r++,o/=2),r+c>=u?(i=0,r=u):r+c>=1?(i=(t*o-1)*U(2,e),r+=c):(i=t*U(2,c-1)*U(2,e),r=0));e>=8;a[h++]=255&i,i/=256,e-=8);for(r=r<<e|i,s+=e;s>0;a[h++]=255&r,r/=256,s-=8);return a[--h]|=128*f,a}function i(t,e,n){var r,i=8*n-e-1,o=(1<<i)-1,a=o>>1,s=i-7,u=n-1,c=t[u--],l=127&c;for(c>>=7;s>0;l=256*l+t[u],u--,s-=8);for(r=l&(1<<-s)-1,l>>=-s,s+=e;s>0;r=256*r+t[u],u--,s-=8);if(0===l)l=1-a;else{if(l===o)return r?NaN:c?-M:M;r+=U(2,e),l-=a}return(c?-1:1)*r*U(2,l-e)}function o(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]}function a(t){return[255&t]}function s(t){return[255&t,t>>8&255]}function u(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]}function c(t){return r(t,52,8)}function l(t){return r(t,23,4)}function h(t,e,n){A(t[R],e,{get:function(){return this[n]}})}function f(t,e,n,r){var i=T(+n);if(i+e>t[q])throw x(N);var o=t[W]._b,a=i+t[H],s=o.slice(a,a+e);return r?s:s.reverse()}function p(t,e,n,r,i,o){var a=T(+n);if(a+e>t[q])throw x(N);for(var s=t[W]._b,u=a+t[H],c=r(+i),l=0;l<e;l++)s[u+l]=c[o?l:e-l-1]}var d=n(3),v=n(10),g=n(53),y=n(99),m=n(20),_=n(61),b=n(5),E=n(59),w=n(37),S=n(12),T=n(203),I=n(57).f,A=n(11).f,O=n(144),C=n(69),R="prototype",N="Wrong index!",k=d.ArrayBuffer,P=d.DataView,D=d.Math,x=d.RangeError,M=d.Infinity,L=k,F=D.abs,U=D.pow,j=D.floor,B=D.log,V=D.LN2,W=v?"_b":"buffer",q=v?"_l":"byteLength",H=v?"_o":"byteOffset";if(y.ABV){if(!b(function(){k(1)})||!b(function(){new k(-1)})||b(function(){return new k,new k(1.5),new k(NaN),"ArrayBuffer"!=k.name})){for(var G,K=(k=function(t){return E(this,k),new L(T(t))})[R]=L[R],z=I(L),Q=0;z.length>Q;)(G=z[Q++])in k||m(k,G,L[G]);g||(K.constructor=k)}var X=new P(new k(2)),Y=P[R].setInt8;X.setInt8(0,2147483648),X.setInt8(1,2147483649),!X.getInt8(0)&&X.getInt8(1)||_(P[R],{setInt8:function(t,e){Y.call(this,t,e<<24>>24)},setUint8:function(t,e){Y.call(this,t,e<<24>>24)}},!0)}else k=function(t){E(this,k,"ArrayBuffer");var e=T(t);this._b=O.call(new Array(e),0),this[q]=e},P=function(t,e,n){E(this,P,"DataView"),E(t,k,"DataView");var r=t[q],i=w(e);if(i<0||i>r)throw x("Wrong offset!");if(i+(n=void 0===n?r-i:S(n))>r)throw x("Wrong length!");this[W]=t,this[H]=i,this[q]=n},v&&(h(k,"byteLength","_l"),h(P,"buffer","_b"),h(P,"byteLength","_l"),h(P,"byteOffset","_o")),_(P[R],{getInt8:function(t){return f(this,1,t)[0]<<24>>24},getUint8:function(t){return f(this,1,t)[0]},getInt16:function(t){var e=f(this,2,t,arguments[1]);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=f(this,2,t,arguments[1]);return e[1]<<8|e[0]},getInt32:function(t){return o(f(this,4,t,arguments[1]))},getUint32:function(t){return o(f(this,4,t,arguments[1]))>>>0},getFloat32:function(t){return i(f(this,4,t,arguments[1]),23,4)},getFloat64:function(t){return i(f(this,8,t,arguments[1]),52,8)},setInt8:function(t,e){p(this,1,t,a,e)},setUint8:function(t,e){p(this,1,t,a,e)},setInt16:function(t,e){p(this,2,t,s,e,arguments[2])},setUint16:function(t,e){p(this,2,t,s,e,arguments[2])},setInt32:function(t,e){p(this,4,t,u,e,arguments[2])},setUint32:function(t,e){p(this,4,t,u,e,arguments[2])},setFloat32:function(t,e){p(this,4,t,l,e,arguments[2])},setFloat64:function(t,e){p(this,8,t,c,e,arguments[2])}});C(k,"ArrayBuffer"),C(P,"DataView"),m(P[R],y.VIEW,!0),e.ArrayBuffer=k,e.DataView=P},function(t,e,n){var r=n(3).navigator;t.exports=r&&r.userAgent||""},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.bannedSites=["gistnote.com/app/dashboard","newtab/","www.gistnote.com/app/dashboard","dev.gistnote.com/app/dashboard","www.weavatools.com/app/dashboard","dev.weavatools.com/app/dashboard","testing.weavatools.com/app/dashboard","testing.weavatools.com/dashboard","staging.weavatools.com/app/dashboard","accounts.google.com/AccountChooser","localhost:4200/dashboard","localhost:3000/dashboard","chrome.google.com/webstore","extensions/","chrome-extension","hkucc1.hku.hk","hkucc"],e.whiteList=["chrome-extension://cbnaodkpfinfiipjblikofhlhlcickei/src/pdfviewer/web/viewer.html?file=","localhost:3000/app/onboarding","localhost:3000/onboarding","localhost:4200/app/onboarding","www.weavatools.com/app/onboarding","dev.weavatools.com/app/onboarding","testing.weavatools.com/app/onboarding","testing.weavatools.com/onboarding","staging.weavatools.com/app/onboarding"],e.webAppDomains=["localhost:3000/app/dashboard","localhost:3000/dashboard","localhost:4200/app/dashboard","gistnote.com/app/dashboard","dev.gistnote.com/app/dashboard","www.weavatools.com/app/dashboard","dev.weavatools.com/app/dashboard","testing.weavatools.com/app/dashboard","testing.weavatools.com/dashboard","staging.weavatools.com/app/dashboard"],e.webAppLoginUrls=["localhost:3000/login","localhost:4200/login","gistnote.com/login","dev.gistnote.com/login","www.weavatools.com/login","staging.weavatools.com/login","testing.weavatools.com/login","dev.weavatools.com/login"],e.isBannedSite=function(t){t=UrlUtil.getOriginalUrlForPDF(t);for(var n=!1,r=UrlUtil.buildMatchString(t,{scheme:!1,query:!0,fragment:!1}),i=0;i<e.bannedSites.length;i++){var o=e.bannedSites[i];if(0===r.indexOf(o)){n=!0;break}}for(var a=0;a<e.whiteList.length;a++){var s=e.whiteList[a];0===t.indexOf(s)&&(n=!1)}return n},e.isWebApp=function(t){for(var n=UrlUtil.buildMatchString(t,{scheme:!1,query:!0,fragment:!1}),r=0;r<e.webAppDomains.length;r++){var i=e.webAppDomains[r];if(0===n.indexOf(i))return!0}return!1},e.isWebAppLogin=function(t){for(var n=UrlUtil.buildMatchString(t,{scheme:!1,query:!0,fragment:!1}),r=0;r<e.webAppLoginUrls.length;r++){var i=e.webAppLoginUrls[r];if(0===n.indexOf(i))return!0}return!1}},function(t,e){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function i(t){if(c===setTimeout)return setTimeout(t,0);if((c===n||!c)&&setTimeout)return c=setTimeout,setTimeout(t,0);try{return c(t,0)}catch(e){try{return c.call(null,t,0)}catch(e){return c.call(this,t,0)}}}function o(){d&&f&&(d=!1,f.length?p=f.concat(p):v=-1,p.length&&a())}function a(){if(!d){var t=i(o);d=!0;for(var e=p.length;e;){for(f=p,p=[];++v<e;)f&&f[v].run();v=-1,e=p.length}f=null,d=!1,function(t){if(l===clearTimeout)return clearTimeout(t);if((l===r||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(t);try{l(t)}catch(e){try{return l.call(null,t)}catch(e){return l.call(this,t)}}}(t)}}function s(t,e){this.fun=t,this.array=e}function u(){}var c,l,h=t.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:n}catch(t){c=n}try{l="function"==typeof clearTimeout?clearTimeout:r}catch(t){l=r}}();var f,p=[],d=!1,v=-1;h.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];p.push(new s(t,e)),1!==p.length||d||i(a)},s.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=u,h.addListener=u,h.once=u,h.off=u,h.removeListener=u,h.removeAllListeners=u,h.emit=u,h.prependListener=u,h.prependOnceListener=u,h.listeners=function(t){return[]},h.binding=function(t){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(t){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CONSTANTS={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"}},function(t,e,n){n(519)},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n(219),o=n(523),a=n(4),s=n(524),u=n(220),c=n(110),l=n(13),h=n(548),f=n(63),p=n(1),d=n(1),v=n(231),g=function(t){function e(e,n){if(!(e instanceof c.Repo))throw new Error("new Reference() no longer supported - use app.database().");return t.call(this,e,n,h.QueryParams.DEFAULT,!1)||this}return r(e,t),e.prototype.getKey=function(){return p.validateArgCount("Reference.key",0,0,arguments.length),this.path.isEmpty()?null:this.path.getBack()},e.prototype.child=function(t){return p.validateArgCount("Reference.child",1,1,arguments.length),"number"==typeof t?t=String(t):t instanceof l.Path||(null===this.path.getFront()?f.validateRootPathString("Reference.child",1,t,!1):f.validatePathString("Reference.child",1,t,!1)),new e(this.repo,this.path.child(t))},e.prototype.getParent=function(){p.validateArgCount("Reference.parent",0,0,arguments.length);var t=this.path.parent();return null===t?null:new e(this.repo,t)},e.prototype.getRoot=function(){p.validateArgCount("Reference.root",0,0,arguments.length);for(var t=this;null!==t.getParent();)t=t.getParent();return t},e.prototype.databaseProp=function(){return this.repo.database},e.prototype.set=function(t,e){p.validateArgCount("Reference.set",1,2,arguments.length),f.validateWritablePath("Reference.set",this.path),f.validateFirebaseDataArg("Reference.set",1,t,this.path,!1),p.validateCallback("Reference.set",2,e,!0);var n=new d.Deferred;return this.repo.setWithPriority(this.path,t,null,n.wrapCallback(e)),n.promise},e.prototype.update=function(t,e){if(p.validateArgCount("Reference.update",1,2,arguments.length),f.validateWritablePath("Reference.update",this.path),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,a.warn("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}f.validateFirebaseMergeDataArg("Reference.update",1,t,this.path,!1),p.validateCallback("Reference.update",2,e,!0);var i=new d.Deferred;return this.repo.update(this.path,t,i.wrapCallback(e)),i.promise},e.prototype.setWithPriority=function(t,e,n){if(p.validateArgCount("Reference.setWithPriority",2,3,arguments.length),f.validateWritablePath("Reference.setWithPriority",this.path),f.validateFirebaseDataArg("Reference.setWithPriority",1,t,this.path,!1),f.validatePriority("Reference.setWithPriority",2,e,!1),p.validateCallback("Reference.setWithPriority",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.setWithPriority failed: "+this.getKey()+" is a read-only object.";var r=new d.Deferred;return this.repo.setWithPriority(this.path,t,e,r.wrapCallback(n)),r.promise},e.prototype.remove=function(t){return p.validateArgCount("Reference.remove",0,1,arguments.length),f.validateWritablePath("Reference.remove",this.path),p.validateCallback("Reference.remove",1,t,!0),this.set(null,t)},e.prototype.transaction=function(t,e,n){if(p.validateArgCount("Reference.transaction",1,3,arguments.length),f.validateWritablePath("Reference.transaction",this.path),p.validateCallback("Reference.transaction",1,t,!1),p.validateCallback("Reference.transaction",2,e,!0),f.validateBoolean("Reference.transaction",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.transaction failed: "+this.getKey()+" is a read-only object.";void 0===n&&(n=!0);var r=new d.Deferred;"function"==typeof e&&r.promise.catch(function(){});return this.repo.startTransaction(this.path,t,function(t,n,i){t?r.reject(t):r.resolve(new o.TransactionResult(n,i)),"function"==typeof e&&e(t,n,i)},n),r.promise},e.prototype.setPriority=function(t,e){p.validateArgCount("Reference.setPriority",1,2,arguments.length),f.validateWritablePath("Reference.setPriority",this.path),f.validatePriority("Reference.setPriority",1,t,!1),p.validateCallback("Reference.setPriority",2,e,!0);var n=new d.Deferred;return this.repo.setWithPriority(this.path.child(".priority"),t,null,n.wrapCallback(e)),n.promise},e.prototype.push=function(t,e){p.validateArgCount("Reference.push",0,2,arguments.length),f.validateWritablePath("Reference.push",this.path),f.validateFirebaseDataArg("Reference.push",1,t,this.path,!0),p.validateCallback("Reference.push",2,e,!0);var n,r=this.repo.serverTime(),i=s.nextPushId(r),o=this.child(i),a=this.child(i);return n=null!=t?o.set(t,e).then(function(){return a}):Promise.resolve(a),o.then=n.then.bind(n),o.catch=n.then.bind(n,void 0),"function"==typeof e&&n.catch(function(){}),o},e.prototype.onDisconnect=function(){return f.validateWritablePath("Reference.onDisconnect",this.path),new i.OnDisconnect(this.repo,this.path)},Object.defineProperty(e.prototype,"database",{get:function(){return this.databaseProp()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"key",{get:function(){return this.getKey()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this.getParent()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this.getRoot()},enumerable:!0,configurable:!0}),e}(u.Query);e.Reference=g,u.Query.__referenceConstructor=g,v.SyncPoint.__referenceConstructor=g},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=n(63),o=n(13),a=n(19),s=function(){function t(t,e,n){this.node_=t,this.ref_=e,this.index_=n}return t.prototype.val=function(){return r.validateArgCount("DataSnapshot.val",0,0,arguments.length),this.node_.val()},t.prototype.exportVal=function(){return r.validateArgCount("DataSnapshot.exportVal",0,0,arguments.length),this.node_.val(!0)},t.prototype.toJSON=function(){return r.validateArgCount("DataSnapshot.toJSON",0,1,arguments.length),this.exportVal()},t.prototype.exists=function(){return r.validateArgCount("DataSnapshot.exists",0,0,arguments.length),!this.node_.isEmpty()},t.prototype.child=function(e){r.validateArgCount("DataSnapshot.child",0,1,arguments.length),e=String(e),i.validatePathString("DataSnapshot.child",1,e,!1);var n=new o.Path(e),s=this.ref_.child(n);return new t(this.node_.getChild(n),s,a.PRIORITY_INDEX)},t.prototype.hasChild=function(t){r.validateArgCount("DataSnapshot.hasChild",1,1,arguments.length),i.validatePathString("DataSnapshot.hasChild",1,t,!1);var e=new o.Path(t);return!this.node_.getChild(e).isEmpty()},t.prototype.getPriority=function(){return r.validateArgCount("DataSnapshot.getPriority",0,0,arguments.length),this.node_.getPriority().val()},t.prototype.forEach=function(e){var n=this;return r.validateArgCount("DataSnapshot.forEach",1,1,arguments.length),r.validateCallback("DataSnapshot.forEach",1,e,!1),!this.node_.isLeafNode()&&!!this.node_.forEachChild(this.index_,function(r,i){return e(new t(i,n.ref_.child(r),a.PRIORITY_INDEX))})},t.prototype.hasChildren=function(){return r.validateArgCount("DataSnapshot.hasChildren",0,0,arguments.length),!this.node_.isLeafNode()&&!this.node_.isEmpty()},Object.defineProperty(t.prototype,"key",{get:function(){return this.ref_.getKey()},enumerable:!0,configurable:!0}),t.prototype.numChildren=function(){return r.validateArgCount("DataSnapshot.numChildren",0,0,arguments.length),this.node_.numChildren()},t.prototype.getRef=function(){return r.validateArgCount("DataSnapshot.ref",0,0,arguments.length),this.ref_},Object.defineProperty(t.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),t}();e.DataSnapshot=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(109),o=n(13),a=n(4),s=n(1),u=function(){return r||(r=new i.SortedMap(a.stringCompare)),r},c=function(){function t(t,e){void 0===e&&(e=u()),this.value=t,this.children=e}return t.fromObject=function(e){var n=t.Empty;return s.forEach(e,function(t,e){n=n.set(new o.Path(t),e)}),n},t.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},t.prototype.findRootMostMatchingPathAndValue=function(t,e){if(null!=this.value&&e(this.value))return{path:o.Path.Empty,value:this.value};if(t.isEmpty())return null;var n=t.getFront(),r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(t.popFront(),e);return null!=i?{path:new o.Path(n).child(i.path),value:i.value}:null}return null},t.prototype.findRootMostValueAndPath=function(t){return this.findRootMostMatchingPathAndValue(t,function(){return!0})},t.prototype.subtree=function(e){if(e.isEmpty())return this;var n=e.getFront(),r=this.children.get(n);return null!==r?r.subtree(e.popFront()):t.Empty},t.prototype.set=function(e,n){if(e.isEmpty())return new t(n,this.children);var r=e.getFront(),i=(this.children.get(r)||t.Empty).set(e.popFront(),n),o=this.children.insert(r,i);return new t(this.value,o)},t.prototype.remove=function(e){if(e.isEmpty())return this.children.isEmpty()?t.Empty:new t(null,this.children);var n=e.getFront(),r=this.children.get(n);if(r){var i=r.remove(e.popFront()),o=void 0;return o=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),null===this.value&&o.isEmpty()?t.Empty:new t(this.value,o)}return this},t.prototype.get=function(t){if(t.isEmpty())return this.value;var e=t.getFront(),n=this.children.get(e);return n?n.get(t.popFront()):null},t.prototype.setTree=function(e,n){if(e.isEmpty())return n;var r,i=e.getFront(),o=(this.children.get(i)||t.Empty).setTree(e.popFront(),n);return r=o.isEmpty()?this.children.remove(i):this.children.insert(i,o),new t(this.value,r)},t.prototype.fold=function(t){return this.fold_(o.Path.Empty,t)},t.prototype.fold_=function(t,e){var n={};return this.children.inorderTraversal(function(r,i){n[r]=i.fold_(t.child(r),e)}),e(t,this.value,n)},t.prototype.findOnPath=function(t,e){return this.findOnPath_(t,o.Path.Empty,e)},t.prototype.findOnPath_=function(t,e,n){var r=!!this.value&&n(e,this.value);if(r)return r;if(t.isEmpty())return null;var i=t.getFront(),o=this.children.get(i);return o?o.findOnPath_(t.popFront(),e.child(i),n):null},t.prototype.foreachOnPath=function(t,e){return this.foreachOnPath_(t,o.Path.Empty,e)},t.prototype.foreachOnPath_=function(e,n,r){if(e.isEmpty())return this;this.value&&r(n,this.value);var i=e.getFront(),o=this.children.get(i);return o?o.foreachOnPath_(e.popFront(),n.child(i),r):t.Empty},t.prototype.foreach=function(t){this.foreach_(o.Path.Empty,t)},t.prototype.foreach_=function(t,e){this.children.inorderTraversal(function(n,r){r.foreach_(t.child(n),e)}),this.value&&e(t,this.value)},t.prototype.foreachChild=function(t){this.children.inorderTraversal(function(e,n){n.value&&t(e,n.value)})},t.Empty=new t(null),t}();e.ImmutableTree=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=n(74),o=n(24),a=n(19),s=function(){function t(t){this.index_=t}return t.prototype.updateChild=function(t,e,n,o,a,s){r.assert(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");var u=t.getImmediateChild(e);return u.getChild(o).equals(n.getChild(o))&&u.isEmpty()==n.isEmpty()?t:(null!=s&&(n.isEmpty()?t.hasChild(e)?s.trackChildChange(i.Change.childRemovedChange(e,u)):r.assert(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):u.isEmpty()?s.trackChildChange(i.Change.childAddedChange(e,n)):s.trackChildChange(i.Change.childChangedChange(e,n,u))),t.isLeafNode()&&n.isEmpty()?t:t.updateImmediateChild(e,n).withIndex(this.index_))},t.prototype.updateFullNode=function(t,e,n){return null!=n&&(t.isLeafNode()||t.forEachChild(a.PRIORITY_INDEX,function(t,r){e.hasChild(t)||n.trackChildChange(i.Change.childRemovedChange(t,r))}),e.isLeafNode()||e.forEachChild(a.PRIORITY_INDEX,function(e,r){if(t.hasChild(e)){var o=t.getImmediateChild(e);o.equals(r)||n.trackChildChange(i.Change.childChangedChange(e,r,o))}else n.trackChildChange(i.Change.childAddedChange(e,r))})),e.withIndex(this.index_)},t.prototype.updatePriority=function(t,e){return t.isEmpty()?o.ChildrenNode.EMPTY_NODE:t.updatePriority(e)},t.prototype.filtersNodes=function(){return!1},t.prototype.getIndexedFilter=function(){return this},t.prototype.getIndex=function(){return this.index_},t}();e.IndexedFilter=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(540),i=function(){function t(){}return t.getCollection=function(t){var e=t.toString();return this.collections_[e]||(this.collections_[e]=new r.StatsCollection),this.collections_[e]},t.getOrCreateReporter=function(t,e){var n=t.toString();return this.reporters_[n]||(this.reporters_[n]=e()),this.reporters_[n]},t.collections_={},t.reporters_={},t}();e.StatsManager=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=n(110),o=n(4),a=n(217),s=n(63);n(550);var u,c=function(){function t(){this.repos_={},this.useRestClient_=!1}return t.getInstance=function(){return u||(u=new t),u},t.prototype.interrupt=function(){for(var t in this.repos_)for(var e in this.repos_[t])this.repos_[t][e].interrupt()},t.prototype.resume=function(){for(var t in this.repos_)for(var e in this.repos_[t])this.repos_[t][e].resume()},t.prototype.databaseFromApp=function(t,e){var n=e||t.options.databaseURL;void 0===n&&o.fatal("Can't determine Firebase Database URL.  Be sure to include databaseURL option when calling firebase.initializeApp().");var r=a.parseRepoInfo(n),i=r.repoInfo;return s.validateUrl("Invalid Firebase Database URL",1,r),r.path.isEmpty()||o.fatal("Database URL must point to the root of a Firebase Database (not including a child path)."),this.createRepo(i,t).database},t.prototype.deleteRepo=function(t){var e=r.safeGet(this.repos_,t.app.name);e&&r.safeGet(e,t.repoInfo_.toURLString())===t||o.fatal("Database "+t.app.name+"("+t.repoInfo_+") has already been deleted."),t.interrupt(),delete e[t.repoInfo_.toURLString()]},t.prototype.createRepo=function(t,e){var n=r.safeGet(this.repos_,e.name);n||(n={},this.repos_[e.name]=n);var a=r.safeGet(n,t.toURLString());return a&&o.fatal("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),a=new i.Repo(t,this.useRestClient_,e),n[t.toURLString()]=a,a},t.prototype.forceRestClient=function(t){this.useRestClient_=t},t}();e.RepoManager=c},function(t,e,n){"use strict";var r=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});var i=n(9),o=n(15),a=n(50),s=n(103),u=n(563),c=n(112),l=n(44),h=n(40);e.moveWebsiteAsync=function(t,e,n){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){var i,u,c,h,f,p,d,v;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(t!==e){r.next=2;break}return r.abrupt("return");case 2:return i=(i=(i=(i=[]).concat(o.database().ref("/websites/"+n).once("value"))).concat(o.database().ref("/folders/"+t).once("value"))).concat(o.database().ref("/folders/"+e).once("value")),r.next=8,Promise.all(i);case 8:if(u=r.sent,c=u[0].val(),h=u[1].val(),f=u[2].val(),p={},!(d=l.findKey(f?f.websiteIds:[],function(t,e){return t.url===c.url}))){r.next=20;break}c.highlights&&l.forEach(c.highlights,function(t,e){return p["websites/"+d+"/highlights/"+e]=t}),p["websites/"+n]=null,p["folders/"+t+"/websiteIds/"+n]=null,r.next=27;break;case 20:return d=n,r.next=23,o.database().ref("/folders/"+e+"/accessRight").once("value");case 23:v=r.sent.val(),p["folders/"+e+"/websiteIds/"+n]=h.websiteIds[n],p["folders/"+t+"/websiteIds/"+n]=null,p["websites/"+n+"/accessRight"]=v;case 27:return p=a.objectUndefinedToNull(p),s.weavaFirebaseLogger.moveWebsiteLog(p),r.abrupt("return",o.database().ref("/").update(p));case 30:case"end":return r.stop()}},r,this)}))},e.deleteWebsiteAsync=function(t,e){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return i="websites/"+e,(r={})["folders/"+t+"/websiteIds/"+e]=null,r[i]=null,r=a.objectUndefinedToNull(r),s.weavaFirebaseLogger.deleteWebsiteLog(r),n.abrupt("return",o.database().ref("/").update(r));case 8:case"end":return n.stop()}},n,this)}))},e.createWebsiteWithHighlightAsync=function(t,n,i,o,a,s,u,c){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",e.createWebsiteInFolderAsync(t,n,i,o,a,s,u,c));case 1:case"end":return r.stop()}},r,this)}))},e.createPDFsWebsiteObjAsync=function(t,e,n){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function i(){var c,l,h=this;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:c=Object.keys(n),l={},l=a.objectUndefinedToNull(l),c.forEach(function(i){return r(h,void 0,void 0,regeneratorRuntime.mark(function r(){var c,h,f,p,d,v,g;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return c=n[i].id,h=i,f="chrome-extension://cbnaodkpfinfiipjblikofhlhlcickei/src/pdfviewer/web/viewer.html?file=file:///"+n[i].file.path.replace(/\\/g,"/"),p={url:f,localUrls:[f],createDate:o.database.ServerValue.TIMESTAMP},r.next=6,o.database().ref("/folders/"+e+"/accessRight").once("value");case 6:return d=r.sent.val(),v={creator:t.uid,accessRight:d,title:h,url:f,localUrls:[f],favIconUrl:"",createDate:o.database.ServerValue.TIMESTAMP,version:u.websiteMigrationManager.lastestVersion()},g="websites/"+c,l["folders/"+e+"/websiteIds/"+c]=p,l[g]=v,l=a.objectUndefinedToNull(l),s.weavaFirebaseLogger.createWebsiteLog(l),r.next=16,o.database().ref("/").update(l);case 16:case"end":return r.stop()}},r,this)}))});case 4:case"end":return i.stop()}},i,this)}))},e.createWebsiteAsync=function(t,n,i,o,a){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",e.createWebsiteInFolderAsync(t,n,i,o,a,s));case 1:case"end":return r.stop()}},r,this)}))},e.createWebsiteInFolderAsync=function(t,e,n,i,c){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,h=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,f=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){var p,d,v,g,y,m,_;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return p=void 0,p=l||generatePushID(),d={url:"undefined"!=typeof UrlUtil?UrlUtil.getOriginalUrlForPDF(n):n,createDate:o.database.ServerValue.TIMESTAMP},r.next=5,o.database().ref("/folders/"+e+"/accessRight").once("value");case 5:return v=r.sent.val(),g={creator:t.uid,accessRight:v,title:i,url:"undefined"!=typeof UrlUtil?UrlUtil.getOriginalUrlForPDF(n):n,favIconUrl:c,createDate:o.database.ServerValue.TIMESTAMP,version:u.websiteMigrationManager.lastestVersion()},h&&f&&(g.highlights={},g.highlights[h]=f),y="websites/"+p,m={},(_={})["folders/"+e+"/websiteIds/"+p]=d,m[y]=g,_=a.objectUndefinedToNull(_),m=a.objectUndefinedToNull(m),s.weavaFirebaseLogger.createWebsiteLog(m),r.next=19,o.database().ref("/").update(m);case 19:return r.next=21,o.database().ref("/").update(_);case 21:return r.abrupt("return",p);case 22:case"end":return r.stop()}},r,this)}))};var f=i.Set([]),p=i.Set([]),d=i.Set([]),v={};e.unsubscribeAllWebsitesAndHighlights=function(){s.weavaFirebaseLogger.unSubscribeAllWebsitesLog();var t=i.Set([]);t=t.union(f).union(p).union(d),f=i.Set([]),p=i.Set([]),d=i.Set([]),t.forEach(function(t){g(t)})};var g=function(t){if(!p.includes(t)&&!f.includes(t)){s.weavaFirebaseLogger.unSubscribeWebsiteLog(t),clearTimeout(v[t]);var e="websites/"+t;o.database().ref(e).off(),o.database().ref("websites/"+t+"/highlights").off()}},y=function(t,e){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=!0,(i=u.websiteMigrationManager.apply(t)).version===t.version){n.next=7;break}return n.next=5,o.database().ref("websites/"+e).set(a.objectUndefinedToNull(i));case 5:return r=!1,n.abrupt("return",r);case 7:return n.abrupt("return",!0);case 8:case"end":return n.stop()}},n,this)}))};e.subscribeActiveWebsitesAsync=function(t,n,a,u){var l=!0;n.forEach(function(n){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function h(){var p,d=this;return regeneratorRuntime.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:f.includes(n)||(s.weavaFirebaseLogger.subscribeActiveWebsiteLog(n),f=f.add(n),p="websites/"+n,o.database().ref(p).on("value",function(o){return r(d,void 0,void 0,regeneratorRuntime.mark(function r(){var h,f,p,d;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(h=o.val(),f=i.fromJS(h),l&&(h.createDate+864e5>Date.now()||(p=UrlUtil.getOriginalUrlForPDF(h.url),d=purl(p).attr("host"),u(p,d),c.TrackerAsyncFunction.trackUsageStat("revisitCount",1)),l=!1),f){r.next=7;break}return s.weavaFirebaseLogger.websiteUpdatedLog(n,h),e.deleteWebsiteAsync(t,n),r.abrupt("return");case 7:return s.weavaFirebaseLogger.websiteUpdatedLog(n,h),r.next=10,y(h,n);case 10:if(r.sent){r.next=13;break}return r.abrupt("return");case 13:a(n,f);case 14:case"end":return r.stop()}},r,this)}))}));case 1:case"end":return h.stop()}},h,this)}))}),f.forEach(function(t){!n.includes(t)&&(d=d.remove(t),f=f.remove(t),g(t))})},e.subscribenonActiveWebsiteBodiesAsync=function(t,n,a,u,c){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function l(){var h,v,m,_,b=this;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return h=i.List([]),h=a.get("ascending")?i.List(n.sortBy(function(t){return t.get("createDate")}).keySeq()):i.List(n.sortBy(function(t){return-t.get("createDate")}).keySeq()),v=a.get("endAt"),h=h.takeWhile(function(t,e){return e<=v}).toList(),m=function(n){return r(b,void 0,void 0,regeneratorRuntime.mark(function a(){var l=this;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",new Promise(function(a,h){if(n.length>0){s.weavaFirebaseLogger.subscribeListWebsiteLog(n);var f=n.map(function(t){return r(l,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.database().ref("websites/"+t).once("value");case 2:return e.abrupt("return",e.sent.val());case 3:case"end":return e.stop()}},e,this)}))});Promise.all(f).then(function(h){return r(l,void 0,void 0,regeneratorRuntime.mark(function l(){var f,p,d=this;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:f=[],p=[],h.forEach(function(t,e){return r(d,void 0,void 0,regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,y(t,n[e]);case 2:if(r.sent){r.next=4;break}p.push(n[e]);case 4:case"end":return r.stop()}},r,this)}))}),0===p.length?c(i.fromJS(n),i.fromJS(h)):n.forEach(function(t){f.push(t)}),n.forEach(function(n){var a="websites/"+n;o.database().ref(a).on("value",function(o){return r(d,void 0,void 0,regeneratorRuntime.mark(function r(){var a,c;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(a=o.val(),c=i.fromJS(a),-1!==f.indexOf(n)){r.next=5;break}return f.push(n),r.abrupt("return");case 5:if(c){r.next=9;break}return s.weavaFirebaseLogger.websiteUpdatedLog(n,a),e.deleteWebsiteAsync(t,n),r.abrupt("return");case 9:return s.weavaFirebaseLogger.websiteUpdatedLog(n,a),r.next=12,y(a,n);case 12:if(r.sent){r.next=15;break}return r.abrupt("return");case 15:u(n,c);case 16:case"end":return r.stop()}},r,this)}))})}),a();case 6:case"end":return l.stop()}},l,this)}))})}else a()}));case 1:case"end":return a.stop()}},a,this)}))},0,_=[],h.forEach(function(t,e){f.includes(t)||p.includes(t)||(0,p=p.add(t),_.push(t))}),l.next=10,m(_);case 10:p.forEach(function(t){!h.includes(t)&&(d=d.remove(t),p=p.remove(t),g(t))});case 11:case"end":return l.stop()}},l,this)}))},e.subscribeSearchWebsitesAsync=function(t,n,r){var a=function(n){s.weavaFirebaseLogger.subscribeListWebsiteLog(n);var a="websites/"+n;o.database().ref(a).on("value",function(a){var c=a.val(),l=i.fromJS(c);if(!l)return s.weavaFirebaseLogger.websiteUpdatedLog(n,c),void e.deleteWebsiteAsync(t,n);s.weavaFirebaseLogger.websiteUpdatedLog(n,c);var h=u.websiteMigrationManager.apply(c);h.version===c.version?r(n,l):o.database().ref("websites/"+n).set(h)})};n.forEach(function(t){f.includes(t)||p.includes(t)||(p=p.add(t),a(t))})},e.uploadPDFsAsync=function(t,n,i,o,a,s,u,c){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function l(){var f,p,d,v,g,y=this;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return f={},(p=Object.keys(a)).forEach(function(t){f[t]=a[t].id}),d={pdfNamesMap:f},v=t+"apis/pdfstorage/getSignedUploadUrl?token="+i,g=void 0,l.prev=6,l.next=9,h(v,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)});case 9:return l.next=11,l.sent.json();case 11:g=l.sent,u(!0),l.next=20;break;case 15:return l.prev=15,l.t0=l.catch(6),console.error(l.t0),u(!1),l.abrupt("return");case 20:p.forEach(function(i){return r(y,void 0,void 0,regeneratorRuntime.mark(function r(){var u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:u={method:"PUT",body:a[i].file},h(g[i],u).then(function(r){if(!r.ok)return s(),c(!1),alert("Failed to upload file. "+i);c(!0);var u="chrome-extension://cbnaodkpfinfiipjblikofhlhlcickei/src/pdfviewer/web/viewer.html?file=";console.log(""+u+t+"apis/pdfstorage/"+a[i].id),e.createWebsiteAsync(n,o,""+u+t+"apis/pdfstorage/"+a[i].id,i,"",a[i].id).then(s)});case 2:case"end":return r.stop()}},r,this)}))});case 21:case"end":return l.stop()}},l,this,[[6,15]])}))}},function(t,e,n){"use strict";var r=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});var i=n(161),o=n(9),a=n(18),s=n(84),u=n(50),c=n(23);n(44),e.websiteActionConstant=c({ON_NEXT_PAGE:null,ON_PREV_PAGE:null,CHANGE_WEBSITE_ORDER:null,MOVE_WEBSITE:null,WEBSITE_UPDATED:null,WEBSITES_UPDATED:null,WEBSITE_HIGHLIGHT_ADDED:null,WEBSITE_HIGHLIGHT_EDITED:null,WEBSITE_HIGHLIGHT_DELETED:null,SET_PDF_UPLOAD_PROGRESS:null}),e.onNextPage=function(){return{type:e.websiteActionConstant.ON_NEXT_PAGE}},e.changeWebsiteOrder=function(t){return i.unsubscribeAllWebsitesAndHighlights(),{type:e.websiteActionConstant.CHANGE_WEBSITE_ORDER,ascending:t}},e.deleteWebsite=function(t,e){return function(n){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:(r=u.getActiveFolderIdFromState(t))&&i.deleteWebsiteAsync(r,e);case 2:case"end":return n.stop()}},n,this)}))}},e.moveWebsite=function(t,e,n){return function(o){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:i.moveWebsiteAsync(t,e,n);case 1:case"end":return r.stop()}},r,this)}))}},e.subscribeActiveWebsites=function(t,n){return function(r){var o=u.getActiveFolderIdFromState(t);o&&i.subscribeActiveWebsitesAsync(o,n,function(t,n){r({type:e.websiteActionConstant.WEBSITE_UPDATED,websiteId:t,website:n})},function(t,e){r(a.TrackerActions.trackEvent(s.organizeResearchEventConstants.VISIT_HIGHLIGHTED_SITE,{url:t,domain:e}))})}},e.subscribenonActiveWebsiteBodies=function(t,n,r){return function(a){var s=u.getActiveFolderIdFromState(t);s&&i.subscribenonActiveWebsiteBodiesAsync(s,n||o.Map({}),r,function(t,n){a({type:e.websiteActionConstant.WEBSITE_UPDATED,websiteId:t,website:n})},function(t,n){console.log("LIST_WEBSITE_FIRST_DOWNLOAD",t.toJS(),n.toJS()),a({type:e.websiteActionConstant.WEBSITES_UPDATED,websiteIds:t,websites:n})})}},e.subscribeSearchWebsites=function(t,n){return function(r){var o=u.getActiveFolderIdFromState(t);o&&i.subscribeSearchWebsitesAsync(o,n,function(t,n){r({type:e.websiteActionConstant.WEBSITE_UPDATED,websiteId:t,website:n})})}},e.setPdfUploadProgress=function(t,n){return{type:e.websiteActionConstant.SET_PDF_UPLOAD_PROGRESS,current:t,total:n}},e.uploadPDFs=function(t,n,r,o,c){return function(l){var h=u.getActiveFolderIdFromState(o);if(h){var f=Object.keys(c).length,p=0;l(e.setPdfUploadProgress(p,f)),i.uploadPDFsAsync(t,n,r,h,c,function(){p++,l(e.setPdfUploadProgress(p,f))},function(t){l(t?a.TrackerActions.trackEvent(s.PDFStorageEventConstants.SIGNED_UPLOAD_URL_SUCCEED):a.TrackerActions.trackEvent(s.PDFStorageEventConstants.SIGNED_UPLOAD_URL_FAILED))},function(t){l(t?a.TrackerActions.trackEvent(s.PDFStorageEventConstants.UPLOAD_PDF_SUCCEED):a.TrackerActions.trackEvent(s.PDFStorageEventConstants.UPLOAD_PDF_FAILED))})}}},e.createWebsite=function(t,e,n,r,o){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;return function(s){var c=u.getActiveFolderIdFromState(e);c&&i.createWebsiteAsync(t,c,n,o,r,a)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(73);e.pdfActionConstants=r({SET_PDF_MODE:null}),e.pdfModeOptions=r({FALSE:null,DEFAULT:null,PDF_JS:null}),e.setPdfMode=function(t,n){return{type:e.pdfActionConstants.SET_PDF_MODE,tabId:t,mode:n}}},function(t,e,n){(function(e){function r(t){return void 0===t}function i(t){return"[object Object]"===Object.prototype.toString.call(t)}function o(t){return"[object String]"===Object.prototype.toString.call(t)}function a(t){return"[object Array]"===Object.prototype.toString.call(t)}function s(){if(!("fetch"in m))return!1;try{return new Headers,new Request(""),new Response,!0}catch(t){return!1}}function u(t,e){var n,i;if(r(t.length))for(n in t)l(t,n)&&e.call(null,n,t[n]);else if(i=t.length)for(n=0;n<i;n++)e.call(null,n,t[n])}function c(t,e){if("number"!=typeof e)throw new Error("2nd argument to `truncate` function should be a number");return"string"!=typeof t||0===e?t:t.length<=e?t:t.substr(0,e)+"…"}function l(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function h(t){for(var e,n=[],r=0,i=t.length;r<i;r++)o(e=t[r])?n.push(e.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")):e&&e.source&&n.push(e.source);return new RegExp(n.join("|"),"i")}function f(t){var e,n,r,i,a,s=[];if(!t||!t.tagName)return"";if(s.push(t.tagName.toLowerCase()),t.id&&s.push("#"+t.id),(e=t.className)&&o(e))for(n=e.split(/\s+/),a=0;a<n.length;a++)s.push("."+n[a]);var u=["type","name","title","alt"];for(a=0;a<u.length;a++)r=u[a],(i=t.getAttribute(r))&&s.push("["+r+'="'+i+'"]');return s.join("")}function p(t,e){return!!(!!t^!!e)}function d(t,e){if(p(t,e))return!1;var n=t.frames,r=e.frames;if(void 0===n||void 0===r)return!1;if(n.length!==r.length)return!1;for(var i,o,a=0;a<n.length;a++)if(i=n[a],o=r[a],i.filename!==o.filename||i.lineno!==o.lineno||i.colno!==o.colno||i.function!==o.function)return!1;return!0}function v(t){return function(t){return~-encodeURI(t).split(/%..|./).length}(JSON.stringify(t))}function g(t){if("string"==typeof t)return c(t,40);if("number"==typeof t||"boolean"==typeof t||void 0===t)return t;var e=Object.prototype.toString.call(t);return"[object Object]"===e?"[Object]":"[object Array]"===e?"[Array]":"[object Function]"===e?t.name?"[Function: "+t.name+"]":"[Function]":t}var y=n(251),m="undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{},_=3,b=51200,E=40;t.exports={isObject:function(t){return"object"==typeof t&&null!==t},isError:function(t){switch(Object.prototype.toString.call(t)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return t instanceof Error}},isErrorEvent:function(t){return"[object ErrorEvent]"===Object.prototype.toString.call(t)},isDOMError:function(t){return"[object DOMError]"===Object.prototype.toString.call(t)},isDOMException:function(t){return"[object DOMException]"===Object.prototype.toString.call(t)},isUndefined:r,isFunction:function(t){return"function"==typeof t},isPlainObject:i,isString:o,isArray:a,isEmptyObject:function(t){if(!i(t))return!1;for(var e in t)if(t.hasOwnProperty(e))return!1;return!0},supportsErrorEvent:function(){try{return new ErrorEvent(""),!0}catch(t){return!1}},supportsDOMError:function(){try{return new DOMError(""),!0}catch(t){return!1}},supportsDOMException:function(){try{return new DOMException(""),!0}catch(t){return!1}},supportsFetch:s,supportsReferrerPolicy:function(){if(!s())return!1;try{return new Request("pickleRick",{referrerPolicy:"origin"}),!0}catch(t){return!1}},supportsPromiseRejectionEvent:function(){return"function"==typeof PromiseRejectionEvent},wrappedCallback:function(t){return function(e,n){var r=t(e)||e;return n&&n(r)||r}},each:u,objectMerge:function(t,e){return e?(u(e,function(e,n){t[e]=n}),t):t},truncate:c,objectFrozen:function(t){return!!Object.isFrozen&&Object.isFrozen(t)},hasKey:l,joinRegExp:h,urlencode:function(t){var e=[];return u(t,function(t,n){e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))}),e.join("&")},uuid4:function(){var t=m.crypto||m.msCrypto;if(!r(t)&&t.getRandomValues){var e=new Uint16Array(8);t.getRandomValues(e),e[3]=4095&e[3]|16384,e[4]=16383&e[4]|32768;var n=function(t){for(var e=t.toString(16);e.length<4;)e="0"+e;return e};return n(e[0])+n(e[1])+n(e[2])+n(e[3])+n(e[4])+n(e[5])+n(e[6])+n(e[7])}return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})},htmlTreeAsString:function(t){for(var e,n=[],r=0,i=0,o=" > ".length;t&&r++<5&&!("html"===(e=f(t))||r>1&&i+n.length*o+e.length>=80);)n.push(e),i+=e.length,t=t.parentNode;return n.reverse().join(" > ")},htmlElementAsString:f,isSameException:function(t,e){return!p(t,e)&&(t=t.values[0],e=e.values[0],t.type===e.type&&t.value===e.value&&!function(t,e){return r(t)&&r(e)}(t.stacktrace,e.stacktrace)&&d(t.stacktrace,e.stacktrace))},isSameStacktrace:d,parseUrl:function(t){if("string"!=typeof t)return{};var e=t.match(/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/),n=e[6]||"",r=e[8]||"";return{protocol:e[2],host:e[4],path:e[5],relative:e[5]+n+r}},fill:function(t,e,n,r){if(null!=t){var i=t[e];t[e]=n(i),t[e].__raven__=!0,t[e].__orig__=i,r&&r.push([t,e,i])}},safeJoin:function(t,e){if(!a(t))return"";for(var n=[],r=0;r<t.length;r++)try{n.push(String(t[r]))}catch(t){n.push("[value cannot be serialized]")}return n.join(e)},serializeException:function t(e,n,r){if(!i(e))return e;r="number"!=typeof(n="number"!=typeof n?_:n)?b:r;var o=function t(e,n){return 0===n?g(e):i(e)?Object.keys(e).reduce(function(r,i){return r[i]=t(e[i],n-1),r},{}):Array.isArray(e)?e.map(function(e){return t(e,n-1)}):g(e)}(e,n);return v(y(o))>r?t(e,n-1):o},serializeKeysForMessage:function(t,e){if("number"==typeof t||"string"==typeof t)return t.toString();if(!Array.isArray(t))return"";if(0===(t=t.filter(function(t){return"string"==typeof t})).length)return"[object has no keys]";if(e="number"!=typeof e?E:e,t[0].length>=e)return t[0];for(var n=t.length;n>0;n--){var r=t.slice(0,n).join(", ");if(!(r.length>e))return n===t.length?r:r+"…"}return""},sanitize:function(t,e){if(!a(e)||a(e)&&0===e.length)return t;var n,r=h(e),o="********";try{n=JSON.parse(y(t))}catch(e){return t}return function t(e){return a(e)?e.map(function(e){return t(e)}):i(e)?Object.keys(e).reduce(function(n,i){return r.test(i)?n[i]=o:n[i]=t(e[i]),n},{}):e}(n)}}}).call(this,n(8))},function(t,e,n){function r(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new i;++e<n;)this.add(t[e])}var i=n(166),o=n(641),a=n(642);r.prototype.add=r.prototype.push=o,r.prototype.has=a,t.exports=r},function(t,e,n){function r(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}var i=n(618),o=n(636),a=n(638),s=n(639),u=n(640);r.prototype.clear=i,r.prototype.delete=o,r.prototype.get=a,r.prototype.has=s,r.prototype.set=u,t.exports=r},function(t,e){t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},function(t,e,n){var r=n(67)(n(45),"Map");t.exports=r},function(t,e){t.exports=function(t,e){return t.has(e)}},function(t,e,n){var r=n(648),i=n(68),o=Object.prototype,a=o.hasOwnProperty,s=o.propertyIsEnumerable,u=r(function(){return arguments}())?r:function(t){return i(t)&&a.call(t,"callee")&&!s.call(t,"callee")};t.exports=u},function(t,e){t.exports=function(t){return t}},function(t,e){var n=9007199254740991;t.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=n}},function(t,e){t.exports=function(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}},function(t,e,n){var r=n(683),i=n(688),o=n(274);t.exports=function(t){return o(t)?r(t):i(t)}},function(t,e,n){var r=n(46),i=n(176),o=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;t.exports=function(t,e){if(r(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!i(t))||a.test(t)||!o.test(t)||null!=e&&t in Object(e)}},function(t,e,n){var r=n(75),i=n(68),o="[object Symbol]";t.exports=function(t){return"symbol"==typeof t||i(t)&&r(t)==o}},function(t,e,n){t.exports=!n(10)&&!n(5)(function(){return 7!=Object.defineProperty(n(124)("div"),"a",{get:function(){return 7}}).a})},function(t,e,n){e.f=n(7)},function(t,e,n){var r=n(25),i=n(26),o=n(90)(!1),a=n(126)("IE_PROTO");t.exports=function(t,e){var n,s=i(t),u=0,c=[];for(n in s)n!=a&&r(s,n)&&c.push(n);for(;e.length>u;)r(s,n=e[u++])&&(~o(c,n)||c.push(n));return c}},function(t,e,n){var r=n(11),i=n(2),o=n(54);t.exports=n(10)?Object.defineProperties:function(t,e){i(t);for(var n,a=o(e),s=a.length,u=0;s>u;)r.f(t,n=a[u++],e[n]);return t}},function(t,e,n){var r=n(26),i=n(57).f,o={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return a&&"[object Window]"==o.call(t)?function(t){try{return i(t)}catch(t){return a.slice()}}(t):i(r(t))}},function(t,e,n){"use strict";var r=n(54),i=n(91),o=n(77),a=n(14),s=n(76),u=Object.assign;t.exports=!u||n(5)(function(){var t={},e={},n=Symbol(),r="abcdefghijklmnopqrst";return t[n]=7,r.split("").forEach(function(t){e[t]=t}),7!=u({},t)[n]||Object.keys(u({},e)).join("")!=r})?function(t,e){for(var n=a(t),u=arguments.length,c=1,l=i.f,h=o.f;u>c;)for(var f,p=s(arguments[c++]),d=l?r(p).concat(l(p)):r(p),v=d.length,g=0;v>g;)h.call(p,f=d[g++])&&(n[f]=p[f]);return n}:u},function(t,e,n){"use strict";var r=n(17),i=n(6),o=n(184),a=[].slice,s={},u=function(t,e,n){if(!(e in s)){for(var r=[],i=0;i<e;i++)r[i]="a["+i+"]";s[e]=Function("F,a","return new F("+r.join(",")+")")}return s[e](t,n)};t.exports=Function.bind||function(t){var e=r(this),n=a.call(arguments,1),s=function(){var r=n.concat(a.call(arguments));return this instanceof s?u(e,r.length,r):o(e,r,t)};return i(e.prototype)&&(s.prototype=e.prototype),s}},function(t,e){t.exports=function(t,e,n){var r=void 0===n;switch(e.length){case 0:return r?t():t.call(n);case 1:return r?t(e[0]):t.call(n,e[0]);case 2:return r?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return r?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return r?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)}},function(t,e,n){var r=n(3).parseInt,i=n(70).trim,o=n(130),a=/^[-+]?0[xX]/;t.exports=8!==r(o+"08")||22!==r(o+"0x16")?function(t,e){var n=i(String(t),3);return r(n,e>>>0||(a.test(n)?16:10))}:r},function(t,e,n){var r=n(3).parseFloat,i=n(70).trim;t.exports=1/r(n(130)+"-0")!=-1/0?function(t){var e=i(String(t),3),n=r(e);return 0===n&&"-"==e.charAt(0)?-0:n}:r},function(t,e,n){var r=n(31);t.exports=function(t,e){if("number"!=typeof t&&"Number"!=r(t))throw TypeError(e);return+t}},function(t,e,n){var r=n(6),i=Math.floor;t.exports=function(t){return!r(t)&&isFinite(t)&&i(t)===t}},function(t,e){t.exports=Math.log1p||function(t){return(t=+t)>-1e-8&&t<1e-8?t-t*t/2:Math.log(1+t)}},function(t,e,n){var r=n(133),i=Math.pow,o=i(2,-52),a=i(2,-23),s=i(2,127)*(2-a),u=i(2,-126);t.exports=Math.fround||function(t){var e,n,i=Math.abs(t),c=r(t);return i<u?c*function(t){return t+1/o-1/o}(i/u/a)*u*a:(n=(e=(1+a/o)*i)-(e-i))>s||n!=n?c*(1/0):c*n}},function(t,e,n){var r=n(2);t.exports=function(t,e,n,i){try{return i?e(r(n)[0],n[1]):e(n)}catch(e){var o=t.return;throw void 0!==o&&r(o.call(t)),e}}},function(t,e,n){var r=n(17),i=n(14),o=n(76),a=n(12);t.exports=function(t,e,n,s,u){r(e);var c=i(t),l=o(c),h=a(c.length),f=u?h-1:0,p=u?-1:1;if(n<2)for(;;){if(f in l){s=l[f],f+=p;break}if(f+=p,u?f<0:h<=f)throw TypeError("Reduce of empty array with no initial value")}for(;u?f>=0:h>f;f+=p)f in l&&(s=e(s,l[f],f,c));return s}},function(t,e,n){"use strict";var r=n(14),i=n(55),o=n(12);t.exports=[].copyWithin||function(t,e){var n=r(this),a=o(n.length),s=i(t,a),u=i(e,a),c=arguments.length>2?arguments[2]:void 0,l=Math.min((void 0===c?a:i(c,a))-u,a-s),h=1;for(u<s&&s<u+l&&(h=-1,u+=l-1,s+=l-1);l-- >0;)u in n?n[s]=n[u]:delete n[s],s+=h,u+=h;return n}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,n){n(10)&&"g"!=/./g.flags&&n(11).f(RegExp.prototype,"flags",{configurable:!0,get:n(95)})},function(t,e){t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},function(t,e,n){var r=n(2),i=n(6),o=n(148);t.exports=function(t,e){if(r(t),i(e)&&e.constructor===t)return e;var n=o.f(t);return(0,n.resolve)(e),n.promise}},function(t,e,n){"use strict";var r=n(199),i=n(72);t.exports=n(98)("Map",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function(t){var e=r.getEntry(i(this,"Map"),t);return e&&e.v},set:function(t,e){return r.def(i(this,"Map"),0===t?0:t,e)}},r,!0)},function(t,e,n){"use strict";var r=n(11).f,i=n(56),o=n(61),a=n(30),s=n(59),u=n(60),c=n(136),l=n(194),h=n(58),f=n(10),p=n(47).fastKey,d=n(72),v=f?"_s":"size",g=function(t,e){var n,r=p(e);if("F"!==r)return t._i[r];for(n=t._f;n;n=n.n)if(n.k==e)return n};t.exports={getConstructor:function(t,e,n,c){var l=t(function(t,r){s(t,l,e,"_i"),t._t=e,t._i=i(null),t._f=void 0,t._l=void 0,t[v]=0,null!=r&&u(r,n,t[c],t)});return o(l.prototype,{clear:function(){for(var t=d(this,e),n=t._i,r=t._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete n[r.i];t._f=t._l=void 0,t[v]=0},delete:function(t){var n=d(this,e),r=g(n,t);if(r){var i=r.n,o=r.p;delete n._i[r.i],r.r=!0,o&&(o.n=i),i&&(i.p=o),n._f==r&&(n._f=i),n._l==r&&(n._l=o),n[v]--}return!!r},forEach:function(t){d(this,e);for(var n,r=a(t,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(r(n.v,n.k,this);n&&n.r;)n=n.p},has:function(t){return!!g(d(this,e),t)}}),f&&r(l.prototype,"size",{get:function(){return d(this,e)[v]}}),l},def:function(t,e,n){var r,i,o=g(t,e);return o?o.v=n:(t._l=o={i:i=p(e,!0),k:e,v:n,p:r=t._l,n:void 0,r:!1},t._f||(t._f=o),r&&(r.n=o),t[v]++,"F"!==i&&(t._i[i]=o)),t},getEntry:g,setStrong:function(t,e,n){c(t,e,function(t,n){this._t=d(t,e),this._k=n,this._l=void 0},function(){for(var t=this,e=t._k,n=t._l;n&&n.r;)n=n.p;return t._t&&(t._l=n=n?n.n:t._t._f)?l(0,"keys"==e?n.k:"values"==e?n.v:[n.k,n.v]):(t._t=void 0,l(1))},n?"entries":"values",!n,!0),h(e)}}},function(t,e,n){"use strict";var r=n(199),i=n(72);t.exports=n(98)("Set",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return r.def(i(this,"Set"),t=0===t?0:t,t)}},r)},function(t,e,n){"use strict";var r,i=n(39)(0),o=n(21),a=n(47),s=n(182),u=n(202),c=n(6),l=n(5),h=n(72),f=a.getWeak,p=Object.isExtensible,d=u.ufstore,v={},g=function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},y={get:function(t){if(c(t)){var e=f(t);return!0===e?d(h(this,"WeakMap")).get(t):e?e[this._i]:void 0}},set:function(t,e){return u.def(h(this,"WeakMap"),t,e)}},m=t.exports=n(98)("WeakMap",g,y,u,!0,!0);l(function(){return 7!=(new m).set((Object.freeze||Object)(v),7).get(v)})&&(s((r=u.getConstructor(g,"WeakMap")).prototype,y),a.NEED=!0,i(["delete","has","get","set"],function(t){var e=m.prototype,n=e[t];o(e,t,function(e,i){if(c(e)&&!p(e)){this._f||(this._f=new r);var o=this._f[t](e,i);return"set"==t?this:o}return n.call(this,e,i)})}))},function(t,e,n){"use strict";var r=n(61),i=n(47).getWeak,o=n(2),a=n(6),s=n(59),u=n(60),c=n(39),l=n(25),h=n(72),f=c(5),p=c(6),d=0,v=function(t){return t._l||(t._l=new g)},g=function(){this.a=[]},y=function(t,e){return f(t.a,function(t){return t[0]===e})};g.prototype={get:function(t){var e=y(this,t);if(e)return e[1]},has:function(t){return!!y(this,t)},set:function(t,e){var n=y(this,t);n?n[1]=e:this.a.push([t,e])},delete:function(t){var e=p(this.a,function(e){return e[0]===t});return~e&&this.a.splice(e,1),!!~e}},t.exports={getConstructor:function(t,e,n,o){var c=t(function(t,r){s(t,c,e,"_i"),t._t=e,t._i=d++,t._l=void 0,null!=r&&u(r,n,t[o],t)});return r(c.prototype,{delete:function(t){if(!a(t))return!1;var n=i(t);return!0===n?v(h(this,e)).delete(t):n&&l(n,this._i)&&delete n[this._i]},has:function(t){if(!a(t))return!1;var n=i(t);return!0===n?v(h(this,e)).has(t):n&&l(n,this._i)}}),c},def:function(t,e,n){var r=i(o(e),!0);return!0===r?v(t).set(e,n):r[t._i]=n,t},ufstore:v}},function(t,e,n){var r=n(37),i=n(12);t.exports=function(t){if(void 0===t)return 0;var e=r(t),n=i(e);if(e!==n)throw RangeError("Wrong length!");return n}},function(t,e,n){var r=n(57),i=n(91),o=n(2),a=n(3).Reflect;t.exports=a&&a.ownKeys||function(t){var e=r.f(o(t)),n=i.f;return n?e.concat(n(t)):e}},function(t,e,n){"use strict";var r=n(92),i=n(6),o=n(12),a=n(30),s=n(7)("isConcatSpreadable");t.exports=function t(e,n,u,c,l,h,f,p){for(var d,v,g=l,y=0,m=!!f&&a(f,p,3);y<c;){if(y in u){if(d=m?m(u[y],y,n):u[y],v=!1,i(d)&&(v=void 0!==(v=d[s])?!!v:r(d)),v&&h>0)g=t(e,n,d,o(d.length),g,h-1)-1;else{if(g>=9007199254740991)throw TypeError();e[g]=d}g++}y++}return g}},function(t,e,n){var r=n(12),i=n(132),o=n(36);t.exports=function(t,e,n,a){var s=String(o(t)),u=s.length,c=void 0===n?" ":String(n),l=r(e);if(l<=u||""==c)return s;var h=l-u,f=i.call(c,Math.ceil(h/c.length));return f.length>h&&(f=f.slice(0,h)),a?f+s:s+f}},function(t,e,n){var r=n(54),i=n(26),o=n(77).f;t.exports=function(t){return function(e){for(var n,a=i(e),s=r(a),u=s.length,c=0,l=[];u>c;)o.call(a,n=s[c++])&&l.push(t?[n,a[n]]:a[n]);return l}}},function(t,e,n){var r=n(78),i=n(209);t.exports=function(t){return function(){if(r(this)!=t)throw TypeError(t+"#toJSON isn't generic");return i(this)}}},function(t,e,n){var r=n(60);t.exports=function(t,e){var n=[];return r(t,!1,n.push,n,e),n}},function(t,e){t.exports=Math.scale||function(t,e,n,r,i){return 0===arguments.length||t!=t||e!=e||n!=n||r!=r||i!=i?NaN:t===1/0||t===-1/0?t:(t-e)*(i-r)/(n-e)+r}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(153);e.assert=function(t,n){if(!t)throw e.assertionError(n)},e.assertionError=function(t){return new Error("Firebase Database ("+r.CONSTANTS.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e};e.base64={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],a=i+1<t.length,s=a?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,l=o>>2,h=(3&o)<<4|s>>4,f=(15&s)<<2|c>>6,p=63&c;u||(p=64,a||(f=64)),r.push(n[l],n[h],n[f],n[p])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(r(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var a=((7&i)<<18|(63&(o=t[n++]))<<12|(63&(s=t[n++]))<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(a>>10)),e[r++]=String.fromCharCode(56320+(1023&a))}else{o=t[n++];var s=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0,s=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==a||null==s||null==u)throw Error();var c=o<<2|a>>4;if(r.push(c),64!=s){var l=a<<4&240|s>>2;if(r.push(l),64!=u){var h=s<<6&192|u;r.push(h)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},e.base64Encode=function(t){var n=r(t);return e.base64.encodeByteArray(n,!0)},e.base64Decode=function(t){try{return e.base64.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.jsonEval=function(t){return JSON.parse(t)},e.stringify=function(t){return JSON.stringify(t)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.contains=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.safeGet=function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]},e.forEach=function(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])},e.extend=function(t,n){return e.forEach(n,function(e,n){t[e]=n}),t},e.clone=function(t){return e.extend({},t)},e.isNonNullObject=function(t){return"object"==typeof t&&null!==t},e.isEmpty=function(t){for(var e in t)return!1;return!0},e.getCount=function(t){var e=0;for(var n in t)e++;return e},e.map=function(t,e,n){var r={};for(var i in t)r[i]=e.call(n,t[i],i,t);return r},e.findKey=function(t,e,n){for(var r in t)if(e.call(n,t[r],r,t))return r},e.findValue=function(t,n,r){var i=e.findKey(t,n,r);return i&&t[i]},e.getAnyKey=function(t){for(var e in t)return e},e.getValues=function(t){var e=[],n=0;for(var r in t)e[n++]=t[r];return e},e.every=function(t,e){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&!e(n,t[n]))return!1;return!0}},function(t,e,n){t.exports=n(520)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(4),i=n(217),o=n(13),a=n(155),s=n(110),u=n(160),c=n(1),l=n(63),h=function(){function t(t){this.repo_=t,t instanceof s.Repo||r.fatal("Don't call new Database() directly - please use firebase.database()."),this.root_=new a.Reference(t,o.Path.Empty),this.INTERNAL=new f(this)}return Object.defineProperty(t.prototype,"app",{get:function(){return this.repo_.app},enumerable:!0,configurable:!0}),t.prototype.ref=function(t){return this.checkDeleted_("ref"),c.validateArgCount("database.ref",0,1,arguments.length),void 0!==t?this.root_.child(t):this.root_},t.prototype.refFromURL=function(t){var e="database.refFromURL";this.checkDeleted_(e),c.validateArgCount(e,1,1,arguments.length);var n=i.parseRepoInfo(t);l.validateUrl(e,1,n);var o=n.repoInfo;return o.host!==this.repo_.repoInfo_.host&&r.fatal(e+": Host name does not match the current database: (found "+o.host+" but expected "+this.repo_.repoInfo_.host+")"),this.ref(n.path.toString())},t.prototype.checkDeleted_=function(t){null===this.repo_&&r.fatal("Cannot call "+t+" on a deleted database.")},t.prototype.goOffline=function(){c.validateArgCount("database.goOffline",0,0,arguments.length),this.checkDeleted_("goOffline"),this.repo_.interrupt()},t.prototype.goOnline=function(){c.validateArgCount("database.goOnline",0,0,arguments.length),this.checkDeleted_("goOnline"),this.repo_.resume()},t.ServerValue={TIMESTAMP:{".sv":"timestamp"}},t}();e.Database=h;var f=function(){function t(t){this.database=t}return t.prototype.delete=function(){return this.database.checkDeleted_("delete"),u.RepoManager.getInstance().deleteRepo(this.database.repo_),this.database.repo_=null,this.database.root_=null,this.database.INTERNAL=null,this.database=null,Promise.resolve()},t}();e.DatabaseInternals=f},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(13),i=n(218),o=n(4);e.parseRepoInfo=function(t){var n=e.parseURL(t),a=n.subdomain;"firebase"===n.domain&&o.fatal(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),a&&"undefined"!=a||"localhost"===n.domain||o.fatal("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||o.warnIfPageIsSecure();var s="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new i.RepoInfo(n.host,n.secure,a,s),path:new r.Path(n.pathString)}},e.parseURL=function(t){var e="",n="",r="",i="",o=!0,a="https",s=443;if("string"==typeof t){var u=t.indexOf("//");u>=0&&(a=t.substring(0,u-1),t=t.substring(u+2));var c=t.indexOf("/");-1===c&&(c=t.length),e=t.substring(0,c),i=function(t){for(var e="",n=t.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(t){}e+="/"+i}return e}(t.substring(c)),(u=e.indexOf(":"))>=0?(o="https"===a||"wss"===a,s=parseInt(e.substring(u+1),10)):u=t.length;var l=e.split(".");3===l.length?(n=l[1],r=l[0].toLowerCase()):2===l.length?n=l[0]:"localhost"===l[0].slice(0,u).toLowerCase()&&(n="localhost")}return{host:e,port:s,domain:n,subdomain:r,secure:o,scheme:a,pathString:i}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=n(1),o=n(105),a=n(106),s=function(){function t(t,e,n,r,i){void 0===i&&(i=""),this.secure=e,this.namespace=n,this.webSocketOnly=r,this.persistenceKey=i,this.host=t.toLowerCase(),this.domain=this.host.substr(this.host.indexOf(".")+1),this.internalHost=o.PersistentStorage.get("host:"+t)||this.host}return t.prototype.needsQueryParam=function(){return this.host!==this.internalHost},t.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},t.prototype.isDemoHost=function(){return"firebaseio-demo.com"===this.domain},t.prototype.isCustomHost=function(){return"firebaseio.com"!==this.domain&&"firebaseio-demo.com"!==this.domain},t.prototype.updateHost=function(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&o.PersistentStorage.set("host:"+this.host,this.internalHost))},t.prototype.connectionURL=function(t,e){var n;if(r.assert("string"==typeof t,"typeof type must == string"),r.assert("object"==typeof e,"typeof params must == object"),t===a.WEBSOCKET)n=(this.secure?"wss://":"ws://")+this.internalHost+"/.ws?";else{if(t!==a.LONG_POLLING)throw new Error("Unknown connection type: "+t);n=(this.secure?"https://":"http://")+this.internalHost+"/.lp?"}this.needsQueryParam()&&(e.ns=this.namespace);var o=[];return i.forEach(e,function(t,e){o.push(t+"="+e)}),n+o.join("&")},t.prototype.toString=function(){var t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t},t.prototype.toURLString=function(){return(this.secure?"https://":"http://")+this.host},t}();e.RepoInfo=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=n(63),o=n(4),a=n(1),s=function(){function t(t,e){this.repo_=t,this.path_=e}return t.prototype.cancel=function(t){r.validateArgCount("OnDisconnect.cancel",0,1,arguments.length),r.validateCallback("OnDisconnect.cancel",1,t,!0);var e=new a.Deferred;return this.repo_.onDisconnectCancel(this.path_,e.wrapCallback(t)),e.promise},t.prototype.remove=function(t){r.validateArgCount("OnDisconnect.remove",0,1,arguments.length),i.validateWritablePath("OnDisconnect.remove",this.path_),r.validateCallback("OnDisconnect.remove",1,t,!0);var e=new a.Deferred;return this.repo_.onDisconnectSet(this.path_,null,e.wrapCallback(t)),e.promise},t.prototype.set=function(t,e){r.validateArgCount("OnDisconnect.set",1,2,arguments.length),i.validateWritablePath("OnDisconnect.set",this.path_),i.validateFirebaseDataArg("OnDisconnect.set",1,t,this.path_,!1),r.validateCallback("OnDisconnect.set",2,e,!0);var n=new a.Deferred;return this.repo_.onDisconnectSet(this.path_,t,n.wrapCallback(e)),n.promise},t.prototype.setWithPriority=function(t,e,n){r.validateArgCount("OnDisconnect.setWithPriority",2,3,arguments.length),i.validateWritablePath("OnDisconnect.setWithPriority",this.path_),i.validateFirebaseDataArg("OnDisconnect.setWithPriority",1,t,this.path_,!1),i.validatePriority("OnDisconnect.setWithPriority",2,e,!1),r.validateCallback("OnDisconnect.setWithPriority",3,n,!0);var o=new a.Deferred;return this.repo_.onDisconnectSetWithPriority(this.path_,t,e,o.wrapCallback(n)),o.promise},t.prototype.update=function(t,e){if(r.validateArgCount("OnDisconnect.update",1,2,arguments.length),i.validateWritablePath("OnDisconnect.update",this.path_),Array.isArray(t)){for(var n={},s=0;s<t.length;++s)n[""+s]=t[s];t=n,o.warn("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}i.validateFirebaseMergeDataArg("OnDisconnect.update",1,t,this.path_,!1),r.validateCallback("OnDisconnect.update",2,e,!0);var u=new a.Deferred;return this.repo_.onDisconnectUpdate(this.path_,t,u.wrapCallback(e)),u.promise},t}();e.OnDisconnect=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(1),o=n(81),a=n(19),s=n(222),u=n(226),c=n(4),l=n(13),h=n(63),f=n(1),p=n(525),d=n(1),v=function(){function t(t,e,n,r){this.repo=t,this.path=e,this.queryParams_=n,this.orderByCalled_=r}return Object.defineProperty(t,"__referenceConstructor",{get:function(){return i.assert(r,"Reference.ts has not been loaded"),r},set:function(t){r=t},enumerable:!0,configurable:!0}),t.validateQueryEndpoints_=function(t){var e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===o.KEY_INDEX){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",l="Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!=c.MIN_NAME)throw new Error(r);if("string"!=typeof e)throw new Error(l)}if(t.hasEnd()){if(t.getIndexEndName()!=c.MAX_NAME)throw new Error(r);if("string"!=typeof n)throw new Error(l)}}else if(t.getIndex()===a.PRIORITY_INDEX){if(null!=e&&!h.isValidPriority(e)||null!=n&&!h.isValidPriority(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), endAt(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(i.assert(t.getIndex()instanceof u.PathIndex||t.getIndex()===s.VALUE_INDEX,"unknown index type."),null!=e&&"object"==typeof e||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), endAt(), or equalTo() cannot be an object.")},t.validateLimit_=function(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), endAt(), and limit(). Use limitToFirst() or limitToLast() instead.")},t.prototype.validateNoPreviousOrderByCall_=function(t){if(!0===this.orderByCalled_)throw new Error(t+": You can't combine multiple orderBy calls.")},t.prototype.getQueryParams=function(){return this.queryParams_},t.prototype.getRef=function(){return f.validateArgCount("Query.ref",0,0,arguments.length),new t.__referenceConstructor(this.repo,this.path)},t.prototype.on=function(e,n,r,i){f.validateArgCount("Query.on",2,4,arguments.length),h.validateEventType("Query.on",1,e,!1),f.validateCallback("Query.on",2,n,!1);var o=t.getCancelAndContextArgs_("Query.on",r,i);if("value"===e)this.onValueEvent(n,o.cancel,o.context);else{var a={};a[e]=n,this.onChildEvent(a,o.cancel,o.context)}return n},t.prototype.onValueEvent=function(t,e,n){var r=new p.ValueEventRegistration(t,e||null,n||null);this.repo.addEventCallbackForQuery(this,r)},t.prototype.onChildEvent=function(t,e,n){var r=new p.ChildEventRegistration(t,e,n);this.repo.addEventCallbackForQuery(this,r)},t.prototype.off=function(t,e,n){f.validateArgCount("Query.off",0,3,arguments.length),h.validateEventType("Query.off",1,t,!0),f.validateCallback("Query.off",2,e,!0),f.validateContextObject("Query.off",3,n,!0);var r=null,i=null;if("value"===t){var o=e||null;r=new p.ValueEventRegistration(o,null,n||null)}else t&&(e&&((i={})[t]=e),r=new p.ChildEventRegistration(i,null,n||null));this.repo.removeEventCallbackForQuery(this,r)},t.prototype.once=function(e,n,r,i){var o=this;f.validateArgCount("Query.once",1,4,arguments.length),h.validateEventType("Query.once",1,e,!1),f.validateCallback("Query.once",2,n,!0);var a=t.getCancelAndContextArgs_("Query.once",r,i),s=!0,u=new d.Deferred;u.promise.catch(function(){});var c=function(t){s&&(s=!1,o.off(e,c),n&&n.bind(a.context)(t),u.resolve(t))};return this.on(e,c,function(t){o.off(e,c),a.cancel&&a.cancel.bind(a.context)(t),u.reject(t)}),u.promise},t.prototype.limitToFirst=function(e){if(f.validateArgCount("Query.limitToFirst",1,1,arguments.length),"number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("Query.limitToFirst: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToFirst: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new t(this.repo,this.path,this.queryParams_.limitToFirst(e),this.orderByCalled_)},t.prototype.limitToLast=function(e){if(f.validateArgCount("Query.limitToLast",1,1,arguments.length),"number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("Query.limitToLast: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToLast: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new t(this.repo,this.path,this.queryParams_.limitToLast(e),this.orderByCalled_)},t.prototype.orderByChild=function(e){if(f.validateArgCount("Query.orderByChild",1,1,arguments.length),"$key"===e)throw new Error('Query.orderByChild: "$key" is invalid.  Use Query.orderByKey() instead.');if("$priority"===e)throw new Error('Query.orderByChild: "$priority" is invalid.  Use Query.orderByPriority() instead.');if("$value"===e)throw new Error('Query.orderByChild: "$value" is invalid.  Use Query.orderByValue() instead.');h.validatePathString("Query.orderByChild",1,e,!1),this.validateNoPreviousOrderByCall_("Query.orderByChild");var n=new l.Path(e);if(n.isEmpty())throw new Error("Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.");var r=new u.PathIndex(n),i=this.queryParams_.orderBy(r);return t.validateQueryEndpoints_(i),new t(this.repo,this.path,i,!0)},t.prototype.orderByKey=function(){f.validateArgCount("Query.orderByKey",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByKey");var e=this.queryParams_.orderBy(o.KEY_INDEX);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.orderByPriority=function(){f.validateArgCount("Query.orderByPriority",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByPriority");var e=this.queryParams_.orderBy(a.PRIORITY_INDEX);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.orderByValue=function(){f.validateArgCount("Query.orderByValue",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByValue");var e=this.queryParams_.orderBy(s.VALUE_INDEX);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.startAt=function(e,n){void 0===e&&(e=null),f.validateArgCount("Query.startAt",0,2,arguments.length),h.validateFirebaseDataArg("Query.startAt",1,e,this.path,!0),h.validateKey("Query.startAt",2,n,!0);var r=this.queryParams_.startAt(e,n);if(t.validateLimit_(r),t.validateQueryEndpoints_(r),this.queryParams_.hasStart())throw new Error("Query.startAt: Starting point was already set (by another call to startAt or equalTo).");return void 0===e&&(e=null,n=null),new t(this.repo,this.path,r,this.orderByCalled_)},t.prototype.endAt=function(e,n){void 0===e&&(e=null),f.validateArgCount("Query.endAt",0,2,arguments.length),h.validateFirebaseDataArg("Query.endAt",1,e,this.path,!0),h.validateKey("Query.endAt",2,n,!0);var r=this.queryParams_.endAt(e,n);if(t.validateLimit_(r),t.validateQueryEndpoints_(r),this.queryParams_.hasEnd())throw new Error("Query.endAt: Ending point was already set (by another call to endAt or equalTo).");return new t(this.repo,this.path,r,this.orderByCalled_)},t.prototype.equalTo=function(t,e){if(f.validateArgCount("Query.equalTo",1,2,arguments.length),h.validateFirebaseDataArg("Query.equalTo",1,t,this.path,!1),h.validateKey("Query.equalTo",2,e,!0),this.queryParams_.hasStart())throw new Error("Query.equalTo: Starting point was already set (by another call to startAt or equalTo).");if(this.queryParams_.hasEnd())throw new Error("Query.equalTo: Ending point was already set (by another call to endAt or equalTo).");return this.startAt(t,e).endAt(t,e)},t.prototype.toString=function(){return f.validateArgCount("Query.toString",0,0,arguments.length),this.repo.toString()+this.path.toUrlEncodedString()},t.prototype.toJSON=function(){return f.validateArgCount("Query.toJSON",0,1,arguments.length),this.toString()},t.prototype.queryObject=function(){return this.queryParams_.getQueryObject()},t.prototype.queryIdentifier=function(){var t=this.queryObject(),e=c.ObjectToUniqueKey(t);return"{}"===e?"default":e},t.prototype.isEqual=function(e){if(f.validateArgCount("Query.isEqual",1,1,arguments.length),!(e instanceof t))throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.");var n=this.repo===e.repo,r=this.path.equals(e.path),i=this.queryIdentifier()===e.queryIdentifier();return n&&r&&i},t.getCancelAndContextArgs_=function(t,e,n){var r={cancel:null,context:null};if(e&&n)r.cancel=e,f.validateCallback(t,3,r.cancel,!0),r.context=n,f.validateContextObject(t,4,r.context,!0);else if(e)if("object"==typeof e&&null!==e)r.context=e;else{if("function"!=typeof e)throw new Error(f.errorPrefix(t,3,!0)+" must either be a cancel callback or a context object.");r.cancel=e}return r},Object.defineProperty(t.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),t}();e.Query=v},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(1),o=n(4),a=n(1);e.setMaxNode=function(t){r=t},e.priorityHashText=function(t){return"number"==typeof t?"number:"+o.doubleToIEEE754String(t):"string:"+t},e.validatePriorityNode=function(t){if(t.isLeafNode()){var e=t.val();i.assert("string"==typeof e||"number"==typeof e||"object"==typeof e&&a.contains(e,".sv"),"Priority must be a string or number.")}else i.assert(t===r||t.isEmpty(),"priority of unexpected type.");i.assert(t===r||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")}},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n(107),o=n(29),a=n(4),s=n(82),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.compare=function(t,e){var n=t.node.compareTo(e.node);return 0===n?a.nameCompare(t.name,e.name):n},e.prototype.isDefinedOn=function(t){return!0},e.prototype.indexedValueChanged=function(t,e){return!t.equals(e)},e.prototype.minPost=function(){return o.NamedNode.MIN},e.prototype.maxPost=function(){return o.NamedNode.MAX},e.prototype.makePost=function(t,e){var n=s.nodeFromJSON(t);return new o.NamedNode(e,n)},e.prototype.toString=function(){return".value"},e}(i.Index);e.ValueIndex=u,e.VALUE_INDEX=new u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(1),o=n(224),a=n(1),s=n(29),u=n(19),c=n(81),l={},h=function(){function t(t,e){this.indexes_=t,this.indexSet_=e}return Object.defineProperty(t,"Default",{get:function(){return i.assert(l&&u.PRIORITY_INDEX,"ChildrenNode.ts has not been loaded"),r=r||new t({".priority":l},{".priority":u.PRIORITY_INDEX})},enumerable:!0,configurable:!0}),t.prototype.get=function(t){var e=a.safeGet(this.indexes_,t);if(!e)throw new Error("No index defined for "+t);return e===l?null:e},t.prototype.hasIndex=function(t){return a.contains(this.indexSet_,t.toString())},t.prototype.addIndex=function(e,n){i.assert(e!==c.KEY_INDEX,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var r=[],u=!1,h=n.getIterator(s.NamedNode.Wrap),f=h.getNext();f;)u=u||e.isDefinedOn(f.node),r.push(f),f=h.getNext();var p;p=u?o.buildChildSet(r,e.getCompare()):l;var d=e.toString(),v=a.clone(this.indexSet_);v[d]=e;var g=a.clone(this.indexes_);return g[d]=p,new t(g,v)},t.prototype.addToIndexes=function(e,n){var r=this;return new t(a.map(this.indexes_,function(t,u){var c=a.safeGet(r.indexSet_,u);if(i.assert(c,"Missing index implementation for "+u),t===l){if(c.isDefinedOn(e.node)){for(var h=[],f=n.getIterator(s.NamedNode.Wrap),p=f.getNext();p;)p.name!=e.name&&h.push(p),p=f.getNext();return h.push(e),o.buildChildSet(h,c.getCompare())}return l}var d=n.get(e.name),v=t;return d&&(v=v.remove(new s.NamedNode(e.name,d))),v.insert(e,e.node)}),this.indexSet_)},t.prototype.removeFromIndexes=function(e,n){return new t(a.map(this.indexes_,function(t){if(t===l)return t;var r=n.get(e.name);return r?t.remove(new s.NamedNode(e.name,r)):t}),this.indexSet_)},t}();e.IndexMap=h},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(109),i=n(109),o=Math.log(2),a=function(){function t(t){this.count=function(t){return parseInt(Math.log(t)/o,10)}(t+1),this.current_=this.count-1;var e=function(t){return parseInt(Array(t+1).join("1"),2)}(this.count);this.bits_=t+1&e}return t.prototype.nextBitIsOne=function(){var t=!(this.bits_&1<<this.current_);return this.current_--,t},t}();e.buildChildSet=function(t,e,n,o){t.sort(e);var s=function(e,i){var o,a,u=i-e;if(0==u)return null;if(1==u)return o=t[e],a=n?n(o):o,new r.LLRBNode(a,o.node,r.LLRBNode.BLACK,null,null);var c=parseInt(u/2,10)+e,l=s(e,c),h=s(c+1,i);return o=t[c],a=n?n(o):o,new r.LLRBNode(a,o.node,r.LLRBNode.BLACK,l,h)},u=function(e){for(var i=null,o=null,a=t.length,u=function(e,i){var o=a-e,u=a;a-=e;var l=s(o+1,u),h=t[o],f=n?n(h):h;c(new r.LLRBNode(f,h.node,i,null,l))},c=function(t){i?(i.left=t,i=t):(o=t,i=t)},l=0;l<e.count;++l){var h=e.nextBitIsOne(),f=Math.pow(2,e.count-(l+1));h?u(f,r.LLRBNode.BLACK):(u(f,r.LLRBNode.BLACK),u(f,r.LLRBNode.RED))}return o}(new a(t.length));return new i.SortedMap(o||e,u)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(4);e.NAME_ONLY_COMPARATOR=function(t,e){return r.nameCompare(t.name,e.name)},e.NAME_COMPARATOR=function(t,e){return r.nameCompare(t,e)}},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),o=n(4),a=n(107),s=n(24),u=n(29),c=n(82),l=function(t){function e(e){var n=t.call(this)||this;return n.indexPath_=e,i.assert(!e.isEmpty()&&".priority"!==e.getFront(),"Can't create PathIndex with empty path or .priority key"),n}return r(e,t),e.prototype.extractChild=function(t){return t.getChild(this.indexPath_)},e.prototype.isDefinedOn=function(t){return!t.getChild(this.indexPath_).isEmpty()},e.prototype.compare=function(t,e){var n=this.extractChild(t.node),r=this.extractChild(e.node),i=n.compareTo(r);return 0===i?o.nameCompare(t.name,e.name):i},e.prototype.makePost=function(t,e){var n=c.nodeFromJSON(t),r=s.ChildrenNode.EMPTY_NODE.updateChild(this.indexPath_,n);return new u.NamedNode(e,r)},e.prototype.maxPost=function(){var t=s.ChildrenNode.EMPTY_NODE.updateChild(this.indexPath_,s.MAX_NODE);return new u.NamedNode(o.MAX_NAME,t)},e.prototype.toString=function(){return this.indexPath_.slice().join("/")},e}(a.Index);e.PathIndex=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=n(13),o=n(228),a=n(108),s=n(82),u=n(19);e.generateWithValues=function(t){return(t=t||{}).timestamp=t.timestamp||(new Date).getTime(),t},e.resolveDeferredValue=function(t,e){return t&&"object"==typeof t?(r.assert(".sv"in t,"Unexpected leaf node or priority contents"),e[t[".sv"]]):t},e.resolveDeferredValueTree=function(t,n){var r=new o.SparseSnapshotTree;return t.forEachTree(new i.Path(""),function(t,i){r.remember(t,e.resolveDeferredValueSnapshot(i,n))}),r},e.resolveDeferredValueSnapshot=function(t,n){var r,i=t.getPriority().val(),o=e.resolveDeferredValue(i,n);if(t.isLeafNode()){var c=t,l=e.resolveDeferredValue(c.getValue(),n);return l!==c.getValue()||o!==c.getPriority().val()?new a.LeafNode(l,s.nodeFromJSON(o)):t}var h=t;return r=h,o!==h.getPriority().val()&&(r=r.updatePriority(new a.LeafNode(o))),h.forEachChild(u.PRIORITY_INDEX,function(t,i){var o=e.resolveDeferredValueSnapshot(i,n);o!==i&&(r=r.updateImmediateChild(t,o))}),r}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(13),i=n(19),o=n(229),a=function(){function t(){this.value_=null,this.children_=null}return t.prototype.find=function(t){if(null!=this.value_)return this.value_.getChild(t);if(t.isEmpty()||null==this.children_)return null;var e=t.getFront();return t=t.popFront(),this.children_.contains(e)?this.children_.get(e).find(t):null},t.prototype.remember=function(e,n){if(e.isEmpty())this.value_=n,this.children_=null;else if(null!==this.value_)this.value_=this.value_.updateChild(e,n);else{null==this.children_&&(this.children_=new o.CountedSet);var r=e.getFront();this.children_.contains(r)||this.children_.add(r,new t);var i=this.children_.get(r);e=e.popFront(),i.remember(e,n)}},t.prototype.forget=function(t){if(t.isEmpty())return this.value_=null,this.children_=null,!0;if(null!==this.value_){if(this.value_.isLeafNode())return!1;var e=this.value_;this.value_=null;var n=this;return e.forEachChild(i.PRIORITY_INDEX,function(t,e){n.remember(new r.Path(t),e)}),this.forget(t)}if(null!==this.children_){var o=t.getFront();return t=t.popFront(),this.children_.contains(o)&&this.children_.get(o).forget(t)&&this.children_.remove(o),!!this.children_.isEmpty()&&(this.children_=null,!0)}return!0},t.prototype.forEachTree=function(t,e){null!==this.value_?e(t,this.value_):this.forEachChild(function(n,i){var o=new r.Path(t.toString()+"/"+n);i.forEachTree(o,e)})},t.prototype.forEachChild=function(t){null!==this.children_&&this.children_.each(function(e,n){t(e,n)})},t}();e.SparseSnapshotTree=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=function(){function t(){this.set={}}return t.prototype.add=function(t,e){this.set[t]=null===e||e},t.prototype.contains=function(t){return r.contains(this.set,t)},t.prototype.get=function(t){return this.contains(t)?this.set[t]:void 0},t.prototype.remove=function(t){delete this.set[t]},t.prototype.clear=function(){this.set={}},t.prototype.isEmpty=function(){return r.isEmpty(this.set)},t.prototype.count=function(){return r.getCount(this.set)},t.prototype.each=function(t){r.forEach(this.set,function(e,n){return t(e,n)})},t.prototype.keys=function(){var t=[];return r.forEach(this.set,function(e){t.push(e)}),t},t}();e.CountedSet=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(64),i=n(13),o=function(){function t(t,e,n){this.source=t,this.path=e,this.snap=n,this.type=r.OperationType.OVERWRITE}return t.prototype.operationForChild=function(e){return this.path.isEmpty()?new t(this.source,i.Path.Empty,this.snap.getImmediateChild(e)):new t(this.source,this.path.popFront(),this.snap)},t}();e.Overwrite=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(111),o=n(24),a=n(1),s=n(1),u=n(232),c=n(531),l=function(){function t(){this.views_={}}return Object.defineProperty(t,"__referenceConstructor",{get:function(){return a.assert(r,"Reference.ts has not been loaded"),r},set:function(t){a.assert(!r,"__referenceConstructor has already been defined"),r=t},enumerable:!0,configurable:!0}),t.prototype.isEmpty=function(){return s.isEmpty(this.views_)},t.prototype.applyOperation=function(t,e,n){var r=t.source.queryId;if(null!==r){var i=s.safeGet(this.views_,r);return a.assert(null!=i,"SyncTree gave us an op for an invalid query."),i.applyOperation(t,e,n)}var o=[];return s.forEach(this.views_,function(r,i){o=o.concat(i.applyOperation(t,e,n))}),o},t.prototype.addEventRegistration=function(t,e,n,r,a){var l=t.queryIdentifier(),h=s.safeGet(this.views_,l);if(!h){var f=n.calcCompleteEventCache(a?r:null),p=!1;f?p=!0:r instanceof o.ChildrenNode?(f=n.calcCompleteEventChildren(r),p=!1):(f=o.ChildrenNode.EMPTY_NODE,p=!1);var d=new u.ViewCache(new i.CacheNode(f,p,!1),new i.CacheNode(r,a,!1));h=new c.View(t,d),this.views_[l]=h}return h.addEventRegistration(e),h.getInitialEvents(e)},t.prototype.removeEventRegistration=function(e,n,r){var i=e.queryIdentifier(),o=[],a=[],u=this.hasCompleteView();if("default"===i){var c=this;s.forEach(this.views_,function(t,e){a=a.concat(e.removeEventRegistration(n,r)),e.isEmpty()&&(delete c.views_[t],e.getQuery().getQueryParams().loadsAllData()||o.push(e.getQuery()))})}else{var l=s.safeGet(this.views_,i);l&&(a=a.concat(l.removeEventRegistration(n,r)),l.isEmpty()&&(delete this.views_[i],l.getQuery().getQueryParams().loadsAllData()||o.push(l.getQuery())))}return u&&!this.hasCompleteView()&&o.push(new t.__referenceConstructor(e.repo,e.path)),{removed:o,events:a}},t.prototype.getQueryViews=function(){var t=this;return Object.keys(this.views_).map(function(e){return t.views_[e]}).filter(function(t){return!t.getQuery().getQueryParams().loadsAllData()})},t.prototype.getCompleteServerCache=function(t){var e=null;return s.forEach(this.views_,function(n,r){e=e||r.getCompleteServerCache(t)}),e},t.prototype.viewForQuery=function(t){if(t.getQueryParams().loadsAllData())return this.getCompleteView();var e=t.queryIdentifier();return s.safeGet(this.views_,e)},t.prototype.viewExistsForQuery=function(t){return null!=this.viewForQuery(t)},t.prototype.hasCompleteView=function(){return null!=this.getCompleteView()},t.prototype.getCompleteView=function(){return s.findValue(this.views_,function(t){return t.getQuery().getQueryParams().loadsAllData()})||null},t}();e.SyncPoint=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(24),i=n(111),o=function(){function t(t,e){this.eventCache_=t,this.serverCache_=e}return t.prototype.updateEventSnap=function(e,n,r){return new t(new i.CacheNode(e,n,r),this.serverCache_)},t.prototype.updateServerSnap=function(e,n,r){return new t(this.eventCache_,new i.CacheNode(e,n,r))},t.prototype.getEventCache=function(){return this.eventCache_},t.prototype.getCompleteEventSnap=function(){return this.eventCache_.isFullyInitialized()?this.eventCache_.getNode():null},t.prototype.getServerCache=function(){return this.serverCache_},t.prototype.getCompleteServerSnap=function(){return this.serverCache_.isFullyInitialized()?this.serverCache_.getNode():null},t.Empty=new t(new i.CacheNode(r.ChildrenNode.EMPTY_NODE,!1,!1),new i.CacheNode(r.ChildrenNode.EMPTY_NODE,!1,!1)),t}();e.ViewCache=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=function(){function t(t){this.collection_=t,this.last_=null}return t.prototype.get=function(){var t=this.collection_.get(),e=r.clone(t);return this.last_&&r.forEach(this.last_,function(t,n){e[t]=e[t]-n}),this.last_=t,e},t}();e.StatsListener=i},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n(16),o=n(1),a=n(1),s=n(1),u=n(4),c=n(13),l=n(543),h=n(544),f=n(1),p=n(236),d=n(1),v=n(1),g=n(239),y=1e3,m=3e5,_=function(t){function e(n,r,i,o,a,s){var c=t.call(this)||this;if(c.repoInfo_=n,c.onDataUpdate_=r,c.onConnectStatus_=i,c.onServerInfoUpdate_=o,c.authTokenProvider_=a,c.authOverride_=s,c.id=e.nextPersistentConnectionId_++,c.log_=u.logWrapper("p:"+c.id+":"),c.interruptReasons_={},c.listens_={},c.outstandingPuts_=[],c.outstandingPutCount_=0,c.onDisconnectRequestQueue_=[],c.connected_=!1,c.reconnectDelay_=y,c.maxReconnectDelay_=m,c.securityDebugCallback_=null,c.lastSessionId=null,c.establishConnectionTimer_=null,c.visible_=!1,c.requestCBHash_={},c.requestNumber_=0,c.realtime_=null,c.authToken_=null,c.forceTokenRefresh_=!1,c.invalidAuthTokenCount_=0,c.firstConnection_=!0,c.lastConnectionAttemptTime_=null,c.lastConnectionEstablishedTime_=null,s&&!v.isNodeSdk())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return c.scheduleConnect_(0),l.VisibilityMonitor.getInstance().on("visible",c.onVisible_,c),-1===n.host.indexOf("fblocal")&&h.OnlineMonitor.getInstance().on("online",c.onOnline_,c),c}return r(e,t),e.prototype.sendRequest=function(t,e,n){var r=++this.requestNumber_,i={r:r,a:t,b:e};this.log_(a.stringify(i)),s.assert(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)},e.prototype.listen=function(t,e,n,r){var i=t.queryIdentifier(),o=t.path.toString();this.log_("Listen called for "+o+" "+i),this.listens_[o]=this.listens_[o]||{},s.assert(t.getQueryParams().isDefault()||!t.getQueryParams().loadsAllData(),"listen() called for non-default but complete query"),s.assert(!this.listens_[o][i],"listen() called twice for same path/queryId.");var a={onComplete:r,hashFn:e,query:t,tag:n};this.listens_[o][i]=a,this.connected_&&this.sendListen_(a)},e.prototype.sendListen_=function(t){var n=this,r=t.query,i=r.path.toString(),o=r.queryIdentifier();this.log_("Listen on "+i+" for "+o);var a={p:i};t.tag&&(a.q=r.queryObject(),a.t=t.tag),a.h=t.hashFn(),this.sendRequest("q",a,function(a){var s=a.d,u=a.s;e.warnOnListenWarnings_(s,r),(n.listens_[i]&&n.listens_[i][o])===t&&(n.log_("listen response",a),"ok"!==u&&n.removeListen_(i,o),t.onComplete&&t.onComplete(u,s))})},e.warnOnListenWarnings_=function(t,e){if(t&&"object"==typeof t&&o.contains(t,"w")){var n=o.safeGet(t,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+e.getQueryParams().getIndex().toString()+'"',i=e.path.toString();u.warn("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+r+" at "+i+" to your security rules for better performance.")}}},e.prototype.refreshAuthToken=function(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},function(){}),this.reduceReconnectDelayIfAdminCredential_(t)},e.prototype.reduceReconnectDelayIfAdminCredential_=function(t){(t&&40===t.length||f.isAdmin(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)},e.prototype.tryAuth=function(){var t=this;if(this.connected_&&this.authToken_){var e=this.authToken_,n=f.isValidFormat(e)?"auth":"gauth",r={cred:e};null===this.authOverride_?r.noauth=!0:"object"==typeof this.authOverride_&&(r.authvar=this.authOverride_),this.sendRequest(n,r,function(n){var r=n.s,i=n.d||"error";t.authToken_===e&&("ok"===r?t.invalidAuthTokenCount_=0:t.onAuthRevoked_(r,i))})}},e.prototype.unlisten=function(t,e){var n=t.path.toString(),r=t.queryIdentifier();this.log_("Unlisten called for "+n+" "+r),s.assert(t.getQueryParams().isDefault()||!t.getQueryParams().loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,t.queryObject(),e)},e.prototype.sendUnlisten_=function(t,e,n,r){this.log_("Unlisten on "+t+" for "+e);var i={p:t};r&&(i.q=n,i.t=r),this.sendRequest("n",i)},e.prototype.onDisconnectPut=function(t,e,n){this.connected_?this.sendOnDisconnect_("o",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:e,onComplete:n})},e.prototype.onDisconnectMerge=function(t,e,n){this.connected_?this.sendOnDisconnect_("om",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:e,onComplete:n})},e.prototype.onDisconnectCancel=function(t,e){this.connected_?this.sendOnDisconnect_("oc",t,null,e):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:e})},e.prototype.sendOnDisconnect_=function(t,e,n,r){var i={p:e,d:n};this.log_("onDisconnect "+t,i),this.sendRequest(t,i,function(t){r&&setTimeout(function(){r(t.s,t.d)},Math.floor(0))})},e.prototype.put=function(t,e,n,r){this.putInternal("p",t,e,n,r)},e.prototype.merge=function(t,e,n,r){this.putInternal("m",t,e,n,r)},e.prototype.putInternal=function(t,e,n,r,i){var o={p:e,d:n};void 0!==i&&(o.h=i),this.outstandingPuts_.push({action:t,request:o,onComplete:r}),this.outstandingPutCount_++;var a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+e)},e.prototype.sendPut_=function(t){var e=this,n=this.outstandingPuts_[t].action,r=this.outstandingPuts_[t].request,i=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(n,r,function(r){e.log_(n+" response",r),delete e.outstandingPuts_[t],e.outstandingPutCount_--,0===e.outstandingPutCount_&&(e.outstandingPuts_=[]),i&&i(r.s,r.d)})},e.prototype.reportStats=function(t){var e=this;if(this.connected_){var n={c:t};this.log_("reportStats",n),this.sendRequest("s",n,function(t){if("ok"!==t.s){var n=t.d;e.log_("reportStats","Error sending stats: "+n)}})}},e.prototype.onDataMessage_=function(t){if("r"in t){this.log_("from server: "+a.stringify(t));var e=t.r,n=this.requestCBHash_[e];n&&(delete this.requestCBHash_[e],n(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}},e.prototype.onDataPush_=function(t,e){this.log_("handleServerMessage",t,e),"d"===t?this.onDataUpdate_(e.p,e.d,!1,e.t):"m"===t?this.onDataUpdate_(e.p,e.d,!0,e.t):"c"===t?this.onListenRevoked_(e.p,e.q):"ac"===t?this.onAuthRevoked_(e.s,e.d):"sd"===t?this.onSecurityDebugPacket_(e):u.error("Unrecognized action received from server: "+a.stringify(t)+"\nAre you using the latest client?")},e.prototype.onReady_=function(t,e){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=e,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},e.prototype.scheduleConnect_=function(t){var e=this;s.assert(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(function(){e.establishConnectionTimer_=null,e.establishConnection_()},Math.floor(t))},e.prototype.onVisible_=function(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=y,this.realtime_||this.scheduleConnect_(0)),this.visible_=t},e.prototype.onOnline_=function(t){t?(this.log_("Browser went online."),this.reconnectDelay_=y,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},e.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_)(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=y),this.lastConnectionEstablishedTime_=null}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();var t=(new Date).getTime()-this.lastConnectionAttemptTime_,e=Math.max(0,this.reconnectDelay_-t);e=Math.random()*e,this.log_("Trying to reconnect in "+e+"ms"),this.scheduleConnect_(e),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)},e.prototype.establishConnection_=function(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;var t=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+e.nextConnectionId_++,o=this,a=this.lastSessionId,c=!1,l=null,h=function(){l?l.close():(c=!0,r())};this.realtime_={close:h,sendRequest:function(t){s.assert(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(t)}};var f=this.forceTokenRefresh_;this.forceTokenRefresh_=!1,this.authTokenProvider_.getToken(f).then(function(e){c?u.log("getToken() completed but was canceled"):(u.log("getToken() completed. Creating connection."),o.authToken_=e&&e.accessToken,l=new p.Connection(i,o.repoInfo_,t,n,r,function(t){u.warn(t+" ("+o.repoInfo_.toString()+")"),o.interrupt("server_kill")},a))}).then(null,function(t){o.log_("Failed to get token: "+t),c||(d.CONSTANTS.NODE_ADMIN&&u.warn(t),h())})}},e.prototype.interrupt=function(t){u.log("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},e.prototype.resume=function(t){u.log("Resuming connection for reason: "+t),delete this.interruptReasons_[t],o.isEmpty(this.interruptReasons_)&&(this.reconnectDelay_=y,this.realtime_||this.scheduleConnect_(0))},e.prototype.handleTimestamp_=function(t){var e=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:e})},e.prototype.cancelSentTransactions_=function(){for(var t=0;t<this.outstandingPuts_.length;t++){var e=this.outstandingPuts_[t];e&&"h"in e.request&&e.queued&&(e.onComplete&&e.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},e.prototype.onListenRevoked_=function(t,e){var n;n=e?e.map(function(t){return u.ObjectToUniqueKey(t)}).join("$"):"default";var r=this.removeListen_(t,n);r&&r.onComplete&&r.onComplete("permission_denied")},e.prototype.removeListen_=function(t,e){var n,r=new c.Path(t).toString();return void 0!==this.listens_[r]?(n=this.listens_[r][e],delete this.listens_[r][e],0===o.getCount(this.listens_[r])&&delete this.listens_[r]):n=void 0,n},e.prototype.onAuthRevoked_=function(t,e){u.log("Auth token revoked: "+t+"/"+e),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==t&&"permission_denied"!==t||++this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken())},e.prototype.onSecurityDebugPacket_=function(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&"undefined"!=typeof console&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))},e.prototype.restoreState_=function(){var t=this;this.tryAuth(),o.forEach(this.listens_,function(e,n){o.forEach(n,function(e,n){t.sendListen_(n)})});for(var e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){var n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}},e.prototype.sendConnectStats_=function(){var t={},e="js";d.CONSTANTS.NODE_ADMIN?e="admin_node":d.CONSTANTS.NODE_CLIENT&&(e="node"),t["sdk."+e+"."+i.default.SDK_VERSION.replace(/\./g,"-")]=1,v.isMobileCordova()?t["framework.cordova"]=1:v.isReactNative()&&(t["framework.reactnative"]=1),this.reportStats(t)},e.prototype.shouldReconnect_=function(){var t=h.OnlineMonitor.getInstance().currentlyOnline();return o.isEmpty(this.interruptReasons_)&&t},e.nextPersistentConnectionId_=0,e.nextConnectionId_=0,e}(g.ServerActions);e.PersistentConnection=_},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=function(){function t(t){this.allowedEvents_=t,this.listeners_={},r.assert(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}return t.prototype.trigger=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Array.isArray(this.listeners_[t]))for(var r=this.listeners_[t].slice(),i=0;i<r.length;i++)r[i].callback.apply(r[i].context,e)},t.prototype.on=function(t,e,n){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:e,context:n});var r=this.getInitialEvent(t);r&&e.apply(n,r)},t.prototype.off=function(t,e,n){this.validateEventType_(t);for(var r=this.listeners_[t]||[],i=0;i<r.length;i++)if(r[i].callback===e&&(!n||n===r[i].context))return void r.splice(i,1)},t.prototype.validateEventType_=function(t){r.assert(this.allowedEvents_.find(function(e){return e===t}),"Unknown event: "+t)},t}();e.EventEmitter=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(4),i=n(105),o=n(106),a=n(545),s=function(){function t(t,e,n,i,o,s,u){this.id=t,this.repoInfo_=e,this.onMessage_=n,this.onReady_=i,this.onDisconnect_=o,this.onKill_=s,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=r.logWrapper("c:"+this.id+":"),this.transportManager_=new a.TransportManager(e),this.log_("Connection created"),this.start_()}return t.prototype.start_=function(){var t=this,e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,void 0,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(function(){t.conn_&&t.conn_.open(n,i)},Math.floor(0));var o=e.healthyTimeout||0;o>0&&(this.healthyTimeout_=r.setTimeoutNonBlocking(function(){t.healthyTimeout_=null,t.isHealthy_||(t.conn_&&t.conn_.bytesReceived>102400?(t.log_("Connection exceeded healthy timeout but has received "+t.conn_.bytesReceived+" bytes.  Marking connection healthy."),t.isHealthy_=!0,t.conn_.markConnectionHealthy()):t.conn_&&t.conn_.bytesSent>10240?t.log_("Connection exceeded healthy timeout but has sent "+t.conn_.bytesSent+" bytes.  Leaving connection alive."):(t.log_("Closing unhealthy connection after timeout."),t.close()))},Math.floor(o)))},t.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},t.prototype.disconnReceiver_=function(t){var e=this;return function(n){t===e.conn_?e.onConnectionLost_(n):t===e.secondaryConn_?(e.log_("Secondary connection lost."),e.onSecondaryConnectionLost_()):e.log_("closing an old connection")}},t.prototype.connReceiver_=function(t){var e=this;return function(n){2!=e.state_&&(t===e.rx_?e.onPrimaryMessageReceived_(n):t===e.secondaryConn_?e.onSecondaryMessageReceived_(n):e.log_("message on old connection"))}},t.prototype.sendRequest=function(t){var e={t:"d",d:t};this.sendData_(e)},t.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},t.prototype.onSecondaryControl_=function(t){if("t"in t){var e=t.t;"a"===e?this.upgradeIfSecondaryHealthy_():"r"===e?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===e&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},t.prototype.onSecondaryMessageReceived_=function(t){var e=r.requireKey("t",t),n=r.requireKey("d",t);if("c"==e)this.onSecondaryControl_(n);else{if("d"!=e)throw new Error("Unknown protocol layer: "+e);this.pendingDataMessages.push(n)}},t.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))},t.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},t.prototype.onPrimaryMessageReceived_=function(t){var e=r.requireKey("t",t),n=r.requireKey("d",t);"c"==e?this.onControl_(n):"d"==e&&this.onDataMessage_(n)},t.prototype.onDataMessage_=function(t){this.onPrimaryResponse_(),this.onMessage_(t)},t.prototype.onPrimaryResponse_=function(){this.isHealthy_||--this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy())},t.prototype.onControl_=function(t){var e=r.requireKey("t",t);if("d"in t){var n=t.d;if("h"===e)this.onHandshake_(n);else if("n"===e){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===e?this.onConnectionShutdown_(n):"r"===e?this.onReset_(n):"e"===e?r.error("Server Error: "+n):"o"===e?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):r.error("Unknown control packet command: "+e)}},t.prototype.onHandshake_=function(t){var e=t.ts,n=t.v,i=t.h;this.sessionId=t.s,this.repoInfo_.updateHost(i),0==this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,e),o.PROTOCOL_VERSION!==n&&r.warn("Protocol version mismatch detected"),this.tryStartUpgrade_())},t.prototype.tryStartUpgrade_=function(){var t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)},t.prototype.startUpgrade_=function(t){var e=this;this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,i),r.setTimeoutNonBlocking(function(){e.secondaryConn_&&(e.log_("Timed out trying to upgrade."),e.secondaryConn_.close())},Math.floor(6e4))},t.prototype.onReset_=function(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.updateHost(t),1===this.state_?this.close():(this.closeConnections_(),this.start_())},t.prototype.onConnectionEstablished_=function(t,e){var n=this;this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(e,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):r.setTimeoutNonBlocking(function(){n.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))},t.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))},t.prototype.onSecondaryConnectionLost_=function(){var t=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==t&&this.rx_!==t||this.close()},t.prototype.onConnectionLost_=function(t){this.conn_=null,t||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(i.PersistentStorage.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},t.prototype.onConnectionShutdown_=function(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()},t.prototype.sendData_=function(t){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(t)},t.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},t.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},t}();e.Connection=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(4),i=n(229),o=n(159),a=n(546),s=n(106),u=n(1),c=n(1);e.FIREBASE_LONGPOLL_START_PARAM="start",e.FIREBASE_LONGPOLL_CLOSE_COMMAND="close",e.FIREBASE_LONGPOLL_COMMAND_CB_NAME="pLPCommand",e.FIREBASE_LONGPOLL_DATA_CB_NAME="pRTLPCB",e.FIREBASE_LONGPOLL_ID_PARAM="id",e.FIREBASE_LONGPOLL_PW_PARAM="pw",e.FIREBASE_LONGPOLL_SERIAL_PARAM="ser",e.FIREBASE_LONGPOLL_CALLBACK_ID_PARAM="cb",e.FIREBASE_LONGPOLL_SEGMENT_NUM_PARAM="seg",e.FIREBASE_LONGPOLL_SEGMENTS_IN_PACKET="ts",e.FIREBASE_LONGPOLL_DATA_PARAM="d",e.FIREBASE_LONGPOLL_DISCONN_FRAME_PARAM="disconn",e.FIREBASE_LONGPOLL_DISCONN_FRAME_REQUEST_PARAM="dframe";var l=function(){function t(t,e,n,i){this.connId=t,this.repoInfo=e,this.transportSessionId=n,this.lastSessionId=i,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=r.logWrapper(t),this.stats_=o.StatsManager.getCollection(e),this.urlFn=function(t){return e.connectionURL(s.LONG_POLLING,t)}}return t.prototype.open=function(t,n){var i=this;this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new a.PacketReceiver(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(function(){i.log_("Timed out trying to connect."),i.onClosed_(),i.connectTimeoutTimer_=null},Math.floor(3e4)),r.executeWhenDOMReady(function(){if(!i.isClosed_){i.scriptTagHolder=new h(function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=t[0],o=t[1],a=t[2];if(t[3],t[4],i.incrementIncomingBytes_(t),i.scriptTagHolder)if(i.connectTimeoutTimer_&&(clearTimeout(i.connectTimeoutTimer_),i.connectTimeoutTimer_=null),i.everConnected_=!0,r==e.FIREBASE_LONGPOLL_START_PARAM)i.id=o,i.password=a;else{if(r!==e.FIREBASE_LONGPOLL_CLOSE_COMMAND)throw new Error("Unrecognized command received: "+r);o?(i.scriptTagHolder.sendNewPolls=!1,i.myPacketOrderer.closeAfter(o,function(){i.onClosed_()})):i.onClosed_()}},function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t[0],r=t[1];i.incrementIncomingBytes_(t),i.myPacketOrderer.handleResponse(n,r)},function(){i.onClosed_()},i.urlFn);var t={};t[e.FIREBASE_LONGPOLL_START_PARAM]="t",t[e.FIREBASE_LONGPOLL_SERIAL_PARAM]=Math.floor(1e8*Math.random()),i.scriptTagHolder.uniqueCallbackIdentifier&&(t[e.FIREBASE_LONGPOLL_CALLBACK_ID_PARAM]=i.scriptTagHolder.uniqueCallbackIdentifier),t[s.VERSION_PARAM]=s.PROTOCOL_VERSION,i.transportSessionId&&(t[s.TRANSPORT_SESSION_PARAM]=i.transportSessionId),i.lastSessionId&&(t[s.LAST_SESSION_PARAM]=i.lastSessionId),!c.isNodeSdk()&&"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf(s.FORGE_DOMAIN)&&(t[s.REFERER_PARAM]=s.FORGE_REF);var n=i.urlFn(t);i.log_("Connecting via long-poll to "+n),i.scriptTagHolder.addTag(n,function(){})}})},t.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},t.forceAllow=function(){t.forceAllow_=!0},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){return t.forceAllow_||!t.forceDisallow_&&"undefined"!=typeof document&&null!=document.createElement&&!r.isChromeExtensionContentScript()&&!r.isWindowsStoreApp()&&!c.isNodeSdk()},t.prototype.markConnectionHealthy=function(){},t.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},t.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},t.prototype.send=function(t){var e=u.stringify(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);for(var n=u.base64Encode(e),i=r.splitStringBySize(n,1840),o=0;o<i.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[o]),this.curSegmentNum++},t.prototype.addDisconnectPingFrame=function(t,n){if(!c.isNodeSdk()){this.myDisconnFrame=document.createElement("iframe");var r={};r[e.FIREBASE_LONGPOLL_DISCONN_FRAME_REQUEST_PARAM]="t",r[e.FIREBASE_LONGPOLL_ID_PARAM]=t,r[e.FIREBASE_LONGPOLL_PW_PARAM]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},t.prototype.incrementIncomingBytes_=function(t){var e=u.stringify(t).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)},t}();e.BrowserPollConnection=l;var h=function(){function t(n,o,a,s){if(this.onDisconnect=a,this.urlFn=s,this.outstandingRequests=new i.CountedSet,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,c.isNodeSdk())this.commandCB=n,this.onMessageCB=o;else{this.uniqueCallbackIdentifier=r.LUIDGenerator(),window[e.FIREBASE_LONGPOLL_COMMAND_CB_NAME+this.uniqueCallbackIdentifier]=n,window[e.FIREBASE_LONGPOLL_DATA_CB_NAME+this.uniqueCallbackIdentifier]=o,this.myIFrame=t.createIFrame_();var u="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)&&(u='<script>document.domain="'+document.domain+'";<\/script>');var l="<html><body>"+u+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(l),this.myIFrame.doc.close()}catch(t){r.log("frame writing exception"),t.stack&&r.log(t.stack),r.log(t)}}}return t.createIFrame_=function(){var t=document.createElement("iframe");if(t.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(t);try{t.contentWindow.document||r.log("No IE domain setting required")}catch(n){var e=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+e+"';document.close();})())"}return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t},t.prototype.close=function(){var n=this;if(this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(function(){null!==n.myIFrame&&(document.body.removeChild(n.myIFrame),n.myIFrame=null)},Math.floor(0))),c.isNodeSdk()&&this.myID){var r={};r[e.FIREBASE_LONGPOLL_DISCONN_FRAME_PARAM]="t",r[e.FIREBASE_LONGPOLL_ID_PARAM]=this.myID,r[e.FIREBASE_LONGPOLL_PW_PARAM]=this.myPW;var i=this.urlFn(r);t.nodeRestRequest(i)}var o=this.onDisconnect;o&&(this.onDisconnect=null,o())},t.prototype.startLongPoll=function(t,e){for(this.myID=t,this.myPW=e,this.alive=!0;this.newRequest_(););},t.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.count()<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var t={};t[e.FIREBASE_LONGPOLL_ID_PARAM]=this.myID,t[e.FIREBASE_LONGPOLL_PW_PARAM]=this.myPW,t[e.FIREBASE_LONGPOLL_SERIAL_PARAM]=this.currentSerial;for(var n=this.urlFn(t),r="",i=0;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+r.length<=1870;){var o=this.pendingSegs.shift();r=r+"&"+e.FIREBASE_LONGPOLL_SEGMENT_NUM_PARAM+i+"="+o.seg+"&"+e.FIREBASE_LONGPOLL_SEGMENTS_IN_PACKET+i+"="+o.ts+"&"+e.FIREBASE_LONGPOLL_DATA_PARAM+i+"="+o.d,i++}return n+=r,this.addLongPollTag_(n,this.currentSerial),!0}return!1},t.prototype.enqueueSegment=function(t,e,n){this.pendingSegs.push({seg:t,ts:e,d:n}),this.alive&&this.newRequest_()},t.prototype.addLongPollTag_=function(t,e){var n=this;this.outstandingRequests.add(e,1);var r=function(){n.outstandingRequests.remove(e),n.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(t,function(){clearTimeout(i),r()})},t.prototype.addTag=function(t,e){var n=this;c.isNodeSdk()?this.doNodeLongPoll(t,e):setTimeout(function(){try{if(!n.sendNewPolls)return;var i=n.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=t,i.onload=i.onreadystatechange=function(){var t=i.readyState;t&&"loaded"!==t&&"complete"!==t||(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),e())},i.onerror=function(){r.log("Long-poll script failed to load: "+t),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(i)}catch(t){}},Math.floor(1))},t}();e.FirebaseIFrameScriptHolder=h},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var r=n(16),i=n(1),o=n(4),a=n(159),s=n(106),u=n(1),c=n(105),l=n(1),h=n(1),f=null;"undefined"!=typeof MozWebSocket?f=MozWebSocket:"undefined"!=typeof WebSocket&&(f=WebSocket),e.setWebSocketImpl=function(t){f=t};var p=function(){function e(t,n,r,i){this.connId=t,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=o.logWrapper(this.connId),this.stats_=a.StatsManager.getCollection(n),this.connURL=e.connectionURL_(n,r,i)}return e.connectionURL_=function(t,e,n){var r={};return r[s.VERSION_PARAM]=s.PROTOCOL_VERSION,!h.isNodeSdk()&&"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf(s.FORGE_DOMAIN)&&(r[s.REFERER_PARAM]=s.FORGE_REF),e&&(r[s.TRANSPORT_SESSION_PARAM]=e),n&&(r[s.LAST_SESSION_PARAM]=n),t.connectionURL(s.WEBSOCKET,r)},e.prototype.open=function(e,n){var i=this;this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,c.PersistentStorage.set("previous_websocket_failure",!0);try{if(h.isNodeSdk()){var o=u.CONSTANTS.NODE_ADMIN?"AdminNode":"Node",a={headers:{"User-Agent":"Firebase/"+s.PROTOCOL_VERSION+"/"+r.default.SDK_VERSION+"/"+t.platform+"/"+o}},l=Object({NODE_ENV:"production"}),p=0==this.connURL.indexOf("wss://")?l.HTTPS_PROXY||l.https_proxy:l.HTTP_PROXY||l.http_proxy;p&&(a.proxy={origin:p}),this.mySock=new f(this.connURL,[],a)}else this.mySock=new f(this.connURL)}catch(t){this.log_("Error instantiating WebSocket.");var d=t.message||t.data;return d&&this.log_(d),void this.onClosed_()}this.mySock.onopen=function(){i.log_("Websocket connected."),i.everConnected_=!0},this.mySock.onclose=function(){i.log_("Websocket connection was disconnected."),i.mySock=null,i.onClosed_()},this.mySock.onmessage=function(t){i.handleIncomingFrame(t)},this.mySock.onerror=function(t){i.log_("WebSocket error.  Closing connection.");var e=t.message||t.data;e&&i.log_(e),i.onClosed_()}},e.prototype.start=function(){},e.forceDisallow=function(){e.forceDisallow_=!0},e.isAvailable=function(){var t=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var n=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);n&&n.length>1&&parseFloat(n[1])<4.4&&(t=!0)}return!t&&null!==f&&!e.forceDisallow_},e.previouslyFailed=function(){return c.PersistentStorage.isInMemoryStorage||!0===c.PersistentStorage.get("previous_websocket_failure")},e.prototype.markConnectionHealthy=function(){c.PersistentStorage.remove("previous_websocket_failure")},e.prototype.appendFrame_=function(t){if(this.frames.push(t),this.frames.length==this.totalFrames){var e=this.frames.join("");this.frames=null;var n=l.jsonEval(e);this.onMessage(n)}},e.prototype.handleNewFrameCount_=function(t){this.totalFrames=t,this.frames=[]},e.prototype.extractFrameCount_=function(t){if(i.assert(null===this.frames,"We already have a frame buffer"),t.length<=6){var e=Number(t);if(!isNaN(e))return this.handleNewFrameCount_(e),null}return this.handleNewFrameCount_(1),t},e.prototype.handleIncomingFrame=function(t){if(null!==this.mySock){var e=t.data;if(this.bytesReceived+=e.length,this.stats_.incrementCounter("bytes_received",e.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(e);else{var n=this.extractFrameCount_(e);null!==n&&this.appendFrame_(n)}}},e.prototype.send=function(t){this.resetKeepAlive();var e=l.stringify(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);var n=o.splitStringBySize(e,16384);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])},e.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},e.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},e.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},e.prototype.resetKeepAlive=function(){var t=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(function(){t.mySock&&t.sendString_("0"),t.resetKeepAlive()},Math.floor(45e3))},e.prototype.sendString_=function(t){try{this.mySock.send(t)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},e.responsesRequiredToBeHealthy=2,e.healthyTimeout=3e4,e}();e.WebSocketConnection=p}).call(this,n(152))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){}return t.prototype.put=function(t,e,n,r){},t.prototype.merge=function(t,e,n,r){},t.prototype.refreshAuthToken=function(t){},t.prototype.onDisconnectPut=function(t,e,n){},t.prototype.onDisconnectMerge=function(t,e,n){},t.prototype.onDisconnectCancel=function(t,e){},t.prototype.reportStats=function(t){},t}();e.ServerActions=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(158),i=n(19),o=n(29),a=n(24),s=function(){function t(e){this.indexedFilter_=new r.IndexedFilter(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e)}return t.prototype.getStartPost=function(){return this.startPost_},t.prototype.getEndPost=function(){return this.endPost_},t.prototype.matches=function(t){return this.index_.compare(this.getStartPost(),t)<=0&&this.index_.compare(t,this.getEndPost())<=0},t.prototype.updateChild=function(t,e,n,r,i,s){return this.matches(new o.NamedNode(e,n))||(n=a.ChildrenNode.EMPTY_NODE),this.indexedFilter_.updateChild(t,e,n,r,i,s)},t.prototype.updateFullNode=function(t,e,n){e.isLeafNode()&&(e=a.ChildrenNode.EMPTY_NODE);var r=e.withIndex(this.index_);r=r.updatePriority(a.ChildrenNode.EMPTY_NODE);var s=this;return e.forEachChild(i.PRIORITY_INDEX,function(t,e){s.matches(new o.NamedNode(t,e))||(r=r.updateImmediateChild(t,a.ChildrenNode.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.indexedFilter_},t.prototype.getIndex=function(){return this.index_},t.getStartPost_=function(t){if(t.hasStart()){var e=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),e)}return t.getIndex().minPost()},t.getEndPost_=function(t){if(t.hasEnd()){var e=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),e)}return t.getIndex().maxPost()},t}();e.RangedFilter=s},function(t,e,n){n(737)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(9),i={searching:!1,searchResult:r.fromJS({})},o=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r.Record(i)),e}();e.SearchStateRecord=o},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n(9),o=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.params=e,this.version=e.version}return r(t,[{key:"apply",value:function(t){return t=i.fromJS(t).toJS(),(t=this.params.transform(t)).version=this.params.version,t}}]),t}();e.default=o},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n(15),o=n(245),a=function(){function t(e,n){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.name="",this.migrations=n,this.migrations.sort(function(t,e){return o.lt(t.version,e.version)?-1:o.gt(t.version,e.version)?1:0}),this.name=e,this.logEnabled=r,this.log("Migration Manager Created.",this.migrations.map(function(t){return t.version}).join(","))}return r(t,[{key:"lastestVersion",value:function(){return this.migrations[this.migrations.length-1].version}},{key:"apply",value:function(t){var e=i.auth().currentUser;if(e&&"yvpTpoYFXUP7nYvCj6p7Sk5Brtq1"!==e.uid){var n=!0,r=!1,a=void 0;try{for(var s,u=this.migrations[Symbol.iterator]();!(n=(s=u.next()).done);n=!0){var c=s.value;t.version&&!o.lt(t.version,c.version)||(this.log("Migrating to "+c.version),t=c.apply(t),this.log("Migrated to "+c.version,t))}}catch(t){r=!0,a=t}finally{try{!n&&u.return&&u.return()}finally{if(r)throw a}}}return t}},{key:"log",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.logEnabled&&console.log("%c [ "+this.name+" Migration] %c "+t,"background-color: black; color: white","color:black;font-weight:bold;",e||"")}}]),t}();e.default=a},function(t,e,n){(function(n){function r(t,e){if(e&&"object"==typeof e||(e={loose:!!e,includePrerelease:!1}),t instanceof i)return t;if("string"!=typeof t)return null;if(t.length>S)return null;if(!(e.loose?I[W]:I[j]).test(t))return null;try{return new i(t,e)}catch(t){return null}}function i(t,e){if(e&&"object"==typeof e||(e={loose:!!e,includePrerelease:!1}),t instanceof i){if(t.loose===e.loose)return t;t=t.version}else if("string"!=typeof t)throw new TypeError("Invalid Version: "+t);if(t.length>S)throw new TypeError("version is longer than "+S+" characters");if(!(this instanceof i))return new i(t,e);w("SemVer",t,e),this.options=e,this.loose=!!e.loose;var n=t.trim().match(e.loose?I[W]:I[j]);if(!n)throw new TypeError("Invalid Version: "+t);if(this.raw=t,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>T||this.major<0)throw new TypeError("Invalid major version");if(this.minor>T||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>T||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(function(t){if(/^[0-9]+$/.test(t)){var e=+t;if(e>=0&&e<T)return e}return t}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}function o(t,e){var n=ft.test(t),r=ft.test(e);return n&&r&&(t=+t,e=+e),n&&!r?-1:r&&!n?1:t<e?-1:t>e?1:0}function a(t,e,n){return new i(t,n).compare(new i(e,n))}function s(t,e,n){return a(t,e,n)>0}function u(t,e,n){return a(t,e,n)<0}function c(t,e,n){return 0===a(t,e,n)}function l(t,e,n){return 0!==a(t,e,n)}function h(t,e,n){return a(t,e,n)>=0}function f(t,e,n){return a(t,e,n)<=0}function p(t,e,n,r){var i;switch(e){case"===":"object"==typeof t&&(t=t.version),"object"==typeof n&&(n=n.version),i=t===n;break;case"!==":"object"==typeof t&&(t=t.version),"object"==typeof n&&(n=n.version),i=t!==n;break;case"":case"=":case"==":i=c(t,n,r);break;case"!=":i=l(t,n,r);break;case">":i=s(t,n,r);break;case">=":i=h(t,n,r);break;case"<":i=u(t,n,r);break;case"<=":i=f(t,n,r);break;default:throw new TypeError("Invalid operator: "+e)}return i}function d(t,e){if(e&&"object"==typeof e||(e={loose:!!e,includePrerelease:!1}),t instanceof d){if(t.loose===!!e.loose)return t;t=t.value}if(!(this instanceof d))return new d(t,e);w("comparator",t,e),this.options=e,this.loose=!!e.loose,this.parse(t),this.semver===pt?this.value="":this.value=this.operator+this.semver.version,w("comp",this)}function v(t,e){if(e&&"object"==typeof e||(e={loose:!!e,includePrerelease:!1}),t instanceof v)return t.loose===!!e.loose&&t.includePrerelease===!!e.includePrerelease?t:new v(t.raw,e);if(t instanceof d)return new v(t.value,e);if(!(this instanceof v))return new v(t,e);if(this.options=e,this.loose=!!e.loose,this.includePrerelease=!!e.includePrerelease,this.raw=t,this.set=t.split(/\s*\|\|\s*/).map(function(t){return this.parseRange(t.trim())},this).filter(function(t){return t.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+t);this.format()}function g(t,e){return w("comp",t,e),t=function(t,e){return t.trim().split(/\s+/).map(function(t){return function(t,e){w("caret",t,e),e&&"object"==typeof e||(e={loose:!!e,includePrerelease:!1});var n=e.loose?I[it]:I[rt];return t.replace(n,function(e,n,r,i,o){var a;return w("caret",t,e,n,r,i,o),y(n)?a="":y(r)?a=">="+n+".0.0 <"+(+n+1)+".0.0":y(i)?a="0"===n?">="+n+"."+r+".0 <"+n+"."+(+r+1)+".0":">="+n+"."+r+".0 <"+(+n+1)+".0.0":o?(w("replaceCaret pr",o),"-"!==o.charAt(0)&&(o="-"+o),a="0"===n?"0"===r?">="+n+"."+r+"."+i+o+" <"+n+"."+r+"."+(+i+1):">="+n+"."+r+"."+i+o+" <"+n+"."+(+r+1)+".0":">="+n+"."+r+"."+i+o+" <"+(+n+1)+".0.0"):(w("no pr"),a="0"===n?"0"===r?">="+n+"."+r+"."+i+" <"+n+"."+r+"."+(+i+1):">="+n+"."+r+"."+i+" <"+n+"."+(+r+1)+".0":">="+n+"."+r+"."+i+" <"+(+n+1)+".0.0"),w("caret return",a),a})}(t,e)}).join(" ")}(t,e),w("caret",t),t=function(t,e){return t.trim().split(/\s+/).map(function(t){return function(t,e){e&&"object"==typeof e||(e={loose:!!e,includePrerelease:!1});var n=e.loose?I[tt]:I[Z];return t.replace(n,function(e,n,r,i,o){var a;return w("tilde",t,e,n,r,i,o),y(n)?a="":y(r)?a=">="+n+".0.0 <"+(+n+1)+".0.0":y(i)?a=">="+n+"."+r+".0 <"+n+"."+(+r+1)+".0":o?(w("replaceTilde pr",o),"-"!==o.charAt(0)&&(o="-"+o),a=">="+n+"."+r+"."+i+o+" <"+n+"."+(+r+1)+".0"):a=">="+n+"."+r+"."+i+" <"+n+"."+(+r+1)+".0",w("tilde return",a),a})}(t,e)}).join(" ")}(t,e),w("tildes",t),t=function(t,e){return w("replaceXRanges",t,e),t.split(/\s+/).map(function(t){return function(t,e){t=t.trim(),e&&"object"==typeof e||(e={loose:!!e,includePrerelease:!1});var n=e.loose?I[X]:I[Q];return t.replace(n,function(e,n,r,i,o,a){w("xRange",t,e,n,r,i,o,a);var s=y(r),u=s||y(i),c=u||y(o),l=c;return"="===n&&l&&(n=""),s?e=">"===n||"<"===n?"<0.0.0":"*":n&&l?(u&&(i=0),c&&(o=0),">"===n?(n=">=",u?(r=+r+1,i=0,o=0):c&&(i=+i+1,o=0)):"<="===n&&(n="<",u?r=+r+1:i=+i+1),e=n+r+"."+i+"."+o):u?e=">="+r+".0.0 <"+(+r+1)+".0.0":c&&(e=">="+r+"."+i+".0 <"+r+"."+(+i+1)+".0"),w("xRange return",e),e})}(t,e)}).join(" ")}(t,e),w("xrange",t),t=function(t,e){return w("replaceStars",t,e),t.trim().replace(I[lt],"")}(t,e),w("stars",t),t}function y(t){return!t||"x"===t.toLowerCase()||"*"===t}function m(t,e,n,r,i,o,a,s,u,c,l,h,f){return((e=y(n)?"":y(r)?">="+n+".0.0":y(i)?">="+n+"."+r+".0":">="+e)+" "+(s=y(u)?"":y(c)?"<"+(+u+1)+".0.0":y(l)?"<"+u+"."+(+c+1)+".0":h?"<="+u+"."+c+"."+l+"-"+h:"<="+s)).trim()}function _(t,e,n){for(var r=0;r<t.length;r++)if(!t[r].test(e))return!1;if(n||(n={}),e.prerelease.length&&!n.includePrerelease){for(r=0;r<t.length;r++)if(w(t[r].semver),t[r].semver!==pt&&t[r].semver.prerelease.length>0){var i=t[r].semver;if(i.major===e.major&&i.minor===e.minor&&i.patch===e.patch)return!0}return!1}return!0}function b(t,e,n){try{e=new v(e,n)}catch(t){return!1}return e.test(t)}function E(t,e,n,r){var o,a,c,l,p;switch(t=new i(t,r),e=new v(e,r),n){case">":o=s,a=f,c=u,l=">",p=">=";break;case"<":o=u,a=h,c=s,l="<",p="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(b(t,e,r))return!1;for(var g=0;g<e.set.length;++g){var y=e.set[g],m=null,_=null;if(y.forEach(function(t){t.semver===pt&&(t=new d(">=0.0.0")),m=m||t,_=_||t,o(t.semver,m.semver,r)?m=t:c(t.semver,_.semver,r)&&(_=t)}),m.operator===l||m.operator===p)return!1;if((!_.operator||_.operator===l)&&a(t,_.semver))return!1;if(_.operator===p&&c(t,_.semver))return!1}return!0}var w;e=t.exports=i,w="object"==typeof n&&Object({NODE_ENV:"production"})&&Object({NODE_ENV:"production"}).NODE_DEBUG&&/\bsemver\b/i.test(Object({NODE_ENV:"production"}).NODE_DEBUG)?function(){var t=Array.prototype.slice.call(arguments,0);t.unshift("SEMVER"),console.log.apply(console,t)}:function(){},e.SEMVER_SPEC_VERSION="2.0.0";var S=256,T=Number.MAX_SAFE_INTEGER||9007199254740991,I=e.re=[],A=e.src=[],O=0,C=O++;A[C]="0|[1-9]\\d*";var R=O++;A[R]="[0-9]+";var N=O++;A[N]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var k=O++;A[k]="("+A[C]+")\\.("+A[C]+")\\.("+A[C]+")";var P=O++;A[P]="("+A[R]+")\\.("+A[R]+")\\.("+A[R]+")";var D=O++;A[D]="(?:"+A[C]+"|"+A[N]+")";var x=O++;A[x]="(?:"+A[R]+"|"+A[N]+")";var M=O++;A[M]="(?:-("+A[D]+"(?:\\."+A[D]+")*))";var L=O++;A[L]="(?:-?("+A[x]+"(?:\\."+A[x]+")*))";var F=O++;A[F]="[0-9A-Za-z-]+";var U=O++;A[U]="(?:\\+("+A[F]+"(?:\\."+A[F]+")*))";var j=O++,B="v?"+A[k]+A[M]+"?"+A[U]+"?";A[j]="^"+B+"$";var V="[v=\\s]*"+A[P]+A[L]+"?"+A[U]+"?",W=O++;A[W]="^"+V+"$";var q=O++;A[q]="((?:<|>)?=?)";var H=O++;A[H]=A[R]+"|x|X|\\*";var G=O++;A[G]=A[C]+"|x|X|\\*";var K=O++;A[K]="[v=\\s]*("+A[G]+")(?:\\.("+A[G]+")(?:\\.("+A[G]+")(?:"+A[M]+")?"+A[U]+"?)?)?";var z=O++;A[z]="[v=\\s]*("+A[H]+")(?:\\.("+A[H]+")(?:\\.("+A[H]+")(?:"+A[L]+")?"+A[U]+"?)?)?";var Q=O++;A[Q]="^"+A[q]+"\\s*"+A[K]+"$";var X=O++;A[X]="^"+A[q]+"\\s*"+A[z]+"$";var Y=O++;A[Y]="(?:^|[^\\d])(\\d{1,16})(?:\\.(\\d{1,16}))?(?:\\.(\\d{1,16}))?(?:$|[^\\d])";var J=O++;A[J]="(?:~>?)";var $=O++;A[$]="(\\s*)"+A[J]+"\\s+",I[$]=new RegExp(A[$],"g");var Z=O++;A[Z]="^"+A[J]+A[K]+"$";var tt=O++;A[tt]="^"+A[J]+A[z]+"$";var et=O++;A[et]="(?:\\^)";var nt=O++;A[nt]="(\\s*)"+A[et]+"\\s+",I[nt]=new RegExp(A[nt],"g");var rt=O++;A[rt]="^"+A[et]+A[K]+"$";var it=O++;A[it]="^"+A[et]+A[z]+"$";var ot=O++;A[ot]="^"+A[q]+"\\s*("+V+")$|^$";var at=O++;A[at]="^"+A[q]+"\\s*("+B+")$|^$";var st=O++;A[st]="(\\s*)"+A[q]+"\\s*("+V+"|"+A[K]+")",I[st]=new RegExp(A[st],"g");var ut=O++;A[ut]="^\\s*("+A[K]+")\\s+-\\s+("+A[K]+")\\s*$";var ct=O++;A[ct]="^\\s*("+A[z]+")\\s+-\\s+("+A[z]+")\\s*$";var lt=O++;A[lt]="(<|>)?=?\\s*\\*";for(var ht=0;ht<35;ht++)w(ht,A[ht]),I[ht]||(I[ht]=new RegExp(A[ht]));e.parse=r,e.valid=function(t,e){var n=r(t,e);return n?n.version:null},e.clean=function(t,e){var n=r(t.trim().replace(/^[=v]+/,""),e);return n?n.version:null},e.SemVer=i,i.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},i.prototype.toString=function(){return this.version},i.prototype.compare=function(t){return w("SemVer.compare",this.version,this.options,t),t instanceof i||(t=new i(t,this.options)),this.compareMain(t)||this.comparePre(t)},i.prototype.compareMain=function(t){return t instanceof i||(t=new i(t,this.options)),o(this.major,t.major)||o(this.minor,t.minor)||o(this.patch,t.patch)},i.prototype.comparePre=function(t){if(t instanceof i||(t=new i(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;var e=0;do{var n=this.prerelease[e],r=t.prerelease[e];if(w("prerelease compare",e,n,r),void 0===n&&void 0===r)return 0;if(void 0===r)return 1;if(void 0===n)return-1;if(n!==r)return o(n,r)}while(++e)},i.prototype.inc=function(t,e){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",e);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",e);break;case"prepatch":this.prerelease.length=0,this.inc("patch",e),this.inc("pre",e);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",e),this.inc("pre",e);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var n=this.prerelease.length;--n>=0;)"number"==typeof this.prerelease[n]&&(this.prerelease[n]++,n=-2);-1===n&&this.prerelease.push(0)}e&&(this.prerelease[0]===e?isNaN(this.prerelease[1])&&(this.prerelease=[e,0]):this.prerelease=[e,0]);break;default:throw new Error("invalid increment argument: "+t)}return this.format(),this.raw=this.version,this},e.inc=function(t,e,n,r){"string"==typeof n&&(r=n,n=void 0);try{return new i(t,n).inc(e,r).version}catch(t){return null}},e.diff=function(t,e){if(c(t,e))return null;var n=r(t),i=r(e);if(n.prerelease.length||i.prerelease.length){for(var o in n)if(("major"===o||"minor"===o||"patch"===o)&&n[o]!==i[o])return"pre"+o;return"prerelease"}for(var o in n)if(("major"===o||"minor"===o||"patch"===o)&&n[o]!==i[o])return o},e.compareIdentifiers=o;var ft=/^[0-9]+$/;e.rcompareIdentifiers=function(t,e){return o(e,t)},e.major=function(t,e){return new i(t,e).major},e.minor=function(t,e){return new i(t,e).minor},e.patch=function(t,e){return new i(t,e).patch},e.compare=a,e.compareLoose=function(t,e){return a(t,e,!0)},e.rcompare=function(t,e,n){return a(e,t,n)},e.sort=function(t,n){return t.sort(function(t,r){return e.compare(t,r,n)})},e.rsort=function(t,n){return t.sort(function(t,r){return e.rcompare(t,r,n)})},e.gt=s,e.lt=u,e.eq=c,e.neq=l,e.gte=h,e.lte=f,e.cmp=p,e.Comparator=d;var pt={};d.prototype.parse=function(t){var e=this.options.loose?I[ot]:I[at],n=t.match(e);if(!n)throw new TypeError("Invalid comparator: "+t);this.operator=n[1],"="===this.operator&&(this.operator=""),n[2]?this.semver=new i(n[2],this.options.loose):this.semver=pt},d.prototype.toString=function(){return this.value},d.prototype.test=function(t){return w("Comparator.test",t,this.options.loose),this.semver===pt||("string"==typeof t&&(t=new i(t,this.options)),p(t,this.operator,this.semver,this.options))},d.prototype.intersects=function(t,e){if(!(t instanceof d))throw new TypeError("a Comparator is required");var n;if(e&&"object"==typeof e||(e={loose:!!e,includePrerelease:!1}),""===this.operator)return n=new v(t.value,e),b(this.value,n,e);if(""===t.operator)return n=new v(this.value,e),b(t.semver,n,e);var r=!(">="!==this.operator&&">"!==this.operator||">="!==t.operator&&">"!==t.operator),i=!("<="!==this.operator&&"<"!==this.operator||"<="!==t.operator&&"<"!==t.operator),o=this.semver.version===t.semver.version,a=!(">="!==this.operator&&"<="!==this.operator||">="!==t.operator&&"<="!==t.operator),s=p(this.semver,"<",t.semver,e)&&(">="===this.operator||">"===this.operator)&&("<="===t.operator||"<"===t.operator),u=p(this.semver,">",t.semver,e)&&("<="===this.operator||"<"===this.operator)&&(">="===t.operator||">"===t.operator);return r||i||o&&a||s||u},e.Range=v,v.prototype.format=function(){return this.range=this.set.map(function(t){return t.join(" ").trim()}).join("||").trim(),this.range},v.prototype.toString=function(){return this.range},v.prototype.parseRange=function(t){var e=this.options.loose;t=t.trim();var n=e?I[ct]:I[ut];t=t.replace(n,m),w("hyphen replace",t),t=t.replace(I[st],"$1$2$3"),w("comparator trim",t,I[st]),t=(t=(t=t.replace(I[$],"$1~")).replace(I[nt],"$1^")).split(/\s+/).join(" ");var r=e?I[ot]:I[at],i=t.split(" ").map(function(t){return g(t,this.options)},this).join(" ").split(/\s+/);return this.options.loose&&(i=i.filter(function(t){return!!t.match(r)})),i.map(function(t){return new d(t,this.options)},this)},v.prototype.intersects=function(t,e){if(!(t instanceof v))throw new TypeError("a Range is required");return this.set.some(function(n){return n.every(function(n){return t.set.some(function(t){return t.every(function(t){return n.intersects(t,e)})})})})},e.toComparators=function(t,e){return new v(t,e).set.map(function(t){return t.map(function(t){return t.value}).join(" ").trim().split(" ")})},v.prototype.test=function(t){if(!t)return!1;"string"==typeof t&&(t=new i(t,this.options));for(var e=0;e<this.set.length;e++)if(_(this.set[e],t,this.options))return!0;return!1},e.satisfies=b,e.maxSatisfying=function(t,e,n){var r=null,o=null;try{var a=new v(e,n)}catch(t){return null}return t.forEach(function(t){a.test(t)&&(r&&-1!==o.compare(t)||(o=new i(r=t,n)))}),r},e.minSatisfying=function(t,e,n){var r=null,o=null;try{var a=new v(e,n)}catch(t){return null}return t.forEach(function(t){a.test(t)&&(r&&1!==o.compare(t)||(o=new i(r=t,n)))}),r},e.validRange=function(t,e){try{return new v(t,e).range||"*"}catch(t){return null}},e.ltr=function(t,e,n){return E(t,e,"<",n)},e.gtr=function(t,e,n){return E(t,e,">",n)},e.outside=E,e.prerelease=function(t,e){var n=r(t,e);return n&&n.prerelease.length?n.prerelease:null},e.intersects=function(t,e,n){return t=new v(t,n),e=new v(e,n),t.intersects(e)},e.coerce=function(t){if(t instanceof i)return t;if("string"!=typeof t)return null;var e=t.match(I[Y]);return null==e?null:r((e[1]||"0")+"."+(e[2]||"0")+"."+(e[3]||"0"))}}).call(this,n(152))},function(t,e,n){"use strict";var r=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});var i=n(15);e.closeExtensionNotificationModalAsync=function(t,e){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r="users/"+t.uid+"/onboarding/notificationModalshown",n.abrupt("return",i.database().ref(r).set(e));case 2:case"end":return n.stop()}},n,this)}))},e.updateExtensionGuideStateAsync=function(t,e){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r="users/"+t.uid+"/onboarding/extensionGuideState",n.abrupt("return",i.database().ref(r).set(e));case 2:case"end":return n.stop()}},n,this)}))},e.updateColorLimitTestAsync=function(t,e){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r="users/"+t.uid+"/onboarding/colorLimitReferralTest",n.abrupt("return",i.database().ref(r).set(e));case 2:case"end":return n.stop()}},n,this)}))},e.startExtensionGuideAsync=function(t){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n="users/"+t.uid+"/onboarding/extensionGuideState",e.abrupt("return",i.database().ref(n).set(1));case 2:case"end":return e.stop()}},e,this)}))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(572),i=n(73);e.shortcutActionsConstants=i({INIT_SHORTCUT:null}),e.initShortcut=function(){return function(t){return function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})}(void 0,void 0,void 0,regeneratorRuntime.mark(function n(){var i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.ShortcutAsyncFunction.getAllCommands();case 2:i=n.sent,t({type:e.shortcutActionsConstants.INIT_SHORTCUT,commands:i});case 4:case"end":return n.stop()}},n,this)}))}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(9),i=n(66),o=n(62),a=n(86),s=n(79),u=n(247),c=n(65),l=n(73);e.sideBarStateOptions=l({HIDDEN:null,SHOWN:null,PINNED:null});var h=r.fromJS({highlightMode:!0,autoPdf:!0,sidebarStatus:{},commands:null,showPaymentModal:!1});e.workspaceReducer=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,n=arguments[1],r=t;switch(n.type){case c.userActionConstants.BLOCK_COLLABORATION_INVITATION:return r=r.set("showPaymentModal",!0);case i.workspaceActionsConstants.HIDE_PAYMENT_MODAL:return r=r.set("showPaymentModal",!1);case i.workspaceActionsConstants.WORKSPACE_UPDATED:return void 0!==n.workspace.highlighter&&(r=r.set("highlightMode",n.workspace.highlighter)),void 0!==n.workspace.pdf&&(r=r.set("autoPdf",n.workspace.pdf)),r;case i.workspaceActionsConstants.AUTO_PDF_SETTING:return r.set("autoPdf",n.autoPdf);case a.chromeIconActionConstants.ICON_CLICKED:return n.activeTabs.forEach(function(t){var n=t.id;switch(r.getIn(["sidebarStatus",n])){case e.sideBarStateOptions.PINNED:case e.sideBarStateOptions.SHOWN:r=r.setIn(["sidebarStatus",n],e.sideBarStateOptions.HIDDEN);break;case e.sideBarStateOptions.HIDDEN:default:r=r.setIn(["sidebarStatus",n],e.sideBarStateOptions.SHOWN)}}),r;case i.workspaceActionsConstants.SIDEBAR_PINNED:var l=r.getIn(["sidebarStatus",n.tabId]);return r=l===e.sideBarStateOptions.PINNED?r.setIn(["sidebarStatus",n.tabId],e.sideBarStateOptions.SHOWN):r.setIn(["sidebarStatus",n.tabId],e.sideBarStateOptions.PINNED);case i.workspaceActionsConstants.BODY_CLICKED:return r.getIn(["sidebarStatus",n.tabId])!==e.sideBarStateOptions.PINNED&&(r=r.setIn(["sidebarStatus",n.tabId],e.sideBarStateOptions.HIDDEN)),r;case u.shortcutActionsConstants.INIT_SHORTCUT:return r.set("commands",n.commands);case s.chromeTabActionsConstants.ON_TAB_ACTIVATED:n.tabs.filter(function(t){return t.active}).forEach(function(t){switch(r.getIn(["sidebarStatus",t.id])){case e.sideBarStateOptions.PINNED:r=r.setIn(["sidebarStatus",t.id],e.sideBarStateOptions.PINNED);break;case e.sideBarStateOptions.SHOWN:case e.sideBarStateOptions.HIDDEN:default:r=r.setIn(["sidebarStatus",t.id],e.sideBarStateOptions.HIDDEN)}});var f=n.tabs.map(function(t){return t.id});return r.get("sidebarStatus").forEach(function(t,e){-1===f.indexOf(e)&&(r=r.deleteIn(["sidebarStatus",e]))}),r;case i.workspaceActionsConstants.SHOW_ALL_SIDEBAR:return r=r.set("sidebarStatus",r.get("sidebarStatus").map(function(t,n){return e.sideBarStateOptions.SHOWN}));case o.firebaseAuthActionsConstants.SIGN_OUT:return h.set("sidebarStatus",r.get("sidebarStatus"));default:return r}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(18),i=n(15),o=n(9),a=n(23);n(40),e.stripeActionConstants=a({SET_STRIPE:null,STRIPE_UPDATED:null}),e.subscribeStripe=function(t){return function(n){var a="stripeData/"+t.uid;i.database().ref(a).on("value",function(t){console.log("### Firebase ==> StripeModel ###",t.val());var i=t.val(),a="Free";i&&i.subscription&&(i.subscription.plan.nickname&&(i.subscription.plan.name=i.subscription.plan.nickname),a=i.subscription.plan.name),n({type:e.stripeActionConstants.STRIPE_UPDATED,stripeData:o.fromJS(i)}),n(r.TrackerActions.trackStripeData(a))})}},e.unSubscribeStripe=function(t){return function(e){var n="stripeData/"+t.uid+"/subscription";i.database().ref(n).off()}}},function(t,e,n){"use strict";var r=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});var i=n(18),o=n(15),a=n(580),s=n(23);e.questionnaireActionConstant=s({QUESTIONNAIRE_UPDATED:null}),e.submitQuestionnaire=function(t,e,n,i){return function(s){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:o.database().ref("/questionnaire/"+t.uid+"/"+e).set(n),o.database().ref("/questionnaire/"+t.uid+"/channels").set(i),"K-12 School"===n.purpose&&"Student"!==n.userRole&&a.SlackAsyncFunction.postNewQuestionnaireMessage("A new questionnaire from a K12 School:\n\n        School:\t"+n.nameOfSchool+"\n\n        Name:\t"+t.displayName+"\n\n        Email:\t"+t.email+"\n\n        role:\t"+n.userRole);case 3:case"end":return r.stop()}},r,this)}))}},e.subscribeQuestionnaire=function(t){return function(n){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){var a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:a="questionnaire/"+t.uid,o.database().ref(a).on("value",function(t){console.log("### Firebase ==> Questionnaire ###",t.val());var r=t.val();r&&(r.questionnaireV1&&n(i.TrackerActions.trackQuestionnaireV1(r.questionnaireV1)),r.channels&&n(i.TrackerActions.trackChannels(r.channels))),n({type:e.questionnaireActionConstant.QUESTIONNAIRE_UPDATED,answer:r})});case 2:case"end":return r.stop()}},r,this)}))}},e.unSubscribeQuestionnaire=function(t){return function(e){var n="questionnaire/"+t.uid;o.database().ref(n).off()}}},function(t,e){function n(t,e){for(var n=0;n<t.length;++n)if(t[n]===e)return n;return-1}function r(t,e){var r=[],i=[];return null==e&&(e=function(t,e){return r[0]===e?"[Circular ~]":"[Circular ~."+i.slice(0,n(r,e)).join(".")+"]"}),function(o,a){if(r.length>0){var s=n(r,this);~s?r.splice(s+1):r.push(this),~s?i.splice(s,1/0,o):i.push(o),~n(r,a)&&(a=e.call(this,o,a))}else r.push(a);return null==t?a instanceof Error?function(t){var e={stack:t.stack,message:t.message,name:t.name};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}(a):a:t.call(this,o,a)}}(t.exports=function(t,e,n,i){return JSON.stringify(t,r(e,i),n)}).getSerialize=r},function(t,e,n){t.exports=n(253)},function(t,e,n){var r=n(592);e.stringify=function(t,e,n,i){var o=i||!1;"boolean"==typeof o&&(o={date:o,function:o,regex:o,undefined:o,error:o,symbol:o,map:o,set:o,nan:o,infinity:o});var a=r.decycle(t,o,e);return JSON.stringify(a)},e.parse=function(t,e){var n=(/"\$jsan"/.test(t),JSON.parse(t)),i=r.retrocycle(n);if(e){var o=JSON.stringify(i);return JSON.parse(o,e)}return i}},function(t,e){t.exports=function(t,e){if("$"!==e)for(var n=function(t){for(var e,n=/(?:\.(\w+))|(?:\[(\d+)\])|(?:\["((?:[^\\"]|\\.)*)"\])/g,r=[];e=n.exec(t);)r.push(e[1]||e[2]||e[3]);return r}(e),r=0;r<n.length;r++)void 0===t[e=n[r].toString().replace(/\\"/g,'"')]&&r!==n.length-1||(t=t[e]);return t}},function(t,e,n){(function(e,r){var i=n(115),o=n(598).SCChannel,a=(n(257).Response,n(600).AuthEngine),s=n(601),u=n(602).SCTransport,c=n(258),l=n(606),h=n(608),f=n(609),p=n(116),d=p.InvalidArgumentsError,v=p.InvalidMessageError,g=p.InvalidActionError,y=p.SocketProtocolError,m=p.TimeoutError,_=p.BadConnectionError,b="undefined"!=typeof window,E=function(t){var n=this;i.call(this),this.id=null,this.state=this.CLOSED,this.authState=this.UNAUTHENTICATED,this.signedAuthToken=null,this.authToken=null,this.pendingReconnect=!1,this.pendingReconnectTimeout=null,this.preparingPendingSubscriptions=!1,this.clientId=t.clientId,this.connectTimeout=t.connectTimeout,this.ackTimeout=t.ackTimeout,this.channelPrefix=t.channelPrefix||null,this.disconnectOnUnload=null==t.disconnectOnUnload||t.disconnectOnUnload,this.authTokenName=t.authTokenName,this.pingTimeout=this.ackTimeout,this.pingTimeoutDisabled=!!t.pingTimeoutDisabled,this.active=!0,this._clientMap=t.clientMap||{};var r=Math.pow(2,31)-1,o=function(t){if(n[t]>r)throw new d("The "+t+" value provided exceeded the maximum amount allowed")};if(o("connectTimeout"),o("ackTimeout"),this._localEvents={connect:1,connectAbort:1,close:1,disconnect:1,message:1,error:1,raw:1,kickOut:1,subscribe:1,unsubscribe:1,subscribeStateChange:1,authStateChange:1,authenticate:1,deauthenticate:1,removeAuthToken:1,subscribeRequest:1},this.connectAttempts=0,this._emitBuffer=new l,this.channels={},this.options=t,this._cid=1,this.options.callIdGenerator=function(){return n._cid++},this.options.autoReconnect){null==this.options.autoReconnectOptions&&(this.options.autoReconnectOptions={});var u=this.options.autoReconnectOptions;null==u.initialDelay&&(u.initialDelay=1e4),null==u.randomness&&(u.randomness=1e4),null==u.multiplier&&(u.multiplier=1.5),null==u.maxDelay&&(u.maxDelay=6e4)}null==this.options.subscriptionRetryOptions&&(this.options.subscriptionRetryOptions={}),this.options.authEngine?this.auth=this.options.authEngine:this.auth=new a,this.options.codecEngine?this.codec=this.options.codecEngine:this.codec=s,this.options.path=this.options.path.replace(/\/$/,"")+"/",this.options.query=t.query||{},"string"==typeof this.options.query&&(this.options.query=c.parse(this.options.query)),this._channelEmitter=new i,this._unloadHandler=function(){n.disconnect()},b&&this.disconnectOnUnload&&e.addEventListener&&e.addEventListener("beforeunload",this._unloadHandler,!1),this._clientMap[this.clientId]=this,this.options.autoConnect&&this.connect()};E.prototype=Object.create(i.prototype),E.CONNECTING=E.prototype.CONNECTING=u.prototype.CONNECTING,E.OPEN=E.prototype.OPEN=u.prototype.OPEN,E.CLOSED=E.prototype.CLOSED=u.prototype.CLOSED,E.AUTHENTICATED=E.prototype.AUTHENTICATED="authenticated",E.UNAUTHENTICATED=E.prototype.UNAUTHENTICATED="unauthenticated",E.PENDING=E.prototype.PENDING="pending",E.ignoreStatuses=p.socketProtocolIgnoreStatuses,E.errorStatuses=p.socketProtocolErrorStatuses,E.prototype._privateEventHandlerMap={"#publish":function(t){var e=this._undecorateChannelName(t.channel);this.isSubscribed(e,!0)&&this._channelEmitter.emit(e,t.data)},"#kickOut":function(t){var e=this._undecorateChannelName(t.channel),n=this.channels[e];n&&(i.prototype.emit.call(this,"kickOut",t.message,e),n.emit("kickOut",t.message,e),this._triggerChannelUnsubscribe(n))},"#setAuthToken":function(t,e){var n=this;if(t){this.auth.saveToken(this.authTokenName,t.token,{},function(r){r?(e.error(r),n._onSCError(r)):(n._changeToAuthenticatedState(t.token),e.end())})}else e.error(new v("No token data provided by #setAuthToken event"))},"#removeAuthToken":function(t,e){var n=this;this.auth.removeToken(this.authTokenName,function(t,r){t?(e.error(t),n._onSCError(t)):(i.prototype.emit.call(n,"removeAuthToken",r),n._changeToUnauthenticatedStateAndClearTokens(),e.end())})},"#disconnect":function(t){this.transport.close(t.code,t.data)}},E.prototype.getState=function(){return this.state},E.prototype.getBytesReceived=function(){return this.transport.getBytesReceived()},E.prototype.deauthenticate=function(t){var e=this;this.auth.removeToken(this.authTokenName,function(n,r){n?e._onSCError(n):(i.prototype.emit.call(e,"removeAuthToken",r),e.state!=e.CLOSED&&e.emit("#removeAuthToken"),e._changeToUnauthenticatedStateAndClearTokens()),t&&t(n)})},E.prototype.connect=E.prototype.open=function(){var t=this;if(this.active)this.state==this.CLOSED&&(this.pendingReconnect=!1,this.pendingReconnectTimeout=null,clearTimeout(this._reconnectTimeoutRef),this.state=this.CONNECTING,i.prototype.emit.call(this,"connecting"),this.transport&&this.transport.off(),this.transport=new u(this.auth,this.codec,this.options),this.transport.on("open",function(e){t.state=t.OPEN,t._onSCOpen(e)}),this.transport.on("error",function(e){t._onSCError(e)}),this.transport.on("close",function(e,n){t.state=t.CLOSED,t._onSCClose(e,n)}),this.transport.on("openAbort",function(e,n){t.state=t.CLOSED,t._onSCClose(e,n,!0)}),this.transport.on("event",function(e,n,r){t._onSCEvent(e,n,r)}));else{var e=new g("Cannot connect a destroyed client");this._onSCError(e)}},E.prototype.reconnect=function(t,e){this.disconnect(t,e),this.connect()},E.prototype.disconnect=function(t,e){if("number"!=typeof(t=t||1e3))throw new d("If specified, the code argument must be a number");this.state==this.OPEN||this.state==this.CONNECTING?this.transport.close(t,e):(this.pendingReconnect=!1,this.pendingReconnectTimeout=null,clearTimeout(this._reconnectTimeoutRef))},E.prototype.destroy=function(t,n){b&&e.removeEventListener&&e.removeEventListener("beforeunload",this._unloadHandler,!1),this.active=!1,this.disconnect(t,n),delete this._clientMap[this.clientId]},E.prototype._changeToUnauthenticatedStateAndClearTokens=function(){if(this.authState!=this.UNAUTHENTICATED){var t=this.authState,e=this.signedAuthToken;this.authState=this.UNAUTHENTICATED,this.signedAuthToken=null,this.authToken=null;var n={oldState:t,newState:this.authState};i.prototype.emit.call(this,"authStateChange",n),i.prototype.emit.call(this,"deauthenticate",e)}},E.prototype._changeToAuthenticatedState=function(t){if(this.signedAuthToken=t,this.authToken=this._extractAuthTokenData(t),this.authState!=this.AUTHENTICATED){var e=this.authState;this.authState=this.AUTHENTICATED;var n={oldState:e,newState:this.authState,signedAuthToken:t,authToken:this.authToken};this.preparingPendingSubscriptions||this.processPendingSubscriptions(),i.prototype.emit.call(this,"authStateChange",n)}i.prototype.emit.call(this,"authenticate",t)},E.prototype.decodeBase64=function(t){return void 0===r?e.atob?e.atob(t):h.decode(t):new r(t,"base64").toString("utf8")},E.prototype.encodeBase64=function(t){return void 0===r?e.btoa?e.btoa(t):h.encode(t):new r(t,"utf8").toString("base64")},E.prototype._extractAuthTokenData=function(t){var e=(t||"").split(".")[1];if(null!=e){var n=e;try{return n=this.decodeBase64(n),JSON.parse(n)}catch(t){return n}}return null},E.prototype.getAuthToken=function(){return this.authToken},E.prototype.getSignedAuthToken=function(){return this.signedAuthToken},E.prototype.authenticate=function(t,e){var n=this;this.emit("#authenticate",t,function(r,i){i&&null!=i.isAuthenticated?i.authError&&(i.authError=p.hydrateError(i.authError)):i={isAuthenticated:n.authState,authError:null},r?("BadConnectionError"!=r.name&&"TimeoutError"!=r.name&&n._changeToUnauthenticatedStateAndClearTokens(),e&&e(r,i)):n.auth.saveToken(n.authTokenName,t,{},function(r){r&&n._onSCError(r),i.isAuthenticated?n._changeToAuthenticatedState(t):n._changeToUnauthenticatedStateAndClearTokens(),e&&e(r,i)})})},E.prototype._tryReconnect=function(t){var e,n=this,r=this.connectAttempts++,i=this.options.autoReconnectOptions;if(null==t||r>0){var o=Math.round(i.initialDelay+(i.randomness||0)*Math.random());e=Math.round(o*Math.pow(i.multiplier,r))}else e=t;e>i.maxDelay&&(e=i.maxDelay),clearTimeout(this._reconnectTimeoutRef),this.pendingReconnect=!0,this.pendingReconnectTimeout=e,this._reconnectTimeoutRef=setTimeout(function(){n.connect()},e)},E.prototype._onSCOpen=function(t){var e=this;this.preparingPendingSubscriptions=!0,t?(this.id=t.id,this.pingTimeout=t.pingTimeout,this.transport.pingTimeout=this.pingTimeout,t.isAuthenticated?this._changeToAuthenticatedState(t.authToken):this._changeToUnauthenticatedStateAndClearTokens()):this._changeToUnauthenticatedStateAndClearTokens(),this.connectAttempts=0,this.options.autoSubscribeOnConnect&&this.processPendingSubscriptions(),i.prototype.emit.call(this,"connect",t,function(){e.processPendingSubscriptions()}),this.state==this.OPEN&&this._flushEmitBuffer()},E.prototype._onSCError=function(t){var e=this;setTimeout(function(){if(e.listeners("error").length<1)throw t;i.prototype.emit.call(e,"error",t)},0)},E.prototype._suspendSubscriptions=function(){var t,e;for(var n in this.channels)this.channels.hasOwnProperty(n)&&(e=(t=this.channels[n]).state==t.SUBSCRIBED||t.state==t.PENDING?t.PENDING:t.UNSUBSCRIBED,this._triggerChannelUnsubscribe(t,e))},E.prototype._abortAllPendingEventsDueToBadConnection=function(t){for(var e,n=this._emitBuffer.head;n;){e=n.next;var r=n.data;clearTimeout(r.timeout),delete r.timeout,n.detach(),n=e;var i=r.callback;if(i){delete r.callback;var o="Event '"+r.event+"' was aborted due to a bad connection",a=new _(o,t);i.call(r,a,r)}r.cid&&this.transport.cancelPendingResponse(r.cid)}},E.prototype._onSCClose=function(t,e,n){var r=this;if(this.id=null,this.transport&&this.transport.off(),this.pendingReconnect=!1,this.pendingReconnectTimeout=null,clearTimeout(this._reconnectTimeoutRef),this._suspendSubscriptions(),this._abortAllPendingEventsDueToBadConnection(n?"connectAbort":"disconnect"),this.options.autoReconnect&&(4e3==t||4001==t||1005==t?this._tryReconnect(0):1e3!=t&&t<4500&&this._tryReconnect()),n?i.prototype.emit.call(r,"connectAbort",t,e):i.prototype.emit.call(r,"disconnect",t,e),i.prototype.emit.call(r,"close",t,e),!E.ignoreStatuses[t]){var o;o=e?"Socket connection closed with status code "+t+" and reason: "+e:"Socket connection closed with status code "+t;var a=new y(E.errorStatuses[t]||o,t);this._onSCError(a)}},E.prototype._onSCEvent=function(t,e,n){var r=this._privateEventHandlerMap[t];r?r.call(this,e,n):i.prototype.emit.call(this,t,e,function(){n&&n.callback.apply(n,arguments)})},E.prototype.decode=function(t){return this.transport.decode(t)},E.prototype.encode=function(t){return this.transport.encode(t)},E.prototype._flushEmitBuffer=function(){for(var t,e=this._emitBuffer.head;e;){t=e.next;var n=e.data;e.detach(),this.transport.emitObject(n),e=t}},E.prototype._handleEventAckTimeout=function(t,e){e&&e.detach(),delete t.timeout;var n=t.callback;if(n){delete t.callback;var r=new m("Event response for '"+t.event+"' timed out");n.call(t,r,t)}t.cid&&this.transport.cancelPendingResponse(t.cid)},E.prototype._emit=function(t,e,n){var r=this;this.state==this.CLOSED&&this.connect();var i={event:t,callback:n},o=new l.Item;this.options.cloneData?i.data=f(e):i.data=e,o.data=i,i.timeout=setTimeout(function(){r._handleEventAckTimeout(i,o)},this.ackTimeout),this._emitBuffer.append(o),this.state==this.OPEN&&this._flushEmitBuffer()},E.prototype.send=function(t){this.transport.send(t)},E.prototype.emit=function(t,e,n){if(null==this._localEvents[t])this._emit(t,e,n);else if("error"==t)i.prototype.emit.call(this,t,e);else{var r=new g('The "'+t+'" event is reserved and cannot be emitted on a client socket');this._onSCError(r)}},E.prototype.publish=function(t,e,n){var r={channel:this._decorateChannelName(t),data:e};this.emit("#publish",r,n)},E.prototype._triggerChannelSubscribe=function(t,e){var n=t.name;if(t.state!=t.SUBSCRIBED){var r=t.state;t.state=t.SUBSCRIBED;var o={channel:n,oldState:r,newState:t.state,subscriptionOptions:e};t.emit("subscribeStateChange",o),t.emit("subscribe",n,e),i.prototype.emit.call(this,"subscribeStateChange",o),i.prototype.emit.call(this,"subscribe",n,e)}},E.prototype._triggerChannelSubscribeFail=function(t,e,n){var r=e.name,o=!e.waitForAuth||this.authState==this.AUTHENTICATED;e.state!=e.UNSUBSCRIBED&&o&&(e.state=e.UNSUBSCRIBED,e.emit("subscribeFail",t,r,n),i.prototype.emit.call(this,"subscribeFail",t,r,n))},E.prototype._cancelPendingSubscribeCallback=function(t){null!=t._pendingSubscriptionCid&&(this.transport.cancelPendingResponse(t._pendingSubscriptionCid),delete t._pendingSubscriptionCid)},E.prototype._decorateChannelName=function(t){return this.channelPrefix&&(t=this.channelPrefix+t),t},E.prototype._undecorateChannelName=function(t){return this.channelPrefix&&0==t.indexOf(this.channelPrefix)?t.replace(this.channelPrefix,""):t},E.prototype._trySubscribe=function(t){var e=this,n=!t.waitForAuth||this.authState==this.AUTHENTICATED;if(this.state==this.OPEN&&!this.preparingPendingSubscriptions&&null==t._pendingSubscriptionCid&&n){var r={noTimeout:!0},o={channel:this._decorateChannelName(t.name)};t.waitForAuth&&(r.waitForAuth=!0,o.waitForAuth=r.waitForAuth),t.data&&(o.data=t.data),t.batch&&(r.batch=!0,o.batch=!0),t._pendingSubscriptionCid=this.transport.emit("#subscribe",o,r,function(n){delete t._pendingSubscriptionCid,n?e._triggerChannelSubscribeFail(n,t,o):e._triggerChannelSubscribe(t,o)}),i.prototype.emit.call(this,"subscribeRequest",t.name,o)}},E.prototype.subscribe=function(t,e){var n=this.channels[t];return n?e&&n.setOptions(e):(n=new o(t,this,e),this.channels[t]=n),n.state==n.UNSUBSCRIBED&&(n.state=n.PENDING,this._trySubscribe(n)),n},E.prototype._triggerChannelUnsubscribe=function(t,e){var n=t.name,r=t.state;if(t.state=e||t.UNSUBSCRIBED,this._cancelPendingSubscribeCallback(t),r==t.SUBSCRIBED){var o={channel:n,oldState:r,newState:t.state};t.emit("subscribeStateChange",o),t.emit("unsubscribe",n),i.prototype.emit.call(this,"subscribeStateChange",o),i.prototype.emit.call(this,"unsubscribe",n)}},E.prototype._tryUnsubscribe=function(t){if(this.state==this.OPEN){var e={noTimeout:!0};t.batch&&(e.batch=!0),this._cancelPendingSubscribeCallback(t);var n=this._decorateChannelName(t.name);this.transport.emit("#unsubscribe",n,e)}},E.prototype.unsubscribe=function(t){var e=this.channels[t];e&&e.state!=e.UNSUBSCRIBED&&(this._triggerChannelUnsubscribe(e),this._tryUnsubscribe(e))},E.prototype.channel=function(t,e){var n=this.channels[t];return n||(n=new o(t,this,e),this.channels[t]=n),n},E.prototype.destroyChannel=function(t){var e=this.channels[t];e&&(e.unwatch(),e.unsubscribe(),delete this.channels[t])},E.prototype.subscriptions=function(t){var e,n=[];for(var r in this.channels)this.channels.hasOwnProperty(r)&&(e=this.channels[r],(t?e&&(e.state==e.SUBSCRIBED||e.state==e.PENDING):e&&e.state==e.SUBSCRIBED)&&n.push(r));return n},E.prototype.isSubscribed=function(t,e){var n=this.channels[t];return e?!!n&&(n.state==n.SUBSCRIBED||n.state==n.PENDING):!!n&&n.state==n.SUBSCRIBED},E.prototype.processPendingSubscriptions=function(){var t=this;this.preparingPendingSubscriptions=!1;var e=[];for(var n in this.channels)if(this.channels.hasOwnProperty(n)){var r=this.channels[n];r.state==r.PENDING&&e.push(r)}e.sort(function(t,e){var n=t.priority||0,r=e.priority||0;return n>r?-1:n<r?1:0}),e.forEach(function(e){t._trySubscribe(e)})},E.prototype.watch=function(t,e){if("function"!=typeof e)throw new d("No handler function was provided");this._channelEmitter.on(t,e)},E.prototype.unwatch=function(t,e){e?this._channelEmitter.removeListener(t,e):this._channelEmitter.removeAllListeners(t)},E.prototype.watchers=function(t){return this._channelEmitter.listeners(t)},t.exports=E}).call(this,n(8),n(256).Buffer)},function(t,e,n){"use strict";(function(t){function r(){return o.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function i(t,e){if(r()<e)throw new RangeError("Invalid typed array length");return o.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=o.prototype:(null===t&&(t=new o(e)),t.length=e),t}function o(t,e,n){if(!(o.TYPED_ARRAY_SUPPORT||this instanceof o))return new o(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return u(this,t)}return a(this,t,e,n)}function a(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r),o.TYPED_ARRAY_SUPPORT?(t=e).__proto__=o.prototype:t=c(t,e),t}(t,e,n,r):"string"==typeof e?function(t,e,n){if("string"==typeof n&&""!==n||(n="utf8"),!o.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|h(e,n),a=(t=i(t,r)).write(e,n);return a!==r&&(t=t.slice(0,a)),t}(t,e,n):function(t,e){if(o.isBuffer(e)){var n=0|l(e.length);return 0===(t=i(t,n)).length?t:(e.copy(t,0,0,n),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||function(t){return t!=t}(e.length)?i(t,0):c(t,e);if("Buffer"===e.type&&B(e.data))return c(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function s(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function u(t,e){if(s(e),t=i(t,e<0?0:0|l(e)),!o.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function c(t,e){var n=e.length<0?0:0|l(e.length);t=i(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function l(t){if(t>=r())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r().toString(16)+" bytes");return 0|t}function h(t,e){if(o.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return M(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return L(t).length;default:if(r)return M(t).length;e=(""+e).toLowerCase(),r=!0}}function f(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function p(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=o.from(e,r)),o.isBuffer(e))return 0===e.length?-1:d(t,e,n,r,i);if("number"==typeof e)return e&=255,o.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):d(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function d(t,e,n,r,i){function o(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}var a,s=1,u=t.length,c=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s=2,u/=2,c/=2,n/=2}if(i){var l=-1;for(a=n;a<u;a++)if(o(t,a)===o(e,-1===l?0:a-l)){if(-1===l&&(l=a),a-l+1===c)return l*s}else-1!==l&&(a-=a-l),l=-1}else for(n+c>u&&(n=u-c),a=n;a>=0;a--){for(var h=!0,f=0;f<c;f++)if(o(t,a+f)!==o(e,f)){h=!1;break}if(h)return a}return-1}function v(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=e.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var a=0;a<r;++a){var s=parseInt(e.substr(2*a,2),16);if(isNaN(s))return a;t[n+a]=s}return a}function g(t,e,n,r){return F(M(e,t.length-n),t,n,r)}function y(t,e,n,r){return F(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function m(t,e,n,r){return y(t,e,n,r)}function _(t,e,n,r){return F(L(e),t,n,r)}function b(t,e,n,r){return F(function(t,e){for(var n,r,i,o=[],a=0;a<t.length&&!((e-=2)<0);++a)n=t.charCodeAt(a),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(e,t.length-n),t,n,r)}function E(t,e,n){return 0===e&&n===t.length?U.fromByteArray(t):U.fromByteArray(t.slice(e,n))}function w(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var o,a,s,u,c=t[i],l=null,h=c>239?4:c>223?3:c>191?2:1;if(i+h<=n)switch(h){case 1:c<128&&(l=c);break;case 2:128==(192&(o=t[i+1]))&&(u=(31&c)<<6|63&o)>127&&(l=u);break;case 3:o=t[i+1],a=t[i+2],128==(192&o)&&128==(192&a)&&(u=(15&c)<<12|(63&o)<<6|63&a)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:o=t[i+1],a=t[i+2],s=t[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(u=(15&c)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&u<1114112&&(l=u)}null===l?(l=65533,h=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=h}return function(t){var e=t.length;if(e<=V)return String.fromCharCode.apply(String,t);for(var n="",r=0;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=V));return n}(r)}function S(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function T(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function I(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=e;o<n;++o)i+=x(t[o]);return i}function A(t,e,n){for(var r=t.slice(e,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function O(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function C(t,e,n,r,i,a){if(!o.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<a)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function R(t,e,n,r){e<0&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-n,2);i<o;++i)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function N(t,e,n,r){e<0&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-n,4);i<o;++i)t[n+i]=e>>>8*(r?i:3-i)&255}function k(t,e,n,r,i,o){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function P(t,e,n,r,i){return i||k(t,0,n,4),j.write(t,e,n,r,23,4),n+4}function D(t,e,n,r,i){return i||k(t,0,n,8),j.write(t,e,n,r,52,8),n+8}function x(t){return t<16?"0"+t.toString(16):t.toString(16)}function M(t,e){e=e||1/0;for(var n,r=t.length,i=null,o=[],a=0;a<r;++a){if((n=t.charCodeAt(a))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(a+1===r){(e-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function L(t){return U.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(W,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function F(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}var U=n(595),j=n(596),B=n(597);e.Buffer=o,e.SlowBuffer=function(t){return+t!=t&&(t=0),o.alloc(+t)},e.INSPECT_MAX_BYTES=50,o.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=r(),o.poolSize=8192,o._augment=function(t){return t.__proto__=o.prototype,t},o.from=function(t,e,n){return a(null,t,e,n)},o.TYPED_ARRAY_SUPPORT&&(o.prototype.__proto__=Uint8Array.prototype,o.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&o[Symbol.species]===o&&Object.defineProperty(o,Symbol.species,{value:null,configurable:!0})),o.alloc=function(t,e,n){return function(t,e,n,r){return s(e),e<=0?i(t,e):void 0!==n?"string"==typeof r?i(t,e).fill(n,r):i(t,e).fill(n):i(t,e)}(null,t,e,n)},o.allocUnsafe=function(t){return u(null,t)},o.allocUnsafeSlow=function(t){return u(null,t)},o.isBuffer=function(t){return!(null==t||!t._isBuffer)},o.compare=function(t,e){if(!o.isBuffer(t)||!o.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,i=0,a=Math.min(n,r);i<a;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},o.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(t,e){if(!B(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return o.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=o.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var a=t[n];if(!o.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,i),i+=a.length}return r},o.byteLength=h,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)f(this,e,e+1);return this},o.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)f(this,e,e+3),f(this,e+1,e+2);return this},o.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)f(this,e,e+7),f(this,e+1,e+6),f(this,e+2,e+5),f(this,e+3,e+4);return this},o.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?w(this,0,t):function(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return I(this,e,n);case"utf8":case"utf-8":return w(this,e,n);case"ascii":return S(this,e,n);case"latin1":case"binary":return T(this,e,n);case"base64":return E(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}.apply(this,arguments)},o.prototype.equals=function(t){if(!o.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===o.compare(this,t)},o.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},o.prototype.compare=function(t,e,n,r,i){if(!o.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(this===t)return 0;for(var a=(i>>>=0)-(r>>>=0),s=(n>>>=0)-(e>>>=0),u=Math.min(a,s),c=this.slice(r,i),l=t.slice(e,n),h=0;h<u;++h)if(c[h]!==l[h]){a=c[h],s=l[h];break}return a<s?-1:s<a?1:0},o.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},o.prototype.indexOf=function(t,e,n){return p(this,t,e,n,!0)},o.prototype.lastIndexOf=function(t,e,n){return p(this,t,e,n,!1)},o.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return v(this,t,e,n);case"utf8":case"utf-8":return g(this,t,e,n);case"ascii":return y(this,t,e,n);case"latin1":case"binary":return m(this,t,e,n);case"base64":return _(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return b(this,t,e,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var V=4096;o.prototype.slice=function(t,e){var n,r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),o.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=o.prototype;else{var i=e-t;n=new o(i,void 0);for(var a=0;a<i;++a)n[a]=this[a+t]}return n},o.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||O(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r},o.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||O(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},o.prototype.readUInt8=function(t,e){return e||O(t,1,this.length),this[t]},o.prototype.readUInt16LE=function(t,e){return e||O(t,2,this.length),this[t]|this[t+1]<<8},o.prototype.readUInt16BE=function(t,e){return e||O(t,2,this.length),this[t]<<8|this[t+1]},o.prototype.readUInt32LE=function(t,e){return e||O(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},o.prototype.readUInt32BE=function(t,e){return e||O(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},o.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||O(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},o.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||O(t,e,this.length);for(var r=e,i=1,o=this[t+--r];r>0&&(i*=256);)o+=this[t+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},o.prototype.readInt8=function(t,e){return e||O(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},o.prototype.readInt16LE=function(t,e){e||O(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},o.prototype.readInt16BE=function(t,e){e||O(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},o.prototype.readInt32LE=function(t,e){return e||O(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},o.prototype.readInt32BE=function(t,e){return e||O(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},o.prototype.readFloatLE=function(t,e){return e||O(t,4,this.length),j.read(this,t,!0,23,4)},o.prototype.readFloatBE=function(t,e){return e||O(t,4,this.length),j.read(this,t,!1,23,4)},o.prototype.readDoubleLE=function(t,e){return e||O(t,8,this.length),j.read(this,t,!0,52,8)},o.prototype.readDoubleBE=function(t,e){return e||O(t,8,this.length),j.read(this,t,!1,52,8)},o.prototype.writeUIntLE=function(t,e,n,r){t=+t,e|=0,n|=0,r||C(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[e]=255&t;++o<n&&(i*=256);)this[e+o]=t/i&255;return e+n},o.prototype.writeUIntBE=function(t,e,n,r){t=+t,e|=0,n|=0,r||C(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+n},o.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,1,255,0),o.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},o.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):R(this,t,e,!0),e+2},o.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):R(this,t,e,!1),e+2},o.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):N(this,t,e,!0),e+4},o.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):N(this,t,e,!1),e+4},o.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);C(this,t,e,n,i-1,-i)}var o=0,a=1,s=0;for(this[e]=255&t;++o<n&&(a*=256);)t<0&&0===s&&0!==this[e+o-1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+n},o.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);C(this,t,e,n,i-1,-i)}var o=n-1,a=1,s=0;for(this[e+o]=255&t;--o>=0&&(a*=256);)t<0&&0===s&&0!==this[e+o+1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+n},o.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,1,127,-128),o.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},o.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):R(this,t,e,!0),e+2},o.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):R(this,t,e,!1),e+2},o.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,4,2147483647,-2147483648),o.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):N(this,t,e,!0),e+4},o.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||C(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),o.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):N(this,t,e,!1),e+4},o.prototype.writeFloatLE=function(t,e,n){return P(this,t,e,!0,n)},o.prototype.writeFloatBE=function(t,e,n){return P(this,t,e,!1,n)},o.prototype.writeDoubleLE=function(t,e,n){return D(this,t,e,!0,n)},o.prototype.writeDoubleBE=function(t,e,n){return D(this,t,e,!1,n)},o.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i,a=r-n;if(this===t&&n<e&&e<r)for(i=a-1;i>=0;--i)t[i+e]=this[i+n];else if(a<1e3||!o.TYPED_ARRAY_SUPPORT)for(i=0;i<a;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+a),e);return a},o.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!o.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var a;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(a=e;a<n;++a)this[a]=t;else{var s=o.isBuffer(t)?t:M(new o(t,r).toString()),u=s.length;for(a=0;a<n-e;++a)this[a+e]=s[a%u]}return this};var W=/[^+\/0-9A-Za-z-_]/g}).call(this,n(8))},function(t,e,n){var r=n(116),i=r.InvalidActionError,o=function(t,e){this.socket=t,this.id=e,this.sent=!1};o.prototype._respond=function(t){if(this.sent)throw new i("Response "+this.id+" has already been sent");this.sent=!0,this.socket.send(this.socket.encode(t))},o.prototype.end=function(t){if(this.id){var e={rid:this.id};void 0!==t&&(e.data=t),this._respond(e)}},o.prototype.error=function(t,e){if(this.id){var n=r.dehydrateError(t),i={rid:this.id,error:n};void 0!==e&&(i.data=e),this._respond(i)}},o.prototype.callback=function(t,e){t?this.error(t,e):this.end(e)},t.exports.Response=o},function(t,e,n){"use strict";e.decode=e.parse=n(603),e.encode=e.stringify=n(604)},function(t,e){var n="undefined"!=typeof crypto&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);t.exports=function(){return n(r),r}}else{var i=new Array(16);t.exports=function(){for(var t,e=0;e<16;e++)0==(3&e)&&(t=4294967296*Math.random()),i[e]=t>>>((3&e)<<3)&255;return i}}},function(t,e){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);t.exports=function(t,e){var r=e||0,i=n;return i[t[r++]]+i[t[r++]]+i[t[r++]]+i[t[r++]]+"-"+i[t[r++]]+i[t[r++]]+"-"+i[t[r++]]+i[t[r++]]+"-"+i[t[r++]]+i[t[r++]]+"-"+i[t[r++]]+i[t[r++]]+i[t[r++]]+i[t[r++]]+i[t[r++]]+i[t[r++]]}},function(t,e,n){var r=n(75),i=n(167),o="[object AsyncFunction]",a="[object Function]",s="[object GeneratorFunction]",u="[object Proxy]";t.exports=function(t){if(!i(t))return!1;var e=r(t);return e==a||e==s||e==o||e==u}},function(t,e,n){(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.exports=n}).call(this,n(8))},function(t,e){var n=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return n.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},function(t,e){t.exports=function(t,e){return t===e||t!=t&&e!=e}},function(t,e,n){var r=n(643);t.exports=function(t,e){return!(null==t||!t.length)&&r(t,e,0)>-1}},function(t,e){t.exports=function(t,e,n){for(var r=-1,i=null==t?0:t.length;++r<i;)if(n(e,t[r]))return!0;return!1}},function(t,e){t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}},function(t,e){t.exports=function(t){return function(e){return t(e)}}},function(t,e,n){var r=n(270),i=n(647);t.exports=function t(e,n,o,a,s){var u=-1,c=e.length;for(o||(o=i),s||(s=[]);++u<c;){var l=e[u];n>0&&o(l)?n>1?t(l,n-1,o,a,s):r(s,l):a||(s[s.length]=l)}return s}},function(t,e){t.exports=function(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}},function(t,e,n){var r=n(171),i=n(649),o=n(651);t.exports=function(t,e){return o(i(t,e,r),t+"")}},function(t,e,n){var r=n(67),i=function(){try{var t=r(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();t.exports=i},function(t,e,n){var r=n(274),i=n(68);t.exports=function(t){return i(t)&&r(t)}},function(t,e,n){var r=n(261),i=n(172);t.exports=function(t){return null!=t&&i(t.length)&&!r(t)}},function(t,e,n){var r=n(67)(n(45),"Set");t.exports=r},function(t,e){t.exports=function(t,e){return function(n){return t(e(n))}}},function(t,e,n){(function(t){var r=n(45),i=n(685),o=e&&!e.nodeType&&e,a=o&&"object"==typeof t&&t&&!t.nodeType&&t,s=a&&a.exports===o?r.Buffer:void 0,u=(s?s.isBuffer:void 0)||i;t.exports=u}).call(this,n(113)(t))},function(t,e){var n=9007199254740991,r=/^(?:0|[1-9]\d*)$/;t.exports=function(t,e){var i=typeof t;return!!(e=null==e?n:e)&&("number"==i||"symbol"!=i&&r.test(t))&&t>-1&&t%1==0&&t<e}},function(t,e,n){var r=n(686),i=n(268),o=n(687),a=o&&o.isTypedArray,s=a?i(a):r;t.exports=s},function(t,e,n){function r(t){var e=this.__data__=new i(t);this.size=e.size}var i=n(118),o=n(694),a=n(695),s=n(696),u=n(697),c=n(698);r.prototype.clear=o,r.prototype.delete=a,r.prototype.get=s,r.prototype.has=u,r.prototype.set=c,t.exports=r},function(t,e,n){var r=n(699),i=n(68);t.exports=function t(e,n,o,a,s){return e===n||(null==e||null==n||!i(e)&&!i(n)?e!=e&&n!=n:r(e,n,o,a,t,s))}},function(t,e,n){var r=n(165),i=n(700),o=n(169),a=1,s=2;t.exports=function(t,e,n,u,c,l){var h=n&a,f=t.length,p=e.length;if(f!=p&&!(h&&p>f))return!1;var d=l.get(t);if(d&&l.get(e))return d==e;var v=-1,g=!0,y=n&s?new r:void 0;for(l.set(t,e),l.set(e,t);++v<f;){var m=t[v],_=e[v];if(u)var b=h?u(_,m,v,e,t,l):u(m,_,v,t,e,l);if(void 0!==b){if(b)continue;g=!1;break}if(y){if(!i(e,function(t,e){if(!o(y,e)&&(m===t||c(m,t,n,u,l)))return y.push(e)})){g=!1;break}}else if(m!==_&&!c(m,_,n,u,l)){g=!1;break}}return l.delete(t),l.delete(e),g}},function(t,e,n){var r=n(167);t.exports=function(t){return t==t&&!r(t)}},function(t,e){t.exports=function(t,e){return function(n){return null!=n&&n[t]===e&&(void 0!==e||t in Object(n))}}},function(t,e,n){var r=n(286),i=n(122);t.exports=function(t,e){for(var n=0,o=(e=r(e,t)).length;null!=t&&n<o;)t=t[i(e[n++])];return n&&n==o?t:void 0}},function(t,e,n){var r=n(46),i=n(175),o=n(717),a=n(720);t.exports=function(t,e){return r(t)?t:i(t,e)?[t]:o(a(t))}},function(t,e,n){"use strict";function r(t){var e,n=t.Symbol;return"function"==typeof n?n.observable?e=n.observable:(e=n("observable"),n.observable=e):e="@@observable",e}n.d(e,"a",function(){return r})},function(t,e,n){"use strict";(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t;e.a=n}).call(this,n(8))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n(290);var r=n(103),i=n(739),o=n(493),a=n(494),s=n(496),u=n(498),c=n(574),l=n(248),h=n(575),f=n(577),p=n(578),d=n(581),v=n(588),g=n(589),y=n(590),m=n(728),_=n(729),b=n(49),E=n(730),w=n(731),S=n(733),T=n(734),I=n(18),A=n(735),O=n(736),C=chrome.runtime.getManifest().version;console.log("Background App init:",C),chrome.runtime.setUninstallURL(StaticConstants.APP_BASE_PATH+"app/log-redirect;email=Anonymous;name=Anonymous;uid=Anonymous;version="+C);var R=i.combineReducers({chromeTabsReducer:a.chromeTabsReducer,workspaceReducer:l.workspaceReducer,dataReducer:w.dataReducer,firebaseAuthReducer:S.firebaseAuthReducer,syncProcessReducer:d.syncProcessReducer,questionnaireReducer:O.questionnaireReducer,pdfReducer:v.pdfReducer,stripeReducer:g.stripeReducer,chromeIconReducer:_.chromeIconReducer,loggerRedcuer:E.loggerRedcuer,onboardingReducer:T.onboardingReducer}),N=null;"Local"===StaticConstants.ENVIRONMENT||"Testing"===StaticConstants.ENVIRONMENT?(r.weavaFirebaseLogger.logEnabled=!0,b.weavaLogger.logEnabled=!0,N=i.createStore(R,y.composeWithDevTools(i.applyMiddleware(o.default)))):(N=i.createStore(R,i.applyMiddleware(o.default)),I.TrackerActions.enableTracking=!0,I.TrackerActions.app="CHROME_EXTENSION"),new p.FirebaseView(N),new s.ChromeTabsView(N),new u.ChromeMessageView(N),new c.ChromeIconView(N),new h.PdfHandlerView(N),new f.ChromeLocalStorageView(N),new m.ChromeShortcutView(N),new A.ChromeContextMenuView(N)},function(t,e,n){"use strict";(function(t){function e(t,e,n){t[e]||Object[r](t,e,{writable:!0,configurable:!0,value:n})}if(n(291),n(488),n(489),t._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");t._babelPolyfill=!0;var r="defineProperty";e(String.prototype,"padLeft","".padStart),e(String.prototype,"padRight","".padEnd),"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach(function(t){[][t]&&e(Array,t,Function.call.bind([][t]))})}).call(this,n(8))},function(t,e,n){n(292),n(294),n(295),n(296),n(297),n(298),n(299),n(300),n(301),n(302),n(303),n(304),n(305),n(306),n(307),n(308),n(310),n(311),n(312),n(313),n(314),n(315),n(316),n(317),n(318),n(319),n(320),n(321),n(322),n(323),n(324),n(325),n(326),n(327),n(328),n(329),n(330),n(331),n(332),n(333),n(334),n(335),n(336),n(337),n(338),n(339),n(340),n(341),n(342),n(343),n(344),n(345),n(346),n(347),n(348),n(349),n(350),n(351),n(352),n(353),n(354),n(355),n(356),n(357),n(358),n(359),n(360),n(361),n(362),n(363),n(364),n(365),n(366),n(367),n(368),n(369),n(370),n(372),n(373),n(375),n(376),n(377),n(378),n(379),n(380),n(381),n(383),n(384),n(385),n(386),n(387),n(388),n(389),n(390),n(391),n(392),n(393),n(394),n(395),n(145),n(396),n(397),n(195),n(398),n(399),n(400),n(401),n(402),n(198),n(200),n(201),n(403),n(404),n(405),n(406),n(407),n(408),n(409),n(410),n(411),n(412),n(413),n(414),n(415),n(416),n(417),n(418),n(419),n(420),n(421),n(422),n(423),n(424),n(425),n(426),n(427),n(428),n(429),n(430),n(431),n(432),n(433),n(434),n(435),n(436),n(437),n(438),n(439),n(440),n(441),n(442),n(443),n(444),n(445),n(446),n(447),n(448),n(449),n(450),n(451),n(452),n(453),n(454),n(455),n(456),n(457),n(458),n(459),n(460),n(461),n(462),n(463),n(464),n(465),n(466),n(467),n(468),n(469),n(470),n(471),n(472),n(473),n(474),n(475),n(476),n(477),n(478),n(479),n(480),n(481),n(482),n(483),n(484),n(485),n(486),n(487),t.exports=n(34)},function(t,e,n){"use strict";var r=n(3),i=n(25),o=n(10),a=n(0),s=n(21),u=n(47).KEY,c=n(5),l=n(89),h=n(69),f=n(52),p=n(7),d=n(178),v=n(125),g=n(293),y=n(92),m=n(2),_=n(6),b=n(26),E=n(35),w=n(51),S=n(56),T=n(181),I=n(27),A=n(11),O=n(54),C=I.f,R=A.f,N=T.f,k=r.Symbol,P=r.JSON,D=P&&P.stringify,x=p("_hidden"),M=p("toPrimitive"),L={}.propertyIsEnumerable,F=l("symbol-registry"),U=l("symbols"),j=l("op-symbols"),B=Object.prototype,V="function"==typeof k,W=r.QObject,q=!W||!W.prototype||!W.prototype.findChild,H=o&&c(function(){return 7!=S(R({},"a",{get:function(){return R(this,"a",{value:7}).a}})).a})?function(t,e,n){var r=C(B,e);r&&delete B[e],R(t,e,n),r&&t!==B&&R(B,e,r)}:R,G=function(t){var e=U[t]=S(k.prototype);return e._k=t,e},K=V&&"symbol"==typeof k.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof k},z=function(t,e,n){return t===B&&z(j,e,n),m(t),e=E(e,!0),m(n),i(U,e)?(n.enumerable?(i(t,x)&&t[x][e]&&(t[x][e]=!1),n=S(n,{enumerable:w(0,!1)})):(i(t,x)||R(t,x,w(1,{})),t[x][e]=!0),H(t,e,n)):R(t,e,n)},Q=function(t,e){m(t);for(var n,r=g(e=b(e)),i=0,o=r.length;o>i;)z(t,n=r[i++],e[n]);return t},X=function(t){var e=L.call(this,t=E(t,!0));return!(this===B&&i(U,t)&&!i(j,t))&&(!(e||!i(this,t)||!i(U,t)||i(this,x)&&this[x][t])||e)},Y=function(t,e){if(t=b(t),e=E(e,!0),t!==B||!i(U,e)||i(j,e)){var n=C(t,e);return!n||!i(U,e)||i(t,x)&&t[x][e]||(n.enumerable=!0),n}},J=function(t){for(var e,n=N(b(t)),r=[],o=0;n.length>o;)i(U,e=n[o++])||e==x||e==u||r.push(e);return r},$=function(t){for(var e,n=t===B,r=N(n?j:b(t)),o=[],a=0;r.length>a;)!i(U,e=r[a++])||n&&!i(B,e)||o.push(U[e]);return o};V||(s((k=function(){if(this instanceof k)throw TypeError("Symbol is not a constructor!");var t=f(arguments.length>0?arguments[0]:void 0),e=function(n){this===B&&e.call(j,n),i(this,x)&&i(this[x],t)&&(this[x][t]=!1),H(this,t,w(1,n))};return o&&q&&H(B,t,{configurable:!0,set:e}),G(t)}).prototype,"toString",function(){return this._k}),I.f=Y,A.f=z,n(57).f=T.f=J,n(77).f=X,n(91).f=$,o&&!n(53)&&s(B,"propertyIsEnumerable",X,!0),d.f=function(t){return G(p(t))}),a(a.G+a.W+a.F*!V,{Symbol:k});for(var Z="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),tt=0;Z.length>tt;)p(Z[tt++]);for(var et=O(p.store),nt=0;et.length>nt;)v(et[nt++]);a(a.S+a.F*!V,"Symbol",{for:function(t){return i(F,t+="")?F[t]:F[t]=k(t)},keyFor:function(t){if(!K(t))throw TypeError(t+" is not a symbol!");for(var e in F)if(F[e]===t)return e},useSetter:function(){q=!0},useSimple:function(){q=!1}}),a(a.S+a.F*!V,"Object",{create:function(t,e){return void 0===e?S(t):Q(S(t),e)},defineProperty:z,defineProperties:Q,getOwnPropertyDescriptor:Y,getOwnPropertyNames:J,getOwnPropertySymbols:$}),P&&a(a.S+a.F*(!V||c(function(){var t=k();return"[null]"!=D([t])||"{}"!=D({a:t})||"{}"!=D(Object(t))})),"JSON",{stringify:function(t){for(var e,n,r=[t],i=1;arguments.length>i;)r.push(arguments[i++]);if(n=e=r[1],(_(e)||void 0!==t)&&!K(t))return y(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!K(e))return e}),r[1]=e,D.apply(P,r)}}),k.prototype[M]||n(20)(k.prototype,M,k.prototype.valueOf),h(k,"Symbol"),h(Math,"Math",!0),h(r.JSON,"JSON",!0)},function(t,e,n){var r=n(54),i=n(91),o=n(77);t.exports=function(t){var e=r(t),n=i.f;if(n)for(var a,s=n(t),u=o.f,c=0;s.length>c;)u.call(t,a=s[c++])&&e.push(a);return e}},function(t,e,n){var r=n(0);r(r.S,"Object",{create:n(56)})},function(t,e,n){var r=n(0);r(r.S+r.F*!n(10),"Object",{defineProperty:n(11).f})},function(t,e,n){var r=n(0);r(r.S+r.F*!n(10),"Object",{defineProperties:n(180)})},function(t,e,n){var r=n(26),i=n(27).f;n(38)("getOwnPropertyDescriptor",function(){return function(t,e){return i(r(t),e)}})},function(t,e,n){var r=n(14),i=n(28);n(38)("getPrototypeOf",function(){return function(t){return i(r(t))}})},function(t,e,n){var r=n(14),i=n(54);n(38)("keys",function(){return function(t){return i(r(t))}})},function(t,e,n){n(38)("getOwnPropertyNames",function(){return n(181).f})},function(t,e,n){var r=n(6),i=n(47).onFreeze;n(38)("freeze",function(t){return function(e){return t&&r(e)?t(i(e)):e}})},function(t,e,n){var r=n(6),i=n(47).onFreeze;n(38)("seal",function(t){return function(e){return t&&r(e)?t(i(e)):e}})},function(t,e,n){var r=n(6),i=n(47).onFreeze;n(38)("preventExtensions",function(t){return function(e){return t&&r(e)?t(i(e)):e}})},function(t,e,n){var r=n(6);n(38)("isFrozen",function(t){return function(e){return!r(e)||!!t&&t(e)}})},function(t,e,n){var r=n(6);n(38)("isSealed",function(t){return function(e){return!r(e)||!!t&&t(e)}})},function(t,e,n){var r=n(6);n(38)("isExtensible",function(t){return function(e){return!!r(e)&&(!t||t(e))}})},function(t,e,n){var r=n(0);r(r.S+r.F,"Object",{assign:n(182)})},function(t,e,n){var r=n(0);r(r.S,"Object",{is:n(309)})},function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}},function(t,e,n){var r=n(0);r(r.S,"Object",{setPrototypeOf:n(129).set})},function(t,e,n){"use strict";var r=n(78),i={};i[n(7)("toStringTag")]="z",i+""!="[object z]"&&n(21)(Object.prototype,"toString",function(){return"[object "+r(this)+"]"},!0)},function(t,e,n){var r=n(0);r(r.P,"Function",{bind:n(183)})},function(t,e,n){var r=n(11).f,i=Function.prototype,o=/^\s*function ([^ (]*)/;"name"in i||n(10)&&r(i,"name",{configurable:!0,get:function(){try{return(""+this).match(o)[1]}catch(t){return""}}})},function(t,e,n){"use strict";var r=n(6),i=n(28),o=n(7)("hasInstance"),a=Function.prototype;o in a||n(11).f(a,o,{value:function(t){if("function"!=typeof this||!r(t))return!1;if(!r(this.prototype))return t instanceof this;for(;t=i(t);)if(this.prototype===t)return!0;return!1}})},function(t,e,n){var r=n(0),i=n(185);r(r.G+r.F*(parseInt!=i),{parseInt:i})},function(t,e,n){var r=n(0),i=n(186);r(r.G+r.F*(parseFloat!=i),{parseFloat:i})},function(t,e,n){"use strict";var r=n(3),i=n(25),o=n(31),a=n(131),s=n(35),u=n(5),c=n(57).f,l=n(27).f,h=n(11).f,f=n(70).trim,p=r.Number,d=p,v=p.prototype,g="Number"==o(n(56)(v)),y="trim"in String.prototype,m=function(t){var e=s(t,!1);if("string"==typeof e&&e.length>2){var n,r,i,o=(e=y?e.trim():f(e,3)).charCodeAt(0);if(43===o||45===o){if(88===(n=e.charCodeAt(2))||120===n)return NaN}else if(48===o){switch(e.charCodeAt(1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+e}for(var a,u=e.slice(2),c=0,l=u.length;c<l;c++)if((a=u.charCodeAt(c))<48||a>i)return NaN;return parseInt(u,r)}}return+e};if(!p(" 0o1")||!p("0b1")||p("+0x1")){p=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof p&&(g?u(function(){v.valueOf.call(n)}):"Number"!=o(n))?a(new d(m(e)),n,p):m(e)};for(var _,b=n(10)?c(d):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),E=0;b.length>E;E++)i(d,_=b[E])&&!i(p,_)&&h(p,_,l(d,_));p.prototype=v,v.constructor=p,n(21)(r,"Number",p)}},function(t,e,n){"use strict";var r=n(0),i=n(37),o=n(187),a=n(132),s=1..toFixed,u=Math.floor,c=[0,0,0,0,0,0],l="Number.toFixed: incorrect invocation!",h=function(t,e){for(var n=-1,r=e;++n<6;)r+=t*c[n],c[n]=r%1e7,r=u(r/1e7)},f=function(t){for(var e=6,n=0;--e>=0;)n+=c[e],c[e]=u(n/t),n=n%t*1e7},p=function(){for(var t=6,e="";--t>=0;)if(""!==e||0===t||0!==c[t]){var n=String(c[t]);e=""===e?n:e+a.call("0",7-n.length)+n}return e},d=function(t,e,n){return 0===e?n:e%2==1?d(t,e-1,n*t):d(t*t,e/2,n)};r(r.P+r.F*(!!s&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!n(5)(function(){s.call({})})),"Number",{toFixed:function(t){var e,n,r,s,u=o(this,l),c=i(t),v="",g="0";if(c<0||c>20)throw RangeError(l);if(u!=u)return"NaN";if(u<=-1e21||u>=1e21)return String(u);if(u<0&&(v="-",u=-u),u>1e-21)if(e=function(t){for(var e=0,n=t;n>=4096;)e+=12,n/=4096;for(;n>=2;)e+=1,n/=2;return e}(u*d(2,69,1))-69,n=e<0?u*d(2,-e,1):u/d(2,e,1),n*=4503599627370496,(e=52-e)>0){for(h(0,n),r=c;r>=7;)h(1e7,0),r-=7;for(h(d(10,r,1),0),r=e-1;r>=23;)f(1<<23),r-=23;f(1<<r),h(1,1),f(2),g=p()}else h(0,n),h(1<<-e,0),g=p()+a.call("0",c);return c>0?g=v+((s=g.length)<=c?"0."+a.call("0",c-s)+g:g.slice(0,s-c)+"."+g.slice(s-c)):g=v+g,g}})},function(t,e,n){"use strict";var r=n(0),i=n(5),o=n(187),a=1..toPrecision;r(r.P+r.F*(i(function(){return"1"!==a.call(1,void 0)})||!i(function(){a.call({})})),"Number",{toPrecision:function(t){var e=o(this,"Number#toPrecision: incorrect invocation!");return void 0===t?a.call(e):a.call(e,t)}})},function(t,e,n){var r=n(0);r(r.S,"Number",{EPSILON:Math.pow(2,-52)})},function(t,e,n){var r=n(0),i=n(3).isFinite;r(r.S,"Number",{isFinite:function(t){return"number"==typeof t&&i(t)}})},function(t,e,n){var r=n(0);r(r.S,"Number",{isInteger:n(188)})},function(t,e,n){var r=n(0);r(r.S,"Number",{isNaN:function(t){return t!=t}})},function(t,e,n){var r=n(0),i=n(188),o=Math.abs;r(r.S,"Number",{isSafeInteger:function(t){return i(t)&&o(t)<=9007199254740991}})},function(t,e,n){var r=n(0);r(r.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(t,e,n){var r=n(0);r(r.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(t,e,n){var r=n(0),i=n(186);r(r.S+r.F*(Number.parseFloat!=i),"Number",{parseFloat:i})},function(t,e,n){var r=n(0),i=n(185);r(r.S+r.F*(Number.parseInt!=i),"Number",{parseInt:i})},function(t,e,n){var r=n(0),i=n(189),o=Math.sqrt,a=Math.acosh;r(r.S+r.F*!(a&&710==Math.floor(a(Number.MAX_VALUE))&&a(1/0)==1/0),"Math",{acosh:function(t){return(t=+t)<1?NaN:t>94906265.62425156?Math.log(t)+Math.LN2:i(t-1+o(t-1)*o(t+1))}})},function(t,e,n){var r=n(0),i=Math.asinh;r(r.S+r.F*!(i&&1/i(0)>0),"Math",{asinh:function t(e){return isFinite(e=+e)&&0!=e?e<0?-t(-e):Math.log(e+Math.sqrt(e*e+1)):e}})},function(t,e,n){var r=n(0),i=Math.atanh;r(r.S+r.F*!(i&&1/i(-0)<0),"Math",{atanh:function(t){return 0==(t=+t)?t:Math.log((1+t)/(1-t))/2}})},function(t,e,n){var r=n(0),i=n(133);r(r.S,"Math",{cbrt:function(t){return i(t=+t)*Math.pow(Math.abs(t),1/3)}})},function(t,e,n){var r=n(0);r(r.S,"Math",{clz32:function(t){return(t>>>=0)?31-Math.floor(Math.log(t+.5)*Math.LOG2E):32}})},function(t,e,n){var r=n(0),i=Math.exp;r(r.S,"Math",{cosh:function(t){return(i(t=+t)+i(-t))/2}})},function(t,e,n){var r=n(0),i=n(134);r(r.S+r.F*(i!=Math.expm1),"Math",{expm1:i})},function(t,e,n){var r=n(0);r(r.S,"Math",{fround:n(190)})},function(t,e,n){var r=n(0),i=Math.abs;r(r.S,"Math",{hypot:function(t,e){for(var n,r,o=0,a=0,s=arguments.length,u=0;a<s;)u<(n=i(arguments[a++]))?(o=o*(r=u/n)*r+1,u=n):n>0?o+=(r=n/u)*r:o+=n;return u===1/0?1/0:u*Math.sqrt(o)}})},function(t,e,n){var r=n(0),i=Math.imul;r(r.S+r.F*n(5)(function(){return-5!=i(4294967295,5)||2!=i.length}),"Math",{imul:function(t,e){var n=+t,r=+e,i=65535&n,o=65535&r;return 0|i*o+((65535&n>>>16)*o+i*(65535&r>>>16)<<16>>>0)}})},function(t,e,n){var r=n(0);r(r.S,"Math",{log10:function(t){return Math.log(t)*Math.LOG10E}})},function(t,e,n){var r=n(0);r(r.S,"Math",{log1p:n(189)})},function(t,e,n){var r=n(0);r(r.S,"Math",{log2:function(t){return Math.log(t)/Math.LN2}})},function(t,e,n){var r=n(0);r(r.S,"Math",{sign:n(133)})},function(t,e,n){var r=n(0),i=n(134),o=Math.exp;r(r.S+r.F*n(5)(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(t){return Math.abs(t=+t)<1?(i(t)-i(-t))/2:(o(t-1)-o(-t-1))*(Math.E/2)}})},function(t,e,n){var r=n(0),i=n(134),o=Math.exp;r(r.S,"Math",{tanh:function(t){var e=i(t=+t),n=i(-t);return e==1/0?1:n==1/0?-1:(e-n)/(o(t)+o(-t))}})},function(t,e,n){var r=n(0);r(r.S,"Math",{trunc:function(t){return(t>0?Math.floor:Math.ceil)(t)}})},function(t,e,n){var r=n(0),i=n(55),o=String.fromCharCode,a=String.fromCodePoint;r(r.S+r.F*(!!a&&1!=a.length),"String",{fromCodePoint:function(t){for(var e,n=[],r=arguments.length,a=0;r>a;){if(e=+arguments[a++],i(e,1114111)!==e)throw RangeError(e+" is not a valid code point");n.push(e<65536?o(e):o(55296+((e-=65536)>>10),e%1024+56320))}return n.join("")}})},function(t,e,n){var r=n(0),i=n(26),o=n(12);r(r.S,"String",{raw:function(t){for(var e=i(t.raw),n=o(e.length),r=arguments.length,a=[],s=0;n>s;)a.push(String(e[s++])),s<r&&a.push(String(arguments[s]));return a.join("")}})},function(t,e,n){"use strict";n(70)("trim",function(t){return function(){return t(this,3)}})},function(t,e,n){"use strict";var r=n(135)(!0);n(136)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=r(e,n),this._i+=t.length,{value:t,done:!1})})},function(t,e,n){"use strict";var r=n(0),i=n(135)(!1);r(r.P,"String",{codePointAt:function(t){return i(this,t)}})},function(t,e,n){"use strict";var r=n(0),i=n(12),o=n(138),a="".endsWith;r(r.P+r.F*n(139)("endsWith"),"String",{endsWith:function(t){var e=o(this,t,"endsWith"),n=arguments.length>1?arguments[1]:void 0,r=i(e.length),s=void 0===n?r:Math.min(i(n),r),u=String(t);return a?a.call(e,u,s):e.slice(s-u.length,s)===u}})},function(t,e,n){"use strict";var r=n(0),i=n(138);r(r.P+r.F*n(139)("includes"),"String",{includes:function(t){return!!~i(this,t,"includes").indexOf(t,arguments.length>1?arguments[1]:void 0)}})},function(t,e,n){var r=n(0);r(r.P,"String",{repeat:n(132)})},function(t,e,n){"use strict";var r=n(0),i=n(12),o=n(138),a="".startsWith;r(r.P+r.F*n(139)("startsWith"),"String",{startsWith:function(t){var e=o(this,t,"startsWith"),n=i(Math.min(arguments.length>1?arguments[1]:void 0,e.length)),r=String(t);return a?a.call(e,r,n):e.slice(n,n+r.length)===r}})},function(t,e,n){"use strict";n(22)("anchor",function(t){return function(e){return t(this,"a","name",e)}})},function(t,e,n){"use strict";n(22)("big",function(t){return function(){return t(this,"big","","")}})},function(t,e,n){"use strict";n(22)("blink",function(t){return function(){return t(this,"blink","","")}})},function(t,e,n){"use strict";n(22)("bold",function(t){return function(){return t(this,"b","","")}})},function(t,e,n){"use strict";n(22)("fixed",function(t){return function(){return t(this,"tt","","")}})},function(t,e,n){"use strict";n(22)("fontcolor",function(t){return function(e){return t(this,"font","color",e)}})},function(t,e,n){"use strict";n(22)("fontsize",function(t){return function(e){return t(this,"font","size",e)}})},function(t,e,n){"use strict";n(22)("italics",function(t){return function(){return t(this,"i","","")}})},function(t,e,n){"use strict";n(22)("link",function(t){return function(e){return t(this,"a","href",e)}})},function(t,e,n){"use strict";n(22)("small",function(t){return function(){return t(this,"small","","")}})},function(t,e,n){"use strict";n(22)("strike",function(t){return function(){return t(this,"strike","","")}})},function(t,e,n){"use strict";n(22)("sub",function(t){return function(){return t(this,"sub","","")}})},function(t,e,n){"use strict";n(22)("sup",function(t){return function(){return t(this,"sup","","")}})},function(t,e,n){var r=n(0);r(r.S,"Date",{now:function(){return(new Date).getTime()}})},function(t,e,n){"use strict";var r=n(0),i=n(14),o=n(35);r(r.P+r.F*n(5)(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(t){var e=i(this),n=o(e);return"number"!=typeof n||isFinite(n)?e.toISOString():null}})},function(t,e,n){var r=n(0),i=n(371);r(r.P+r.F*(Date.prototype.toISOString!==i),"Date",{toISOString:i})},function(t,e,n){"use strict";var r=n(5),i=Date.prototype.getTime,o=Date.prototype.toISOString,a=function(t){return t>9?t:"0"+t};t.exports=r(function(){return"0385-07-25T07:06:39.999Z"!=o.call(new Date(-5e13-1))})||!r(function(){o.call(new Date(NaN))})?function(){if(!isFinite(i.call(this)))throw RangeError("Invalid time value");var t=this,e=t.getUTCFullYear(),n=t.getUTCMilliseconds(),r=e<0?"-":e>9999?"+":"";return r+("00000"+Math.abs(e)).slice(r?-6:-4)+"-"+a(t.getUTCMonth()+1)+"-"+a(t.getUTCDate())+"T"+a(t.getUTCHours())+":"+a(t.getUTCMinutes())+":"+a(t.getUTCSeconds())+"."+(n>99?n:"0"+a(n))+"Z"}:o},function(t,e,n){var r=Date.prototype,i=r.toString,o=r.getTime;new Date(NaN)+""!="Invalid Date"&&n(21)(r,"toString",function(){var t=o.call(this);return t==t?i.call(this):"Invalid Date"})},function(t,e,n){var r=n(7)("toPrimitive"),i=Date.prototype;r in i||n(20)(i,r,n(374))},function(t,e,n){"use strict";var r=n(2),i=n(35);t.exports=function(t){if("string"!==t&&"number"!==t&&"default"!==t)throw TypeError("Incorrect hint");return i(r(this),"number"!=t)}},function(t,e,n){var r=n(0);r(r.S,"Array",{isArray:n(92)})},function(t,e,n){"use strict";var r=n(30),i=n(0),o=n(14),a=n(191),s=n(140),u=n(12),c=n(141),l=n(142);i(i.S+i.F*!n(94)(function(t){Array.from(t)}),"Array",{from:function(t){var e,n,i,h,f=o(t),p="function"==typeof this?this:Array,d=arguments.length,v=d>1?arguments[1]:void 0,g=void 0!==v,y=0,m=l(f);if(g&&(v=r(v,d>2?arguments[2]:void 0,2)),null==m||p==Array&&s(m))for(n=new p(e=u(f.length));e>y;y++)c(n,y,g?v(f[y],y):f[y]);else for(h=m.call(f),n=new p;!(i=h.next()).done;y++)c(n,y,g?a(h,v,[i.value,y],!0):i.value);return n.length=y,n}})},function(t,e,n){"use strict";var r=n(0),i=n(141);r(r.S+r.F*n(5)(function(){function t(){}return!(Array.of.call(t)instanceof t)}),"Array",{of:function(){for(var t=0,e=arguments.length,n=new("function"==typeof this?this:Array)(e);e>t;)i(n,t,arguments[t++]);return n.length=e,n}})},function(t,e,n){"use strict";var r=n(0),i=n(26),o=[].join;r(r.P+r.F*(n(76)!=Object||!n(32)(o)),"Array",{join:function(t){return o.call(i(this),void 0===t?",":t)}})},function(t,e,n){"use strict";var r=n(0),i=n(128),o=n(31),a=n(55),s=n(12),u=[].slice;r(r.P+r.F*n(5)(function(){i&&u.call(i)}),"Array",{slice:function(t,e){var n=s(this.length),r=o(this);if(e=void 0===e?n:e,"Array"==r)return u.call(this,t,e);for(var i=a(t,n),c=a(e,n),l=s(c-i),h=new Array(l),f=0;f<l;f++)h[f]="String"==r?this.charAt(i+f):this[i+f];return h}})},function(t,e,n){"use strict";var r=n(0),i=n(17),o=n(14),a=n(5),s=[].sort,u=[1,2,3];r(r.P+r.F*(a(function(){u.sort(void 0)})||!a(function(){u.sort(null)})||!n(32)(s)),"Array",{sort:function(t){return void 0===t?s.call(o(this)):s.call(o(this),i(t))}})},function(t,e,n){"use strict";var r=n(0),i=n(39)(0),o=n(32)([].forEach,!0);r(r.P+r.F*!o,"Array",{forEach:function(t){return i(this,t,arguments[1])}})},function(t,e,n){var r=n(6),i=n(92),o=n(7)("species");t.exports=function(t){var e;return i(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!i(e.prototype)||(e=void 0),r(e)&&null===(e=e[o])&&(e=void 0)),void 0===e?Array:e}},function(t,e,n){"use strict";var r=n(0),i=n(39)(1);r(r.P+r.F*!n(32)([].map,!0),"Array",{map:function(t){return i(this,t,arguments[1])}})},function(t,e,n){"use strict";var r=n(0),i=n(39)(2);r(r.P+r.F*!n(32)([].filter,!0),"Array",{filter:function(t){return i(this,t,arguments[1])}})},function(t,e,n){"use strict";var r=n(0),i=n(39)(3);r(r.P+r.F*!n(32)([].some,!0),"Array",{some:function(t){return i(this,t,arguments[1])}})},function(t,e,n){"use strict";var r=n(0),i=n(39)(4);r(r.P+r.F*!n(32)([].every,!0),"Array",{every:function(t){return i(this,t,arguments[1])}})},function(t,e,n){"use strict";var r=n(0),i=n(192);r(r.P+r.F*!n(32)([].reduce,!0),"Array",{reduce:function(t){return i(this,t,arguments.length,arguments[1],!1)}})},function(t,e,n){"use strict";var r=n(0),i=n(192);r(r.P+r.F*!n(32)([].reduceRight,!0),"Array",{reduceRight:function(t){return i(this,t,arguments.length,arguments[1],!0)}})},function(t,e,n){"use strict";var r=n(0),i=n(90)(!1),o=[].indexOf,a=!!o&&1/[1].indexOf(1,-0)<0;r(r.P+r.F*(a||!n(32)(o)),"Array",{indexOf:function(t){return a?o.apply(this,arguments)||0:i(this,t,arguments[1])}})},function(t,e,n){"use strict";var r=n(0),i=n(26),o=n(37),a=n(12),s=[].lastIndexOf,u=!!s&&1/[1].lastIndexOf(1,-0)<0;r(r.P+r.F*(u||!n(32)(s)),"Array",{lastIndexOf:function(t){if(u)return s.apply(this,arguments)||0;var e=i(this),n=a(e.length),r=n-1;for(arguments.length>1&&(r=Math.min(r,o(arguments[1]))),r<0&&(r=n+r);r>=0;r--)if(r in e&&e[r]===t)return r||0;return-1}})},function(t,e,n){var r=n(0);r(r.P,"Array",{copyWithin:n(193)}),n(48)("copyWithin")},function(t,e,n){var r=n(0);r(r.P,"Array",{fill:n(144)}),n(48)("fill")},function(t,e,n){"use strict";var r=n(0),i=n(39)(5),o=!0;"find"in[]&&Array(1).find(function(){o=!1}),r(r.P+r.F*o,"Array",{find:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),n(48)("find")},function(t,e,n){"use strict";var r=n(0),i=n(39)(6),o="findIndex",a=!0;o in[]&&Array(1)[o](function(){a=!1}),r(r.P+r.F*a,"Array",{findIndex:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),n(48)(o)},function(t,e,n){n(58)("Array")},function(t,e,n){var r=n(3),i=n(131),o=n(11).f,a=n(57).f,s=n(93),u=n(95),c=r.RegExp,l=c,h=c.prototype,f=/a/g,p=/a/g,d=new c(f)!==f;if(n(10)&&(!d||n(5)(function(){return p[n(7)("match")]=!1,c(f)!=f||c(p)==p||"/a/i"!=c(f,"i")}))){c=function(t,e){var n=this instanceof c,r=s(t),o=void 0===e;return!n&&r&&t.constructor===c&&o?t:i(d?new l(r&&!o?t.source:t,e):l((r=t instanceof c)?t.source:t,r&&o?u.call(t):e),n?this:h,c)};for(var v=a(l),g=0;v.length>g;)!function(t){t in c||o(c,t,{configurable:!0,get:function(){return l[t]},set:function(e){l[t]=e}})}(v[g++]);h.constructor=c,c.prototype=h,n(21)(r,"RegExp",c)}n(58)("RegExp")},function(t,e,n){"use strict";n(195);var r=n(2),i=n(95),o=n(10),a=/./.toString,s=function(t){n(21)(RegExp.prototype,"toString",t,!0)};n(5)(function(){return"/a/b"!=a.call({source:"a",flags:"b"})})?s(function(){var t=r(this);return"/".concat(t.source,"/","flags"in t?t.flags:!o&&t instanceof RegExp?i.call(t):void 0)}):"toString"!=a.name&&s(function(){return a.call(this)})},function(t,e,n){n(96)("match",1,function(t,e,n){return[function(n){"use strict";var r=t(this),i=null==n?void 0:n[e];return void 0!==i?i.call(n,r):new RegExp(n)[e](String(r))},n]})},function(t,e,n){n(96)("replace",2,function(t,e,n){return[function(r,i){"use strict";var o=t(this),a=null==r?void 0:r[e];return void 0!==a?a.call(r,o,i):n.call(String(o),r,i)},n]})},function(t,e,n){n(96)("search",1,function(t,e,n){return[function(n){"use strict";var r=t(this),i=null==n?void 0:n[e];return void 0!==i?i.call(n,r):new RegExp(n)[e](String(r))},n]})},function(t,e,n){n(96)("split",2,function(t,e,r){"use strict";var i=n(93),o=r,a=[].push,s="length";if("c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1)[s]||2!="ab".split(/(?:ab)*/)[s]||4!=".".split(/(.?)(.?)/)[s]||".".split(/()()/)[s]>1||"".split(/.?/)[s]){var u=void 0===/()??/.exec("")[1];r=function(t,e){var n=String(this);if(void 0===t&&0===e)return[];if(!i(t))return o.call(n,t,e);var r,c,l,h,f,p=[],d=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),v=0,g=void 0===e?4294967295:e>>>0,y=new RegExp(t.source,d+"g");for(u||(r=new RegExp("^"+y.source+"$(?!\\s)",d));(c=y.exec(n))&&!((l=c.index+c[0][s])>v&&(p.push(n.slice(v,c.index)),!u&&c[s]>1&&c[0].replace(r,function(){for(f=1;f<arguments[s]-2;f++)void 0===arguments[f]&&(c[f]=void 0)}),c[s]>1&&c.index<n[s]&&a.apply(p,c.slice(1)),h=c[0][s],v=l,p[s]>=g));)y.lastIndex===c.index&&y.lastIndex++;return v===n[s]?!h&&y.test("")||p.push(""):p.push(n.slice(v)),p[s]>g?p.slice(0,g):p}}else"0".split(void 0,0)[s]&&(r=function(t,e){return void 0===t&&0===e?[]:o.call(this,t,e)});return[function(n,i){var o=t(this),a=null==n?void 0:n[e];return void 0!==a?a.call(n,o,i):r.call(String(o),n,i)},r]})},function(t,e,n){"use strict";var r,i,o,a,s=n(53),u=n(3),c=n(30),l=n(78),h=n(0),f=n(6),p=n(17),d=n(59),v=n(60),g=n(97),y=n(146).set,m=n(147)(),_=n(148),b=n(196),E=n(197),w=u.TypeError,S=u.process,T=u.Promise,I="process"==l(S),A=function(){},O=i=_.f,C=!!function(){try{var t=T.resolve(1),e=(t.constructor={})[n(7)("species")]=function(t){t(A,A)};return(I||"function"==typeof PromiseRejectionEvent)&&t.then(A)instanceof e}catch(t){}}(),R=function(t){var e;return!(!f(t)||"function"!=typeof(e=t.then))&&e},N=function(t,e){if(!t._n){t._n=!0;var n=t._c;m(function(){for(var r=t._v,i=1==t._s,o=0;n.length>o;)!function(e){var n,o,a,s=i?e.ok:e.fail,u=e.resolve,c=e.reject,l=e.domain;try{s?(i||(2==t._h&&D(t),t._h=1),!0===s?n=r:(l&&l.enter(),n=s(r),l&&(l.exit(),a=!0)),n===e.promise?c(w("Promise-chain cycle")):(o=R(n))?o.call(n,u,c):u(n)):c(r)}catch(t){l&&!a&&l.exit(),c(t)}}(n[o++]);t._c=[],t._n=!1,e&&!t._h&&k(t)})}},k=function(t){y.call(u,function(){var e,n,r,i=t._v,o=P(t);if(o&&(e=b(function(){I?S.emit("unhandledRejection",i,t):(n=u.onunhandledrejection)?n({promise:t,reason:i}):(r=u.console)&&r.error&&r.error("Unhandled promise rejection",i)}),t._h=I||P(t)?2:1),t._a=void 0,o&&e.e)throw e.v})},P=function(t){return 1!==t._h&&0===(t._a||t._c).length},D=function(t){y.call(u,function(){var e;I?S.emit("rejectionHandled",t):(e=u.onrejectionhandled)&&e({promise:t,reason:t._v})})},x=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),N(e,!0))},M=function(t){var e,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw w("Promise can't be resolved itself");(e=R(t))?m(function(){var r={_w:n,_d:!1};try{e.call(t,c(M,r,1),c(x,r,1))}catch(t){x.call(r,t)}}):(n._v=t,n._s=1,N(n,!1))}catch(t){x.call({_w:n,_d:!1},t)}}};C||(T=function(t){d(this,T,"Promise","_h"),p(t),r.call(this);try{t(c(M,this,1),c(x,this,1))}catch(t){x.call(this,t)}},(r=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(61)(T.prototype,{then:function(t,e){var n=O(g(this,T));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=I?S.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&N(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),o=function(){var t=new r;this.promise=t,this.resolve=c(M,t,1),this.reject=c(x,t,1)},_.f=O=function(t){return t===T||t===a?new o(t):i(t)}),h(h.G+h.W+h.F*!C,{Promise:T}),n(69)(T,"Promise"),n(58)("Promise"),a=n(34).Promise,h(h.S+h.F*!C,"Promise",{reject:function(t){var e=O(this);return(0,e.reject)(t),e.promise}}),h(h.S+h.F*(s||!C),"Promise",{resolve:function(t){return E(s&&this===a?T:this,t)}}),h(h.S+h.F*!(C&&n(94)(function(t){T.all(t).catch(A)})),"Promise",{all:function(t){var e=this,n=O(e),r=n.resolve,i=n.reject,o=b(function(){var n=[],o=0,a=1;v(t,!1,function(t){var s=o++,u=!1;n.push(void 0),a++,e.resolve(t).then(function(t){u||(u=!0,n[s]=t,--a||r(n))},i)}),--a||r(n)});return o.e&&i(o.v),n.promise},race:function(t){var e=this,n=O(e),r=n.reject,i=b(function(){v(t,!1,function(t){e.resolve(t).then(n.resolve,r)})});return i.e&&r(i.v),n.promise}})},function(t,e,n){"use strict";var r=n(202),i=n(72);n(98)("WeakSet",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return r.def(i(this,"WeakSet"),t,!0)}},r,!1,!0)},function(t,e,n){"use strict";var r=n(0),i=n(99),o=n(149),a=n(2),s=n(55),u=n(12),c=n(6),l=n(3).ArrayBuffer,h=n(97),f=o.ArrayBuffer,p=o.DataView,d=i.ABV&&l.isView,v=f.prototype.slice,g=i.VIEW;r(r.G+r.W+r.F*(l!==f),{ArrayBuffer:f}),r(r.S+r.F*!i.CONSTR,"ArrayBuffer",{isView:function(t){return d&&d(t)||c(t)&&g in t}}),r(r.P+r.U+r.F*n(5)(function(){return!new f(2).slice(1,void 0).byteLength}),"ArrayBuffer",{slice:function(t,e){if(void 0!==v&&void 0===e)return v.call(a(this),t);for(var n=a(this).byteLength,r=s(t,n),i=s(void 0===e?n:e,n),o=new(h(this,f))(u(i-r)),c=new p(this),l=new p(o),d=0;r<i;)l.setUint8(d++,c.getUint8(r++));return o}}),n(58)("ArrayBuffer")},function(t,e,n){var r=n(0);r(r.G+r.W+r.F*!n(99).ABV,{DataView:n(149).DataView})},function(t,e,n){n(41)("Int8",1,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){n(41)("Uint8",1,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){n(41)("Uint8",1,function(t){return function(e,n,r){return t(this,e,n,r)}},!0)},function(t,e,n){n(41)("Int16",2,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){n(41)("Uint16",2,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){n(41)("Int32",4,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){n(41)("Uint32",4,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){n(41)("Float32",4,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){n(41)("Float64",8,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){var r=n(0),i=n(17),o=n(2),a=(n(3).Reflect||{}).apply,s=Function.apply;r(r.S+r.F*!n(5)(function(){a(function(){})}),"Reflect",{apply:function(t,e,n){var r=i(t),u=o(n);return a?a(r,e,u):s.call(r,e,u)}})},function(t,e,n){var r=n(0),i=n(56),o=n(17),a=n(2),s=n(6),u=n(5),c=n(183),l=(n(3).Reflect||{}).construct,h=u(function(){function t(){}return!(l(function(){},[],t)instanceof t)}),f=!u(function(){l(function(){})});r(r.S+r.F*(h||f),"Reflect",{construct:function(t,e){o(t),a(e);var n=arguments.length<3?t:o(arguments[2]);if(f&&!h)return l(t,e,n);if(t==n){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var r=[null];return r.push.apply(r,e),new(c.apply(t,r))}var u=n.prototype,p=i(s(u)?u:Object.prototype),d=Function.apply.call(t,p,e);return s(d)?d:p}})},function(t,e,n){var r=n(11),i=n(0),o=n(2),a=n(35);i(i.S+i.F*n(5)(function(){Reflect.defineProperty(r.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(t,e,n){o(t),e=a(e,!0),o(n);try{return r.f(t,e,n),!0}catch(t){return!1}}})},function(t,e,n){var r=n(0),i=n(27).f,o=n(2);r(r.S,"Reflect",{deleteProperty:function(t,e){var n=i(o(t),e);return!(n&&!n.configurable)&&delete t[e]}})},function(t,e,n){"use strict";var r=n(0),i=n(2),o=function(t){this._t=i(t),this._i=0;var e,n=this._k=[];for(e in t)n.push(e)};n(137)(o,"Object",function(){var t,e=this,n=e._k;do{if(e._i>=n.length)return{value:void 0,done:!0}}while(!((t=n[e._i++])in e._t));return{value:t,done:!1}}),r(r.S,"Reflect",{enumerate:function(t){return new o(t)}})},function(t,e,n){var r=n(27),i=n(28),o=n(25),a=n(0),s=n(6),u=n(2);a(a.S,"Reflect",{get:function t(e,n){var a,c,l=arguments.length<3?e:arguments[2];return u(e)===l?e[n]:(a=r.f(e,n))?o(a,"value")?a.value:void 0!==a.get?a.get.call(l):void 0:s(c=i(e))?t(c,n,l):void 0}})},function(t,e,n){var r=n(27),i=n(0),o=n(2);i(i.S,"Reflect",{getOwnPropertyDescriptor:function(t,e){return r.f(o(t),e)}})},function(t,e,n){var r=n(0),i=n(28),o=n(2);r(r.S,"Reflect",{getPrototypeOf:function(t){return i(o(t))}})},function(t,e,n){var r=n(0);r(r.S,"Reflect",{has:function(t,e){return e in t}})},function(t,e,n){var r=n(0),i=n(2),o=Object.isExtensible;r(r.S,"Reflect",{isExtensible:function(t){return i(t),!o||o(t)}})},function(t,e,n){var r=n(0);r(r.S,"Reflect",{ownKeys:n(204)})},function(t,e,n){var r=n(0),i=n(2),o=Object.preventExtensions;r(r.S,"Reflect",{preventExtensions:function(t){i(t);try{return o&&o(t),!0}catch(t){return!1}}})},function(t,e,n){var r=n(11),i=n(27),o=n(28),a=n(25),s=n(0),u=n(51),c=n(2),l=n(6);s(s.S,"Reflect",{set:function t(e,n,s){var h,f,p=arguments.length<4?e:arguments[3],d=i.f(c(e),n);if(!d){if(l(f=o(e)))return t(f,n,s,p);d=u(0)}if(a(d,"value")){if(!1===d.writable||!l(p))return!1;if(h=i.f(p,n)){if(h.get||h.set||!1===h.writable)return!1;h.value=s,r.f(p,n,h)}else r.f(p,n,u(0,s));return!0}return void 0!==d.set&&(d.set.call(p,s),!0)}})},function(t,e,n){var r=n(0),i=n(129);i&&r(r.S,"Reflect",{setPrototypeOf:function(t,e){i.check(t,e);try{return i.set(t,e),!0}catch(t){return!1}}})},function(t,e,n){"use strict";var r=n(0),i=n(90)(!0);r(r.P,"Array",{includes:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),n(48)("includes")},function(t,e,n){"use strict";var r=n(0),i=n(205),o=n(14),a=n(12),s=n(17),u=n(143);r(r.P,"Array",{flatMap:function(t){var e,n,r=o(this);return s(t),e=a(r.length),n=u(r,0),i(n,r,r,e,0,1,t,arguments[1]),n}}),n(48)("flatMap")},function(t,e,n){"use strict";var r=n(0),i=n(205),o=n(14),a=n(12),s=n(37),u=n(143);r(r.P,"Array",{flatten:function(){var t=arguments[0],e=o(this),n=a(e.length),r=u(e,0);return i(r,e,e,n,0,void 0===t?1:s(t)),r}}),n(48)("flatten")},function(t,e,n){"use strict";var r=n(0),i=n(135)(!0);r(r.P,"String",{at:function(t){return i(this,t)}})},function(t,e,n){"use strict";var r=n(0),i=n(206),o=n(150);r(r.P+r.F*/Version\/10\.\d+(\.\d+)? Safari\//.test(o),"String",{padStart:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!0)}})},function(t,e,n){"use strict";var r=n(0),i=n(206),o=n(150);r(r.P+r.F*/Version\/10\.\d+(\.\d+)? Safari\//.test(o),"String",{padEnd:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!1)}})},function(t,e,n){"use strict";n(70)("trimLeft",function(t){return function(){return t(this,1)}},"trimStart")},function(t,e,n){"use strict";n(70)("trimRight",function(t){return function(){return t(this,2)}},"trimEnd")},function(t,e,n){"use strict";var r=n(0),i=n(36),o=n(12),a=n(93),s=n(95),u=RegExp.prototype,c=function(t,e){this._r=t,this._s=e};n(137)(c,"RegExp String",function(){var t=this._r.exec(this._s);return{value:t,done:null===t}}),r(r.P,"String",{matchAll:function(t){if(i(this),!a(t))throw TypeError(t+" is not a regexp!");var e=String(this),n="flags"in u?String(t.flags):s.call(t),r=new RegExp(t.source,~n.indexOf("g")?n:"g"+n);return r.lastIndex=o(t.lastIndex),new c(r,e)}})},function(t,e,n){n(125)("asyncIterator")},function(t,e,n){n(125)("observable")},function(t,e,n){var r=n(0),i=n(204),o=n(26),a=n(27),s=n(141);r(r.S,"Object",{getOwnPropertyDescriptors:function(t){for(var e,n,r=o(t),u=a.f,c=i(r),l={},h=0;c.length>h;)void 0!==(n=u(r,e=c[h++]))&&s(l,e,n);return l}})},function(t,e,n){var r=n(0),i=n(207)(!1);r(r.S,"Object",{values:function(t){return i(t)}})},function(t,e,n){var r=n(0),i=n(207)(!0);r(r.S,"Object",{entries:function(t){return i(t)}})},function(t,e,n){"use strict";var r=n(0),i=n(14),o=n(17),a=n(11);n(10)&&r(r.P+n(100),"Object",{__defineGetter__:function(t,e){a.f(i(this),t,{get:o(e),enumerable:!0,configurable:!0})}})},function(t,e,n){"use strict";var r=n(0),i=n(14),o=n(17),a=n(11);n(10)&&r(r.P+n(100),"Object",{__defineSetter__:function(t,e){a.f(i(this),t,{set:o(e),enumerable:!0,configurable:!0})}})},function(t,e,n){"use strict";var r=n(0),i=n(14),o=n(35),a=n(28),s=n(27).f;n(10)&&r(r.P+n(100),"Object",{__lookupGetter__:function(t){var e,n=i(this),r=o(t,!0);do{if(e=s(n,r))return e.get}while(n=a(n))}})},function(t,e,n){"use strict";var r=n(0),i=n(14),o=n(35),a=n(28),s=n(27).f;n(10)&&r(r.P+n(100),"Object",{__lookupSetter__:function(t){var e,n=i(this),r=o(t,!0);do{if(e=s(n,r))return e.set}while(n=a(n))}})},function(t,e,n){var r=n(0);r(r.P+r.R,"Map",{toJSON:n(208)("Map")})},function(t,e,n){var r=n(0);r(r.P+r.R,"Set",{toJSON:n(208)("Set")})},function(t,e,n){n(101)("Map")},function(t,e,n){n(101)("Set")},function(t,e,n){n(101)("WeakMap")},function(t,e,n){n(101)("WeakSet")},function(t,e,n){n(102)("Map")},function(t,e,n){n(102)("Set")},function(t,e,n){n(102)("WeakMap")},function(t,e,n){n(102)("WeakSet")},function(t,e,n){var r=n(0);r(r.G,{global:n(3)})},function(t,e,n){var r=n(0);r(r.S,"System",{global:n(3)})},function(t,e,n){var r=n(0),i=n(31);r(r.S,"Error",{isError:function(t){return"Error"===i(t)}})},function(t,e,n){var r=n(0);r(r.S,"Math",{clamp:function(t,e,n){return Math.min(n,Math.max(e,t))}})},function(t,e,n){var r=n(0);r(r.S,"Math",{DEG_PER_RAD:Math.PI/180})},function(t,e,n){var r=n(0),i=180/Math.PI;r(r.S,"Math",{degrees:function(t){return t*i}})},function(t,e,n){var r=n(0),i=n(210),o=n(190);r(r.S,"Math",{fscale:function(t,e,n,r,a){return o(i(t,e,n,r,a))}})},function(t,e,n){var r=n(0);r(r.S,"Math",{iaddh:function(t,e,n,r){var i=t>>>0,o=n>>>0;return(e>>>0)+(r>>>0)+((i&o|(i|o)&~(i+o>>>0))>>>31)|0}})},function(t,e,n){var r=n(0);r(r.S,"Math",{isubh:function(t,e,n,r){var i=t>>>0,o=n>>>0;return(e>>>0)-(r>>>0)-((~i&o|~(i^o)&i-o>>>0)>>>31)|0}})},function(t,e,n){var r=n(0);r(r.S,"Math",{imulh:function(t,e){var n=+t,r=+e,i=65535&n,o=65535&r,a=n>>16,s=r>>16,u=(a*o>>>0)+(i*o>>>16);return a*s+(u>>16)+((i*s>>>0)+(65535&u)>>16)}})},function(t,e,n){var r=n(0);r(r.S,"Math",{RAD_PER_DEG:180/Math.PI})},function(t,e,n){var r=n(0),i=Math.PI/180;r(r.S,"Math",{radians:function(t){return t*i}})},function(t,e,n){var r=n(0);r(r.S,"Math",{scale:n(210)})},function(t,e,n){var r=n(0);r(r.S,"Math",{umulh:function(t,e){var n=+t,r=+e,i=65535&n,o=65535&r,a=n>>>16,s=r>>>16,u=(a*o>>>0)+(i*o>>>16);return a*s+(u>>>16)+((i*s>>>0)+(65535&u)>>>16)}})},function(t,e,n){var r=n(0);r(r.S,"Math",{signbit:function(t){return(t=+t)!=t?t:0==t?1/t==1/0:t>0}})},function(t,e,n){"use strict";var r=n(0),i=n(34),o=n(3),a=n(97),s=n(197);r(r.P+r.R,"Promise",{finally:function(t){var e=a(this,i.Promise||o.Promise),n="function"==typeof t;return this.then(n?function(n){return s(e,t()).then(function(){return n})}:t,n?function(n){return s(e,t()).then(function(){throw n})}:t)}})},function(t,e,n){"use strict";var r=n(0),i=n(148),o=n(196);r(r.S,"Promise",{try:function(t){var e=i.f(this),n=o(t);return(n.e?e.reject:e.resolve)(n.v),e.promise}})},function(t,e,n){var r=n(42),i=n(2),o=r.key,a=r.set;r.exp({defineMetadata:function(t,e,n,r){a(t,e,i(n),o(r))}})},function(t,e,n){var r=n(42),i=n(2),o=r.key,a=r.map,s=r.store;r.exp({deleteMetadata:function(t,e){var n=arguments.length<3?void 0:o(arguments[2]),r=a(i(e),n,!1);if(void 0===r||!r.delete(t))return!1;if(r.size)return!0;var u=s.get(e);return u.delete(n),!!u.size||s.delete(e)}})},function(t,e,n){var r=n(42),i=n(2),o=n(28),a=r.has,s=r.get,u=r.key,c=function(t,e,n){if(a(t,e,n))return s(t,e,n);var r=o(e);return null!==r?c(t,r,n):void 0};r.exp({getMetadata:function(t,e){return c(t,i(e),arguments.length<3?void 0:u(arguments[2]))}})},function(t,e,n){var r=n(200),i=n(209),o=n(42),a=n(2),s=n(28),u=o.keys,c=o.key,l=function(t,e){var n=u(t,e),o=s(t);if(null===o)return n;var a=l(o,e);return a.length?n.length?i(new r(n.concat(a))):a:n};o.exp({getMetadataKeys:function(t){return l(a(t),arguments.length<2?void 0:c(arguments[1]))}})},function(t,e,n){var r=n(42),i=n(2),o=r.get,a=r.key;r.exp({getOwnMetadata:function(t,e){return o(t,i(e),arguments.length<3?void 0:a(arguments[2]))}})},function(t,e,n){var r=n(42),i=n(2),o=r.keys,a=r.key;r.exp({getOwnMetadataKeys:function(t){return o(i(t),arguments.length<2?void 0:a(arguments[1]))}})},function(t,e,n){var r=n(42),i=n(2),o=n(28),a=r.has,s=r.key,u=function(t,e,n){if(a(t,e,n))return!0;var r=o(e);return null!==r&&u(t,r,n)};r.exp({hasMetadata:function(t,e){return u(t,i(e),arguments.length<3?void 0:s(arguments[2]))}})},function(t,e,n){var r=n(42),i=n(2),o=r.has,a=r.key;r.exp({hasOwnMetadata:function(t,e){return o(t,i(e),arguments.length<3?void 0:a(arguments[2]))}})},function(t,e,n){var r=n(42),i=n(2),o=n(17),a=r.key,s=r.set;r.exp({metadata:function(t,e){return function(n,r){s(t,e,(void 0!==r?i:o)(n),a(r))}}})},function(t,e,n){var r=n(0),i=n(147)(),o=n(3).process,a="process"==n(31)(o);r(r.G,{asap:function(t){var e=a&&o.domain;i(e?e.bind(t):t)}})},function(t,e,n){"use strict";var r=n(0),i=n(3),o=n(34),a=n(147)(),s=n(7)("observable"),u=n(17),c=n(2),l=n(59),h=n(61),f=n(20),p=n(60),d=p.RETURN,v=function(t){return null==t?void 0:u(t)},g=function(t){var e=t._c;e&&(t._c=void 0,e())},y=function(t){return void 0===t._o},m=function(t){y(t)||(t._o=void 0,g(t))},_=function(t,e){c(t),this._c=void 0,this._o=t,t=new b(this);try{var n=e(t),r=n;null!=n&&("function"==typeof n.unsubscribe?n=function(){r.unsubscribe()}:u(n),this._c=n)}catch(e){return void t.error(e)}y(this)&&g(this)};_.prototype=h({},{unsubscribe:function(){m(this)}});var b=function(t){this._s=t};b.prototype=h({},{next:function(t){var e=this._s;if(!y(e)){var n=e._o;try{var r=v(n.next);if(r)return r.call(n,t)}catch(t){try{m(e)}finally{throw t}}}},error:function(t){var e=this._s;if(y(e))throw t;var n=e._o;e._o=void 0;try{var r=v(n.error);if(!r)throw t;t=r.call(n,t)}catch(t){try{g(e)}finally{throw t}}return g(e),t},complete:function(t){var e=this._s;if(!y(e)){var n=e._o;e._o=void 0;try{var r=v(n.complete);t=r?r.call(n,t):void 0}catch(t){try{g(e)}finally{throw t}}return g(e),t}}});var E=function(t){l(this,E,"Observable","_f")._f=u(t)};h(E.prototype,{subscribe:function(t){return new _(t,this._f)},forEach:function(t){var e=this;return new(o.Promise||i.Promise)(function(n,r){u(t);var i=e.subscribe({next:function(e){try{return t(e)}catch(t){r(t),i.unsubscribe()}},error:r,complete:n})})}}),h(E,{from:function(t){var e="function"==typeof this?this:E,n=v(c(t)[s]);if(n){var r=c(n.call(t));return r.constructor===e?r:new e(function(t){return r.subscribe(t)})}return new e(function(e){var n=!1;return a(function(){if(!n){try{if(p(t,!1,function(t){if(e.next(t),n)return d})===d)return}catch(t){if(n)throw t;return void e.error(t)}e.complete()}}),function(){n=!0}})},of:function(){for(var t=0,e=arguments.length,n=new Array(e);t<e;)n[t]=arguments[t++];return new("function"==typeof this?this:E)(function(t){var e=!1;return a(function(){if(!e){for(var r=0;r<n.length;++r)if(t.next(n[r]),e)return;t.complete()}}),function(){e=!0}})}}),f(E.prototype,s,function(){return this}),r(r.G,{Observable:E}),n(58)("Observable")},function(t,e,n){var r=n(3),i=n(0),o=n(150),a=[].slice,s=/MSIE .\./.test(o),u=function(t){return function(e,n){var r=arguments.length>2,i=!!r&&a.call(arguments,2);return t(r?function(){("function"==typeof e?e:Function(e)).apply(this,i)}:e,n)}};i(i.G+i.B+i.F*s,{setTimeout:u(r.setTimeout),setInterval:u(r.setInterval)})},function(t,e,n){var r=n(0),i=n(146);r(r.G+r.B,{setImmediate:i.set,clearImmediate:i.clear})},function(t,e,n){for(var r=n(145),i=n(54),o=n(21),a=n(3),s=n(20),u=n(71),c=n(7),l=c("iterator"),h=c("toStringTag"),f=u.Array,p={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},d=i(p),v=0;v<d.length;v++){var g,y=d[v],m=p[y],_=a[y],b=_&&_.prototype;if(b&&(b[l]||s(b,l,f),b[h]||s(b,h,y),u[y]=f,m))for(g in r)b[g]||o(b,g,r[g],!0)}},function(t,e,n){(function(e){!function(e){"use strict";function n(t,e,n,r){var o=e&&e.prototype instanceof i?e:i,a=Object.create(o.prototype),s=new p(r||[]);return a._invoke=c(t,n,s),a}function r(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}function i(){}function o(){}function a(){}function s(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function u(t){function n(e,i,o,a){var s=r(t[e],t,i);if("throw"!==s.type){var u=s.arg,c=u.value;return c&&"object"==typeof c&&m.call(c,"__await")?Promise.resolve(c.__await).then(function(t){n("next",t,o,a)},function(t){n("throw",t,o,a)}):Promise.resolve(c).then(function(t){u.value=t,o(u)},a)}a(s.arg)}var i;"object"==typeof e.process&&e.process.domain&&(n=e.process.domain.bind(n)),this._invoke=function(t,e){function r(){return new Promise(function(r,i){n(t,e,r,i)})}return i=i?i.then(r,r):r()}}function c(t,e,n){var i=I;return function(o,a){if(i===O)throw new Error("Generator is already running");if(i===C){if("throw"===o)throw a;return v()}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=l(s,n);if(u){if(u===R)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===I)throw i=C,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=O;var c=r(t,e,n);if("normal"===c.type){if(i=n.done?C:A,c.arg===R)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(i=C,n.method="throw",n.arg=c.arg)}}}function l(t,e){var n=t.iterator[e.method];if(n===g){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=g,l(t,e),"throw"===e.method))return R;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return R}var i=r(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,R;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=g),e.delegate=null,R):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,R)}function h(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function f(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function p(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(h,this),this.reset(!0)}function d(t){if(t){var e=t[b];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,r=function e(){for(;++n<t.length;)if(m.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=g,e.done=!0,e};return r.next=r}}return{next:v}}function v(){return{value:g,done:!0}}var g,y=Object.prototype,m=y.hasOwnProperty,_="function"==typeof Symbol?Symbol:{},b=_.iterator||"@@iterator",E=_.asyncIterator||"@@asyncIterator",w=_.toStringTag||"@@toStringTag",S="object"==typeof t,T=e.regeneratorRuntime;if(T)S&&(t.exports=T);else{(T=e.regeneratorRuntime=S?t.exports:{}).wrap=n;var I="suspendedStart",A="suspendedYield",O="executing",C="completed",R={},N={};N[b]=function(){return this};var k=Object.getPrototypeOf,P=k&&k(k(d([])));P&&P!==y&&m.call(P,b)&&(N=P);var D=a.prototype=i.prototype=Object.create(N);o.prototype=D.constructor=a,a.constructor=o,a[w]=o.displayName="GeneratorFunction",T.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===o||"GeneratorFunction"===(e.displayName||e.name))},T.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,a):(t.__proto__=a,w in t||(t[w]="GeneratorFunction")),t.prototype=Object.create(D),t},T.awrap=function(t){return{__await:t}},s(u.prototype),u.prototype[E]=function(){return this},T.AsyncIterator=u,T.async=function(t,e,r,i){var o=new u(n(t,e,r,i));return T.isGeneratorFunction(e)?o:o.next().then(function(t){return t.done?t.value:o.next()})},s(D),D[w]="Generator",D[b]=function(){return this},D.toString=function(){return"[object Generator]"},T.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},T.values=d,p.prototype={constructor:p,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=g,this.done=!1,this.delegate=null,this.method="next",this.arg=g,this.tryEntries.forEach(f),!t)for(var e in this)"t"===e.charAt(0)&&m.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=g)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){function e(e,r){return o.type="throw",o.arg=t,n.next=e,r&&(n.method="next",n.arg=g),!!r}if(this.done)throw t;for(var n=this,r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],o=i.completion;if("root"===i.tryLoc)return e("end");if(i.tryLoc<=this.prev){var a=m.call(i,"catchLoc"),s=m.call(i,"finallyLoc");if(a&&s){if(this.prev<i.catchLoc)return e(i.catchLoc,!0);if(this.prev<i.finallyLoc)return e(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return e(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return e(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&m.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=t,o.arg=e,i?(this.method="next",this.next=i.finallyLoc,R):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),R},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),f(n),R}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;f(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:d(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=g),R}}}}("object"==typeof e?e:"object"==typeof window?window:"object"==typeof self?self:this)}).call(this,n(8))},function(t,e,n){n(490),t.exports=n(34).RegExp.escape},function(t,e,n){var r=n(0),i=n(491)(/[\\^$*+?.()|[\]{}]/g,"\\$&");r(r.S,"RegExp",{escape:function(t){return i(t)}})},function(t,e){t.exports=function(t,e){var n=e===Object(e)?function(t){return e[t]}:e;return function(e){return String(e).replace(t,n)}}},function(t,e){t.exports=function(t){if(!t.webpackPolyfill){var e=Object.create(t);e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),Object.defineProperty(e,"exports",{enumerable:!0}),e.webpackPolyfill=1}return e}},function(t,e,n){"use strict";function r(t){return function(e){var n=e.dispatch,r=e.getState;return function(e){return function(i){return"function"==typeof i?i(n,r,t):e(i)}}}}e.__esModule=!0;var i=r();i.withExtraArgument=r,e.default=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(9),i=n(79),o=n(495),a=r.Map({iframeUrls:r.Map({}),tabsStatus:r.Map({})});e.chromeTabsReducer=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,e=arguments[1],n=t;switch(e.type){case i.chromeTabActionsConstants.ON_TAB_ACTIVATED:var s=e.tabs.filter(function(t){return!(!n.getIn(["iframeUrls",e.tabId])||!n.getIn(["iframeUrls",e.tabId]).includes(t.url))||t.active});return n=o.unloadNotActiveTabsNewState(n,e.tabs,s),n=o.inviteActiveTabsNewState(n,s),n=o.reloadTabsNewState(n,s);case i.chromeTabActionsConstants.ON_CONTENT_SCRIPT_READY:return n=e.active?o.setTabStatusNewState(n,e.tabId,i.tabStatusOptions.CONNECTED):o.setTabStatusNewState(n,e.tabId,i.tabStatusOptions.UNLOADED),e.isIframe&&(n.getIn(["iframeUrls",e.tabId])?n.getIn(["iframeUrls",e.tabId]).includes(e.url)||(n=n.updateIn(["iframeUrls",e.tabId],function(t){return t.push(e.url)})):n=n.setIn(["iframeUrls",e.tabId],r.List([e.url]))),n;default:return n}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(79),i=n(151);e.isActiveTab=function(t,e){return t.get("tabsStatus").get(e)===r.tabStatusOptions.CONNECTED},e.unloadNotActiveTabsNewState=function(t,n,i){var o=i.map(function(t){return t.id}),a=n.map(function(t){return t.id}),s=n.map(function(t){return t.id}),u=t.get("tabsStatus"),c=t.get("iframeUrls"),l=t;return c.forEach(function(t,e){-1===a.indexOf(e)&&(l=l.deleteIn(["iframeUrls",e]))}),u.forEach(function(t,n){-1===o.indexOf(n)&&(l=e.setTabStatusNewState(l,n,r.tabStatusOptions.UNLOADED)),-1===s.indexOf(n)&&(l=e.setTabStatusNewState(l,n,null))}),l},e.inviteActiveTabsNewState=function(t,n){n=(n=n.filter(function(t){return"complete"===t.status})).filter(function(t){return!i.isBannedSite(t.url)});var o=t,a=t.get("tabsStatus"),s=!0,u=!1,c=void 0;try{for(var l,h=n[Symbol.iterator]();!(s=(l=h.next()).done);s=!0){var f=l.value;void 0===a.get(f.id)&&(o=e.setTabStatusNewState(o,f.id,r.tabStatusOptions.INVITED))}}catch(t){u=!0,c=t}finally{try{!s&&h.return&&h.return()}finally{if(u)throw c}}return o},e.reloadTabsNewState=function(t,n){n=(n=n.filter(function(t){return"complete"===t.status})).filter(function(t){return!i.isBannedSite(t.url)});var o=t,a=t.get("tabsStatus"),s=!0,u=!1,c=void 0;try{for(var l,h=n[Symbol.iterator]();!(s=(l=h.next()).done);s=!0){var f=l.value;a.get(f.id)===r.tabStatusOptions.UNLOADED&&(o=e.setTabStatusNewState(o,f.id,r.tabStatusOptions.RELOAD))}}catch(t){u=!0,c=t}finally{try{!s&&h.return&&h.return()}finally{if(u)throw c}}return o},e.setTabStatusNewState=function(t,e,n){var r=t.get("tabsStatus");return r=n?r.set(e,n):r.delete(e),t.set("tabsStatus",r)}},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n(79),o=n(43),a=n(104),s=n(80),u=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.injecting=[],n.unloading=[],n.reloading=[],n.handleActiveTabs=function(){chrome.storage.local.remove("lastContentScriptInit"),chrome.tabs.query({},function(t){n.store.dispatch(i.onTabActivated(t))}),n.store.dispatch(a.syncActiveUrls(n.currentState.chromeTabsReducer.get("iframeUrls").toJS(),[]))},n.bindStore(),n.bindListeners(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.BaseView),r(e,[{key:"handleStoreChange",value:function(){var t=this,e=this.currentState;e.chromeTabsReducer.get("tabsStatus").filter(function(t){return t===i.tabStatusOptions.CONNECTED}).forEach(function(e,n){t.removeTabIdFromArray(n,t.injecting),t.removeTabIdFromArray(n,t.unloading),t.removeTabIdFromArray(n,t.reloading)}),e.chromeTabsReducer.get("tabsStatus").filter(function(t){return t===i.tabStatusOptions.INVITED}).forEach(function(e,n){t.injectContentScriptToTabs(n)}),e.chromeTabsReducer.get("tabsStatus").filter(function(t){return t===i.tabStatusOptions.UNLOADED}).forEach(function(e,n){t.unloadContentScript(n)}),e.chromeTabsReducer.get("tabsStatus").filter(function(t){return t===i.tabStatusOptions.RELOAD}).forEach(function(e,n){t.reloadContentScript(n)});var n=e.dataReducer.activeFolderMap.first(null),r=this.previousState.dataReducer.activeFolderMap.first(null);if(n){var o=n.websiteIds?n.websiteIds.size:0,s=0;r&&r.websiteIds&&(s=r.websiteIds.size),o!==s&&this.store.dispatch(a.syncActiveUrls(e.chromeTabsReducer.get("iframeUrls").toJS(),[]))}}},{key:"bindListeners",value:function(){var t=this;this.handleActiveTabs();var e=null;chrome.tabs.onActivated.addListener(function(){window.clearTimeout(e),e=window.setTimeout(t.handleActiveTabs,500)})}},{key:"injectContentScriptToTabs",value:function(t){if(-1===this.injecting.indexOf(t)){this.injecting=this.injecting.concat(t);for(var e=chrome.runtime.getManifest().content_scripts[0].js,n=0;n<e.length;n++)chrome.tabs.executeScript(t,{file:e[n],allFrames:!0},function(){chrome.runtime.lastError});chrome.tabs.insertCSS(t,{file:"static/css/gistnoteGlobal.css"},function(){chrome.runtime.lastError})}}},{key:"unloadContentScript",value:function(t){-1===this.unloading.indexOf(t)&&(this.unloading=this.unloading.concat(t),this.store.dispatch(s.ChromeMessageAction.sendUnloadMessage(t)))}},{key:"reloadContentScript",value:function(t){-1===this.reloading.indexOf(t)&&(this.reloading=this.reloading.concat(t),this.store.dispatch(s.ChromeMessageAction.sendReloadMessage(t)))}},{key:"removeTabIdFromArray",value:function(t,e){var n=e.indexOf(t);-1!==n&&e.splice(n,1)}}]),e}();e.ChromeTabsView=u},function(t,e,n){"use strict";var r=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});var i=n(49);!function(t){var e=this;t.sendMessage=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return r(e,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){var r=function(t,n){chrome.tabs.sendMessage(t,n,function(n){e({tabId:t,response:n})})};n?(i.weavaLogger.log("Tracker","grey","white","[MessageGateway] <== Send message to tab "+n+":",t),r(n,t)):(i.weavaLogger.log("Tracker","grey","white","[MessageGateway] <== Send message to ALL tab:",t),chrome.tabs.query({},function(e){e.forEach(function(e){return r(e.id,t)})}))}));case 1:case"end":return e.stop()}},e,this)}))},t.sendExternalMessage=function(n){return r(e,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.sendMessage({id:"SEND_TO_WEBAPP",message:n}));case 1:case"end":return e.stop()}},e,this)}))}}(e.MessageAsyncFunction||(e.MessageAsyncFunction={}))},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});var o=n(49),a=n(79),s=n(151),u=n(43),c=n(62),l=n(114),h=n(162),f=n(570),p=n(66),d=n(104),v=n(15),g=n(163),y=n(86),m=n(87),_=n(18),b=n(50),E=n(80),w=n(65),S=n(247),T=n(84),I=n(65),A=n(84),O=n(573),C=n(44),R=n(40),N=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n._EXTENSION_VIEWER_URL="chrome-extension://cbnaodkpfinfiipjblikofhlhlcickei/src/webviewer/gistnoteWebViewer.html?url=",n._EXTENSION_PDF_URL="chrome-extension://cbnaodkpfinfiipjblikofhlhlcickei/src/pdfviewer/web/viewer.html?file=",n._IS_INSIDE_WEB_APP="&webapp=true",n.checkTabUrlsQueue=[],n.commitSyncActiveUrls=C.debounce(function(){n.store.dispatch(d.syncActiveUrls(n.currentState.chromeTabsReducer.get("iframeUrls").toJS(),n.checkTabUrlsQueue)),n.checkTabUrlsQueue=[]},1e3),n._getFavIconFromSender=function(t){return 0===t.frameId&&t.tab.favIconUrl?t.tab.favIconUrl:""},n._deleteImageFromServer=function(t,e,n){var r={imageId:t,folderId:e,websiteId:n},i=JSON.stringify(r);R(StaticConstants.DELETE_IMAGE_API,{method:"POST",headers:{"Content-Type":"application/json"},body:i}).then(function(t){})},n.bindStore(),n.bindListeners(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,u.BaseView),r(e,[{key:"handleStoreChange",value:function(){}},{key:"bindListeners",value:function(){var t=this;chrome.runtime.onMessage.addListener(function(e,n,r){return o.weavaLogger.log("Tracker","grey","white","[MessageGateway.ts] ==> Received Message: ",e),t._handleInitMessage(e,n,r),t._handleFolderMessage(e,n,r),t._handleWebsiteMessage(e,n,r),t._handleHighlightMessage(e,n,r),t._handleNoteMessage(e,n,r),t._handleQuestionnaireMessage(e,n,r),t._handleFirebaseAuthMessage(e,n,r),t._handleWorkspaceMessage(e,n,r),t._handleOtherMessage(e,n,r),!0}),chrome.runtime.onMessageExternal.addListener(function(e,n,r){return o.weavaLogger.log("Tracker","grey","white","[MessageGateway.ts] ==> Received External Message: ",e),t._handleExternalMessage(e,n,r),!0})}},{key:"_handleInitMessage",value:function(t,e,n){var r=this;switch(t.id){case"CHECK_TAB_SETTING":var i=0===e.frameId,o=0===t.documentUrl.indexOf(this._EXTENSION_PDF_URL),u=this.currentState.pdfReducer.getIn(["tabsPdfMode",e.tab.id]),l=o&&(t.documentUrl.indexOf(this._IS_INSIDE_WEB_APP)>0||t.isInsideWebApp);!i&&o&&(u=g.pdfModeOptions.PDF_JS),n({isBlacklisted:s.isBannedSite(t.documentUrl),isActive:e.tab.active,pdfMode:u,isInsideWebApp:l,tabId:e.tab.id}),i&&this.store.dispatch(y.updateIcon(e.tab.id,s.isBannedSite(t.documentUrl),this.currentState.workspaceReducer.get("highlightMode"))),this.store.dispatch(S.initShortcut()),s.isWebAppLogin(t.documentUrl)&&this.currentState.firebaseAuthReducer.get("user")&&v.auth().currentUser.getIdToken(!0).then(function(t){r.store.dispatch(c.setToken(t))}),this.store.dispatch(a.onContentScriptReady(e.tab.id,t.documentUrl,e.tab.active,!i)),this.checkTabUrlsQueue.push(i?null:t.documentUrl),this.commitSyncActiveUrls()}}},{key:"_handleFirebaseAuthMessage",value:function(t,e,n){switch(t.id){case"GO_TO_LOGIN_PAGE":var r=this.currentState.onboardingReducer.getIn(["onboarding","extensionGuideState"]);3!==r&&3.5!==r||(this.store.dispatch(_.TrackerActions.trackEvent("GUIDE_FINISHED",{guide:r})),this.store.dispatch(m.updateExtensionGuideState(v.auth().currentUser,4)));var i="app/dashboard";t.showInvitations&&(i+="?notifications=true"),chrome.tabs.create({url:StaticConstants.APP_BASE_PATH+i});break;case"GO_TO_LINK_ACCOUNT_PAGE":var o=StaticConstants.APP_BASE_PATH+"app/signup;merge=true";this.store.dispatch(_.TrackerActions.trackEvent("GO_TO_LINK_ACCOUNT_PAGE")),chrome.tabs.create({url:o});break;case"SIGN_OUT":this.store.dispatch(_.TrackerActions.trackEvent("GO_TO_SIGNOUT_PAGE")),chrome.tabs.create({url:StaticConstants.APP_BASE_PATH+"app/signout"});break;case"LINK_WITH_GOOGLE_ACCOUNT":this.store.dispatch(c.linkWithGoogle(!0));break;case"LINK_WITH_FACEBOOK_ACCOUNT":this.store.dispatch(c.linkWithFacebook(!0));break;case"LINK_WITH_EMAIL_ACCOUNT":this.store.dispatch(c.linkWithEmail(t.payload.email,t.payload.password,t.payload.displayName,!0))}}},{key:"_handleQuestionnaireMessage",value:function(t,e,n){t.id}},{key:"_handleFolderMessage",value:function(t,e,n){return i(this,void 0,void 0,regeneratorRuntime.mark(function e(){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.id,e.next="CREATE_FOLDER"===e.t0?3:"MOVE_FOLDER"===e.t0?14:"CREATE_NESTED_FOLDER"===e.t0?33:"SWITCH_FOLDER"===e.t0?51:"EDIT_FOLDER"===e.t0?53:"DELETE_FOLDER"===e.t0?67:"UPDATE_FOLDERS_ORDER"===e.t0?78:"EXIT_SEARCH_MODE"===e.t0?79:"SEARCH_IN_FOLDER"===e.t0?81:"RESET_FOLDER_COLLABORATION_INFO"===e.t0?94:"QUERY_FOLDER_COLLABORATION_INFO"===e.t0?96:"INVITE_COLLABORATOR"===e.t0?107:"DELETE_COLLABORATORS"===e.t0?130:153;break;case 3:return this.store.dispatch(_.TrackerActions.trackEvent("BG_CREATE_FOLDER")),e.t1=this.store,e.t2=l,e.t3=StaticConstants.SERVER_BASE_PATH,e.next=9,v.auth().currentUser.getIdToken(!0);case 9:return e.t4=e.sent,e.t5=t.title,e.t6=e.t2.createFolder.call(e.t2,e.t3,e.t4,e.t5),e.t1.dispatch.call(e.t1,e.t6),e.abrupt("break",153);case 14:if(n=b.getAllNestedFolderIds(this.currentState.dataReducer.folderMetaMap).toJS(),r=n.length,"root"===t.toFolderId||this.currentState.stripeReducer.get("stripeData")&&0!==this.currentState.stripeReducer.get("stripeData").size&&"Free"!==this.currentState.stripeReducer.get("stripeData").get("plan").get("name")||!(r>=3)){e.next=21;break}this.store.dispatch(_.TrackerActions.trackEvent(T.folderEventConstants.FOLDER_MOVE_FAIL_UNPAID)),this.store.dispatch(E.ChromeMessageAction.sendNestedCollectionLimitMessage()),e.next=32;break;case 21:return e.t7=this.store,e.t8=l,e.t9=StaticConstants.SERVER_BASE_PATH,e.next=26,v.auth().currentUser.getIdToken(!0);case 26:e.t10=e.sent,e.t11=v.auth().currentUser,e.t12=t.fromFolderId,e.t13=t.toFolderId,e.t14=e.t8.moveFolder.call(e.t8,e.t9,e.t10,e.t11,e.t12,e.t13),e.t7.dispatch.call(e.t7,e.t14);case 32:return e.abrupt("break",153);case 33:if(!((!this.currentState.stripeReducer.get("stripeData")||0===this.currentState.stripeReducer.get("stripeData").size||"Free"===this.currentState.stripeReducer.get("stripeData").get("plan").get("name"))&&b.getAllNestedFolderIds(this.currentState.dataReducer.folderMetaMap).toJS().length>=3)){e.next=39;break}this.store.dispatch(_.TrackerActions.trackEvent("BG_CREATE_NESTED_FOLDER_FAIL_UNPAID")),this.store.dispatch(E.ChromeMessageAction.sendNestedCollectionLimitMessage()),e.next=50;break;case 39:return this.store.dispatch(_.TrackerActions.trackEvent("BG_CREATE_NESTED_FOLDER")),e.t15=this.store,e.t16=l,e.t17=StaticConstants.SERVER_BASE_PATH,e.next=45,v.auth().currentUser.getIdToken(!0);case 45:e.t18=e.sent,e.t19=t.title||"untitled",e.t20=t.parentId,e.t21=e.t16.createFolder.call(e.t16,e.t17,e.t18,e.t19,e.t20),e.t15.dispatch.call(e.t15,e.t21);case 50:return e.abrupt("break",153);case 51:return this.store.dispatch(l.switchFolder(v.auth().currentUser,this.currentState.dataReducer.folderMetaMap,t.folderId)),e.abrupt("break",153);case 53:return this.store.dispatch(_.TrackerActions.trackEvent("BG_RENAME_FOLDER")),e.t22=this.store,e.t23=l,e.t24=StaticConstants.SERVER_BASE_PATH,e.next=59,v.auth().currentUser.getIdToken(!0);case 59:return e.t25=e.sent,e.t26=t.folderId,e.t27=t.title,e.t28=t.colorTags,e.t29=t.colorCodes,e.t30=e.t23.editFolder.call(e.t23,e.t24,e.t25,e.t26,e.t27,e.t28,e.t29),e.t22.dispatch.call(e.t22,e.t30),e.abrupt("break",153);case 67:return this.store.dispatch(_.TrackerActions.trackEvent("BG_DELETE_FOLDER")),e.t31=this.store,e.t32=l,e.t33=StaticConstants.SERVER_BASE_PATH,e.next=73,v.auth().currentUser.getIdToken(!0);case 73:return e.t34=e.sent,e.t35=t.folderId,e.t36=e.t32.deleteFolder.call(e.t32,e.t33,e.t34,e.t35),e.t31.dispatch.call(e.t31,e.t36),e.abrupt("break",153);case 78:return e.abrupt("break",153);case 79:return this.currentState.dataReducer.getIn(["searchState","searching"])&&(this.store.dispatch(_.TrackerActions.trackEvent("BG_ENTER_SEARCH_MODE")),this.store.dispatch(l.resetSearchState())),e.abrupt("break",153);case 81:return this.store.dispatch(_.TrackerActions.trackEvent("BG_SEARCH_IN_FOLDER")),e.t37=this.store,e.t38=l,e.t39=StaticConstants.SERVER_BASE_PATH,e.next=87,v.auth().currentUser.getIdToken(!0);case 87:return e.t40=e.sent,e.t41=t.folderId,e.t42=t.searchStr,e.t43=t.colorFilters,e.t44=e.t38.searchInFolderRequest.call(e.t38,e.t39,e.t40,e.t41,e.t42,e.t43),e.t37.dispatch.call(e.t37,e.t44),e.abrupt("break",153);case 94:return this.store.dispatch(l.resetSharingFolderUserMeta()),e.abrupt("break",153);case 96:return e.t45=this.store,e.t46=l,e.t47=StaticConstants.SERVER_BASE_PATH,e.next=101,v.auth().currentUser.getIdToken(!0);case 101:return e.t48=e.sent,e.t49=t.folderId,e.t50=l.folderConstants.destinationOpts.SHARING_FOLDER,e.t51=e.t46.queryFolderCollaborationInfo.call(e.t46,e.t47,e.t48,e.t49,e.t50),e.t45.dispatch.call(e.t45,e.t51),e.abrupt("break",153);case 107:if(this.store.dispatch(_.TrackerActions.trackEvent(A.collaborationEventConstants.INVITE_USER)),!(!this.currentState.stripeReducer.get("stripeData")||0===this.currentState.stripeReducer.get("stripeData").size||"Free"===this.currentState.stripeReducer.get("stripeData").get("plan").get("name"))){e.next=114;break}this.store.dispatch(_.TrackerActions.trackEvent(A.collaborationEventConstants.INVITE_USER_UNPAID)),this.store.dispatch({type:I.userActionConstants.BLOCK_COLLABORATION_INVITATION}),e.next=129;break;case 114:return this.store.dispatch(_.TrackerActions.trackEvent(A.collaborationEventConstants.INVITE_USER_SUCCEED)),i=this.currentState.firebaseAuthReducer.get("user").get("displayName"),this.store.dispatch(l.addInvited(t.emailInput)),e.t52=this.store,e.t53=w,e.t54=StaticConstants.SERVER_BASE_PATH,e.next=122,v.auth().currentUser.getIdToken(!0);case 122:e.t55=e.sent,e.t56=t.folderId,e.t57=t.emailInput,e.t58=t.title,e.t59=i,e.t60=e.t53.sendInvitation.call(e.t53,e.t54,e.t55,e.t56,e.t57,e.t58,e.t59),e.t52.dispatch.call(e.t52,e.t60);case 129:return e.abrupt("break",153);case 130:if(0===t.deletedInvited.length){e.next=141;break}return e.t61=this.store,e.t62=w,e.t63=StaticConstants.SERVER_BASE_PATH,e.next=136,v.auth().currentUser.getIdToken(!0);case 136:e.t64=e.sent,e.t65=t.folderId,e.t66=t.deletedInvited,e.t67=e.t62.cancelInvitations.call(e.t62,e.t63,e.t64,e.t65,e.t66),e.t61.dispatch.call(e.t61,e.t67);case 141:if(0===t.deletedCollaborator.length){e.next=152;break}return e.t68=this.store,e.t69=w,e.t70=StaticConstants.SERVER_BASE_PATH,e.next=147,v.auth().currentUser.getIdToken(!0);case 147:e.t71=e.sent,e.t72=t.folderId,e.t73=t.deletedCollaborator,e.t74=e.t69.removeCollaborators.call(e.t69,e.t70,e.t71,e.t72,e.t73),e.t68.dispatch.call(e.t68,e.t74);case 152:return e.abrupt("break",153);case 153:case"end":return e.stop()}},e,this)}))}},{key:"_handleWebsiteMessage",value:function(t,e,n){switch(t.id){case"CREATE_WEBSITE":this.store.dispatch(h.createWebsite(v.auth().currentUser,this.currentState.dataReducer,t.url,t.favUrl||"",t.title,t.websiteId||null));break;case"DELETE_WEBSITE":this.store.dispatch(_.TrackerActions.trackEvent("BG_DELETE_WEBSITE")),this.store.dispatch(h.deleteWebsite(this.currentState.dataReducer,t.websiteId));break;case"WEBSITE_LIST_NEXT_PAGE":this.store.dispatch(_.TrackerActions.trackEvent("BG_WEBSITE_LIST_NEXT_PAGE")),this.store.dispatch(h.onNextPage());break;case"MOVE_WEBSITE":this.store.dispatch(h.moveWebsite(t.fromFolderId,t.toFolderId,t.websiteId));break;case"CHANGE_WEBSITE_ORDER":this.store.dispatch(_.TrackerActions.trackEvent("BG_CHANGE_WEBSITE_ORDER")),this.store.dispatch(h.changeWebsiteOrder(t.ascending))}}},{key:"_handleWorkspaceMessage",value:function(t,e,n){switch(t.id){case"HIGHLIGHT_MODE_SETTINGS":null!==t.highlightModeSettings.pdf&&this.store.dispatch(p.updateAutoPdfSetting(v.auth().currentUser,t.highlightModeSettings.pdf)),null!==t.highlightModeSettings.highlighter&&t.highlightModeSettings.highlighter!==this.currentState.workspaceReducer.get("highlightMode")&&(this.store.dispatch(p.updateHighlightModeSetting(v.auth().currentUser,t.highlightModeSettings.highlighter)),this.store.dispatch(E.ChromeMessageAction.sendShowNotificationMessage(t.highlightModeSettings.highlighter?"HIGHLIGHT_MODE_ON":"HIGHLIGHT_MODE_OFF")))}}},{key:"_handleHighlightMessage",value:function(t,e,n){var r=this;switch(t.id){case"CREATE_IMAGE":this.store.dispatch(f.createHighlight(v.auth().currentUser,this.currentState.dataReducer,t.documentUrl,t.websiteTitle,t.imageId,t.image,this._getFavIconFromSender(e),null)),this._sendImageToServer(t.imageId,t.base64String);break;case"DELETE_IMAGE":t.deletingWebsite||t.imageIds.forEach(function(e){r.store.dispatch(f.deleteHighlight(r.currentState.dataReducer,t.documentUrl,t.websiteId,e))}),this._deleteImageFromServer(t.imageIds,t.folderId,t.websiteId);break;case"CREATE_HIGHLIGHT":this.store.dispatch(m.moveUserReportToHighlighted()),this.store.dispatch(f.createHighlight(v.auth().currentUser,this.currentState.dataReducer,t.documentUrl,t.websiteTitle,t.highlightId,t.highlight,this._getFavIconFromSender(e),t.pageHTML));var i=this.currentState.onboardingReducer.getIn(["onboarding","extensionGuideState"]);1!==i&&1.5!==i||t.isOnboardingPage||(this.store.dispatch(_.TrackerActions.trackEvent("GUIDE_FINISHED",{guide:i})),this.store.dispatch(m.updateExtensionGuideState(v.auth().currentUser,2)));break;case"DELETE_HIGHLIGHT_IN_DB":this.store.dispatch(_.TrackerActions.trackEvent("BG_DELETE_HIGHLIGHT")),this.store.dispatch(f.deleteHighlight(this.currentState.dataReducer,t.documentUrl,t.websiteId,t.highlightId));break;case"MOVE_HIGHLIGHT":this.store.dispatch(f.moveHighlight(v.auth().currentUser,this.currentState.dataReducer,t.fromFolderId,t.toFolderId,t.websiteId,t.highlightId));break;case"UPDATE_HIGHLIGHT_COLOR":this.store.dispatch(_.TrackerActions.trackEvent("BG_UPDATE_HIGHLIGHT_COLOR")),this.store.dispatch(f.updateHighlightColor(this.currentState.dataReducer,t.documentUrl,t.highlightId,t.colorNum))}}},{key:"_handleNoteMessage",value:function(t,e,n){switch(t.id){case"EDIT_NOTE":this.store.dispatch(_.TrackerActions.trackEvent("BG_EDIT_NOTE")),this.store.dispatch(f.editNote(this.currentState.dataReducer,t.documentUrl,t.websiteId,t.highlightId,t.note))}}},{key:"_handleOtherMessage",value:function(t,e,n){return i(this,void 0,void 0,regeneratorRuntime.mark(function n(){var r,i,o,a,s,u,l,h,f,d,g=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:n.t0=t.id,n.next="SKIP_GUIDE"===n.t0?3:"FETCH_TOKEN"===n.t0?6:"CREATE_NOTIFICATION"===n.t0?8:"OPEN_PDF_VIEWER"===n.t0?10:"LOG_EVENT"===n.t0?13:"LOG_AB_TESTING_GROUP_EVENT"===n.t0?15:"OPEN_OR_SWITCH_TO_URL"===n.t0?17:"OPEN_OR_SWITCH_TO_WEAVA_URL"===n.t0?19:"HIDE_SIDEBAR_IF_NOT_PINNED"===n.t0?21:"HIDE_PAYMENT_MODAL"===n.t0?23:"TOGGLE_PIN_MODE_BY_SIDEBAR"===n.t0?25:"SHOW_SIDEBAR"===n.t0?27:"CLOSE_NOTIFICATION_MODAL"===n.t0?29:"CLOSE_HIGHLIGHT_MODE_GUIDE"===n.t0?31:"FACEBOOK_REFERRAL"===n.t0?33:"TWITTER_REFERRAL"===n.t0?37:"FACEBOOK_SHARE"===n.t0?42:"ACTUAL_FACEBOOK_SHARE"===n.t0?45:"RELOAD_EXTENSION"===n.t0?55:"SEND_ADD_COLOR_REFERRAL_EMAIL"===n.t0?62:"GRANT_GMAIL_ACCESS"===n.t0?78:88;break;case 3:return(r=this.currentState.onboardingReducer.getIn(["onboarding","extensionGuideState"]))&&(r<3?this.store.dispatch(m.updateExtensionGuideState(v.auth().currentUser,Math.floor(r)+1)):this.store.dispatch(m.updateExtensionGuideState(v.auth().currentUser,4))),n.abrupt("break",88);case 6:return v.auth().currentUser.getIdToken(!0).then(function(t){g.store.dispatch(c.setToken(t))}),n.abrupt("break",88);case 8:return this.store.dispatch(E.ChromeMessageAction.sendShowNotificationMessage(t.message,e.tab.id)),n.abrupt("break",88);case 10:return i=e.tab,chrome.tabs.update(i.id,{url:chrome.extension.getURL("src/pdfviewer/web/viewer.html")+"?file="+t.documentUrl.replace("?forcedefault=true","")}),n.abrupt("break",88);case 13:return this.store.dispatch(_.TrackerActions.trackEvent(t.event,t.meta)),n.abrupt("break",88);case 15:return this.store.dispatch(_.TrackerActions.trackUserABTest(t.name,t.group)),n.abrupt("break",88);case 17:return this._openOrSwitchToUrl(t.url,t.highlightId,t.pdfPageNumber,t.newTab,e.tab.id),n.abrupt("break",88);case 19:return this._openOrSwitchToUrl(""+StaticConstants.APP_BASE_PATH+t.url,t.highlightId,t.pdfPageNumber,t.newTab,e.tab.id),n.abrupt("break",88);case 21:return this.store.dispatch(p.clickBody(e.tab.id)),n.abrupt("break",88);case 23:return this.store.dispatch(p.hidePaymentModal()),n.abrupt("break",88);case 25:return this.store.dispatch(p.pinSideBar(e.tab.id)),n.abrupt("break",88);case 27:return this.store.dispatch(p.showAllSidebars()),n.abrupt("break",88);case 29:return this.store.dispatch(m.closeExtensionNotificationModal(v.auth().currentUser,"1.10.2")),n.abrupt("break",88);case 31:return this.store.dispatch(m.updateExtensionGuideState(v.auth().currentUser,5)),n.abrupt("break",88);case 33:return o=encodeURIComponent(";inviterId="+this.currentState.firebaseAuthReducer.get("user").get("uid")),a="https://www.facebook.com/sharer/sharer.php?u="+StaticConstants.SERVER_BASE_PATH+"referralsignup"+o,window.open(a,"_blank","status=no,height=600,width=600resizable=yes,toolbar=no,menubar=no,scrollbars=no,location=no,directories=no"),n.abrupt("break",88);case 37:return s=encodeURIComponent(";inviterId="+this.currentState.firebaseAuthReducer.get("user").get("uid")),"hashtags=weavatools,weava,highlighter,studytools",u="https://twitter.com/intent/tweet?url="+StaticConstants.SERVER_BASE_PATH+"referralsignup"+s+"&hashtags=weavatools,weava,highlighter,studytools",window.open(u,"_blank","status=no,height=600,width=600resizable=yes,toolbar=no,menubar=no,scrollbars=no,location=no,directories=no"),n.abrupt("break",88);case 42:return l="https://www.facebook.com/sharer/sharer.php?uid="+this.currentState.firebaseAuthReducer.get("user").get("uid")+"&u="+StaticConstants.SERVER_BASE_PATH,window.open(l,"_blank","status=no,height=600,width=600resizable=yes,toolbar=no,menubar=no,scrollbars=no,location=no,directories=no"),n.abrupt("break",88);case 45:return n.t1=this.store,n.t2=w,n.t3=StaticConstants.SERVER_BASE_PATH,n.next=50,v.auth().currentUser.getIdToken(!0);case 50:return n.t4=n.sent,n.t5=n.t2.setFreePremium.call(n.t2,n.t3,n.t4,1),n.t1.dispatch.call(n.t1,n.t5),this.store.dispatch(_.TrackerActions.trackEvent("ACTUAL_FACEBOOK_SHARE")),n.abrupt("break",88);case 55:if(!localStorage.getItem("firebase:previous_websocket_failure")){n.next=58;break}return localStorage.removeItem("firebase:previous_websocket_failure"),n.abrupt("break",88);case 58:return h=this.currentState.loggerRedcuer.get("previousActions").toJS().join(" > "),this.store.dispatch(_.TrackerActions.trackEvent("RELOAD_EXTENSION",{previousActions:h,syncProcessReducer:JSON.stringify(this.currentState.syncProcessReducer.toJS()),firebaseAuthReducer:JSON.stringify(this.currentState.firebaseAuthReducer.toJS())})),window.setTimeout(function(){chrome.runtime.reload()}),n.abrupt("break",88);case 62:if(!(f=v.auth().currentUser)){n.next=75;break}return n.t6=this.store,n.t7=O.MailsActions,n.t8=StaticConstants.SERVER_BASE_PATH,n.next=69,f.getIdToken(!0);case 69:n.t9=n.sent,n.t10=t.emails,n.t11=n.t7.sendAddColorReferralEmails.call(n.t7,n.t8,n.t9,n.t10),n.t6.dispatch.call(n.t6,n.t11),n.next=77;break;case 75:return alert("Please Login Weava"),n.abrupt("return");case 77:return n.abrupt("break",88);case 78:if(!(d=v.auth().currentUser)){n.next=87;break}return n.t12=window,n.t13=StaticConstants.SERVER_BASE_PATH+"apis/googleouath2/init?token=",n.next=84,d.getIdToken(!0);case 84:n.t14=n.sent,n.t15=n.t13+n.t14,n.t12.open.call(n.t12,n.t15);case 87:return n.abrupt("break",88);case 88:case"end":return n.stop()}},n,this)}))}},{key:"_handleExternalMessage",value:function(t,e,n){var r=this;switch(t.id){case"CHECK_VERSION":n({version:chrome.runtime.getManifest().version});break;case"SIGN_IN":chrome.storage.local.get("isAnonymous",function(e){(!r.currentState.firebaseAuthReducer.get("user")||t.uid!==r.currentState.firebaseAuthReducer.get("user").get("uid")||e.isAnonymous&&!t.isAnonymous)&&(r.store.dispatch(_.TrackerActions.trackIsAnonymous(t.isAnonymous)),chrome.storage.local.set({isAnonymous:t.isAnonymous}),r.store.dispatch(c.loginWithCustomToken(t.customToken,t.isAnonymous)))});break;case"SIGN_OUT":this.store.dispatch(c.signout());break;case"OPEN_CHROME_EXTENSION_SHORTCUTS":this._openOrSwitchToUrl("chrome://extensions/shortcuts");break;case"OPEN_CHROME_NOTIFICATION_SETTINGS":this._openOrSwitchToUrl("chrome://settings/content/notifications")}}},{key:"_openOrSwitchToUrl",value:function(t,e,n,r,o){return i(this,void 0,void 0,regeneratorRuntime.mark(function a(){var s=this;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:void 0===r&&(r=!0),chrome.tabs.query({lastFocusedWindow:!0},function(a){return i(s,void 0,void 0,regeneratorRuntime.mark(function i(){var s,u,c,l;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:s=!0,i.t0=regeneratorRuntime.keys(a);case 2:if((i.t1=i.t0()).done){i.next=14;break}if(u=i.t1.value,c=a[u]){i.next=7;break}return i.abrupt("return");case 7:if(UrlUtil.getOriginalUrlForPDF(t)!==UrlUtil.getOriginalUrlForPDF(c.url)){i.next=12;break}return chrome.tabs.update(c.id,{active:!0}),e&&this.store.dispatch(E.ChromeMessageAction.sendScrollToHighlightMessage(e,n)),s=!1,i.abrupt("break",14);case 12:i.next=2;break;case 14:if(!s){i.next=31;break}if(-1!==t.indexOf("weavatools.com")&&-1!==t.indexOf("pdfstorage")){i.next=19;break}t=t.replace(chrome.extension.getURL("src/pdfviewer/web/viewer.html")+"?file=",""),i.next=30;break;case 19:if(!(l=v.auth().currentUser)){i.next=28;break}return i.t2=""+t+encodeURIComponent("?token="),i.next=24,l.getIdToken(!0);case 24:i.t3=i.sent,t=i.t2+i.t3,i.next=30;break;case 28:return alert("Please Login Weava"),i.abrupt("return");case 30:r?chrome.tabs.create({url:t}):chrome.tabs.update(o,{url:t});case 31:case"end":return i.stop()}},i,this)}))});case 2:case"end":return a.stop()}},a,this)}))}},{key:"_sendImageToServer",value:function(t,e){var n={imageId:t,base64String:e},r=JSON.stringify(n);R(StaticConstants.POST_IMAGE_API,{method:"POST",headers:{"Content-Type":"application/json"},body:r}).then(function(t){})}}]),e}();e.ChromeMessageView=N},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(23);e.chromeMessagesActionConstants=r({ADD_MESSAGE:null,MESSAGE_SENT:null,MESSAGE_RECEIVED:null,ADD_EXTERNAL_MESSAGE:null,EXTERNAL_MESSAGE_SENT:null}),e.onAddMessage=function(t,n){return{type:e.chromeMessagesActionConstants.ADD_MESSAGE,tabId:n,message:t}},e.onMessageSent=function(){return{type:e.chromeMessagesActionConstants.MESSAGE_SENT}},e.onAddExternalMessage=function(t,n){return{type:e.chromeMessagesActionConstants.ADD_EXTERNAL_MESSAGE,tabId:n,message:t}},e.onExternalMessageSent=function(){return{type:e.chromeMessagesActionConstants.EXTERNAL_MESSAGE_SENT}}},function(t,e,n){n(501),t.exports=n(16).default},function(t,e,n){"use strict";n.r(e),n(502),n(506),n(507)},function(t,e,n){(function(t){var e=function(){if(void 0!==t)return t;if("undefined"!=typeof window)return window;if("undefined"!=typeof self)return self;throw new Error("unable to locate global object")}();"undefined"==typeof Promise&&(e.Promise=Promise=n(503))}).call(this,n(8))},function(t,e,n){(function(e){!function(n){function r(){}function i(t){if(!(this instanceof i))throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(t,this)}function o(t,e){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,i._immediateFn(function(){var n=1===t._state?e.onFulfilled:e.onRejected;if(null!==n){var r;try{r=n(t._value)}catch(t){return void s(e.promise,t)}a(e.promise,r)}else(1===t._state?a:s)(e.promise,t._value)})):t._deferreds.push(e)}function a(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof i)return t._state=3,t._value=e,void u(t);if("function"==typeof n)return void l(function(t,e){return function(){t.apply(e,arguments)}}(n,e),t)}t._state=1,t._value=e,u(t)}catch(e){s(t,e)}}function s(t,e){t._state=2,t._value=e,u(t)}function u(t){2===t._state&&0===t._deferreds.length&&i._immediateFn(function(){t._handled||i._unhandledRejectionFn(t._value)});for(var e=0,n=t._deferreds.length;e<n;e++)o(t,t._deferreds[e]);t._deferreds=null}function c(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}function l(t,e){var n=!1;try{t(function(t){n||(n=!0,a(e,t))},function(t){n||(n=!0,s(e,t))})}catch(t){if(n)return;n=!0,s(e,t)}}var h=setTimeout;i.prototype.catch=function(t){return this.then(null,t)},i.prototype.then=function(t,e){var n=new this.constructor(r);return o(this,new c(t,e,n)),n},i.all=function(t){return new i(function(e,n){function r(t,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var s=a.then;if("function"==typeof s)return void s.call(a,function(e){r(t,e)},n)}i[t]=a,0==--o&&e(i)}catch(t){n(t)}}if(!t||void 0===t.length)throw new TypeError("Promise.all accepts an array");var i=Array.prototype.slice.call(t);if(0===i.length)return e([]);for(var o=i.length,a=0;a<i.length;a++)r(a,i[a])})},i.resolve=function(t){return t&&"object"==typeof t&&t.constructor===i?t:new i(function(e){e(t)})},i.reject=function(t){return new i(function(e,n){n(t)})},i.race=function(t){return new i(function(e,n){for(var r=0,i=t.length;r<i;r++)t[r].then(e,n)})},i._immediateFn="function"==typeof e&&function(t){e(t)}||function(t){h(t,0)},i._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},i._setImmediateFn=function(t){i._immediateFn=t},i._setUnhandledRejectionFn=function(t){i._unhandledRejectionFn=t},t.exports?t.exports=i:n.Promise||(n.Promise=i)}(this)}).call(this,n(504).setImmediate)},function(t,e,n){(function(t){function r(t,e){this._id=t,this._clearFn=e}var i=void 0!==t&&t||"undefined"!=typeof self&&self||window,o=Function.prototype.apply;e.setTimeout=function(){return new r(o.call(setTimeout,i,arguments),clearTimeout)},e.setInterval=function(){return new r(o.call(setInterval,i,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(i,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},n(505),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n(8))},function(t,e,n){(function(t,e){!function(t,n){"use strict";function r(t){delete s[t]}function i(t){if(u)setTimeout(i,0,t);else{var e=s[t];if(e){u=!0;try{!function(t){var e=t.callback,r=t.args;switch(r.length){case 0:e();break;case 1:e(r[0]);break;case 2:e(r[0],r[1]);break;case 3:e(r[0],r[1],r[2]);break;default:e.apply(n,r)}}(e)}finally{r(t),u=!1}}}}if(!t.setImmediate){var o,a=1,s={},u=!1,c=t.document,l=Object.getPrototypeOf&&Object.getPrototypeOf(t);l=l&&l.setTimeout?l:t,"[object process]"==={}.toString.call(t.process)?o=function(t){e.nextTick(function(){i(t)})}:function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?function(){var e="setImmediate$"+Math.random()+"$",n=function(n){n.source===t&&"string"==typeof n.data&&0===n.data.indexOf(e)&&i(+n.data.slice(e.length))};t.addEventListener?t.addEventListener("message",n,!1):t.attachEvent("onmessage",n),o=function(n){t.postMessage(e+n,"*")}}():t.MessageChannel?function(){var t=new MessageChannel;t.port1.onmessage=function(t){i(t.data)},o=function(e){t.port2.postMessage(e)}}():c&&"onreadystatechange"in c.createElement("script")?function(){var t=c.documentElement;o=function(e){var n=c.createElement("script");n.onreadystatechange=function(){i(e),n.onreadystatechange=null,t.removeChild(n),n=null},t.appendChild(n)}}():o=function(t){setTimeout(i,0,t)},l.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var r={callback:t,args:e};return s[a]=r,o(a),a++},l.clearImmediate=r}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n(8),n(152))},function(t,e){Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(t){if(null==this)throw new TypeError('"this" is null or not defined');var e=Object(this),n=e.length>>>0;if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var r=arguments[1],i=0;i<n;){var o=e[i];if(t.call(r,o,i,e))return o;i++}}})},function(t,e){Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(t){if(null==this)throw new TypeError('"this" is null or not defined');var e=Object(this),n=e.length>>>0;if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var r=arguments[1],i=0;i<n;){var o=e[i];if(t.call(r,o,i,e))return i;i++}return-1}})},function(t,e,n){"use strict";function r(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&(t[n]=r(t[n],e[n]));return t}Object.defineProperty(e,"__esModule",{value:!0}),e.deepCopy=function(t){return r(void 0,t)},e.deepExtend=r,e.patchProperty=function(t,e,n){t[e]=n}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch(function(){}),1===t.length?t(n):t(n,r))}},t}();e.Deferred=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(153);e.getUA=function(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""},e.isMobileCordova=function(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(e.getUA())},e.isReactNative=function(){return"object"==typeof navigator&&"ReactNative"===navigator.product},e.isNodeSdk=function(){return!0===r.CONSTANTS.NODE_CLIENT||!0===r.CONSTANTS.NODE_ADMIN}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r="FirebaseError",i=Error.captureStackTrace;e.patchCapture=function(t){var e=i;return i=t,e};var o=function(){return function(t,e){if(this.code=t,this.message=e,i)i(this,a.prototype.create);else{var n=Error.apply(this,arguments);this.name=r,Object.defineProperty(this,"stack",{get:function(){return n.stack}})}}}();e.FirebaseError=o,o.prototype=Object.create(Error.prototype),o.prototype.constructor=o,o.prototype.name=r;var a=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n,this.pattern=/\{\$([^}]+)}/g}return t.prototype.create=function(t,e){void 0===e&&(e={});var n,r=this.errors[t],i=this.service+"/"+t;n=void 0===r?"Error":r.replace(this.pattern,function(t,n){var r=e[n];return void 0!==r?r.toString():"<"+n+"?>"}),n=this.serviceName+": "+n+" ("+i+").";var a=new o(i,n);for(var s in e)e.hasOwnProperty(s)&&"_"!==s.slice(-1)&&(a[s]=e[s]);return a},t}();e.ErrorFactory=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(212),i=n(213);e.decode=function(t){var e={},n={},o={},a="";try{var s=t.split(".");e=i.jsonEval(r.base64Decode(s[0])||""),n=i.jsonEval(r.base64Decode(s[1])||""),a=s[2],o=n.d||{},delete n.d}catch(t){}return{header:e,claims:n,data:o,signature:a}},e.isValidTimestamp=function(t){var n,r,i=e.decode(t).claims,o=Math.floor((new Date).getTime()/1e3);return"object"==typeof i&&(i.hasOwnProperty("nbf")?n=i.nbf:i.hasOwnProperty("iat")&&(n=i.iat),r=i.hasOwnProperty("exp")?i.exp:n+86400),o&&n&&r&&o>=n&&o<=r},e.issuedAtTime=function(t){var n=e.decode(t).claims;return"object"==typeof n&&n.hasOwnProperty("iat")?n.iat:null},e.isValidFormat=function(t){var n=e.decode(t),r=n.claims;return!!n.signature&&!!r&&"object"==typeof r&&r.hasOwnProperty("iat")},e.isAdmin=function(t){var n=e.decode(t).claims;return"object"==typeof n&&!0===n.admin}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(214);e.querystring=function(t){var e=[];return r.forEach(t,function(t,n){Array.isArray(n)?n.forEach(function(n){e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))}),e.length?"&"+e.join("&"):""},e.querystringDecode=function(t){var e={};return t.replace(/^\?/,"").split("&").forEach(function(t){if(t){var n=t.split("=");e[n[0]]=n[1]}}),e}},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){function e(){var e=t.call(this)||this;e.chain_=[],e.buf_=[],e.W_=[],e.pad_=[],e.inbuf_=0,e.total_=0,e.blockSize=64,e.pad_[0]=128;for(var n=1;n<e.blockSize;++n)e.pad_[n]=0;return e.reset(),e}return r(e,t),e.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},e.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"==typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o,a,s=this.chain_[0],u=this.chain_[1],c=this.chain_[2],l=this.chain_[3],h=this.chain_[4];for(r=0;r<80;r++){r<40?r<20?(o=l^u&(c^l),a=1518500249):(o=u^c^l,a=1859775393):r<60?(o=u&c|l&(u|c),a=2400959708):(o=u^c^l,a=3395469782);i=(s<<5|s>>>27)+o+h+a+n[r]&4294967295;h=l,l=c,c=4294967295&(u<<30|u>>>2),u=s,s=i}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295},e.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<e;){if(0==o)for(;r<=n;)this.compress_(t,r),r+=this.blockSize;if("string"==typeof t){for(;r<e;)if(i[o]=t.charCodeAt(r),++r,++o==this.blockSize){this.compress_(i),o=0;break}}else for(;r<e;)if(i[o]=t[r],++r,++o==this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}},e.prototype.digest=function(){var t=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)t[r]=this.chain_[n]>>i&255,++r;return t},e}(n(515).Hash);e.Sha1=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){return function(){this.blockSize=-1}}();e.Hash=r},function(t,e,n){"use strict";function r(){}Object.defineProperty(e,"__esModule",{value:!0}),e.createSubscribe=function(t,e){var n=new i(t,e);return n.subscribe.bind(n)};var i=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(function(){t(n)}).catch(function(t){n.error(t)})}return t.prototype.next=function(t){this.forEachObserver(function(e){e.next(t)})},t.prototype.error=function(t){this.forEachObserver(function(e){e.error(t)}),this.close(t)},t.prototype.complete=function(){this.forEachObserver(function(t){t.complete()}),this.close()},t.prototype.subscribe=function(t,e,n){var i,o=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(i=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:n}).next&&(i.next=r),void 0===i.error&&(i.error=r),void 0===i.complete&&(i.complete=r);var a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{o.finalError?i.error(o.finalError):i.complete()}catch(t){}}),this.observers.push(i),a},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}})},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then(function(){e.observers=void 0,e.onNoObservers=void 0}))},t}();e.async=function(t,e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Promise.resolve(!0).then(function(){t.apply(void 0,n)}).catch(function(t){e&&e(t)})}}},function(t,e,n){"use strict";function r(t,e,n){var r="";switch(e){case 1:r=n?"first":"First";break;case 2:r=n?"second":"Second";break;case 3:r=n?"third":"Third";break;case 4:r=n?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}return t+" failed: "+(r+" argument ")}Object.defineProperty(e,"__esModule",{value:!0}),e.validateArgCount=function(t,e,n,r){var i;if(r<e?i="at least "+e:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(t+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")},e.errorPrefix=r,e.validateNamespace=function(t,e,n,i){if((!i||n)&&"string"!=typeof n)throw new Error(r(t,e,i)+"must be a valid firebase namespace.")},e.validateCallback=function(t,e,n,i){if((!i||n)&&"function"!=typeof n)throw new Error(r(t,e,i)+"must be a valid function.")},e.validateContextObject=function(t,e,n,i){if((!i||n)&&("object"!=typeof n||null===n))throw new Error(r(t,e,i)+"must be a valid context object.")}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(211);e.stringToByteArray=function(t){for(var e=[],n=0,i=0;i<t.length;i++){var o=t.charCodeAt(i);if(o>=55296&&o<=56319){var a=o-55296;i++,r.assert(i<t.length,"Surrogate pair missing trail surrogate."),o=65536+(a<<10)+(t.charCodeAt(i)-56320)}o<128?e[n++]=o:o<2048?(e[n++]=o>>6|192,e[n++]=63&o|128):o<65536?(e[n++]=o>>12|224,e[n++]=o>>6&63|128,e[n++]=63&o|128):(e[n++]=o>>18|240,e[n++]=o>>12&63|128,e[n++]=o>>6&63|128,e[n++]=63&o|128)}return e},e.stringLength=function(t){for(var e=0,n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e}},function(t,e,n){(function(t){(function(){function t(t){return"string"==typeof t}function e(t){return"boolean"==typeof t}function r(){}function i(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function o(t){return null===t}function a(t){return"array"==i(t)}function s(t){var e=i(t);return"array"==e||"object"==e&&"number"==typeof t.length}function u(t){return"function"==i(t)}function c(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function l(t,e,n){return t.call.apply(t.bind,arguments)}function h(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function f(t,e,n){return(f=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?l:h).apply(null,arguments)}function p(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function d(t,e){function n(){}n.prototype=e.prototype,t.ib=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Rc=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function v(t){if(Error.captureStackTrace)Error.captureStackTrace(this,v);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function g(t,e){for(var n=t.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")}function y(t){return Ga.test(t)?(-1!=t.indexOf("&")&&(t=t.replace(ja,"&amp;")),-1!=t.indexOf("<")&&(t=t.replace(Ba,"&lt;")),-1!=t.indexOf(">")&&(t=t.replace(Va,"&gt;")),-1!=t.indexOf('"')&&(t=t.replace(Wa,"&quot;")),-1!=t.indexOf("'")&&(t=t.replace(qa,"&#39;")),-1!=t.indexOf("\0")&&(t=t.replace(Ha,"&#0;")),t):t}function m(t,e){return-1!=t.indexOf(e)}function _(t,e){return t<e?-1:t>e?1:0}function b(t,e){e.unshift(t),v.call(this,g.apply(null,e)),e.shift()}function E(t,e){throw new b("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}function w(e,n){var r=e.length,i=t(e)?e.split(""):e;for(--r;0<=r;--r)r in i&&n.call(void 0,i[r],r,e)}function S(e){t:{for(var n=tn,r=e.length,i=t(e)?e.split(""):e,o=0;o<r;o++)if(o in i&&n.call(void 0,i[o],o,e)){n=o;break t}n=-1}return 0>n?null:t(e)?e.charAt(n):e[n]}function T(t,e){return 0<=za(t,e)}function I(t,e){var n;return(n=0<=(e=za(t,e)))&&Array.prototype.splice.call(t,e,1),n}function A(t,e){w(t,function(n,r){e.call(void 0,n,r,t)&&1==Array.prototype.splice.call(t,r,1).length&&0})}function O(t){return Array.prototype.concat.apply([],arguments)}function C(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function R(t){return m(Ka,t)}function N(t,e){for(var n in t)e.call(void 0,t[n],n,t)}function k(t){var e,n=[],r=0;for(e in t)n[r++]=t[e];return n}function P(t){var e,n=[],r=0;for(e in t)n[r++]=e;return n}function D(t){for(var e in t)return!1;return!0}function x(t,e){for(var n in t)if(!(n in e)||t[n]!==e[n])return!1;for(n in e)if(!(n in t))return!1;return!0}function M(t){var e,n={};for(e in t)n[e]=t[e];return n}function L(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<Za.length;o++)n=Za[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function F(t){return F[" "](t),t}function U(){var t=xa.document;return t?t.documentMode:void 0}function j(t){return function(t,e){var n=hs;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,function(){for(var e=0,n=Ua(String(ts)).split("."),r=Ua(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=_(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||_(0==a[2].length,0==s[2].length)||_(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e})}function B(t){t.prototype.then=t.prototype.then,t.prototype.$goog_Thenable=!0}function V(t){if(!t)return!1;try{return!!t.$goog_Thenable}catch(t){return!1}}function W(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function q(t,e){t.g(e),t.b<t.f&&(t.b++,e.next=t.a,t.a=e)}function H(){var t=ys,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function G(){this.next=this.b=this.a=null}function K(t){xa.setTimeout(function(){throw t},0)}function z(t,e){vs||function(){if(-1!=String(xa.Promise).indexOf("[native code]")){var t=xa.Promise.resolve(void 0);vs=function(){t.then(Q)}}else vs=function(){var t=Q;!u(xa.setImmediate)||xa.Window&&xa.Window.prototype&&!R("Edge")&&xa.Window.prototype.setImmediate==xa.setImmediate?(ds||(ds=function(){var t=xa.MessageChannel;if(void 0===t&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!R("Presto")&&(t=function(){var t=document.createElement("IFRAME");t.style.display="none",t.src="",document.documentElement.appendChild(t);var e=t.contentWindow;(t=e.document).open(),t.write(""),t.close();var n="callImmediate"+Math.random(),r="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host;t=f(function(t){"*"!=r&&t.origin!=r||t.data!=n||this.port1.onmessage()},this),e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(n,r)}}}),void 0!==t&&!R("Trident")&&!R("MSIE")){var e=new t,n={},r=n;return e.port1.onmessage=function(){if(void 0!==n.next){var t=(n=n.next).pb;n.pb=null,t()}},function(t){r.next={pb:t},r=r.next,e.port2.postMessage(0)}}return"undefined"!=typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(t){var e=document.createElement("SCRIPT");e.onreadystatechange=function(){e.onreadystatechange=null,e.parentNode.removeChild(e),e=null,t(),t=null},document.documentElement.appendChild(e)}:function(t){xa.setTimeout(t,0)}}()),ds(t)):xa.setImmediate(t)}}(),gs||(vs(),gs=!0);var n=ys,r=ps.get();r.set(t,e),n.b?n.b.next=r:n.a=r,n.b=r}function Q(){for(var t;t=H();){try{t.a.call(t.b)}catch(t){K(t)}q(ps,t)}gs=!1}function X(t,e){if(this.a=ms,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,t!=r)try{var n=this;t.call(e,function(t){it(n,_s,t)},function(t){if(!(t instanceof lt))try{if(t instanceof Error)throw t;throw Error("Promise rejected.")}catch(t){}it(n,bs,t)})}catch(t){it(this,bs,t)}}function Y(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}function J(t,e,n){var r=Es.get();return r.g=t,r.b=e,r.f=n,r}function $(t){if(t instanceof X)return t;var e=new X(r);return it(e,_s,t),e}function Z(t){return new X(function(e,n){n(t)})}function tt(t,e,n){ot(t,e,n,null)||z(p(e,t))}function et(t,e){return(e=J(e,e,void 0)).c=!0,nt(t,e),t}function nt(t,e){t.b||t.a!=_s&&t.a!=bs||at(t),t.f?t.f.next=e:t.b=e,t.f=e}function rt(t,e,n,r){var i=J(null,null,null);return i.a=new X(function(t,o){i.g=e?function(n){try{var i=e.call(r,n);t(i)}catch(t){o(t)}}:t,i.b=n?function(e){try{var i=n.call(r,e);void 0===i&&e instanceof lt?o(e):t(i)}catch(t){o(t)}}:o}),i.a.c=t,nt(t,i),i.a}function it(t,e,n){t.a==ms&&(t===n&&(e=bs,n=new TypeError("Promise cannot resolve to itself")),t.a=1,ot(n,t.Ac,t.Bc,t)||(t.i=n,t.a=e,t.c=null,at(t),e!=bs||n instanceof lt||function(t,e){t.g=!0,z(function(){t.g&&ws.call(null,e)})}(t,n)))}function ot(t,e,n,i){if(t instanceof X)return nt(t,J(e||r,n||null,i)),!0;if(V(t))return t.then(e,n,i),!0;if(c(t))try{var o=t.then;if(u(o))return function(t,e,n,r,i){function o(t){a||(a=!0,r.call(i,t))}var a=!1;try{e.call(t,function(t){a||(a=!0,n.call(i,t))},o)}catch(t){o(t)}}(t,o,e,n,i),!0}catch(t){return n.call(i,t),!0}return!1}function at(t){t.h||(t.h=!0,z(t.Qb,t))}function st(t){var e=null;return t.b&&(e=t.b,t.b=e.next,e.next=null),t.b||(t.f=null),e}function ut(t,e,n,r){if(n==bs&&e.b&&!e.c)for(;t&&t.g;t=t.c)t.g=!1;if(e.a)e.a.c=null,ct(e,n,r);else try{e.c?e.g.call(e.f):ct(e,n,r)}catch(t){ws.call(null,t)}q(Es,e)}function ct(t,e,n){e==_s?t.g.call(t.f,n):t.b&&t.b.call(t.f,n)}function lt(t){v.call(this,t)}function ht(){this.a="",this.b=Ts}function ft(t){return t instanceof ht&&t.constructor===ht&&t.b===Ts?t.a:(E("expected object of type Const, got '"+t+"'"),"type_error:Const")}function pt(t){var e=new ht;return e.a=t,e}function dt(){this.a="",this.b=Os}function vt(t){return t instanceof dt&&t.constructor===dt&&t.b===Os?t.a:(E("expected object of type TrustedResourceUrl, got '"+t+"' of type "+i(t)),"type_error:TrustedResourceUrl")}function gt(t,e){return t=function(t,e){var n=ft(t);if(!As.test(n))throw Error("Invalid TrustedResourceUrl format: "+n);return n.replace(Is,function(t,r){if(!Object.prototype.hasOwnProperty.call(e,r))throw Error('Found marker, "'+r+'", in format string, "'+n+'", but no valid label mapping found in args: '+JSON.stringify(e));return(t=e[r])instanceof ht?ft(t):encodeURIComponent(String(t))})}(t,e),(e=new dt).a=t,e}function yt(){this.a="",this.b=Rs}function mt(t){return t instanceof yt&&t.constructor===yt&&t.b===Rs?t.a:(E("expected object of type SafeUrl, got '"+t+"' of type "+i(t)),"type_error:SafeUrl")}function _t(t){return t instanceof yt?t:(t=t.la?t.ja():String(t),Cs.test(t)||(t="about:invalid#zClosurez"),bt(t))}function bt(t){var e=new yt;return e.a=t,e}function Et(){this.a="",this.b=Ns}function wt(t){return t instanceof Et&&t.constructor===Et&&t.b===Ns?t.a:(E("expected object of type SafeHtml, got '"+t+"' of type "+i(t)),"type_error:SafeHtml")}function St(t){var e=new Et;return e.a=t,e}function Tt(e){var n=document;return t(e)?n.getElementById(e):e}function It(t,e){N(e,function(e,n){e&&e.la&&(e=e.ja()),"style"==n?t.style.cssText=e:"class"==n?t.className=e:"for"==n?t.htmlFor=e:ks.hasOwnProperty(n)?t.setAttribute(ks[n],e):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?t.setAttribute(n,e):t[n]=e})}function At(e,n,r){var i=arguments,o=document,s=String(i[0]),u=i[1];if(!Ss&&u&&(u.name||u.type)){if(s=["<",s],u.name&&s.push(' name="',y(u.name),'"'),u.type){s.push(' type="',y(u.type),'"');var c={};L(c,u),delete c.type,u=c}s.push(">"),s=s.join("")}return s=o.createElement(s),u&&(t(u)?s.className=u:a(u)?s.className=u.join(" "):It(s,u)),2<i.length&&Ot(o,s,i),s}function Ot(e,n,r){function i(r){r&&n.appendChild(t(r)?e.createTextNode(r):r)}for(var o=2;o<r.length;o++){var a=r[o];!s(a)||c(a)&&0<a.nodeType?i(a):Qa(Ct(a)?C(a):a,i)}}function Ct(t){if(t&&"number"==typeof t.length){if(c(t))return"function"==typeof t.item||"string"==typeof t.item;if(u(t))return"function"==typeof t.item}return!1}function Rt(t){var e=[];return function t(e,n,r){if(null==n)r.push("null");else{if("object"==typeof n){if(a(n)){var i=n;n=i.length,r.push("[");for(var o="",s=0;s<n;s++)r.push(o),t(e,i[s],r),o=",";return void r.push("]")}if(!(n instanceof String||n instanceof Number||n instanceof Boolean)){for(i in r.push("{"),o="",n)Object.prototype.hasOwnProperty.call(n,i)&&"function"!=typeof(s=n[i])&&(r.push(o),kt(i,r),r.push(":"),t(e,s,r),o=",");return void r.push("}")}n=n.valueOf()}switch(typeof n){case"string":kt(n,r);break;case"number":r.push(isFinite(n)&&!isNaN(n)?String(n):"null");break;case"boolean":r.push(String(n));break;case"function":r.push("null");break;default:throw Error("Unknown type: "+typeof n)}}}(new Nt,t,e),e.join("")}function Nt(){}function kt(t,e){e.push('"',t.replace(Ds,function(t){var e=Ps[t];return e||(e="\\u"+(65536|t.charCodeAt(0)).toString(16).substr(1),Ps[t]=e),e}),'"')}function Pt(){0!=xs&&(Ms[this[Ma]||(this[Ma]=++La)]=this),this.oa=this.oa,this.Fa=this.Fa}function Dt(t){t.oa||(t.oa=!0,t.ta(),0!=xs&&(t=t[Ma]||(t[Ma]=++La),delete Ms[t]))}function xt(t,e){this.type=t,this.b=this.target=e,this.Bb=!0}function Mt(e,n){if(xt.call(this,e?e.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,e){var r=this.type=e.type,i=e.changedTouches?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.b=n,n=e.relatedTarget){if(os){t:{try{F(n.nodeName);var o=!0;break t}catch(t){}o=!1}o||(n=null)}}else"mouseover"==r?n=e.fromElement:"mouseout"==r&&(n=e.toElement);this.relatedTarget=n,null===i?(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0):(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=t(e.pointerType)?e.pointerType:Bs[e.pointerType]||"",this.a=e,e.defaultPrevented&&this.c()}}function Lt(t,e,n,r,i){this.listener=t,this.a=null,this.src=e,this.type=n,this.capture=!!r,this.La=i,this.key=++Ws,this.ma=this.Ha=!1}function Ft(t){t.ma=!0,t.listener=null,t.a=null,t.src=null,t.La=null}function Ut(t){this.src=t,this.a={},this.b=0}function jt(t,e,n,r,i,o){var a=e.toString();(e=t.a[a])||(e=t.a[a]=[],t.b++);var s=Vt(e,n,i,o);return-1<s?(t=e[s],r||(t.Ha=!1)):((t=new Lt(n,t.src,a,!!i,o)).Ha=r,e.push(t)),t}function Bt(t,e){var n=e.type;n in t.a&&I(t.a[n],e)&&(Ft(e),0==t.a[n].length&&(delete t.a[n],t.b--))}function Vt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.ma&&o.listener==e&&o.capture==!!n&&o.La==r)return i}return-1}function Wt(t,e,n,r,i){if(r&&r.once)Ht(t,e,n,r,i);else if(a(e))for(var o=0;o<e.length;o++)Wt(t,e[o],n,r,i);else n=$t(n),t&&t[Vs]?ee(t,e,n,c(r)?!!r.capture:!!r,i):qt(t,e,n,!1,r,i)}function qt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a=c(i)?!!i.capture:!!i,s=Jt(t);if(s||(t[qs]=s=new Ut(t)),!(n=jt(s,e,n,r,a,o)).a){if(r=function(){var t=Yt,e=Fs?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.a=r,r.src=t,r.listener=n,t.addEventListener)js||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else{if(!t.attachEvent)throw Error("addEventListener and attachEvent are unavailable.");t.attachEvent(zt(e.toString()),r)}0}}function Ht(t,e,n,r,i){if(a(e))for(var o=0;o<e.length;o++)Ht(t,e[o],n,r,i);else n=$t(n),t&&t[Vs]?ne(t,e,n,c(r)?!!r.capture:!!r,i):qt(t,e,n,!0,r,i)}function Gt(t,e,n,r,i){if(a(e))for(var o=0;o<e.length;o++)Gt(t,e[o],n,r,i);else r=c(r)?!!r.capture:!!r,n=$t(n),t&&t[Vs]?(t=t.u,(e=String(e).toString())in t.a&&(-1<(n=Vt(o=t.a[e],n,r,i))&&(Ft(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--)))):t&&(t=Jt(t))&&(e=t.a[e.toString()],t=-1,e&&(t=Vt(e,n,r,i)),(n=-1<t?e[t]:null)&&Kt(n))}function Kt(t){if("number"!=typeof t&&t&&!t.ma){var e=t.src;if(e&&e[Vs])Bt(e.u,t);else{var n=t.type,r=t.a;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent&&e.detachEvent(zt(n),r),0,(n=Jt(e))?(Bt(n,t),0==n.b&&(n.src=null,e[qs]=null)):Ft(t)}}}function zt(t){return t in Hs?Hs[t]:Hs[t]="on"+t}function Qt(t,e,n,r){var i=!0;if((t=Jt(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==n&&!o.ma&&(o=Xt(o,r),i=i&&!1!==o)}return i}function Xt(t,e){var n=t.listener,r=t.La||t.src;return t.Ha&&Kt(t),n.call(r,e)}function Yt(t,e){if(t.ma)return!0;if(!Fs){if(!e)t:{e=["window","event"];for(var n=xa,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}if(e=new Mt(r=e,this),n=!0,!(0>r.keyCode||null!=r.returnValue)){t:{var i=!1;if(0==r.keyCode)try{r.keyCode=-1;break t}catch(t){i=!0}(i||null==r.returnValue)&&(r.returnValue=!0)}for(r=[],i=e.b;i;i=i.parentNode)r.push(i);for(t=t.type,i=r.length-1;0<=i;i--){e.b=r[i];var o=Qt(r[i],t,!0,e);n=n&&o}for(i=0;i<r.length;i++)e.b=r[i],o=Qt(r[i],t,!1,e),n=n&&o}return n}return Xt(t,new Mt(e,this))}function Jt(t){return(t=t[qs])instanceof Ut?t:null}function $t(t){return u(t)?t:(t[Gs]||(t[Gs]=function(e){return t.handleEvent(e)}),t[Gs])}function Zt(){Pt.call(this),this.u=new Ut(this),this.Ib=this,this.Ra=null}function te(e,n){var r,i=e.Ra;if(i)for(r=[];i;i=i.Ra)r.push(i);if(e=e.Ib,i=n.type||n,t(n))n=new xt(n,e);else if(n instanceof xt)n.target=n.target||e;else{var o=n;L(n=new xt(i,e),o)}if(o=!0,r)for(var a=r.length-1;0<=a;a--){var s=n.b=r[a];o=re(s,i,!0,n)&&o}if(o=re(s=n.b=e,i,!0,n)&&o,o=re(s,i,!1,n)&&o,r)for(a=0;a<r.length;a++)o=re(s=n.b=r[a],i,!1,n)&&o}function ee(t,e,n,r,i){jt(t.u,String(e),n,!1,r,i)}function ne(t,e,n,r,i){jt(t.u,String(e),n,!0,r,i)}function re(t,e,n,r){if(!(e=t.u.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.ma&&a.capture==n){var s=a.listener,u=a.La||a.src;a.Ha&&Bt(t.u,a),i=!1!==s.call(u,r)&&i}}return i&&0!=r.Bb}function ie(t,e,n){if(u(t))n&&(t=f(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=f(t.handleEvent,t)}return 2147483647<Number(e)?-1:xa.setTimeout(t,e||0)}function oe(t){var e=null;return new X(function(n,r){-1==(e=ie(function(){n(void 0)},t))&&r(Error("Failed to schedule timer."))}).s(function(t){throw xa.clearTimeout(e),t})}function ae(t,e,n,r,i){this.reset(t,e,n,r,i)}function se(t){this.f=t,this.b=this.c=this.a=null}function ue(t,e){this.name=t,this.value=e}function ce(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t){t instanceof ce?(n=t.S(),r=t.P()):(n=P(t),r=k(t));for(var i=0;i<n.length;i++)this.set(n[i],r[i])}}function le(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];he(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)he(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function he(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function fe(t,e){t&&t.log(Qs,e,void 0)}function pe(t){var e="";return function(t,e){function n(e){for(;r<t.length;){var n=t.charAt(r++),i=$s[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return e}!function(){if(!Js){Js={},$s={};for(var t=0;65>t;t++)Js[t]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(t),$s[Js[t]]=t,62<=t&&($s["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(t)]=t)}}();for(var r=0;;){var i=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===i)break;e(i<<2|o>>4),64!=a&&(e(o<<4&240|a>>2),64!=s&&e(a<<6&192|s))}}(t,function(t){e+=String.fromCharCode(t)}),e}function de(t,e){this.g=[],this.v=t,this.o=e||null,this.f=this.a=!1,this.c=void 0,this.u=this.w=this.i=!1,this.h=0,this.b=null,this.l=0}function ve(t,e,n){t.a=!0,t.c=n,t.f=!e,_e(t)}function ge(t){if(t.a){if(!t.u)throw new be;t.u=!1}}function ye(t,e,n,r){t.g.push([e,n,r]),t.a&&_e(t)}function me(t){return Ya(t.g,function(t){return u(t[1])})}function _e(t){if(t.h&&t.a&&me(t)){var e=t.h,n=tu[e];n&&(xa.clearTimeout(n.a),delete tu[e]),t.h=0}t.b&&(t.b.l--,delete t.b),e=t.c;for(var r=n=!1;t.g.length&&!t.i;){var i=t.g.shift(),o=i[0],a=i[1];if(i=i[2],o=t.f?a:o)try{var s=o.call(i||t.o,e);void 0!==s&&(t.f=t.f&&(s==e||s instanceof Error),t.c=e=s),(V(e)||"function"==typeof xa.Promise&&e instanceof xa.Promise)&&(r=!0,t.i=!0)}catch(r){e=r,t.f=!0,me(t)||(n=!0)}}t.c=e,r&&(s=f(t.m,t,!0),r=f(t.m,t,!1),e instanceof de?(ye(e,s,r),e.w=!0):e.then(s,r)),n&&(e=new we(e),tu[e.a]=e,t.h=e.a)}function be(){v.call(this)}function Ee(){v.call(this)}function we(t){this.a=xa.setTimeout(f(this.c,this),0),this.b=t}function Se(t,e){this.b=-1,this.b=eu,this.f=xa.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=t,this.h=e,this.l=xa.Int32Array?new Int32Array(64):Array(64),Zs||(Zs=xa.Int32Array?new Int32Array(au):au),this.reset()}function Te(t){for(var e=t.f,n=t.l,r=0,i=0;i<e.length;)n[r++]=e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3],i=4*r;for(e=16;64>e;e++){i=0|n[e-15],r=0|n[e-2];var o=(0|n[e-16])+((i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3)|0,a=(0|n[e-7])+((r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10)|0;n[e]=o+a|0}r=0|t.a[0],i=0|t.a[1];var s=0|t.a[2],u=0|t.a[3],c=0|t.a[4],l=0|t.a[5],h=0|t.a[6];for(o=0|t.a[7],e=0;64>e;e++){var f=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&i^r&s^i&s)|0;a=(o=o+((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))|0)+((a=(a=c&l^~c&h)+(0|Zs[e])|0)+(0|n[e])|0)|0,o=h,h=l,l=c,c=u+a|0,u=s,s=i,i=r,r=a+f|0}t.a[0]=t.a[0]+r|0,t.a[1]=t.a[1]+i|0,t.a[2]=t.a[2]+s|0,t.a[3]=t.a[3]+u|0,t.a[4]=t.a[4]+c|0,t.a[5]=t.a[5]+l|0,t.a[6]=t.a[6]+h|0,t.a[7]=t.a[7]+o|0}function Ie(e,n,r){void 0===r&&(r=n.length);var i=0,o=e.c;if(t(n))for(;i<r;)e.f[o++]=n.charCodeAt(i++),o==e.b&&(Te(e),o=0);else{if(!s(n))throw Error("message must be string or array");for(;i<r;){var a=n[i++];if(!("number"==typeof a&&0<=a&&255>=a&&a==(0|a)))throw Error("message must be a byte array");e.f[o++]=a,o==e.b&&(Te(e),o=0)}}e.c=o,e.g+=r}function Ae(){Se.call(this,8,su)}function Oe(e){if(e.P&&"function"==typeof e.P)return e.P();if(t(e))return e.split("");if(s(e)){for(var n=[],r=e.length,i=0;i<r;i++)n.push(e[i]);return n}return k(e)}function Ce(e){if(e.S&&"function"==typeof e.S)return e.S();if(!e.P||"function"!=typeof e.P){if(s(e)||t(e)){var n=[];e=e.length;for(var r=0;r<e;r++)n.push(r);return n}return P(e)}}function Re(e,n){if(e.forEach&&"function"==typeof e.forEach)e.forEach(n,void 0);else if(s(e)||t(e))Qa(e,n,void 0);else for(var r=Ce(e),i=Oe(e),o=i.length,a=0;a<o;a++)n.call(void 0,i[a],r&&r[a],e)}function Ne(t,e){if(this.b=this.l=this.c="",this.i=null,this.h=this.g="",this.f=!1,t instanceof Ne){this.f=void 0!==e?e:t.f,ke(this,t.c),this.l=t.l,this.b=t.b,Pe(this,t.i),this.g=t.g,e=t.a;var n=new Ve;n.c=e.c,e.a&&(n.a=new ce(e.a),n.b=e.b),De(this,n),this.h=t.h}else t&&(n=String(t).match(uu))?(this.f=!!e,ke(this,n[1]||"",!0),this.l=Ue(n[2]||""),this.b=Ue(n[3]||"",!0),Pe(this,n[4]),this.g=Ue(n[5]||"",!0),De(this,n[6]||"",!0),this.h=Ue(n[7]||"")):(this.f=!!e,this.a=new Ve(null,0,this.f))}function ke(t,e,n){t.c=n?Ue(e,!0):e,t.c&&(t.c=t.c.replace(/:$/,""))}function Pe(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.i=e}else t.i=null}function De(t,e,n){e instanceof Ve?(t.a=e,function(t,e){e&&!t.f&&(We(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(Ge(this,e),ze(this,n,t))},t)),t.f=e}(t.a,t.f)):(n||(e=je(e,pu)),t.a=new Ve(e,0,t.f))}function xe(t,e,n){t.a.set(e,n)}function Me(t,e){return t.a.get(e)}function Le(t){return t instanceof Ne?new Ne(t):new Ne(t,void 0)}function Fe(t,e){var n=new Ne(null,void 0);return ke(n,"https"),t&&(n.b=t),e&&(n.g=e),n}function Ue(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function je(e,n,r){return t(e)?(e=encodeURI(e).replace(n,Be),r&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Be(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}function Ve(t,e,n){this.b=this.a=null,this.c=t||null,this.f=!!n}function We(t){t.a||(t.a=new ce,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,function(e,n){He(t,decodeURIComponent(e.replace(/\+/g," ")),n)}))}function qe(t){var e=Ce(t);if(void 0===e)throw Error("Keys are undefined");var n=new Ve(null,0,void 0);t=Oe(t);for(var r=0;r<e.length;r++){var i=e[r],o=t[r];a(o)?ze(n,i,o):He(n,i,o)}return n}function He(t,e,n){We(t),t.c=null,e=Qe(t,e);var r=t.a.get(e);r||t.a.set(e,r=[]),r.push(n),t.b+=1}function Ge(t,e){We(t),e=Qe(t,e),he(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,he((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&le(t)))}function Ke(t,e){return We(t),e=Qe(t,e),he(t.a.b,e)}function ze(t,e,n){Ge(t,e),0<n.length&&(t.c=null,t.a.set(Qe(t,e),C(n)),t.b+=n.length)}function Qe(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function Xe(){}function Ye(){}function Je(t){if(!t.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<e.length;n++){var r=e[n];try{return new ActiveXObject(r),t.f=r}catch(t){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return t.f}function $e(t){Zt.call(this),this.headers=new ce,this.w=t||null,this.b=!1,this.v=this.a=null,this.g=this.I=this.i="",this.c=this.G=this.h=this.A=!1,this.f=0,this.m=null,this.l=vu,this.o=this.N=!1}function Ze(t,e,n,r,i){if(t.a)throw Error("[goog.net.XhrIo] Object is active with another request="+t.i+"; newUri="+e);n=n?n.toUpperCase():"GET",t.i=e,t.g="",t.I=n,t.A=!1,t.b=!0,t.a=t.w?t.w.a():cu.a(),t.v=function(t){return t.c||(t.c=t.b())}(t.w?t.w:cu),t.a.onreadystatechange=f(t.Ab,t);try{fe(t.J,cn(t,"Opening Xhr")),t.G=!0,t.a.open(n,String(e),!0),t.G=!1}catch(e){return fe(t.J,cn(t,"Error opening Xhr: "+e.message)),void en(t,e)}e=r||"";var o=new ce(t.headers);i&&Re(i,function(t,e){o.set(e,t)}),i=S(o.S()),r=xa.FormData&&e instanceof xa.FormData,!T(_u,n)||i||r||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},t),t.l&&(t.a.responseType=t.l),"withCredentials"in t.a&&t.a.withCredentials!==t.N&&(t.a.withCredentials=t.N);try{an(t),0<t.f&&(t.o=function(t){return ns&&j(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(t.a),fe(t.J,cn(t,"Will abort after "+t.f+"ms if incomplete, xhr2 "+t.o)),t.o?(t.a.timeout=t.f,t.a.ontimeout=f(t.Ea,t)):t.m=ie(t.Ea,t.f,t)),fe(t.J,cn(t,"Sending request")),t.h=!0,t.a.send(e),t.h=!1}catch(e){fe(t.J,cn(t,"Send error: "+e.message)),en(t,e)}}function tn(t){return"content-type"==t.toLowerCase()}function en(t,e){t.b=!1,t.a&&(t.c=!0,t.a.abort(),t.c=!1),t.g=e,nn(t),on(t)}function nn(t){t.A||(t.A=!0,te(t,"complete"),te(t,"error"))}function rn(t){if(t.b&&void 0!==Da)if(t.v[1]&&4==sn(t)&&2==un(t))fe(t.J,cn(t,"Local request error detected and ignored"));else if(t.h&&4==sn(t))ie(t.Ab,0,t);else if(te(t,"readystatechange"),4==sn(t)){fe(t.J,cn(t,"Request complete")),t.b=!1;try{var e,n=un(t);t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.i).match(uu)[1]||null;if(!o&&xa.self&&xa.self.location){var a=xa.self.location.protocol;o=a.substr(0,a.length-1)}i=!mu.test(o?o.toLowerCase():"")}e=i}if(e)te(t,"complete"),te(t,"success");else{try{var s=2<sn(t)?t.a.statusText:""}catch(n){fe(t.J,"Can not get status: "+n.message),s=""}t.g=s+" ["+un(t)+"]",nn(t)}}finally{on(t)}}}function on(t,e){if(t.a){an(t);var n=t.a,i=t.v[0]?r:null;t.a=null,t.v=null,e||te(t,"ready");try{n.onreadystatechange=i}catch(e){(t=t.J)&&t.log(Ks,"Problem encountered resetting onreadystatechange: "+e.message,void 0)}}}function an(t){t.a&&t.o&&(t.a.ontimeout=null),"number"==typeof t.m&&(xa.clearTimeout(t.m),t.m=null)}function sn(t){return t.a?t.a.readyState:0}function un(t){try{return 2<sn(t)?t.a.status:-1}catch(t){return-1}}function cn(t,e){return e+" ["+t.I+" "+t.i+" "+un(t)+"]"}function ln(t){var e={},n=e.document||document,r=vt(t),i=document.createElement("SCRIPT"),o={Cb:i,Ea:void 0},a=new de(hn,o),s=null,u=null!=e.timeout?e.timeout:5e3;return 0<u&&(s=window.setTimeout(function(){fn(i,!0);var t=new pn(wu,"Timeout reached for loading script "+r);ge(a),ve(a,!1,t)},u),o.Ea=s),i.onload=i.onreadystatechange=function(){i.readyState&&"loaded"!=i.readyState&&"complete"!=i.readyState||(fn(i,e.Sc||!1,s),a.A(null))},i.onerror=function(){fn(i,!0,s);var t=new pn(Eu,"Error while loading script "+r);ge(a),ve(a,!1,t)},L(o=e.attributes||{},{type:"text/javascript",charset:"UTF-8"}),It(i,o),i.src=vt(t),function(t){var e;return(e=(t||document).getElementsByTagName("HEAD"))&&0!=e.length?e[0]:t.documentElement}(n).appendChild(i),a}function hn(){if(this&&this.Cb){var t=this.Cb;t&&"SCRIPT"==t.tagName&&fn(t,!0,this.Ea)}}function fn(t,e,n){null!=n&&xa.clearTimeout(n),t.onload=r,t.onerror=r,t.onreadystatechange=r,e&&window.setTimeout(function(){t&&t.parentNode&&t.parentNode.removeChild(t)},0)}function pn(t,e){var n="Jsloader error (code #"+t+")";e&&(n+=": "+e),v.call(this,n),this.code=t}function dn(){}function vn(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseText="",this.status=-1,this.statusText=this.responseXML=null,this.a.onload=f(this.Wb,this),this.a.onerror=f(this.xb,this),this.a.onprogress=f(this.Xb,this),this.a.ontimeout=f(this.Yb,this)}function gn(t,e){t.readyState=e,t.onreadystatechange&&t.onreadystatechange()}function yn(){var t=Nn();return ns&&!!ls&&11==ls||/Edge\/\d+/.test(t)}function mn(){return xa.window&&xa.window.location.href||""}function _n(t,e){e=e||xa.window;var n="about:blank";t&&(n=mt(_t(t))),e.location.href=n}function bn(t){return!!((t=(t||Nn()).toLowerCase()).match(/android/)||t.match(/webos/)||t.match(/iphone|ipad|ipod/)||t.match(/blackberry/)||t.match(/windows phone/)||t.match(/iemobile/))}function En(t){t=t||xa.window;try{t.close()}catch(t){}}function wn(t,e,n){var r=Math.floor(1e9*Math.random()).toString();e=e||500,n=n||600;var i=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-e)/2;for(a in e={width:e,height:n,top:0<i?i:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=Nn().toLowerCase(),r&&(e.target=r,m(n,"crios/")&&(e.target="_blank")),Cn(Nn())==Tu&&(t=t||"http://localhost",e.scrollbars=!0),n=t||"",(r=e)||(r={}),t=window,e=n instanceof yt?n:_t(void 0!==n.href?n.href:String(n)),n=r.target||n.target,i=[],r)switch(a){case"width":case"height":case"top":case"left":i.push(a+"="+r[a]);break;case"target":case"noreferrer":break;default:i.push(a+"="+(r[a]?1:0))}var a=i.join(",");if((R("iPhone")&&!R("iPod")&&!R("iPad")||R("iPad")||R("iPod"))&&t.navigator&&t.navigator.standalone&&n&&"_self"!=n?(a=t.document.createElement("A"),e instanceof yt||e instanceof yt||(e=e.la?e.ja():String(e),Cs.test(e)||(e="about:invalid#zClosurez"),e=bt(e)),a.href=mt(e),a.setAttribute("target",n),r.noreferrer&&a.setAttribute("rel","noreferrer"),(r=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,t,1),a.dispatchEvent(r),a={}):r.noreferrer?(a=t.open("",n,a),t=mt(e),a&&(is&&m(t,";")&&(t="'"+t.replace(/'/g,"%27")+"'"),a.opener=null,pt("b/12014412, meta tag with sanitized URL"),t=St(t='<META HTTP-EQUIV="refresh" content="0; url='+y(t)+'">'),a.document.write(wt(t)),a.document.close())):a=t.open(mt(e),n,a),a)try{a.focus()}catch(t){}return a}function Sn(){var t=null;return new X(function(e){"complete"==xa.document.readyState?e():(t=function(){e()},Ht(window,"load",t))}).s(function(e){throw Gt(window,"load",t),e})}function Tn(t){return t=t||Nn(),!("file:"!==Mn()||!t.toLowerCase().match(/iphone|ipad|ipod|android/))}function In(){var t=xa.window;try{return!(!t||t==t.top)}catch(t){return!1}}function An(){return Pa.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":Pa.INTERNAL.hasOwnProperty("node")?"Node":"Browser"}function On(){var t=An();return"ReactNative"===t||"Node"===t}function Cn(t){var e=t.toLowerCase();return m(e,"opera/")||m(e,"opr/")||m(e,"opios/")?"Opera":m(e,"iemobile")?"IEMobile":m(e,"msie")||m(e,"trident/")?"IE":m(e,"edge/")?"Edge":m(e,"firefox/")?Tu:m(e,"silk/")?"Silk":m(e,"blackberry")?"Blackberry":m(e,"webos")?"Webos":!m(e,"safari/")||m(e,"chrome/")||m(e,"crios/")||m(e,"android")?!m(e,"chrome/")&&!m(e,"crios/")||m(e,"edge/")?m(e,"android")?"Android":(t=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==t.length?t[1]:"Other":Iu:"Safari"}function Rn(t,e){e=e||[];var n,r=[],i={};for(n in Au)i[Au[n]]=!0;for(n=0;n<e.length;n++)void 0!==i[e[n]]&&(delete i[e[n]],r.push(e[n]));return r.sort(),(e=r).length||(e=["FirebaseCore-web"]),i="",(i="Browser"===(r=An())?Cn(Nn()):r)+"/JsCore/"+t+"/"+e.join(",")}function Nn(){return xa.navigator&&xa.navigator.userAgent||""}function kn(t,e){t=t.split("."),e=e||xa;for(var n=0;n<t.length&&"object"==typeof e&&null!=e;n++)e=e[t[n]];return n!=t.length&&(e=void 0),e}function Pn(){try{var t=xa.localStorage,e=Bn();if(t)return t.setItem(e,"1"),t.removeItem(e),!yn()||!!xa.indexedDB}catch(t){}return!1}function Dn(){return(xn()||"chrome-extension:"===Mn()||Tn())&&!On()&&Pn()}function xn(){return"http:"===Mn()||"https:"===Mn()}function Mn(){return xa.location&&xa.location.protocol||null}function Ln(t){return!bn(t=t||Nn())&&Cn(t)!=Tu}function Fn(t){return void 0===t?null:Rt(t)}function Un(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&null!==t[e]&&void 0!==t[e]&&(n[e]=t[e]);return n}function jn(t){if(null!==t)return JSON.parse(t)}function Bn(t){return t||""+Math.floor(1e9*Math.random()).toString()}function Vn(t){return"Safari"!=Cn(t=t||Nn())&&!t.toLowerCase().match(/iphone|ipad|ipod/)}function Wn(){var t=xa.___jsl;if(t&&t.H)for(var e in t.H)if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=t.H[e].L.concat(),t.CP)for(var n=0;n<t.CP.length;n++)t.CP[n]=null}function qn(){var t=xa.navigator;return!t||"boolean"!=typeof t.onLine||!xn()&&"chrome-extension:"!==Mn()&&void 0===t.connection||t.onLine}function Hn(t,e,n,r){if(t>e)throw Error("Short delay should be less than long delay!");this.c=t,this.b=e,t=n||Nn(),r=r||An(),this.a=bn(t)||"ReactNative"===r}function Gn(){var t=xa.document;return!t||void 0===t.visibilityState||"visible"==t.visibilityState}function Kn(t){try{var e=new Date(parseInt(t,10));if(!isNaN(e.getTime())&&!/[^0-9]/.test(t))return e.toUTCString()}catch(t){}return null}function zn(t,e,n){Ou?Object.defineProperty(t,e,{configurable:!0,enumerable:!0,value:n}):t[e]=n}function Qn(t,e){if(e)for(var n in e)e.hasOwnProperty(n)&&zn(t,n,e[n])}function Xn(t){var e={};return Qn(e,t),e}function Yn(t){var e=t;if("object"==typeof t&&null!=t)for(var n in e="length"in t?[]:{},t)zn(e,n,Yn(t[n]));return e}function Jn(t){var e={},n=t[Nu],r=t[ku];if(t=t[Pu],!n||!t)throw Error("Invalid provider user info!");e[xu]=r||null,e[Du]=n,zn(this,Lu,t),zn(this,Mu,Yn(e))}function $n(t,e){this.code=Fu+t,this.message=e||Uu[t]||""}function Zn(t){var e=t&&t.code;return e?new $n(e.substring(Fu.length),t.message):null}function tr(t){var e=t[Wu];if(void 0===e)throw new $n("missing-continue-uri");if("string"!=typeof e||"string"==typeof e&&!e.length)throw new $n("invalid-continue-uri");this.h=e,this.c=this.a=null,this.g=!1;var n=t[ju];if(n&&"object"==typeof n){e=n[Gu];var r=n[qu];if(n=n[Hu],"string"==typeof e&&e.length){if(this.a=e,void 0!==r&&"boolean"!=typeof r)throw new $n("argument-error",qu+" property must be a boolean when specified.");if(this.g=!!r,void 0!==n&&("string"!=typeof n||"string"==typeof n&&!n.length))throw new $n("argument-error",Hu+" property must be a non empty string when specified.");this.c=n||null}else{if(void 0!==e)throw new $n("argument-error",Gu+" property must be a non empty string when specified.");if(void 0!==r||void 0!==n)throw new $n("missing-android-pkg-name")}}else if(void 0!==n)throw new $n("argument-error",ju+" property must be a non null object when specified.");if(this.b=null,(e=t[Vu])&&"object"==typeof e){if("string"==typeof(e=e[Ku])&&e.length)this.b=e;else if(void 0!==e)throw new $n("argument-error",Ku+" property must be a non empty string when specified.")}else if(void 0!==e)throw new $n("argument-error",Vu+" property must be a non null object when specified.");if(void 0!==(t=t[Bu])&&"boolean"!=typeof t)throw new $n("argument-error",Bu+" property must be a boolean when specified.");if((this.f=!!t)&&!this.b&&!this.a)throw new $n("argument-error",Bu+" property can't be true when no mobile application is provided.")}function er(t){var e={};for(var n in e.continueUrl=t.h,e.canHandleCodeInApp=t.f,(e.androidPackageName=t.a)&&(e.androidMinimumVersion=t.c,e.androidInstallApp=t.g),e.iOSBundleId=t.b,e)null===e[n]&&delete e[n];return e}function nr(t){this.b=t.sub,Fa(),this.a=t.provider_id||t.firebase&&t.firebase.sign_in_provider||null}function rr(t){if(3!=(t=t.split(".")).length)return null;for(var e=(4-(t=t[1]).length%4)%4,n=0;n<e;n++)t+=".";try{var r=JSON.parse(pe(t));if(r.sub&&r.iss&&r.aud&&r.exp)return new nr(r)}catch(t){}return null}function ir(t){for(var e in Xu)if(Xu[e].Na==t)return Xu[e];return null}function or(t){var e={};e["facebook.com"]=ur,e["google.com"]=lr,e["github.com"]=cr,e["twitter.com"]=hr;var n=t&&t[Ju];try{if(n)return e[n]?new e[n](t):new sr(t);if(void 0!==t[Yu])return new ar(t)}catch(t){}return null}function ar(t){var e=t[Ju];if(!e&&t[Yu]){var n=rr(t[Yu]);n&&n.a&&(e=n.a)}if(!e)throw Error("Invalid additional user info!");"anonymous"!=e&&"custom"!=e||(e=null),n=!1,void 0!==t.isNewUser?n=!!t.isNewUser:"identitytoolkit#SignupNewUserResponse"===t.kind&&(n=!0),zn(this,"providerId",e),zn(this,"isNewUser",n)}function sr(t){ar.call(this,t),zn(this,"profile",Yn((t=jn(t.rawUserInfo||"{}"))||{}))}function ur(t){if(sr.call(this,t),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function cr(t){if(sr.call(this,t),"github.com"!=this.providerId)throw Error("Invalid provider ID!");zn(this,"username",this.profile&&this.profile.login||null)}function lr(t){if(sr.call(this,t),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function hr(t){if(sr.call(this,t),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");zn(this,"username",t.screenName||null)}function fr(t,e){return t.then(function(t){if(t[tc]){var n=rr(t[tc]);if(!n||e!=n.b)throw new $n("user-mismatch");return t}throw new $n("user-mismatch")}).s(function(t){throw t&&t.code&&t.code==Fu+"user-not-found"?new $n("user-mismatch"):t})}function pr(t,e){if(e.idToken||e.accessToken)e.idToken&&zn(this,"idToken",e.idToken),e.accessToken&&zn(this,"accessToken",e.accessToken);else{if(!e.oauthToken||!e.oauthTokenSecret)throw new $n("internal-error","failed to construct a credential");zn(this,"accessToken",e.oauthToken),zn(this,"secret",e.oauthTokenSecret)}zn(this,"providerId",t)}function dr(t){var e={};return t.idToken&&(e.id_token=t.idToken),t.accessToken&&(e.access_token=t.accessToken),t.secret&&(e.oauth_token_secret=t.secret),e.providerId=t.providerId,{postBody:qe(e).toString(),requestUri:"http://localhost"}}function vr(t,e){this.rc=e||[],Qn(this,{providerId:t,isOAuthProvider:!0}),this.rb={},this.Wa=(ir(t)||{}).Ma||null,this.Ua=null}function gr(t){vr.call(this,t,Qu),this.a=[]}function yr(){gr.call(this,"facebook.com")}function mr(t){if(!t)throw new $n("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return c(t)&&(e=t.accessToken),(new yr).credential(null,e)}function _r(){gr.call(this,"github.com")}function br(t){if(!t)throw new $n("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return c(t)&&(e=t.accessToken),(new _r).credential(null,e)}function Er(){gr.call(this,"google.com"),this.sa("profile")}function wr(t,e){var n=t;return c(t)&&(n=t.idToken,e=t.accessToken),(new Er).credential(n,e)}function Sr(){vr.call(this,"twitter.com",zu)}function Tr(t,e){var n=t;if(c(n)||(n={oauthToken:t,oauthTokenSecret:e}),!n.oauthToken||!n.oauthTokenSecret)throw new $n("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new pr("twitter.com",n)}function Ir(t,e){this.a=t,this.f=e,zn(this,"providerId","password")}function Ar(){Qn(this,{providerId:"password",isOAuthProvider:!1})}function Or(t){if(!(t.Pa&&t.Oa||t.Da&&t.Y))throw new $n("internal-error");this.a=t,zn(this,"providerId","phone")}function Cr(t){return t.a.Da&&t.a.Y?{temporaryProof:t.a.Da,phoneNumber:t.a.Y}:{sessionInfo:t.a.Pa,code:t.a.Oa}}function Rr(t){try{this.a=t||Pa.auth()}catch(t){throw new $n("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}Qn(this,{providerId:"phone",isOAuthProvider:!1})}function Nr(t,e){if(!t)throw new $n("missing-verification-id");if(!e)throw new $n("missing-verification-code");return new Or({Pa:t,Oa:e})}function kr(t){if(t.temporaryProof&&t.phoneNumber)return new Or({Da:t.temporaryProof,Y:t.phoneNumber});var e=t&&t.providerId;if(!e||"password"===e)return null;var n=t&&t.oauthAccessToken,r=t&&t.oauthTokenSecret;t=t&&t.oauthIdToken;try{switch(e){case"google.com":return wr(t,n);case"facebook.com":return mr(n);case"github.com":return br(n);case"twitter.com":return Tr(n,r);default:return new gr(e).credential(t,n)}}catch(t){return null}}function Pr(t){if(!t.isOAuthProvider)throw new $n("invalid-oauth-provider")}function Dr(t,e,n,r,i){if(this.b=t,this.c=e||null,this.f=n||null,this.g=r||null,this.a=i||null,!this.f&&!this.a)throw new $n("invalid-auth-event");if(this.f&&this.a)throw new $n("invalid-auth-event");if(this.f&&!this.g)throw new $n("invalid-auth-event")}function xr(t){return(t=t||{}).type?new Dr(t.type,t.eventId,t.urlResponse,t.sessionId,t.error&&Zn(t.error)):null}function Mr(){this.b=null,this.a=[]}function Lr(t){var e="unauthorized-domain",n=void 0,r=Le(t);t=r.b,"chrome-extension"==(r=r.c)?n=g("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):"http"==r||"https"==r?n=g("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):e="operation-not-supported-in-this-environment",$n.call(this,e,n)}function Fr(t,e,n){$n.call(this,t,n),(t=e||{}).sb&&zn(this,"email",t.sb),t.Y&&zn(this,"phoneNumber",t.Y),t.credential&&zn(this,"credential",t.credential)}function Ur(t){if(t.code){var e=t.code||"";0==e.indexOf(Fu)&&(e=e.substring(Fu.length));var n={credential:kr(t)};if(t.email)n.sb=t.email;else{if(!t.phoneNumber)return new $n(e,t.message||void 0);n.Y=t.phoneNumber}return new Fr(e,n,t.message)}return null}function jr(t){this.f=t}function Br(t,e,n){var r="Node"==An();if(!(r=xa.XMLHttpRequest||r&&Pa.INTERNAL.node&&Pa.INTERNAL.node.XMLHttpRequest))throw new $n("internal-error","The XMLHttpRequest compatibility library was not found.");this.b=t,t=e||{},this.i=t.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.l=t.secureTokenTimeout||ec,this.c=M(t.secureTokenHeaders||nc),this.g=t.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.h=t.firebaseTimeout||rc,this.a=M(t.firebaseHeaders||ic),n&&(this.a["X-Client-Version"]=n,this.c["X-Client-Version"]=n),this.f=new dn,this.o=new jr(r)}function Vr(t,e){e?t.a["X-Firebase-Locale"]=e:delete t.a["X-Firebase-Locale"]}function Wr(t,e){e?(t.a["X-Client-Version"]=e,t.c["X-Client-Version"]=e):(delete t.a["X-Client-Version"],delete t.c["X-Client-Version"])}function qr(t,e,n,r,i,o,a){qn()?(function(){var t=Nn();return!((t=Cn(t)!=Iu?null:(t=t.match(/\sChrome\/(\d+)/i))&&2==t.length?parseInt(t[1],10):null)&&30>t||ns&&ls&&!(9<ls))}()?t=f(t.m,t):(Zu||(Zu=new X(function(t,e){!function(t,e){((window.gapi||{}).client||{}).request?t():(xa[ac]=function(){((window.gapi||{}).client||{}).request?t():e(Error("CORS_UNSUPPORTED"))},function(t,e){ye(t,null,e,void 0)}(ln(gt(oc,{onload:ac})),function(){e(Error("CORS_UNSUPPORTED"))}))}(t,e)})),t=f(t.u,t)),t(e,n,r,i,o,a)):n&&n(null)}function Hr(t){if(!bu.test(t.email))throw new $n("invalid-email")}function Gr(t){"email"in t&&Hr(t)}function Kr(t){if(!t[tc])throw new $n("internal-error")}function zr(t){if(t.phoneNumber||t.temporaryProof){if(!t.phoneNumber||!t.temporaryProof)throw new $n("internal-error")}else{if(!t.sessionInfo)throw new $n("missing-verification-id");if(!t.code)throw new $n("missing-verification-code")}}function Qr(t){if(!t.requestUri||!t.sessionId&&!t.postBody)throw new $n("internal-error")}function Xr(t){var e=null;if(t.needConfirmation?(t.code="account-exists-with-different-credential",e=Ur(t)):"FEDERATED_USER_ID_ALREADY_LINKED"==t.errorMessage?(t.code="credential-already-in-use",e=Ur(t)):"EMAIL_EXISTS"==t.errorMessage?(t.code="email-already-in-use",e=Ur(t)):t.errorMessage&&(e=ei(t.errorMessage)),e)throw e;if(!t[tc])throw new $n("internal-error")}function Yr(t,e){return e.returnIdpCredential=!0,ti(t,Ic,e)}function Jr(t,e){return e.returnIdpCredential=!0,ti(t,Oc,e)}function $r(t,e){return e.returnIdpCredential=!0,e.autoCreate=!1,ti(t,Ac,e)}function Zr(t){if(!t.oobCode)throw new $n("invalid-action-code")}function ti(t,e,n){if(!function(t,e){if(!e||!e.length)return!0;if(!t)return!1;for(var n=0;n<e.length;n++){var r=t[e[n]];if(null==r||""===r)return!1}return!0}(n,e.ea))return Z(new $n("internal-error"));var r,i=e.zb||"POST";return $(n).then(e.D).then(function(){return e.T&&(n.returnSecureToken=!0),function(t,e,n,r,i,o){var a=Le(t.g+e);xe(a,"key",t.b),o&&xe(a,"cb",Fa().toString());var s="GET"==n;if(s)for(var u in r)r.hasOwnProperty(u)&&xe(a,u,r[u]);return new X(function(e,o){qr(t,a.toString(),function(t){t?t.error?o(ni(t,i||{})):e(t):o(new $n("network-request-failed"))},n,s?void 0:Rt(Un(r)),t.a,t.h.get())})}(t,e.endpoint,i,n,e.Pb,e.nb||!1)}).then(function(t){return r=t}).then(e.O).then(function(){if(!e.ga)return r;if(!(e.ga in r))throw new $n("internal-error");return r[e.ga]})}function ei(t){return ni({error:{errors:[{message:t}],code:400,message:t}})}function ni(t,e){var n=(t.error&&t.error.errors&&t.error.errors[0]||{}).reason||"",r={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=r[n]?new $n(r[n]):null)return n;for(var i in n=t.error&&t.error.message||"",L(r={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash"},e||{}),e=(e=n.match(/^[^\s]+\s*:\s*(.*)$/))&&1<e.length?e[1]:void 0,r)if(0===n.indexOf(i))return new $n(r[i],e);return!e&&t&&(e=Fn(t)),new $n("internal-error",e)}function ri(t){for(var e in Dc)if(Dc[e].id===t)return{firebaseEndpoint:(t=Dc[e]).Va,secureTokenEndpoint:t.ab};return null}function ii(t){this.b=t,this.a=null,this.Ya=function(t){return(Uc||(Uc=new X(function(t,e){if(qn()){var n=function(){Wn(),kn("gapi.load")("gapi.iframes",{callback:t,ontimeout:function(){Wn(),e(Error("Network Error"))},timeout:Lc.get()})};if(kn("gapi.iframes.Iframe"))t();else if(kn("gapi.load"))n();else{var r="__iframefcb"+Math.floor(1e6*Math.random()).toString();xa[r]=function(){kn("gapi.load")?n():e(Error("Network Error"))},$(ln(r=gt(Mc,{onload:r}))).s(function(){e(Error("Network Error"))})}}else e(Error("Network Error"))}).s(function(t){throw Uc=null,t}))).then(function(){return new X(function(e,n){kn("gapi.iframes.getContext")().open({where:document.body,url:t.b,messageHandlersFilter:kn("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},function(r){function i(){clearTimeout(o),e()}t.a=r,t.a.restyle({setHideOnLeave:!1});var o=setTimeout(function(){n(Error("Network Error"))},Fc.get());r.ping(i).then(i,function(){n(Error("Network Error"))})})})})}(this)}function oi(t,e,n){this.i=t,this.g=e,this.h=n,this.f=null,this.a=Fe(this.i,"/__/auth/iframe"),xe(this.a,"apiKey",this.g),xe(this.a,"appName",this.h),this.b=null,this.c=[]}function ai(t,e,n,r,i){this.m=t,this.u=e,this.c=n,this.l=r,this.i=this.g=this.h=null,this.a=i,this.f=null}function si(t){try{return Pa.app(t).auth().Ka()}catch(t){return[]}}function ui(t,e,n,r,i){this.u=t,this.f=e,this.b=n,this.c=r||null,this.h=i||null,this.m=this.o=this.v=null,this.g=[],this.l=this.a=null}function ci(t){var e=mn();return function(t){return ti(t,mc,{}).then(function(t){return t.authorizedDomains||[]})}(t).then(function(t){t:{var n=Le(e),r=n.c;n=n.b;for(var i=0;i<t.length;i++){var o=t[i],a=n,s=r;if(0==o.indexOf("chrome-extension://")?a=Le(o).b==a&&"chrome-extension"==s:"http"!=s&&"https"!=s?a=!1:Su.test(o)?a=a==o:(o=o.split(".").join("\\."),a=new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)),a){t=!0;break t}}t=!1}if(!t)throw new Lr(mn())})}function li(t){return t.l?t.l:(t.l=Sn().then(function(){if(!t.o){var e=t.c,n=t.h,r=si(t.b),i=new oi(t.u,t.f,t.b);i.f=e,i.b=n,i.c=C(r||[]),t.o=i.toString()}t.i=new ii(t.o),function(t){if(!t.i)throw Error("IfcHandler must be initialized!");!function(t,e){t.Ya.then(function(){t.a.register("authEvent",e,kn("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})}(t.i,function(e){var n={};if(e&&e.authEvent){var r=!1;for(e=xr(e.authEvent),n=0;n<t.g.length;n++)r=t.g[n](e)||r;return(n={}).status=r?"ACK":"ERROR",$(n)}return n.status="ERROR",$(n)})}(t)}),t.l)}function hi(t){return t.m||(t.v=t.c?Rn(t.c,si(t.b)):null,t.m=new Br(t.f,ri(t.h),t.v)),t.m}function fi(t,e,n,r,i,o,a,s,u,c){return(t=new ai(t,e,n,r,i)).h=o,t.g=a,t.i=s,t.b=M(u||null),t.f=c,t.toString()}function pi(t){var e={type:"webStorageSupport"};return li(t).then(function(){return function(t,e){return t.Ya.then(function(){return new X(function(n){t.a.send(e.type,e,n,kn("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})})}(t.i,e)}).then(function(t){if(t&&t.length&&void 0!==t[0].webStorageSupport)return t[0].webStorageSupport;throw Error()})}function di(t){if(this.a=t||Pa.INTERNAL.reactNative&&Pa.INTERNAL.reactNative.AsyncStorage,!this.a)throw new $n("internal-error","The React Native compatibility library was not found.")}function vi(){this.a={}}function gi(t,e,n,r,i,o){try{var a=!!xa.indexedDB}catch(t){a=!1}if(!a)throw new $n("web-storage-unsupported");this.u=t,this.h=e,this.g=n,this.l=r,this.m=i,this.f={},this.c=[],this.a=0,this.o=o||xa.indexedDB}function yi(t){return t.i||(t.i=function(t){return new X(function(e,n){var r=t.o.open(t.u,t.m);r.onerror=function(t){n(Error(t.target.errorCode))},r.onupgradeneeded=function(e){e=e.target.result;try{e.createObjectStore(t.h,{keyPath:t.g})}catch(t){n(t)}},r.onsuccess=function(t){e(t.target.result)}})}(t)),t.i}function mi(t,e){return e.objectStore(t.h)}function _i(t,e,n){return e.transaction([t.h],n?"readwrite":"readonly")}function bi(t){return new X(function(e,n){t.onsuccess=function(t){t&&t.target?e(t.target.result):e()},t.onerror=function(t){n(Error(t.target.errorCode))}})}function Ei(){if(!function(){var t="Node"==An();if(!(t=wi()||t&&Pa.INTERNAL.node&&Pa.INTERNAL.node.localStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(t){return!1}}()){if("Node"==An())throw new $n("internal-error","The LocalStorage compatibility library was not found.");throw new $n("web-storage-unsupported")}this.a=wi()||Pa.INTERNAL.node.localStorage}function wi(){try{var t=xa.localStorage,e=Bn();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(t){return null}}function Si(){}function Ti(){if(!function(){var t="Node"==An();if(!(t=Ii()||t&&Pa.INTERNAL.node&&Pa.INTERNAL.node.sessionStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(t){return!1}}()){if("Node"==An())throw new $n("internal-error","The SessionStorage compatibility library was not found.");throw new $n("web-storage-unsupported")}this.a=Ii()||Pa.INTERNAL.node.sessionStorage}function Ii(){try{var t=xa.sessionStorage,e=Bn();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(t){return null}}function Ai(){var t={};t.Browser=Vc,t.Node=Wc,t.ReactNative=qc,this.a=t[An()]}function Oi(t,e,n,r,i){this.i=t,this.g=e,this.A=n,this.u=r,this.v=i,this.a={},jc||(jc=new Ai),t=jc;try{if(yn()){xc||(xc=new gi("firebaseLocalStorageDb","firebaseLocalStorage","fbase_key","value",1));var o=xc}else o=new t.a.C;this.l=o}catch(t){this.l=new vi,this.u=!0}try{this.o=new t.a.jb}catch(t){this.o=new vi}this.w=new vi,this.h=f(this.m,this),this.b={}}function Ci(){return Bc||(Bc=new Oi("firebase",":",!(Vn(Nn())||!In()),Ln(),Pn())),Bc}function Ri(t,e){switch(e){case"session":return t.o;case"none":return t.w;default:return t.l}}function Ni(t,e,n){return t.i+t.g+e.name+(n?t.g+n:"")}function ki(t,e,n){return n=Ni(t,e,n),"local"==e.C&&(t.b[n]=null),Ri(t,e.C).X(n)}function Pi(t,e,n,r){e=Ni(t,e,n),t.v&&(t.b[e]=xa.localStorage.getItem(e)),D(t.a)&&(Ri(t,"local").ia(t.h),t.u||yn()||!t.v||function(t){xi(t),t.f=setInterval(function(){for(var e in t.a){var n=xa.localStorage.getItem(e),r=t.b[e];n!=r&&(t.b[e]=n,n=new Mt({type:"storage",key:e,target:window,oldValue:r,newValue:n,a:!0}),t.m(n))}},1e3)}(t)),t.a[e]||(t.a[e]=[]),t.a[e].push(r)}function Di(t,e,n){e=Ni(t,Xo("local"),e),t.a[e]&&(A(t.a[e],function(t){return t==n}),0==t.a[e].length&&delete t.a[e]),D(t.a)&&function(t){Ri(t,"local").da(t.h),xi(t)}(t)}function xi(t){t.f&&(clearInterval(t.f),t.f=null)}function Mi(t){this.a=t,this.b=Ci()}function Li(){this.a=Ci()}function Fi(t,e,n,r,i,o,a){this.u=t,this.i=e,this.l=n,this.m=r||null,this.o=a||null,this.h=e+":"+n,this.A=new Li,this.g=new Mi(this.h),this.f=null,this.b=[],this.v=i||500,this.w=o||2e3,this.a=this.c=null}function Ui(t){return new $n("invalid-cordova-configuration",t)}function ji(t){var e=new Ae;Ie(e,t),t=[];var n=8*e.g;56>e.c?Ie(e,ou,56-e.c):Ie(e,ou,e.b-(e.c-56));for(var r=63;56<=r;r--)e.f[r]=255&n,n/=256;for(Te(e),r=n=0;r<e.i;r++)for(var i=24;0<=i;i-=8)t[n++]=e.a[r]>>i&255;return function(t){return Xa(t,function(t){return 1<(t=t.toString(16)).length?t:"0"+t}).join("")}(t)}function Bi(t,e,n,r){var i=function(){for(var t=20,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}(),o=new Dr(e,r,null,i,new $n("no-auth-event")),a=kn("BuildInfo.packageName",xa);if("string"!=typeof a)throw new $n("invalid-cordova-configuration");var s=kn("BuildInfo.displayName",xa),u={};if(Nn().toLowerCase().match(/iphone|ipad|ipod/))u.ibi=a;else{if(!Nn().toLowerCase().match(/android/))return Z(new $n("operation-not-supported-in-this-environment"));u.apn=a}s&&(u.appDisplayName=s),i=ji(i),u.sessionId=i;var c=fi(t.u,t.i,t.l,e,n,null,r,t.m,u,t.o);return t.ba().then(function(){var e=t.h;return t.A.a.set(Gc,o.B(),e)}).then(function(){var e=kn("cordova.plugins.browsertab.isAvailable",xa);if("function"!=typeof e)throw new $n("invalid-cordova-configuration");var n=null;e(function(e){if(e){if("function"!=typeof(n=kn("cordova.plugins.browsertab.openUrl",xa)))throw new $n("invalid-cordova-configuration");n(c)}else{if("function"!=typeof(n=kn("cordova.InAppBrowser.open",xa)))throw new $n("invalid-cordova-configuration");e=!(!(e=Nn()).match(/(iPad|iPhone|iPod).*OS 7_\d/i)&&!e.match(/(iPad|iPhone|iPod).*OS 8_\d/i)),t.a=n(c,e?"_blank":"_system","location=yes")}})})}function Vi(t,e){for(var n=0;n<t.b.length;n++)try{t.b[n](e)}catch(t){}}function Wi(t){return t.f||(t.f=t.ba().then(function(){return new X(function(e){t.ua(function n(r){return e(r),t.Ja(n),!1}),function(t){function e(e){r=!0,i&&i.cancel(),qi(t).then(function(r){var i=n;if(r&&e&&e.url){i=null;var o=e.url,a=Le(o),s=Me(a,"link"),u=Me(Le(s),"link");a=Me(a,"deep_link_id"),-1!=(o=Me(Le(a),"link")||a||u||s||o).indexOf("/__/auth/callback")&&(i=(i="object"==typeof(i=jn(Me(i=Le(o),"firebaseError")||null))?Zn(i):null)?new Dr(r.b,r.c,null,null,i):new Dr(r.b,r.c,o,r.g)),i=i||n}Vi(t,i)})}var n=new Dr("unknown",null,null,null,new $n("no-auth-event")),r=!1,i=oe(t.v).then(function(){return qi(t).then(function(){r||Vi(t,n)})}),o=xa.handleOpenURL;xa.handleOpenURL=function(t){if(0==t.toLowerCase().indexOf(kn("BuildInfo.packageName",xa).toLowerCase()+"://")&&e({url:t}),"function"==typeof o)try{o(t)}catch(t){console.error(t)}},$u||($u=new Mr),$u.subscribe(e)}(t)})})),t.f}function qi(t){var e=null;return function(t){return t.b.get(Gc,t.a).then(function(t){return xr(t)})}(t.g).then(function(n){return e=n,ki((n=t.g).b,Gc,n.a)}).then(function(){return e})}function Hi(t){this.a=t,this.b=Ci()}function Gi(t){return ki(t.b,Kc,t.a)}function Ki(t,e,n){this.v=t,this.l=e,this.u=n,this.h=[],this.f=!1,this.i=f(this.m,this),this.c=new Zi,this.o=new ro,this.g=new Hi(this.l+":"+this.u),this.b={},this.b.unknown=this.c,this.b.signInViaRedirect=this.c,this.b.linkViaRedirect=this.c,this.b.reauthViaRedirect=this.c,this.b.signInViaPopup=this.o,this.b.linkViaPopup=this.o,this.b.reauthViaPopup=this.o,this.a=zi(this.v,this.l,this.u,uc)}function zi(t,e,n,r){var i=Pa.SDK_VERSION||null;return Tn()?new Fi(t,e,n,i,void 0,void 0,r):new ui(t,e,n,i,r)}function Qi(t){t.f||(t.f=!0,t.a.ua(t.i));var e=t.a;return t.a.ba().s(function(n){throw t.a==e&&t.reset(),n})}function Xi(t){t.a.Db()&&Qi(t).s(function(e){var n=new Dr("unknown",null,null,null,new $n("operation-not-supported-in-this-environment"));Ji(e)&&t.m(n)}),t.a.yb()||to(t.c)}function Yi(t,e,n,r,i,o){return t.a.vb(e,n,r,function(){t.f||(t.f=!0,t.a.ua(t.i))},function(){t.reset()},i,o)}function Ji(t){return!(!t||"auth/cordova-not-ready"!=t.code)}function $i(t,e,n){var r=e+":"+n;return Xc[r]||(Xc[r]=new Ki(t,e,n)),Xc[r]}function Zi(){this.b=null,this.f=[],this.c=[],this.a=null,this.g=!1}function to(t){t.g||(t.g=!0,no(t,!1,null,null))}function eo(t,e){if(t.b=function(){return $(e)},t.f.length)for(var n=0;n<t.f.length;n++)t.f[n](e)}function no(t,e,n,r){e?r?function(t,e){if(t.b=function(){return Z(e)},t.c.length)for(var n=0;n<t.c.length;n++)t.c[n](e)}(t,r):eo(t,n):eo(t,{user:null}),t.f=[],t.c=[]}function ro(){}function io(t,e){this.a=e,zn(this,"verificationId",t)}function oo(t,e,n,r){return new Rr(t).Qa(e,n).then(function(t){return new io(t,r)})}function ao(t,e,n,r,i,o){if(this.h=t,this.i=e,this.g=n,this.c=r,this.f=i,this.l=!!o,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function so(t,e){uo(t),t.b=oe(function(t,e){return e?(t.a=t.c,t.g()):(e=t.a,t.a*=2,t.a>t.f&&(t.a=t.f),e)}(t,e)).then(function(){return t.l?$():function(){var t=xa.document,e=null;return Gn()||!t?$():new X(function(n){e=function(){Gn()&&(t.removeEventListener("visibilitychange",e,!1),n())},t.addEventListener("visibilitychange",e,!1)}).s(function(n){throw t.removeEventListener("visibilitychange",e,!1),n})}()}).then(function(){return t.h()}).then(function(){so(t,!0)}).s(function(e){t.i(e)&&so(t,!1)})}function uo(t){t.b&&(t.b.cancel(),t.b=null)}function co(t){this.f=t,this.b=this.a=null,this.c=0}function lo(t,e){var n=e[tc],r=e.refreshToken;e=ho(e.expiresIn),t.b=n,t.c=e,t.a=r}function ho(t){return Fa()+1e3*parseInt(t,10)}function fo(t,e){return function(t,e){return new X(function(n,r){"refresh_token"==e.grant_type&&e.refresh_token||"authorization_code"==e.grant_type&&e.code?qr(t,t.i+"?key="+encodeURIComponent(t.b),function(t){t?t.error?r(ni(t)):t.access_token&&t.refresh_token?n(t):r(new $n("internal-error")):r(new $n("network-request-failed"))},"POST",qe(e).toString(),t.c,t.l.get()):r(new $n("internal-error"))})}(t.f,e).then(function(e){return t.b=e.access_token,t.c=ho(e.expires_in),t.a=e.refresh_token,{accessToken:t.b,expirationTime:t.c,refreshToken:t.a}}).s(function(e){throw"auth/user-token-expired"==e.code&&(t.a=null),e})}function po(t,e){this.a=t||null,this.b=e||null,Qn(this,{lastSignInTime:Kn(e||null),creationTime:Kn(t||null)})}function vo(t,e,n,r,i,o){Qn(this,{uid:t,displayName:r||null,photoURL:i||null,email:n||null,phoneNumber:o||null,providerId:e})}function go(t,e){for(var n in xt.call(this,t),e)this[n]=e[n]}function yo(t,e,n){this.A=[],this.G=t.apiKey,this.o=t.appName,this.w=t.authDomain||null,t=Pa.SDK_VERSION?Rn(Pa.SDK_VERSION):null,this.c=new Br(this.G,ri(uc),t),this.h=new co(this.c),To(this,e[tc]),lo(this.h,e),zn(this,"refreshToken",this.h.a),Oo(this,n||{}),Zt.call(this),this.I=!1,this.w&&Dn()&&(this.a=$i(this.w,this.G,this.o)),this.N=[],this.i=null,this.l=function(t){return new ao(function(){return t.F(!0)},function(t){return!(!t||"auth/network-request-failed"!=t.code)},function(){var e=t.h.c-Fa()-3e5;return 0<e?e:0},3e4,96e4,!1)}(this),this.U=f(this.Ga,this);var r=this;this.ha=null,this.ra=function(t){r.na(t.h)},this.W=null,this.R=[],this.qa=function(t){_o(r,t.f)},this.V=null}function mo(t,e){t.W&&Gt(t.W,"languageCodeChanged",t.ra),(t.W=e)&&Wt(e,"languageCodeChanged",t.ra)}function _o(t,e){t.R=e,Wr(t.c,Pa.SDK_VERSION?Rn(Pa.SDK_VERSION,t.R):null)}function bo(t,e){t.V&&Gt(t.V,"frameworkChanged",t.qa),(t.V=e)&&Wt(e,"frameworkChanged",t.qa)}function Eo(t){try{return Pa.app(t.o).auth()}catch(e){throw new $n("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+t.o+"'!")}}function wo(t){t.m||t.l.b||(t.l.start(),Gt(t,"tokenChanged",t.U),Wt(t,"tokenChanged",t.U))}function So(t){Gt(t,"tokenChanged",t.U),uo(t.l)}function To(t,e){t.pa=e,zn(t,"_lat",e)}function Io(t){for(var e=[],n=0;n<t.N.length;n++)e.push(t.N[n](t));return function(t){return new X(function(e){var n=t.length,r=[];if(n)for(var i=function(t,i,o){n--,r[t]=i?{Ub:!0,value:o}:{Ub:!1,reason:o},0==n&&e(r)},o=0;o<t.length;o++)tt(t[o],p(i,o,!0),p(i,o,!1));else e(r)})}(e).then(function(){return t})}function Ao(t){t.a&&!t.I&&(t.I=!0,t.a.subscribe(t))}function Oo(t,e){Qn(t,{uid:e.uid,displayName:e.displayName||null,photoURL:e.photoURL||null,email:e.email||null,emailVerified:e.emailVerified||!1,phoneNumber:e.phoneNumber||null,isAnonymous:e.isAnonymous||!1,metadata:new po(e.createdAt,e.lastLoginAt),providerData:[]})}function Co(){}function Ro(t){return $().then(function(){if(t.m)throw new $n("app-deleted")})}function No(t){return Xa(t.providerData,function(t){return t.providerId})}function ko(t,e){e&&(Po(t,e.providerId),t.providerData.push(e))}function Po(t,e){A(t.providerData,function(t){return t.providerId==e})}function Do(t,e,n){("uid"!=e||n)&&t.hasOwnProperty(e)&&zn(t,e,n)}function xo(t,e){t!=e&&(Qn(t,{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL,email:e.email,emailVerified:e.emailVerified,phoneNumber:e.phoneNumber,isAnonymous:e.isAnonymous,providerData:[]}),e.metadata?zn(t,"metadata",function(t){return new po(t.a,t.b)}(e.metadata)):zn(t,"metadata",new po),Qa(e.providerData,function(e){ko(t,e)}),t.h=e.h,zn(t,"refreshToken",t.h.a))}function Mo(t){return t.F().then(function(e){var n=t.isAnonymous;return function(t,e){return ti(t.c,vc,{idToken:e}).then(f(t.kc,t))}(t,e).then(function(){return n||Do(t,"isAnonymous",!1),e})})}function Lo(t,e){e[tc]&&t.pa!=e[tc]&&(lo(t.h,e),te(t,new go("tokenChanged")),To(t,e[tc]),Do(t,"refreshToken",t.h.a))}function Fo(t,e){return Mo(t).then(function(){if(T(No(t),e))return Io(t).then(function(){throw new $n("provider-already-linked")})})}function Uo(t,e,n){return Xn({user:t,credential:kr(e),additionalUserInfo:e=or(e),operationType:n})}function jo(t,e){return Lo(t,e),t.reload().then(function(){return t})}function Bo(t,e,n,r,i){if(!Dn())return Z(new $n("operation-not-supported-in-this-environment"));if(t.i&&!i)return Z(t.i);var o=ir(n.providerId),a=Bn(t.uid+":::"),s=null;(!Ln()||In())&&t.w&&n.isOAuthProvider&&(s=fi(t.w,t.G,t.o,e,n,null,a,Pa.SDK_VERSION||null));var u=wn(s,o&&o.za,o&&o.ya);return r=r().then(function(){if(Wo(t),!i)return t.F().then(function(){})}).then(function(){return Yi(t.a,u,e,n,a,!!s)}).then(function(){return new X(function(n,r){t.fa(e,null,new $n("cancelled-popup-request"),t.g||null),t.f=n,t.v=r,t.g=a,t.b=t.a.Ca(t,e,u,a)})}).then(function(t){return u&&En(u),t?Xn(t):null}).s(function(t){throw u&&En(u),t}),qo(t,r,i)}function Vo(t,e,n,r,i){if(!Dn())return Z(new $n("operation-not-supported-in-this-environment"));if(t.i&&!i)return Z(t.i);var o=null,a=Bn(t.uid+":::");return r=r().then(function(){if(Wo(t),!i)return t.F().then(function(){})}).then(function(){return t.Z=a,Io(t)}).then(function(e){return t.ca&&(e=(e=t.ca).b.set(Yc,t.B(),e.a)),e}).then(function(){return t.a.Aa(e,n,a)}).s(function(e){if(o=e,t.ca)return Ko(t.ca);throw o}).then(function(){if(o)throw o}),qo(t,r,i)}function Wo(t){if(!t.a||!t.I){if(t.a&&!t.I)throw new $n("internal-error");throw new $n("auth-domain-config-required")}}function qo(t,e,n){var r=function(t,e,n){return t.i&&!n?(e.cancel(),Z(t.i)):e.s(function(e){throw!e||"auth/user-disabled"!=e.code&&"auth/user-token-expired"!=e.code||(t.i||te(t,new go("userInvalidated")),t.i=e),e})}(t,e,n);return t.A.push(r),et(r,function(){I(t.A,r)}),r}function Ho(t){if(!t.apiKey)return null;var e={apiKey:t.apiKey,authDomain:t.authDomain,appName:t.appName},n={};if(!(t.stsTokenManager&&t.stsTokenManager.accessToken&&t.stsTokenManager.expirationTime))return null;n[tc]=t.stsTokenManager.accessToken,n.refreshToken=t.stsTokenManager.refreshToken||null,n.expiresIn=(t.stsTokenManager.expirationTime-Fa())/1e3;var r=new yo(e,n,t);return t.providerData&&Qa(t.providerData,function(t){t&&ko(r,Xn(t))}),t.redirectEventId&&(r.Z=t.redirectEventId),r}function Go(t){this.a=t,this.b=Ci()}function Ko(t){return ki(t.b,Yc,t.a)}function zo(t,e){this.a=t,this.b=e||Ci(),this.c=null,this.f=function(t){var e=Xo("local"),n=Xo("session"),r=Xo("none");return t.b.get(n,t.a).then(function(i){return i?n:t.b.get(r,t.a).then(function(n){return n?r:t.b.get(e,t.a).then(function(n){return n?e:t.b.get(Jc,t.a).then(function(t){return t?Xo(t):e})})})}).then(function(e){return t.c=e,Qo(t,e.C)}).s(function(){t.c||(t.c=e)})}(this),Pi(this.b,Xo("local"),this.a,f(this.g,this))}function Qo(t,e){var n,r=[];for(n in Hc)Hc[n]!==e&&r.push(ki(t.b,Xo(Hc[n]),t.a));return r.push(ki(t.b,Jc,t.a)),function(t){return new X(function(e,n){var r=t.length,i=[];if(r)for(var o=function(t,n){r--,i[t]=n,0==r&&e(i)},a=function(t){n(t)},s=0;s<t.length;s++)tt(t[s],p(o,s),a);else e(i)})}(r)}function Xo(t){return{name:"authUser",C:t}}function Yo(t,e){return Zo(t,function(){return t.b.set(t.c,e.B(),t.a)})}function Jo(t){return Zo(t,function(){return ki(t.b,t.c,t.a)})}function $o(t,e){return Zo(t,function(){return t.b.get(t.c,t.a).then(function(t){return t&&e&&(t.authDomain=e),Ho(t||{})})})}function Zo(t,e){return t.f=t.f.then(e,e),t.f}function ta(t){if(this.l=!1,zn(this,"app",t),!sa(this).options||!sa(this).options.apiKey)throw new $n("invalid-api-key");t=Pa.SDK_VERSION?Rn(Pa.SDK_VERSION):null,this.c=new Br(sa(this).options&&sa(this).options.apiKey,ri(uc),t),this.N=[],this.m=[],this.I=[],this.Kb=Pa.INTERNAL.createSubscribe(f(this.ac,this)),this.R=void 0,this.Lb=Pa.INTERNAL.createSubscribe(f(this.bc,this)),oa(this,null),this.h=new zo(sa(this).options.apiKey+":"+sa(this).name),this.G=new Go(sa(this).options.apiKey+":"+sa(this).name),this.U=ha(this,function(t){var e=sa(t).options.authDomain,n=function(t){var e=function(t,e){return t.b.get(Yc,t.a).then(function(t){return t&&e&&(t.authDomain=e),Ho(t||{})})}(t.G,sa(t).options.authDomain).then(function(e){return(t.w=e)&&(e.ca=t.G),Ko(t.G)});return ha(t,e)}(t).then(function(){return $o(t.h,e)}).then(function(e){return e?(e.ca=t.G,t.w&&(t.w.Z||null)==(e.Z||null)?e:e.reload().then(function(){return Yo(t.h,e).then(function(){return e})}).s(function(n){return"auth/network-request-failed"==n.code?e:Jo(t.h)})):null}).then(function(e){oa(t,e||null)});return ha(t,n)}(this)),this.i=ha(this,function(t){return t.U.then(function(){return t.aa()}).s(function(){}).then(function(){if(!t.l)return t.ha()}).s(function(){}).then(function(){if(!t.l){t.W=!0;var e=t.h;Pi(e.b,Xo("local"),e.a,t.ha)}})}(this)),this.W=!1,this.ha=f(this.yc,this),this.Ga=f(this.ka,this),this.pa=f(this.Tb,this),this.qa=f(this.Zb,this),this.ra=f(this.$b,this),function(t){var e=sa(t).options.authDomain,n=sa(t).options.apiKey;e&&Dn()&&(t.Jb=t.U.then(function(){if(!t.l){if(t.a=$i(e,n,sa(t).name),t.a.subscribe(t),ua(t)&&Ao(ua(t)),t.w){Ao(t.w);var r=t.w;r.na(t.$()),mo(r,t),_o(r=t.w,t.A),bo(r,t),t.w=null}return t.a}}))}(this),this.INTERNAL={},this.INTERNAL.delete=f(this.delete,this),this.INTERNAL.logFramework=f(this.gc,this),this.o=0,Zt.call(this),function(t){Object.defineProperty(t,"lc",{get:function(){return this.$()},set:function(t){this.na(t)},enumerable:!1}),t.V=null}(this),this.A=[]}function ea(t){xt.call(this,"languageCodeChanged"),this.h=t}function na(t){xt.call(this,"frameworkChanged"),this.f=t}function ra(t){return t.Jb||Z(new $n("auth-domain-config-required"))}function ia(t,e){var n={};return n.apiKey=sa(t).options.apiKey,n.authDomain=sa(t).options.authDomain,n.appName=sa(t).name,t.U.then(function(){return function(t,e,n,r){var i=new yo(t,e);return n&&(i.ca=n),r&&_o(i,r),i.reload().then(function(){return i})}(n,e,t.G,t.Ka())}).then(function(e){return ua(t)&&e.uid==ua(t).uid?(xo(ua(t),e),t.ka(e)):(oa(t,e),Ao(e),t.ka(e))}).then(function(){la(t)})}function oa(t,e){ua(t)&&(function(t,e){A(t.N,function(t){return t==e})}(ua(t),t.Ga),Gt(ua(t),"tokenChanged",t.pa),Gt(ua(t),"userDeleted",t.qa),Gt(ua(t),"userInvalidated",t.ra),So(ua(t))),e&&(e.N.push(t.Ga),Wt(e,"tokenChanged",t.pa),Wt(e,"userDeleted",t.qa),Wt(e,"userInvalidated",t.ra),0<t.o&&wo(e)),zn(t,"currentUser",e),e&&(e.na(t.$()),mo(e,t),_o(e,t.A),bo(e,t))}function aa(t,e){var n=null,r=null;return ha(t,e.then(function(e){return n=kr(e),r=or(e),ia(t,e)}).then(function(){return Xn({user:ua(t),credential:n,additionalUserInfo:r,operationType:"signIn"})}))}function sa(t){return t.app}function ua(t){return t.currentUser}function ca(t){return ua(t)&&ua(t)._lat||null}function la(t){if(t.W){for(var e=0;e<t.m.length;e++)t.m[e]&&t.m[e](ca(t));if(t.R!==t.getUid()&&t.I.length)for(t.R=t.getUid(),e=0;e<t.I.length;e++)t.I[e]&&t.I[e](ca(t))}}function ha(t,e){return t.N.push(e),et(e,function(){I(t.N,e)}),e}function fa(t,e,n,r){t:{n=Array.prototype.slice.call(n);for(var i=0,o=!1,a=0;a<e.length;a++)if(e[a].optional)o=!0;else{if(o)throw new $n("internal-error","Argument validator encountered a required argument after an optional argument.");i++}if(o=e.length,n.length<i||o<n.length)r="Expected "+(i==o?1==i?"1 argument":i+" arguments":i+"-"+o+" arguments")+" but got "+n.length+".";else{for(i=0;i<n.length;i++)if(o=e[i].optional&&void 0===n[i],!e[i].M(n[i])&&!o){if(e=e[i],0>i||i>=$c.length)throw new $n("internal-error","Argument validator received an unsupported number of arguments.");n=$c[i],r=(r?"":n+" argument ")+(e.name?'"'+e.name+'" ':"")+"must be "+e.K+".";break t}r=null}}if(r)throw new $n("argument-error",t+" failed: "+r)}function pa(e,n){return{name:e||"",K:"a valid string",optional:!!n,M:t}}function da(){return{name:"opt_forceRefresh",K:"a boolean",optional:!0,M:e}}function va(t,e){return{name:t||"",K:"a valid object",optional:!!e,M:c}}function ga(t,e){return{name:t||"",K:"a function",optional:!!e,M:u}}function ya(t,e){return{name:t||"",K:"null",optional:!!e,M:o}}function ma(t){return{name:t?t+"Credential":"credential",K:t?"a valid "+t+" credential":"a valid credential",optional:!1,M:function(e){if(!e)return!1;var n=!t||e.providerId===t;return!(!e.wa||!n)}}}function _a(){return{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(e){return!!(e&&t(e.type)&&u(e.verify))}}}function ba(t,e,n,r){return{name:n||"",K:t.K+" or "+e.K,optional:!!r,M:function(n){return t.M(n)||e.M(n)}}}function Ea(t,e,n,r,i,o){if(zn(this,"type","recaptcha"),this.b=this.c=null,this.m=!1,this.l=e,this.a=n||{theme:"light",type:"image"},this.g=[],this.a[el])throw new $n("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.h="invisible"===this.a[nl],!Tt(e)||!this.h&&Tt(e).hasChildNodes())throw new $n("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.u=new Br(t,o||null,i||null),this.o=r||function(){return null};var a=this;this.i=[];var s=this.a[Zc];this.a[Zc]=function(t){if(wa(a,t),"function"==typeof s)s(t);else if("string"==typeof s){var e=kn(s,xa);"function"==typeof e&&e(t)}};var u=this.a[tl];this.a[tl]=function(){if(wa(a,null),"function"==typeof u)u();else if("string"==typeof u){var t=kn(u,xa);"function"==typeof t&&t()}}}function wa(t,e){for(var n=0;n<t.i.length;n++)try{t.i[n](e)}catch(t){}}function Sa(t,e){return t.g.push(e),et(e,function(){I(t.g,e)}),e}function Ta(t){if(t.m)throw new $n("internal-error","RecaptchaVerifier instance has been destroyed.")}function Ia(){this.b=xa.grecaptcha?1/0:0,this.c=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}function Aa(){return il||(il=new Ia),il}function Oa(t,e,n){try{this.f=n||Pa.app()}catch(t){throw new $n("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.f.options||!this.f.options.apiKey)throw new $n("invalid-api-key");n=this.f.options.apiKey;var r=this,i=null;try{i=this.f.auth().Ka()}catch(t){}i=Pa.SDK_VERSION?Rn(Pa.SDK_VERSION,i):null,Ea.call(this,n,t,e,function(){try{var t=r.f.auth().$()}catch(e){t=null}return t},i,ri(uc))}function Ca(t,e){for(var n in e){var r=e[n].name;t[r]=Na(r,t[n],e[n].j)}}function Ra(t,e,n,r){t[e]=Na(e,n,r)}function Na(t,e,n){function r(){var t=Array.prototype.slice.call(arguments);return fa(o,n,t),e.apply(this,t)}if(!n)return e;var i,o=function(t){return(t=t.split("."))[t.length-1]}(t);for(i in e)r[i]=e[i];for(i in e.prototype)r.prototype[i]=e.prototype[i];return r}var ka,Pa=n(16).default,Da=Da||{},xa=this,Ma="closure_uid_"+(1e9*Math.random()>>>0),La=0,Fa=Date.now||function(){return+new Date};d(v,Error),v.prototype.name="CustomError";var Ua=String.prototype.trim?function(t){return t.trim()}:function(t){return t.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},ja=/&/g,Ba=/</g,Va=/>/g,Wa=/"/g,qa=/'/g,Ha=/\x00/g,Ga=/[\x00&<>"']/;d(b,v),b.prototype.name="AssertionError";var Ka,za=Array.prototype.indexOf?function(t,e,n){return Array.prototype.indexOf.call(t,e,n)}:function(e,n,r){if(r=null==r?0:0>r?Math.max(0,e.length+r):r,t(e))return t(n)&&1==n.length?e.indexOf(n,r):-1;for(;r<e.length;r++)if(r in e&&e[r]===n)return r;return-1},Qa=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(e,n,r){for(var i=e.length,o=t(e)?e.split(""):e,a=0;a<i;a++)a in o&&n.call(r,o[a],a,e)},Xa=Array.prototype.map?function(t,e,n){return Array.prototype.map.call(t,e,n)}:function(e,n,r){for(var i=e.length,o=Array(i),a=t(e)?e.split(""):e,s=0;s<i;s++)s in a&&(o[s]=n.call(r,a[s],s,e));return o},Ya=Array.prototype.some?function(t,e,n){return Array.prototype.some.call(t,e,n)}:function(e,n,r){for(var i=e.length,o=t(e)?e.split(""):e,a=0;a<i;a++)if(a in o&&n.call(r,o[a],a,e))return!0;return!1};t:{var Ja=xa.navigator;if(Ja){var $a=Ja.userAgent;if($a){Ka=$a;break t}}Ka=""}var Za="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");F[" "]=r;var ts,es=R("Opera"),ns=R("Trident")||R("MSIE"),rs=R("Edge"),is=rs||ns,os=R("Gecko")&&!(m(Ka.toLowerCase(),"webkit")&&!R("Edge"))&&!(R("Trident")||R("MSIE"))&&!R("Edge"),as=m(Ka.toLowerCase(),"webkit")&&!R("Edge");t:{var ss="",us=function(){var t=Ka;return os?/rv\:([^\);]+)(\)|;)/.exec(t):rs?/Edge\/([\d\.]+)/.exec(t):ns?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):as?/WebKit\/(\S+)/.exec(t):es?/(?:Version)[ \/]?(\S+)/.exec(t):void 0}();if(us&&(ss=us?us[1]:""),ns){var cs=U();if(null!=cs&&cs>parseFloat(ss)){ts=String(cs);break t}}ts=ss}var ls,hs={},fs=xa.document;ls=fs&&ns?U()||("CSS1Compat"==fs.compatMode?parseInt(ts,10):5):void 0,W.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var ps=new W(function(){return new G},function(t){t.reset()},100);G.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},G.prototype.reset=function(){this.next=this.b=this.a=null};var ds,vs,gs=!1,ys=new function(){this.b=this.a=null},ms=0,_s=2,bs=3;Y.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var Es=new W(function(){return new Y},function(t){t.reset()},100);X.prototype.then=function(t,e,n){return rt(this,u(t)?t:null,u(e)?e:null,n)},B(X),(ka=X.prototype).s=function(t,e){return rt(this,null,t,e)},ka.cancel=function(t){this.a==ms&&z(function(){!function t(e,n){if(e.a==ms)if(e.c){var r=e.c;if(r.b){for(var i=0,o=null,a=null,s=r.b;s&&(s.c||(i++,s.a==e&&(o=s),!(o&&1<i)));s=s.next)o||(a=s);o&&(r.a==ms&&1==i?t(r,n):(a?((i=a).next==r.f&&(r.f=i),i.next=i.next.next):st(r),ut(r,o,bs,n)))}e.c=null}else it(e,bs,n)}(this,new lt(t))},this)},ka.Ac=function(t){this.a=ms,it(this,_s,t)},ka.Bc=function(t){this.a=ms,it(this,bs,t)},ka.Qb=function(){for(var t;t=st(this);)ut(this,t,this.a,this.i);this.h=!1};var ws=K;d(lt,v),lt.prototype.name="cancel";var Ss=!ns||9<=Number(ls);ht.prototype.la=!0,ht.prototype.ja=function(){return this.a},ht.prototype.toString=function(){return"Const{"+this.a+"}"};var Ts={};pt(""),dt.prototype.la=!0,dt.prototype.ja=function(){return this.a},dt.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var Is=/%{(\w+)}/g,As=/^(?:https:)?\/\/[0-9a-z.:[\]-]+\/|^\/[^\/\\]|^about:blank(#|$)/i,Os={};yt.prototype.la=!0,yt.prototype.ja=function(){return this.a},yt.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var Cs=/^(?:(?:https?|mailto|ftp):|[^:\/?#]*(?:[\/?#]|$))/i,Rs={};bt("about:blank"),Et.prototype.la=!0,Et.prototype.ja=function(){return this.a},Et.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var Ns={};St("<!DOCTYPE html>"),St(""),St("<br>");var ks={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"},Ps={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},Ds=/\uffff/.test("￿")?/[\\\"\x00-\x1f\x7f-\uffff]/g:/[\\\"\x00-\x1f\x7f-\xff]/g,xs=0,Ms={};Pt.prototype.oa=!1,Pt.prototype.ta=function(){if(this.Fa)for(;this.Fa.length;)this.Fa.shift()()};var Ls=Object.freeze||function(t){return t},Fs=!ns||9<=Number(ls),Us=ns&&!j("9"),js=function(){if(!xa.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});return xa.addEventListener("test",r,e),xa.removeEventListener("test",r,e),t}();xt.prototype.c=function(){this.Bb=!1},d(Mt,xt);var Bs=Ls({2:"touch",3:"pen",4:"mouse"});Mt.prototype.c=function(){Mt.ib.c.call(this);var t=this.a;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Us)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}},Mt.prototype.g=function(){return this.a};var Vs="closure_listenable_"+(1e6*Math.random()|0),Ws=0,qs="closure_lm_"+(1e6*Math.random()|0),Hs={},Gs="__closure_events_fn_"+(1e9*Math.random()>>>0);d(Zt,Pt),Zt.prototype[Vs]=!0,Zt.prototype.removeEventListener=function(t,e,n,r){Gt(this,t,e,n,r)},Zt.prototype.ta=function(){if(Zt.ib.ta.call(this),this.u){var t,e=this.u;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)0,Ft(n[r]);delete e.a[t],e.b--}}this.Ra=null},ae.prototype.a=null;ae.prototype.reset=function(t,e,n,r,i){"number"==typeof i||0,r||Fa(),this.b=e,delete this.a},ue.prototype.toString=function(){return this.name};var Ks=new ue("SEVERE",1e3),zs=new ue("CONFIG",700),Qs=new ue("FINE",500);se.prototype.log=function(t,e,n){if(t.value>=function t(e){return e.c?e.c:e.a?t(e.a):(E("Root logger has no level set."),null)}(this).value)for(u(e)&&(e=e()),t=new ae(t,String(e),this.f),n&&(t.a=n),n="log:"+t.b,(t=xa.console)&&t.timeStamp&&t.timeStamp(n),(t=xa.msWriteProfilerMark)&&t(n),n=this;n;)n=n.a};var Xs={},Ys=null;(ka=ce.prototype).P=function(){le(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},ka.S=function(){return le(this),this.a.concat()},ka.clear=function(){this.b={},this.c=this.a.length=0},ka.get=function(t,e){return he(this.b,t)?this.b[t]:e},ka.set=function(t,e){he(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},ka.forEach=function(t,e){for(var n=this.S(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Js=null,$s=null;de.prototype.cancel=function(t){if(this.a)this.c instanceof de&&this.c.cancel();else{if(this.b){var e=this.b;delete this.b,t?e.cancel(t):0>=--e.l&&e.cancel()}this.v?this.v.call(this.o,this):this.u=!0,this.a||(t=new Ee,ge(this),ve(this,!1,t))}},de.prototype.m=function(t,e){this.i=!1,ve(this,t,e)},de.prototype.A=function(t){ge(this),ve(this,!0,t)},de.prototype.then=function(t,e,n){var r,i,o=new X(function(t,e){r=t,i=e});return ye(this,r,function(t){t instanceof Ee?o.cancel():i(t)}),o.then(t,e,n)},B(de),d(be,v),be.prototype.message="Deferred has already fired",be.prototype.name="AlreadyCalledError",d(Ee,v),Ee.prototype.message="Deferred was canceled",Ee.prototype.name="CanceledError",we.prototype.c=function(){throw delete tu[this.a],this.b};var Zs,tu={};d(Se,function(){this.b=-1});for(var eu=64,nu=eu-1,ru=[],iu=0;iu<nu;iu++)ru[iu]=0;var ou=O(128,ru);Se.prototype.reset=function(){this.g=this.c=0,this.a=xa.Int32Array?new Int32Array(this.h):C(this.h)};var au=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];d(Ae,Se);var su=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],uu=/^(?:([^:\/?#.]+):)?(?:\/\/(?:([^\/?#]*)@)?([^\/#?]*?)(?::([0-9]+))?(?=[\/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;Ne.prototype.toString=function(){var t=[],e=this.c;e&&t.push(je(e,lu,!0),":");var n=this.b;return(n||"file"==e)&&(t.push("//"),(e=this.l)&&t.push(je(e,lu,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.i)&&t.push(":",String(n))),(n=this.g)&&(this.b&&"/"!=n.charAt(0)&&t.push("/"),t.push(je(n,"/"==n.charAt(0)?fu:hu,!0))),(n=this.a.toString())&&t.push("?",n),(n=this.h)&&t.push("#",je(n,du)),t.join("")};var cu,lu=/[#\/\?@]/g,hu=/[\#\?:]/g,fu=/[\#\?]/g,pu=/[\#\?@]/g,du=/#/g;(ka=Ve.prototype).clear=function(){this.a=this.c=null,this.b=0},ka.forEach=function(t,e){We(this),this.a.forEach(function(n,r){Qa(n,function(n){t.call(e,n,r,this)},this)},this)},ka.S=function(){We(this);for(var t=this.a.P(),e=this.a.S(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},ka.P=function(e){We(this);var n=[];if(t(e))Ke(this,e)&&(n=O(n,this.a.get(Qe(this,e))));else{e=this.a.P();for(var r=0;r<e.length;r++)n=O(n,e[r])}return n},ka.set=function(t,e){return We(this),this.c=null,Ke(this,t=Qe(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},ka.get=function(t,e){return 0<(t=t?this.P(t):[]).length?String(t[0]):e},ka.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.S(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.P(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),t.push(a)}}return this.c=t.join("&")},Xe.prototype.c=null,d(Ye,Xe),Ye.prototype.a=function(){var t=Je(this);return t?new ActiveXObject(t):new XMLHttpRequest},Ye.prototype.b=function(){var t={};return Je(this)&&(t[0]=!0,t[1]=!0),t},cu=new Ye,d($e,Zt);var vu="",gu=$e.prototype,yu=function t(e){var n;if(Ys||(Ys=new se(""),Xs[""]=Ys,Ys.c=zs),!(n=Xs[e])){n=new se(e);var r=e.lastIndexOf("."),i=e.substr(r+1);(r=t(e.substr(0,r))).b||(r.b={}),r.b[i]=n,n.a=r,Xs[e]=n}return n}("goog.net.XhrIo");gu.J=yu;var mu=/^https?$/i,_u=["POST","PUT"];(ka=$e.prototype).Ea=function(){void 0!==Da&&this.a&&(this.g="Timed out after "+this.f+"ms, aborting",fe(this.J,cn(this,this.g)),te(this,"timeout"),this.abort(8))},ka.abort=function(){this.a&&this.b&&(fe(this.J,cn(this,"Aborting")),this.b=!1,this.c=!0,this.a.abort(),this.c=!1,te(this,"complete"),te(this,"abort"),on(this))},ka.ta=function(){this.a&&(this.b&&(this.b=!1,this.c=!0,this.a.abort(),this.c=!1),on(this,!0)),$e.ib.ta.call(this)},ka.Ab=function(){this.oa||(this.G||this.h||this.c?rn(this):this.jc())},ka.jc=function(){rn(this)},ka.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.l){case vu:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var t=this.J;return t&&t.log(Ks,"Response type "+this.l+" is not supported on this browser",void 0),null}catch(t){return fe(this.J,"Can not get response: "+t.message),null}};var bu=/^[+a-zA-Z0-9_.!#$%&'*\/=?^`{|}~-]+@([a-zA-Z0-9-]+\.)+[a-zA-Z0-9]{2,63}$/,Eu=0,wu=1;d(pn,v),d(dn,Xe),dn.prototype.a=function(){var t=new XMLHttpRequest;if("withCredentials"in t)return t;if("undefined"!=typeof XDomainRequest)return new vn;throw Error("Unsupported browser")},dn.prototype.b=function(){return{}},(ka=vn.prototype).open=function(t,e,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(t,e)},ka.send=function(t){if(t){if("string"!=typeof t)throw Error("Only string data is supported");this.a.send(t)}else this.a.send()},ka.abort=function(){this.a.abort()},ka.setRequestHeader=function(){},ka.getResponseHeader=function(t){return"content-type"==t.toLowerCase()?this.a.contentType:""},ka.Wb=function(){this.status=200,this.responseText=this.a.responseText,gn(this,4)},ka.xb=function(){this.status=500,this.responseText="",gn(this,4)},ka.Yb=function(){this.xb()},ka.Xb=function(){this.status=200,gn(this,1)},ka.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType};var Su=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Tu="Firefox",Iu="Chrome",Au={Gc:"FirebaseCore-web",Ic:"FirebaseUI-web"};Hn.prototype.get=function(){return this.a?this.b:this.c};var Ou,Cu={};try{var Ru={};Object.defineProperty(Ru,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(Ru,"abcd",{configurable:!0,enumerable:!0,value:2}),Ou=2==Ru.abcd}catch(t){Ou=!1}var Nu="email",ku="newEmail",Pu="requestType",Du="email",xu="fromEmail",Mu="data",Lu="operation";d($n,Error),$n.prototype.B=function(){return{code:this.code,message:this.message}},$n.prototype.toJSON=function(){return this.B()};var Fu="auth/",Uu={"argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"The user's credential is no longer valid. The user must sign in again.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","user-cancelled":"User did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."},ju="android",Bu="handleCodeInApp",Vu="iOS",Wu="url",qu="installApp",Hu="minimumVersion",Gu="packageName",Ku="bundleId",zu="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),Qu=["client_id","response_type","scope","redirect_uri","state"],Xu={Hc:{Ma:"locale",za:500,ya:600,Na:"facebook.com",$a:Qu},Jc:{Ma:null,za:500,ya:620,Na:"github.com",$a:Qu},Kc:{Ma:"hl",za:515,ya:680,Na:"google.com",$a:Qu},Qc:{Ma:"lang",za:485,ya:705,Na:"twitter.com",$a:zu}},Yu="idToken",Ju="providerId";d(sr,ar),d(ur,sr),d(cr,sr),d(lr,sr),d(hr,sr),pr.prototype.wa=function(t){return Yr(t,dr(this))},pr.prototype.b=function(t,e){var n=dr(this);return n.idToken=e,Jr(t,n)},pr.prototype.c=function(t,e){return fr($r(t,dr(this)),e)},pr.prototype.B=function(){var t={providerId:this.providerId};return this.idToken&&(t.oauthIdToken=this.idToken),this.accessToken&&(t.oauthAccessToken=this.accessToken),this.secret&&(t.oauthTokenSecret=this.secret),t},vr.prototype.Ba=function(t){return this.rb=M(t),this},d(gr,vr),gr.prototype.sa=function(t){return T(this.a,t)||this.a.push(t),this},gr.prototype.wb=function(){return C(this.a)},gr.prototype.credential=function(t,e){if(!t&&!e)throw new $n("argument-error","credential failed: must provide the ID token and/or the access token.");return new pr(this.providerId,{idToken:t||null,accessToken:e||null})},d(yr,gr),zn(yr,"PROVIDER_ID","facebook.com"),d(_r,gr),zn(_r,"PROVIDER_ID","github.com"),d(Er,gr),zn(Er,"PROVIDER_ID","google.com"),d(Sr,vr),zn(Sr,"PROVIDER_ID","twitter.com"),Ir.prototype.wa=function(t){return ti(t,Rc,{email:this.a,password:this.f})},Ir.prototype.b=function(t,e){return ti(t,Sc,{idToken:e,email:this.a,password:this.f})},Ir.prototype.c=function(t,e){return fr(this.wa(t),e)},Ir.prototype.B=function(){return{email:this.a,password:this.f}},Qn(Ar,{PROVIDER_ID:"password"}),Or.prototype.wa=function(t){return t.Qa(Cr(this))},Or.prototype.b=function(t,e){var n=Cr(this);return n.idToken=e,ti(t,kc,n)},Or.prototype.c=function(t,e){var n=Cr(this);return n.operation="REAUTH",fr(t=ti(t,Pc,n),e)},Or.prototype.B=function(){var t={providerId:"phone"};return this.a.Pa&&(t.verificationId=this.a.Pa),this.a.Oa&&(t.verificationCode=this.a.Oa),this.a.Da&&(t.temporaryProof=this.a.Da),this.a.Y&&(t.phoneNumber=this.a.Y),t},Rr.prototype.Qa=function(e,n){var r=this.a.c;return $(n.verify()).then(function(i){if(!t(i))throw new $n("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(n.type){case"recaptcha":return function(t,e){return ti(t,Ec,e)}(r,{phoneNumber:e,recaptchaToken:i}).then(function(t){return"function"==typeof n.reset&&n.reset(),t},function(t){throw"function"==typeof n.reset&&n.reset(),t});default:throw new $n("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}})},Qn(Rr,{PROVIDER_ID:"phone"}),Dr.prototype.B=function(){return{type:this.b,eventId:this.c,urlResponse:this.f,sessionId:this.g,error:this.a&&this.a.B()}};var $u=null;Mr.prototype.subscribe=function(t){var e=this;this.a.push(t),this.b||(this.b=function(t){for(var n=0;n<e.a.length;n++)e.a[n](t)},"function"==typeof(t=kn("universalLinks.subscribe",xa))&&t(null,this.b))},Mr.prototype.unsubscribe=function(t){A(this.a,function(e){return e==t})},d(Lr,$n),d(Fr,$n),Fr.prototype.B=function(){var t={code:this.code,message:this.message};this.email&&(t.email=this.email),this.phoneNumber&&(t.phoneNumber=this.phoneNumber);var e=this.credential&&this.credential.B();return e&&L(t,e),t},Fr.prototype.toJSON=function(){return this.B()},d(jr,Xe),jr.prototype.a=function(){return new this.f},jr.prototype.b=function(){return{}};var Zu,tc="idToken",ec=new Hn(3e4,6e4),nc={"Content-Type":"application/x-www-form-urlencoded"},rc=new Hn(3e4,6e4),ic={"Content-Type":"application/json"};Br.prototype.m=function(t,e,n,r,i,o){var a="Node"==An(),s=On()?a?new $e(this.o):new $e:new $e(this.f);if(o){s.f=Math.max(0,o);var u=setTimeout(function(){te(s,"timeout")},o)}ee(s,"complete",function(){u&&clearTimeout(u);var t=null;try{t=JSON.parse(function(t){try{return t.a?t.a.responseText:""}catch(e){return fe(t.J,"Can not get responseText: "+e.message),""}}(this))||null}catch(e){t=null}e&&e(t)}),ne(s,"ready",function(){u&&clearTimeout(u),Dt(this)}),ne(s,"timeout",function(){u&&clearTimeout(u),Dt(this),e&&e(null)}),Ze(s,t,n,r,i)};var oc=pt("https://apis.google.com/js/client.js?onload=%{onload}"),ac="__fcb"+Math.floor(1e6*Math.random()).toString();Br.prototype.u=function(t,e,n,r,i){var o=this;Zu.then(function(){window.gapi.client.setApiKey(o.b);var a=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:t,method:n,body:r,headers:i,authType:"none",callback:function(t){window.gapi.auth.setToken(a),e&&e(t)}})}).s(function(t){e&&e({error:{message:t&&t.message||"CORS_UNSUPPORTED"}})})},Br.prototype.gb=function(){return ti(this,Tc,{})},Br.prototype.kb=function(t,e){return ti(this,wc,{idToken:t,email:e})},Br.prototype.lb=function(t,e){return ti(this,Sc,{idToken:t,password:e})};var sc={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};(ka=Br.prototype).mb=function(t,e){var n={idToken:t},r=[];return N(sc,function(t,i){var o=e[i];null===o?r.push(t):i in e&&(n[i]=o)}),r.length&&(n.deleteAttribute=r),ti(this,wc,n)},ka.cb=function(t,e){return L(t={requestType:"PASSWORD_RESET",email:t},e),ti(this,yc,t)},ka.bb=function(t,e){return L(t={requestType:"VERIFY_EMAIL",idToken:t},e),ti(this,gc,t)},ka.Qa=function(t){return ti(this,Nc,t)},ka.Ta=function(t,e){return ti(this,bc,{oobCode:t,newPassword:e})},ka.Ia=function(t){return ti(this,lc,{oobCode:t})},ka.Sa=function(t){return ti(this,cc,{oobCode:t})};var uc,cc={endpoint:"setAccountInfo",D:Zr,ga:"email"},lc={endpoint:"resetPassword",D:Zr,O:function(t){if(!t.email||!t.requestType)throw new $n("internal-error")}},hc={endpoint:"signupNewUser",D:function(t){if(Hr(t),!t.password)throw new $n("weak-password")},O:Kr,T:!0},fc={endpoint:"createAuthUri"},pc={endpoint:"deleteAccount",ea:["idToken"]},dc={endpoint:"setAccountInfo",ea:["idToken","deleteProvider"],D:function(t){if(!a(t.deleteProvider))throw new $n("internal-error")}},vc={endpoint:"getAccountInfo"},gc={endpoint:"getOobConfirmationCode",ea:["idToken","requestType"],D:function(t){if("VERIFY_EMAIL"!=t.requestType)throw new $n("internal-error")},ga:"email"},yc={endpoint:"getOobConfirmationCode",ea:["requestType"],D:function(t){if("PASSWORD_RESET"!=t.requestType)throw new $n("internal-error");Hr(t)},ga:"email"},mc={nb:!0,endpoint:"getProjectConfig",zb:"GET"},_c={nb:!0,endpoint:"getRecaptchaParam",zb:"GET",O:function(t){if(!t.recaptchaSiteKey)throw new $n("internal-error")}},bc={endpoint:"resetPassword",D:Zr,ga:"email"},Ec={endpoint:"sendVerificationCode",ea:["phoneNumber","recaptchaToken"],ga:"sessionInfo"},wc={endpoint:"setAccountInfo",ea:["idToken"],D:Gr,T:!0},Sc={endpoint:"setAccountInfo",ea:["idToken"],D:function(t){if(Gr(t),!t.password)throw new $n("weak-password")},O:Kr,T:!0},Tc={endpoint:"signupNewUser",O:Kr,T:!0},Ic={endpoint:"verifyAssertion",D:Qr,O:Xr,T:!0},Ac={endpoint:"verifyAssertion",D:Qr,O:function(t){if(t.errorMessage&&"USER_NOT_FOUND"==t.errorMessage)throw new $n("user-not-found");if(t.errorMessage)throw ei(t.errorMessage);if(!t[tc])throw new $n("internal-error")},T:!0},Oc={endpoint:"verifyAssertion",D:function(t){if(Qr(t),!t.idToken)throw new $n("internal-error")},O:Xr,T:!0},Cc={endpoint:"verifyCustomToken",D:function(t){if(!t.token)throw new $n("invalid-custom-token")},O:Kr,T:!0},Rc={endpoint:"verifyPassword",D:function(t){if(Hr(t),!t.password)throw new $n("wrong-password")},O:Kr,T:!0},Nc={endpoint:"verifyPhoneNumber",D:zr,O:Kr},kc={endpoint:"verifyPhoneNumber",D:function(t){if(!t.idToken)throw new $n("internal-error");zr(t)},O:function(t){if(t.temporaryProof)throw t.code="credential-already-in-use",Ur(t);Kr(t)}},Pc={Pb:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",D:zr,O:Kr},Dc={Mc:{Va:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",ab:"https://securetoken.googleapis.com/v1/token",id:"p"},Oc:{Va:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",ab:"https://staging-securetoken.sandbox.googleapis.com/v1/token",id:"s"},Pc:{Va:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",ab:"https://test-securetoken.sandbox.googleapis.com/v1/token",id:"t"}};uc=ri("__EID__")?"__EID__":void 0;var xc,Mc=pt("https://apis.google.com/js/api.js?onload=%{onload}"),Lc=new Hn(3e4,6e4),Fc=new Hn(5e3,15e3),Uc=null;oi.prototype.toString=function(){return this.f?xe(this.a,"v",this.f):Ge(this.a.a,"v"),this.b?xe(this.a,"eid",this.b):Ge(this.a.a,"eid"),this.c.length?xe(this.a,"fw",this.c.join(",")):Ge(this.a.a,"fw"),this.a.toString()},ai.prototype.toString=function(){var t=Fe(this.m,"/__/auth/handler");if(xe(t,"apiKey",this.u),xe(t,"appName",this.c),xe(t,"authType",this.l),this.a.isOAuthProvider){var e=this.a;try{var n=Pa.app(this.c).auth().$()}catch(t){n=null}for(var r in e.Ua=n,xe(t,"providerId",this.a.providerId),n=Un((e=this.a).rb))n[r]=n[r].toString();r=e.rc,n=M(n);for(var i=0;i<r.length;i++){var o=r[i];o in n&&delete n[o]}e.Wa&&e.Ua&&!n[e.Wa]&&(n[e.Wa]=e.Ua),D(n)||xe(t,"customParameters",Fn(n))}if("function"==typeof this.a.wb&&((e=this.a.wb()).length&&xe(t,"scopes",e.join(","))),this.h?xe(t,"redirectUrl",this.h):Ge(t.a,"redirectUrl"),this.g?xe(t,"eventId",this.g):Ge(t.a,"eventId"),this.i?xe(t,"v",this.i):Ge(t.a,"v"),this.b)for(var a in this.b)this.b.hasOwnProperty(a)&&!Me(t,a)&&xe(t,a,this.b[a]);return this.f?xe(t,"eid",this.f):Ge(t.a,"eid"),(a=si(this.c)).length&&xe(t,"fw",a.join(",")),t.toString()},(ka=ui.prototype).Ca=function(t,e,n){var r=new $n("popup-closed-by-user"),i=new $n("web-storage-unsupported"),o=this,a=!1;return this.ba().then(function(){pi(o).then(function(n){n||(t&&En(t),e(i),a=!0)})}).s(function(){}).then(function(){if(!a)return function(t){return new X(function(e){return function n(){oe(2e3).then(function(){if(t&&!t.closed)return n();e()})}()})}(t)}).then(function(){if(!a)return oe(n).then(function(){e(r)})})},ka.Db=function(){var t=Nn();return!Ln(t)&&!Vn(t)},ka.yb=function(){return!1},ka.vb=function(t,e,n,r,i,o,a){if(!t)return Z(new $n("popup-blocked"));if(a&&!Ln())return this.ba().s(function(e){En(t),i(e)}),r(),$();this.a||(this.a=ci(hi(this)));var s=this;return this.a.then(function(){var e=s.ba().s(function(e){throw En(t),i(e),e});return r(),e}).then(function(){Pr(n),a||_n(fi(s.u,s.f,s.b,e,n,null,o,s.c,void 0,s.h),t)}).s(function(t){throw"auth/network-request-failed"==t.code&&(s.a=null),t})},ka.Aa=function(t,e,n){this.a||(this.a=ci(hi(this)));var r=this;return this.a.then(function(){Pr(e),_n(fi(r.u,r.f,r.b,t,e,mn(),n,r.c,void 0,r.h))}).s(function(t){throw"auth/network-request-failed"==t.code&&(r.a=null),t})},ka.ba=function(){var t=this;return li(this).then(function(){return t.i.Ya}).s(function(){throw t.a=null,new $n("network-request-failed")})},ka.Hb=function(){return!0},ka.ua=function(t){this.g.push(t)},ka.Ja=function(t){A(this.g,function(e){return e==t})},(ka=di.prototype).get=function(t){return $(this.a.getItem(t)).then(function(t){return t&&jn(t)})},ka.set=function(t,e){return $(this.a.setItem(t,Fn(e)))},ka.X=function(t){return $(this.a.removeItem(t))},ka.ia=function(){},ka.da=function(){},(ka=vi.prototype).get=function(t){return $(this.a[t])},ka.set=function(t,e){return this.a[t]=e,$()},ka.X=function(t){return delete this.a[t],$()},ka.ia=function(){},ka.da=function(){},(ka=gi.prototype).set=function(t,e){var n,r=!1,i=this;return et(yi(this).then(function(e){return bi((e=mi(i,_i(i,n=e,!0))).get(t))}).then(function(o){var a=mi(i,_i(i,n,!0));return o?(o.value=e,bi(a.put(o))):(i.a++,r=!0,(o={})[i.g]=t,o[i.l]=e,bi(a.add(o)))}).then(function(){i.f[t]=e}),function(){r&&i.a--})},ka.get=function(t){var e=this;return yi(this).then(function(n){return bi(mi(e,_i(e,n,!1)).get(t))}).then(function(t){return t&&t.value})},ka.X=function(t){var e=!1,n=this;return et(yi(this).then(function(r){return e=!0,n.a++,bi(mi(n,_i(n,r,!0)).delete(t))}).then(function(){delete n.f[t]}),function(){e&&n.a--})},ka.zc=function(){var t=this;return yi(this).then(function(e){var n=mi(t,_i(t,e,!1));return n.getAll?bi(n.getAll()):new X(function(t,e){var r=[],i=n.openCursor();i.onsuccess=function(e){(e=e.target.result)?(r.push(e.value),e.continue()):t(r)},i.onerror=function(t){e(Error(t.target.errorCode))}})}).then(function(e){var n={},r=[];if(0==t.a){for(r=0;r<e.length;r++)n[e[r][t.g]]=e[r][t.l];r=function t(e,n){var r,i=[];for(r in e)r in n?typeof e[r]!=typeof n[r]?i.push(r):a(e[r])?x(e[r],n[r])||i.push(r):"object"==typeof e[r]&&null!=e[r]&&null!=n[r]?0<t(e[r],n[r]).length&&i.push(r):e[r]!==n[r]&&i.push(r):i.push(r);for(r in n)r in e||i.push(r);return i}(t.f,n),t.f=n}return r})},ka.ia=function(t){0==this.c.length&&function(t){t.b&&t.b.cancel("STOP_EVENT"),function e(){return t.b=oe(800).then(f(t.zc,t)).then(function(e){0<e.length&&Qa(t.c,function(t){t(e)})}).then(e).s(function(t){"STOP_EVENT"!=t.message&&e()}),t.b}()}(this),this.c.push(t)},ka.da=function(t){A(this.c,function(e){return e==t}),0==this.c.length&&this.b&&this.b.cancel("STOP_EVENT")},(ka=Ei.prototype).get=function(t){var e=this;return $().then(function(){return jn(e.a.getItem(t))})},ka.set=function(t,e){var n=this;return $().then(function(){var r=Fn(e);null===r?n.X(t):n.a.setItem(t,r)})},ka.X=function(t){var e=this;return $().then(function(){e.a.removeItem(t)})},ka.ia=function(t){xa.window&&Wt(xa.window,"storage",t)},ka.da=function(t){xa.window&&Gt(xa.window,"storage",t)},(ka=Si.prototype).get=function(){return $(null)},ka.set=function(){return $()},ka.X=function(){return $()},ka.ia=function(){},ka.da=function(){},(ka=Ti.prototype).get=function(t){var e=this;return $().then(function(){return jn(e.a.getItem(t))})},ka.set=function(t,e){var n=this;return $().then(function(){var r=Fn(e);null===r?n.X(t):n.a.setItem(t,r)})},ka.X=function(t){var e=this;return $().then(function(){e.a.removeItem(t)})},ka.ia=function(){},ka.da=function(){};var jc,Bc,Vc={C:Ei,jb:Ti},Wc={C:Ei,jb:Ti},qc={C:di,jb:Si},Hc={Lc:"local",NONE:"none",Nc:"session"};Oi.prototype.get=function(t,e){return Ri(this,t.C).get(Ni(this,t,e))},Oi.prototype.set=function(t,e,n){var r=Ni(this,t,n),i=this,o=Ri(this,t.C);return o.set(r,e).then(function(){return o.get(r)}).then(function(e){"local"==t.C&&(i.b[r]=e)})},Oi.prototype.m=function(t){if(t&&t.g){var e=t.a.key;if(null==e)for(var n in this.a){var r=this.b[n];void 0===r&&(r=null);var i=xa.localStorage.getItem(n);i!==r&&(this.b[n]=i,this.c(n))}else if(0==e.indexOf(this.i+this.g)&&this.a[e]){if(void 0!==t.a.a?Ri(this,"local").da(this.h):xi(this),this.A)if(n=xa.localStorage.getItem(e),(r=t.a.newValue)!==n)null!==r?xa.localStorage.setItem(e,r):xa.localStorage.removeItem(e);else if(this.b[e]===r&&void 0===t.a.a)return;var o=this;n=function(){void 0===t.a.a&&o.b[e]===xa.localStorage.getItem(e)||(o.b[e]=xa.localStorage.getItem(e),o.c(e))},ns&&ls&&10==ls&&xa.localStorage.getItem(e)!==t.a.newValue&&t.a.newValue!==t.a.oldValue?setTimeout(n,10):n()}}else Qa(t,f(this.c,this))},Oi.prototype.c=function(t){this.a[t]&&Qa(this.a[t],function(t){t()})};var Gc={name:"authEvent",C:"local"};(ka=Fi.prototype).ba=function(){return this.xa?this.xa:this.xa=(Tn(void 0)?Sn().then(function(){return new X(function(t,e){var n=xa.document,r=setTimeout(function(){e(Error("Cordova framework is not ready."))},1e3);n.addEventListener("deviceready",function(){clearTimeout(r),t()},!1)})}):Z(Error("Cordova must run in an Android or iOS file scheme."))).then(function(){if("function"!=typeof kn("universalLinks.subscribe",xa))throw Ui("cordova-universal-links-plugin is not installed");if(void 0===kn("BuildInfo.packageName",xa))throw Ui("cordova-plugin-buildinfo is not installed");if("function"!=typeof kn("cordova.plugins.browsertab.openUrl",xa))throw Ui("cordova-plugin-browsertab is not installed");if("function"!=typeof kn("cordova.InAppBrowser.open",xa))throw Ui("cordova-plugin-inappbrowser is not installed")},function(){throw new $n("cordova-not-ready")})},ka.Ca=function(t,e){return e(new $n("operation-not-supported-in-this-environment")),$()},ka.vb=function(){return Z(new $n("operation-not-supported-in-this-environment"))},ka.Hb=function(){return!1},ka.Db=function(){return!0},ka.yb=function(){return!0},ka.Aa=function(t,e,n){if(this.c)return Z(new $n("redirect-operation-pending"));var r=this,i=xa.document,o=null,a=null,s=null,u=null;return this.c=et($().then(function(){return Pr(e),Wi(r)}).then(function(){return Bi(r,t,e,n)}).then(function(){return new X(function(t,e){a=function(){var e=kn("cordova.plugins.browsertab.close",xa);return t(),"function"==typeof e&&e(),r.a&&"function"==typeof r.a.close&&(r.a.close(),r.a=null),!1},r.ua(a),s=function(){o||(o=oe(r.w).then(function(){e(new $n("redirect-cancelled-by-user"))}))},u=function(){Gn()&&s()},i.addEventListener("resume",s,!1),Nn().toLowerCase().match(/android/)||i.addEventListener("visibilitychange",u,!1)}).s(function(t){return qi(r).then(function(){throw t})})}),function(){s&&i.removeEventListener("resume",s,!1),u&&i.removeEventListener("visibilitychange",u,!1),o&&o.cancel(),a&&r.Ja(a),r.c=null})},ka.ua=function(t){this.b.push(t),Wi(this).s(function(e){"auth/invalid-cordova-configuration"===e.code&&(e=new Dr("unknown",null,null,null,new $n("no-auth-event")),t(e))})},ka.Ja=function(t){A(this.b,function(e){return e==t})};var Kc={name:"pendingRedirect",C:"session"};Ki.prototype.reset=function(){this.f=!1,this.a.Ja(this.i),this.a=zi(this.v,this.l,this.u)},Ki.prototype.subscribe=function(t){if(T(this.h,t)||this.h.push(t),!this.f){var e=this;(function(t){return t.b.get(Kc,t.a).then(function(t){return"pending"==t})})(this.g).then(function(t){t?Gi(e.g).then(function(){Qi(e).s(function(t){var n=new Dr("unknown",null,null,null,new $n("operation-not-supported-in-this-environment"));Ji(t)&&e.m(n)})}):Xi(e)}).s(function(){Xi(e)})}},Ki.prototype.unsubscribe=function(t){A(this.h,function(e){return e==t})},Ki.prototype.m=function(t){if(!t)throw new $n("invalid-auth-event");for(var e=!1,n=0;n<this.h.length;n++){var r=this.h[n];if(r.ob(t.b,t.c)){(e=this.b[t.b])&&e.h(t,r),e=!0;break}}return to(this.c),e};var zc=new Hn(2e3,1e4),Qc=new Hn(3e4,6e4);Ki.prototype.aa=function(){return this.c.aa()},Ki.prototype.Aa=function(t,e,n){var r,i=this;return function(t){return t.b.set(Kc,"pending",t.a)}(this.g).then(function(){return i.a.Aa(t,e,n).s(function(t){if(Ji(t))throw new $n("operation-not-supported-in-this-environment");return r=t,Gi(i.g).then(function(){throw r})}).then(function(){return i.a.Hb()?new X(function(){}):Gi(i.g).then(function(){return i.aa()}).then(function(){}).s(function(){})})})},Ki.prototype.Ca=function(t,e,n,r){return this.a.Ca(n,function(n){t.fa(e,null,n,r)},zc.get())};var Xc={};Zi.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},Zi.prototype.h=function(t,e){if(!t)return Z(new $n("invalid-auth-event"));this.reset(),this.g=!0;var n=t.b,r=t.c,i=t.a&&"auth/web-storage-unsupported"==t.a.code,o=t.a&&"auth/operation-not-supported-in-this-environment"==t.a.code;return"unknown"!=n||i||o?t.a?(no(this,!0,null,t.a),t=$()):t=e.va(n,r)?function(t,e,n){n=n.va(e.b,e.c);var r=e.f,i=e.g,o=!!e.b.match(/Redirect$/);return n(r,i).then(function(e){no(t,o,e,null)}).s(function(e){no(t,o,null,e)})}(this,t,e):Z(new $n("invalid-auth-event")):(no(this,!1,null,null),t=$()),t},Zi.prototype.aa=function(){var t=this;return new X(function(e,n){t.b?t.b().then(e,n):(t.f.push(e),t.c.push(n),function(t){var e=new $n("timeout");t.a&&t.a.cancel(),t.a=oe(Qc.get()).then(function(){t.b||no(t,!0,null,e)})}(t))})},ro.prototype.h=function(t,e){if(!t)return Z(new $n("invalid-auth-event"));var n=t.b,r=t.c;return t.a?(e.fa(t.b,null,t.a,t.c),t=$()):t=e.va(n,r)?function(t,e){var n=t.c,r=t.b;return e.va(r,n)(t.f,t.g).then(function(t){e.fa(r,t,null,n)}).s(function(t){e.fa(r,null,t,n)})}(t,e):Z(new $n("invalid-auth-event")),t},io.prototype.confirm=function(t){return t=Nr(this.verificationId,t),this.a(t)},ao.prototype.start=function(){this.a=this.c,so(this,!0)},co.prototype.B=function(){return{apiKey:this.f.b,refreshToken:this.a,accessToken:this.b,expirationTime:this.c}},co.prototype.getToken=function(t){return t=!!t,this.b&&!this.a?Z(new $n("user-token-expired")):t||!this.b||Fa()>this.c-3e4?this.a?fo(this,{grant_type:"refresh_token",refresh_token:this.a}):$(null):$({accessToken:this.b,expirationTime:this.c,refreshToken:this.a})},po.prototype.B=function(){return{lastLoginAt:this.b,createdAt:this.a}},d(go,xt),d(yo,Zt),yo.prototype.na=function(t){this.ha=t,Vr(this.c,t)},yo.prototype.$=function(){return this.ha},yo.prototype.Ka=function(){return C(this.R)},yo.prototype.Ga=function(){this.l.b&&(uo(this.l),this.l.start())},zn(yo.prototype,"providerId","firebase"),(ka=yo.prototype).reload=function(){var t=this;return qo(this,Ro(this).then(function(){return Mo(t).then(function(){return Io(t)}).then(Co)}))},ka.F=function(t){var e=this;return qo(this,Ro(this).then(function(){return e.h.getToken(t)}).then(function(t){if(!t)throw new $n("internal-error");return t.accessToken!=e.pa&&(To(e,t.accessToken),te(e,new go("tokenChanged"))),Do(e,"refreshToken",t.refreshToken),t.accessToken}))},ka.getToken=function(t){return Cu["firebase.User.prototype.getToken is deprecated. Please use firebase.User.prototype.getIdToken instead."]||(Cu["firebase.User.prototype.getToken is deprecated. Please use firebase.User.prototype.getIdToken instead."]=!0,"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn("firebase.User.prototype.getToken is deprecated. Please use firebase.User.prototype.getIdToken instead.")),this.F(t)},ka.kc=function(t){if(!(t=t.users)||!t.length)throw new $n("internal-error");Oo(this,{uid:(t=t[0]).localId,displayName:t.displayName,photoURL:t.photoUrl,email:t.email,emailVerified:!!t.emailVerified,phoneNumber:t.phoneNumber,lastLoginAt:t.lastLoginAt,createdAt:t.createdAt});for(var e=function(t){return(t=t.providerUserInfo)&&t.length?Xa(t,function(t){return new vo(t.rawId,t.providerId,t.email,t.displayName,t.photoUrl,t.phoneNumber)}):[]}(t),n=0;n<e.length;n++)ko(this,e[n]);Do(this,"isAnonymous",!(this.email&&t.passwordHash||this.providerData&&this.providerData.length))},ka.Za=function(t){var e=this,n=null;return qo(this,t.c(this.c,this.uid).then(function(t){return Lo(e,t),n=Uo(e,t,"reauthenticate"),e.i=null,e.reload()}).then(function(){return n}),!0)},ka.mc=function(t){return this.Za(t).then(function(){})},ka.Xa=function(t){var e=this,n=null;return qo(this,Fo(this,t.providerId).then(function(){return e.F()}).then(function(n){return t.b(e.c,n)}).then(function(t){return n=Uo(e,t,"link"),jo(e,t)}).then(function(){return n}))},ka.cc=function(t){return this.Xa(t).then(function(t){return t.user})},ka.dc=function(t,e){var n=this;return qo(this,Fo(this,"phone").then(function(){return oo(Eo(n),t,e,f(n.Xa,n))}))},ka.nc=function(t,e){var n=this;return qo(this,$().then(function(){return oo(Eo(n),t,e,f(n.Za,n))}),!0)},ka.kb=function(t){var e=this;return qo(this,this.F().then(function(n){return e.c.kb(n,t)}).then(function(t){return Lo(e,t),e.reload()}))},ka.Dc=function(t){var e=this;return qo(this,this.F().then(function(n){return t.b(e.c,n)}).then(function(t){return Lo(e,t),e.reload()}))},ka.lb=function(t){var e=this;return qo(this,this.F().then(function(n){return e.c.lb(n,t)}).then(function(t){return Lo(e,t),e.reload()}))},ka.mb=function(t){if(void 0===t.displayName&&void 0===t.photoURL)return Ro(this);var e=this;return qo(this,this.F().then(function(n){return e.c.mb(n,{displayName:t.displayName,photoUrl:t.photoURL})}).then(function(t){return Lo(e,t),Do(e,"displayName",t.displayName||null),Do(e,"photoURL",t.photoUrl||null),Qa(e.providerData,function(t){"password"===t.providerId&&(zn(t,"displayName",e.displayName),zn(t,"photoURL",e.photoURL))}),Io(e)}).then(Co))},ka.Cc=function(t){var e=this;return qo(this,Mo(this).then(function(n){return T(No(e),t)?function(t,e,n){return ti(t,dc,{idToken:e,deleteProvider:n})}(e.c,n,[t]).then(function(t){var n={};return Qa(t.providerUserInfo||[],function(t){n[t.providerId]=!0}),Qa(No(e),function(t){n[t]||Po(e,t)}),n[Rr.PROVIDER_ID]||zn(e,"phoneNumber",null),Io(e)}):Io(e).then(function(){throw new $n("no-such-provider")})}))},ka.delete=function(){var t=this;return qo(this,this.F().then(function(e){return ti(t.c,pc,{idToken:e})}).then(function(){te(t,new go("userDeleted"))})).then(function(){for(var e=0;e<t.A.length;e++)t.A[e].cancel("app-deleted");mo(t,null),bo(t,null),t.A=[],t.m=!0,So(t),zn(t,"refreshToken",null),t.a&&t.a.unsubscribe(t)})},ka.ob=function(t,e){return!!("linkViaPopup"==t&&(this.g||null)==e&&this.f||"reauthViaPopup"==t&&(this.g||null)==e&&this.f||"linkViaRedirect"==t&&(this.Z||null)==e||"reauthViaRedirect"==t&&(this.Z||null)==e)},ka.fa=function(t,e,n,r){"linkViaPopup"!=t&&"reauthViaPopup"!=t||r!=(this.g||null)||(n&&this.v?this.v(n):e&&!n&&this.f&&this.f(e),this.b&&(this.b.cancel(),this.b=null),delete this.f,delete this.v)},ka.va=function(t,e){return"linkViaPopup"==t&&e==(this.g||null)?f(this.tb,this):"reauthViaPopup"==t&&e==(this.g||null)?f(this.ub,this):"linkViaRedirect"==t&&(this.Z||null)==e?f(this.tb,this):"reauthViaRedirect"==t&&(this.Z||null)==e?f(this.ub,this):null},ka.ec=function(t){var e=this;return Bo(this,"linkViaPopup",t,function(){return Fo(e,t.providerId).then(function(){return Io(e)})},!1)},ka.oc=function(t){return Bo(this,"reauthViaPopup",t,function(){return $()},!0)},ka.fc=function(t){var e=this;return Vo(this,"linkViaRedirect",t,function(){return Fo(e,t.providerId)},!1)},ka.pc=function(t){return Vo(this,"reauthViaRedirect",t,function(){return $()},!0)},ka.tb=function(t,e){var n=this;this.b&&(this.b.cancel(),this.b=null);var r=null;return qo(this,this.F().then(function(r){return Jr(n.c,{requestUri:t,sessionId:e,idToken:r})}).then(function(t){return r=Uo(n,t,"link"),jo(n,t)}).then(function(){return r}))},ka.ub=function(t,e){var n=this;this.b&&(this.b.cancel(),this.b=null);var r=null;return qo(this,$().then(function(){return fr($r(n.c,{requestUri:t,sessionId:e}),n.uid)}).then(function(t){return r=Uo(n,t,"reauthenticate"),Lo(n,t),n.i=null,n.reload()}).then(function(){return r}),!0)},ka.bb=function(t){var e=this,n=null;return qo(this,this.F().then(function(e){return n=e,void 0===t||D(t)?{}:er(new tr(t))}).then(function(t){return e.c.bb(n,t)}).then(function(t){if(e.email!=t)return e.reload()}).then(function(){}))},ka.toJSON=function(){return this.B()},ka.B=function(){var t={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,providerData:[],apiKey:this.G,appName:this.o,authDomain:this.w,stsTokenManager:this.h.B(),redirectEventId:this.Z||null};return this.metadata&&L(t,this.metadata.B()),Qa(this.providerData,function(e){t.providerData.push(function(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}(e))}),t};var Yc={name:"redirectUser",C:"session"};zo.prototype.g=function(){var t=this,e=Xo("local");Zo(this,function(){return $().then(function(){return t.c&&"local"!=t.c.C?t.b.get(e,t.a):null}).then(function(n){if(n)return Qo(t,"local").then(function(){t.c=e})})})};var Jc={name:"persistence",C:"session"};zo.prototype.eb=function(t){var e=null,n=this;return function(t){var e=new $n("invalid-persistence-type"),n=new $n("unsupported-persistence-type");t:{for(r in Hc)if(Hc[r]==t){var r=!0;break t}r=!1}if(!r||"string"!=typeof t)throw e;switch(An()){case"ReactNative":if("session"===t)throw n;break;case"Node":if("none"!==t)throw n;break;default:if(!Pn()&&"none"!==t)throw n}}(t),Zo(this,function(){return t!=n.c.C?n.b.get(n.c,n.a).then(function(r){return e=r,Qo(n,t)}).then(function(){if(n.c=Xo(t),e)return n.b.set(n.c,e,n.a)}):$()})},d(ta,Zt),d(ea,xt),d(na,xt),(ka=ta.prototype).eb=function(t){return ha(this,t=this.h.eb(t))},ka.na=function(t){this.V===t||this.l||(this.V=t,Vr(this.c,this.V),te(this,new ea(this.$())))},ka.$=function(){return this.V},ka.Ec=function(){var t=xa.navigator;this.na(t&&(t.languages&&t.languages[0]||t.language||t.userLanguage)||null)},ka.gc=function(t){this.A.push(t),Wr(this.c,Pa.SDK_VERSION?Rn(Pa.SDK_VERSION,this.A):null),te(this,new na(this.A))},ka.Ka=function(){return C(this.A)},ka.toJSON=function(){return{apiKey:sa(this).options.apiKey,authDomain:sa(this).options.authDomain,appName:sa(this).name,currentUser:ua(this)&&ua(this).B()}},ka.ob=function(t,e){switch(t){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==e&&!!this.f;default:return!1}},ka.fa=function(t,e,n,r){"signInViaPopup"==t&&this.g==r&&(n&&this.v?this.v(n):e&&!n&&this.f&&this.f(e),this.b&&(this.b.cancel(),this.b=null),delete this.f,delete this.v)},ka.va=function(t,e){return"signInViaRedirect"==t||"signInViaPopup"==t&&this.g==e&&this.f?f(this.Sb,this):null},ka.Sb=function(t,e){var n=this;t={requestUri:t,sessionId:e},this.b&&(this.b.cancel(),this.b=null);var r=null,i=null,o=Yr(n.c,t).then(function(t){return r=kr(t),i=or(t),t});return ha(this,t=n.U.then(function(){return o}).then(function(t){return ia(n,t)}).then(function(){return Xn({user:ua(n),credential:r,additionalUserInfo:i,operationType:"signIn"})}))},ka.wc=function(t){if(!Dn())return Z(new $n("operation-not-supported-in-this-environment"));var e=this,n=ir(t.providerId),r=Bn(),i=null;(!Ln()||In())&&sa(this).options.authDomain&&t.isOAuthProvider&&(i=fi(sa(this).options.authDomain,sa(this).options.apiKey,sa(this).name,"signInViaPopup",t,null,r,Pa.SDK_VERSION||null));var o=wn(i,n&&n.za,n&&n.ya);return ha(this,n=ra(this).then(function(e){return Yi(e,o,"signInViaPopup",t,r,!!i)}).then(function(){return new X(function(t,n){e.fa("signInViaPopup",null,new $n("cancelled-popup-request"),e.g),e.f=t,e.v=n,e.g=r,e.b=e.a.Ca(e,"signInViaPopup",o,r)})}).then(function(t){return o&&En(o),t?Xn(t):null}).s(function(t){throw o&&En(o),t}))},ka.xc=function(t){if(!Dn())return Z(new $n("operation-not-supported-in-this-environment"));var e=this;return ha(this,ra(this).then(function(){return Zo(t=e.h,function(){return t.b.set(Jc,t.c.C,t.a)});var t}).then(function(){return e.a.Aa("signInViaRedirect",t)}))},ka.aa=function(){if(!Dn())return Z(new $n("operation-not-supported-in-this-environment"));var t=this;return ha(this,ra(this).then(function(){return t.a.aa()}).then(function(t){return t?Xn(t):null}))},ka.hb=function(){var t=this;return ha(this,this.i.then(function(){return ua(t)?(oa(t,null),Jo(t.h).then(function(){la(t)})):$()}))},ka.yc=function(){var t=this;return $o(this.h,sa(this).options.authDomain).then(function(e){if(!t.l){var n;if(n=ua(t)&&e){n=ua(t).uid;var r=e.uid;n=null!=n&&""!==n&&null!=r&&""!==r&&n==r}if(n)return xo(ua(t),e),ua(t).F();(ua(t)||e)&&(oa(t,e),e&&(Ao(e),e.ca=t.G),t.a&&t.a.subscribe(t),la(t))}})},ka.ka=function(t){return Yo(this.h,t)},ka.Tb=function(){la(this),this.ka(ua(this))},ka.Zb=function(){this.hb()},ka.$b=function(){this.hb()},ka.ac=function(t){var e=this;this.addAuthTokenListener(function(){t.next(ua(e))})},ka.bc=function(t){var e=this;!function(t,e){t.I.push(e),ha(t,t.i.then(function(){!t.l&&T(t.I,e)&&t.R!==t.getUid()&&(t.R=t.getUid(),e(ca(t)))}))}(this,function(){t.next(ua(e))})},ka.ic=function(t,e,n){var r=this;return this.W&&Pa.Promise.resolve().then(function(){u(t)?t(ua(r)):u(t.next)&&t.next(ua(r))}),this.Kb(t,e,n)},ka.hc=function(t,e,n){var r=this;return this.W&&Pa.Promise.resolve().then(function(){r.R=r.getUid(),u(t)?t(ua(r)):u(t.next)&&t.next(ua(r))}),this.Lb(t,e,n)},ka.Vb=function(t){var e=this;return ha(this,this.i.then(function(){return ua(e)?ua(e).F(t).then(function(t){return{accessToken:t}}):null}))},ka.tc=function(t){return this.Eb(t).then(function(t){return t.user})},ka.Eb=function(t){var e=this;return this.i.then(function(){return aa(e,ti(e.c,Cc,{token:t}))}).then(function(t){var n=t.user;return Do(n,"isAnonymous",!1),e.ka(n),t})},ka.Fb=function(t,e){var n=this;return this.i.then(function(){return aa(n,ti(n.c,Rc,{email:t,password:e}))})},ka.uc=function(t,e){return this.Fb(t,e).then(function(t){return t.user})},ka.Ob=function(t,e){return this.qb(t,e).then(function(t){return t.user})},ka.qb=function(t,e){var n=this;return this.i.then(function(){return aa(n,ti(n.c,hc,{email:t,password:e}))})},ka.sc=function(t){return this.fb(t).then(function(t){return t.user})},ka.fb=function(t){var e=this;return this.i.then(function(){return aa(e,t.wa(e.c))})},ka.gb=function(){return this.Gb().then(function(t){return t.user})},ka.Gb=function(){var t=this;return this.i.then(function(){var e=ua(t);return e&&e.isAnonymous?Xn({user:e,credential:null,additionalUserInfo:Xn({providerId:null,isNewUser:!1}),operationType:"signIn"}):aa(t,t.c.gb()).then(function(e){var n=e.user;return Do(n,"isAnonymous",!0),t.ka(n),e})})},ka.getUid=function(){return ua(this)&&ua(this).uid||null},ka.Mb=function(t){this.addAuthTokenListener(t),0<++this.o&&ua(this)&&wo(ua(this))},ka.qc=function(t){var e=this;Qa(this.m,function(n){n==t&&e.o--}),0>this.o&&(this.o=0),0==this.o&&ua(this)&&So(ua(this)),this.removeAuthTokenListener(t)},ka.addAuthTokenListener=function(t){var e=this;this.m.push(t),ha(this,this.i.then(function(){e.l||T(e.m,t)&&t(ca(e))}))},ka.removeAuthTokenListener=function(t){A(this.m,function(e){return e==t})},ka.delete=function(){this.l=!0;for(var t=0;t<this.N.length;t++)this.N[t].cancel("app-deleted");return this.N=[],this.h&&Di((t=this.h).b,t.a,this.ha),this.a&&this.a.unsubscribe(this),Pa.Promise.resolve()},ka.Rb=function(t){return ha(this,function(t,e){return ti(t,fc,{identifier:e,continueUri:xn()?mn():"http://localhost"}).then(function(t){return t.allProviders||[]})}(this.c,t))},ka.Fc=function(t){return this.Ia(t).then(function(t){return t.data.email})},ka.Ta=function(t,e){return ha(this,this.c.Ta(t,e).then(function(){}))},ka.Ia=function(t){return ha(this,this.c.Ia(t).then(function(t){return new Jn(t)}))},ka.Sa=function(t){return ha(this,this.c.Sa(t).then(function(){}))},ka.cb=function(t,e){var n=this;return ha(this,$().then(function(){return void 0===e||D(e)?{}:er(new tr(e))}).then(function(e){return n.c.cb(t,e)}).then(function(){}))},ka.vc=function(t,e){return ha(this,oo(this,t,e,f(this.fb,this)))};var $c="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" "),Zc="callback",tl="expired-callback",el="sitekey",nl="size";(ka=Ea.prototype).xa=function(){var t=this;return this.c?this.c:this.c=Sa(this,$().then(function(){if(xn())return Sn();throw new $n("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")}).then(function(){return function(t,e){return new X(function(n,r){qn()?!xa.grecaptcha||e!==t.c&&!t.b?(xa[t.a]=function(){if(xa.grecaptcha){t.c=e;var i=xa.grecaptcha.render;xa.grecaptcha.render=function(e,n){return e=i(e,n),t.b++,e},n()}else r(new $n("internal-error"));delete xa[t.a]},$(ln(gt(rl,{onload:t.a,hl:e||""}))).s(function(){r(new $n("internal-error","Unable to load external reCAPTCHA dependencies!"))})):n():r(new $n("network-request-failed"))})}(Aa(),t.o())}).then(function(){return ti(t.u,_c,{})}).then(function(e){t.a[el]=e.recaptchaSiteKey}).s(function(e){throw t.c=null,e}))},ka.render=function(){Ta(this);var t=this;return Sa(this,this.xa().then(function(){if(null===t.b){var e=t.l;if(!t.h){var n=Tt(e);e=At("DIV"),n.appendChild(e)}t.b=grecaptcha.render(e,t.a)}return t.b}))},ka.verify=function(){Ta(this);var t=this;return Sa(this,this.render().then(function(e){return new X(function(n){var r=grecaptcha.getResponse(e);if(r)n(r);else{var i=function(e){e&&(function(t,e){A(t.i,function(t){return t==e})}(t,i),n(e))};t.i.push(i),t.h&&grecaptcha.execute(t.b)}})}))},ka.reset=function(){Ta(this),null!==this.b&&grecaptcha.reset(this.b)},ka.clear=function(){Ta(this),this.m=!0,Aa().b--;for(var t=0;t<this.g.length;t++)this.g[t].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.h){t=Tt(this.l);for(var e;e=t.firstChild;)t.removeChild(e)}};var rl=pt("https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),il=null;d(Oa,Ea),Ca(ta.prototype,{Sa:{name:"applyActionCode",j:[pa("code")]},Ia:{name:"checkActionCode",j:[pa("code")]},Ta:{name:"confirmPasswordReset",j:[pa("code"),pa("newPassword")]},Ob:{name:"createUserWithEmailAndPassword",j:[pa("email"),pa("password")]},qb:{name:"createUserAndRetrieveDataWithEmailAndPassword",j:[pa("email"),pa("password")]},Rb:{name:"fetchProvidersForEmail",j:[pa("email")]},aa:{name:"getRedirectResult",j:[]},hc:{name:"onAuthStateChanged",j:[ba(va(),ga(),"nextOrObserver"),ga("opt_error",!0),ga("opt_completed",!0)]},ic:{name:"onIdTokenChanged",j:[ba(va(),ga(),"nextOrObserver"),ga("opt_error",!0),ga("opt_completed",!0)]},cb:{name:"sendPasswordResetEmail",j:[pa("email"),ba(va("opt_actionCodeSettings",!0),ya(null,!0),"opt_actionCodeSettings",!0)]},eb:{name:"setPersistence",j:[pa("persistence")]},fb:{name:"signInAndRetrieveDataWithCredential",j:[ma()]},gb:{name:"signInAnonymously",j:[]},Gb:{name:"signInAnonymouslyAndRetrieveData",j:[]},sc:{name:"signInWithCredential",j:[ma()]},tc:{name:"signInWithCustomToken",j:[pa("token")]},Eb:{name:"signInAndRetrieveDataWithCustomToken",j:[pa("token")]},uc:{name:"signInWithEmailAndPassword",j:[pa("email"),pa("password")]},Fb:{name:"signInAndRetrieveDataWithEmailAndPassword",j:[pa("email"),pa("password")]},vc:{name:"signInWithPhoneNumber",j:[pa("phoneNumber"),_a()]},wc:{name:"signInWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},xc:{name:"signInWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},hb:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[pa(null,!0)]},Ec:{name:"useDeviceLanguage",j:[]},Fc:{name:"verifyPasswordResetCode",j:[pa("code")]}}),function(t,e){for(var n in e){var r=e[n].name;if(r!==n){var i=e[n].Nb;Object.defineProperty(t,r,{get:function(){return this[n]},set:function(t){fa(r,[i],[t],!0),this[n]=t},enumerable:!0})}}}(ta.prototype,{lc:{name:"languageCode",Nb:ba(pa(),ya(),"languageCode")}}),ta.Persistence=Hc,ta.Persistence.LOCAL="local",ta.Persistence.SESSION="session",ta.Persistence.NONE="none",Ca(yo.prototype,{delete:{name:"delete",j:[]},F:{name:"getIdToken",j:[da()]},getToken:{name:"getToken",j:[da()]},Xa:{name:"linkAndRetrieveDataWithCredential",j:[ma()]},cc:{name:"linkWithCredential",j:[ma()]},dc:{name:"linkWithPhoneNumber",j:[pa("phoneNumber"),_a()]},ec:{name:"linkWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},fc:{name:"linkWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Za:{name:"reauthenticateAndRetrieveDataWithCredential",j:[ma()]},mc:{name:"reauthenticateWithCredential",j:[ma()]},nc:{name:"reauthenticateWithPhoneNumber",j:[pa("phoneNumber"),_a()]},oc:{name:"reauthenticateWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},pc:{name:"reauthenticateWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},reload:{name:"reload",j:[]},bb:{name:"sendEmailVerification",j:[ba(va("opt_actionCodeSettings",!0),ya(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[pa(null,!0)]},Cc:{name:"unlink",j:[pa("provider")]},kb:{name:"updateEmail",j:[pa("email")]},lb:{name:"updatePassword",j:[pa("password")]},Dc:{name:"updatePhoneNumber",j:[ma("phone")]},mb:{name:"updateProfile",j:[va("profile")]}}),Ca(X.prototype,{s:{name:"catch"},then:{name:"then"}}),Ca(io.prototype,{confirm:{name:"confirm",j:[pa("verificationCode")]}}),Ra(Ar,"credential",function(t,e){return new Ir(t,e)},[pa("email"),pa("password")]),Ca(yr.prototype,{sa:{name:"addScope",j:[pa("scope")]},Ba:{name:"setCustomParameters",j:[va("customOAuthParameters")]}}),Ra(yr,"credential",mr,[ba(pa(),va(),"token")]),Ca(_r.prototype,{sa:{name:"addScope",j:[pa("scope")]},Ba:{name:"setCustomParameters",j:[va("customOAuthParameters")]}}),Ra(_r,"credential",br,[ba(pa(),va(),"token")]),Ca(Er.prototype,{sa:{name:"addScope",j:[pa("scope")]},Ba:{name:"setCustomParameters",j:[va("customOAuthParameters")]}}),Ra(Er,"credential",wr,[ba(pa(),ba(va(),ya()),"idToken"),ba(pa(),ya(),"accessToken",!0)]),Ca(Sr.prototype,{Ba:{name:"setCustomParameters",j:[va("customOAuthParameters")]}}),Ra(Sr,"credential",Tr,[ba(pa(),va(),"token"),pa("secret",!0)]),Ca(gr.prototype,{sa:{name:"addScope",j:[pa("scope")]},credential:{name:"credential",j:[ba(pa(),ya(),"idToken",!0),ba(pa(),ya(),"accessToken",!0)]},Ba:{name:"setCustomParameters",j:[va("customOAuthParameters")]}}),Ra(Rr,"credential",Nr,[pa("verificationId"),pa("verificationCode")]),Ca(Rr.prototype,{Qa:{name:"verifyPhoneNumber",j:[pa("phoneNumber"),_a()]}}),Ca($n.prototype,{toJSON:{name:"toJSON",j:[pa(null,!0)]}}),Ca(Fr.prototype,{toJSON:{name:"toJSON",j:[pa(null,!0)]}}),Ca(Lr.prototype,{toJSON:{name:"toJSON",j:[pa(null,!0)]}}),Ca(Oa.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),function(){if(void 0===Pa||!Pa.INTERNAL||!Pa.INTERNAL.registerService)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var t={Auth:ta,Error:$n};Ra(t,"EmailAuthProvider",Ar,[]),Ra(t,"FacebookAuthProvider",yr,[]),Ra(t,"GithubAuthProvider",_r,[]),Ra(t,"GoogleAuthProvider",Er,[]),Ra(t,"TwitterAuthProvider",Sr,[]),Ra(t,"OAuthProvider",gr,[pa("providerId")]),Ra(t,"PhoneAuthProvider",Rr,[{name:"auth",K:"an instance of Firebase Auth",optional:!0,M:function(t){return!!(t&&t instanceof ta)}}]),Ra(t,"RecaptchaVerifier",Oa,[ba(pa(),{name:"",K:"an HTML element",optional:!1,M:function(t){return!!(t&&t instanceof Element)}},"recaptchaContainer"),va("recaptchaParameters",!0),{name:"app",K:"an instance of Firebase App",optional:!0,M:function(t){return!!(t&&t instanceof Pa.app.App)}}]),Pa.INTERNAL.registerService("auth",function(t,e){return e({INTERNAL:{getUid:f((t=new ta(t)).getUid,t),getToken:f(t.Vb,t),addAuthTokenListener:f(t.Mb,t),removeAuthTokenListener:f(t.qc,t)}}),t},t,function(t,e){if("create"===t)try{e.auth()}catch(t){}}),Pa.INTERNAL.extendNamespace({User:yo})}()}).call(void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})}).call(this,n(8))},function(t,e,n){"use strict";function r(e){var n=e.INTERNAL.registerService("database",function(t,e,n){return c.RepoManager.getInstance().databaseFromApp(t,n)},{Reference:s.Reference,Query:a.Query,Database:o.Database,enableLogging:u.enableLogging,INTERNAL:l,ServerValue:p,TEST_ACCESS:h},null,!0);f.isNodeSdk()&&(t.exports=n)}Object.defineProperty(e,"__esModule",{value:!0});var i=n(16),o=n(216);e.Database=o.Database;var a=n(220);e.Query=a.Query;var s=n(155);e.Reference=s.Reference;var u=n(4);e.enableLogging=u.enableLogging;var c=n(160),l=n(552),h=n(553),f=n(1),p=o.Database.ServerValue;e.ServerValue=p,e.registerDatabase=r,r(i.default);var d=n(156);e.DataSnapshot=d.DataSnapshot;var v=n(219);e.OnDisconnect=v.OnDisconnect},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=function(){function t(t){this.domStorage_=t,this.prefix_="firebase:"}return t.prototype.set=function(t,e){null==e?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),r.stringify(e))},t.prototype.get=function(t){var e=this.domStorage_.getItem(this.prefixedName_(t));return null==e?null:r.jsonEval(e)},t.prototype.remove=function(t){this.domStorage_.removeItem(this.prefixedName_(t))},t.prototype.prefixedName_=function(t){return this.prefix_+t},t.prototype.toString=function(){return this.domStorage_.toString()},t}();e.DOMStorageWrapper=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=function(){function t(){this.cache_={},this.isInMemoryStorage=!0}return t.prototype.set=function(t,e){null==e?delete this.cache_[t]:this.cache_[t]=e},t.prototype.get=function(t){return r.contains(this.cache_,t)?this.cache_[t]:null},t.prototype.remove=function(t){delete this.cache_[t]},t}();e.MemoryStorage=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=function(){function t(t,e){this.committed=t,this.snapshot=e}return t.prototype.toJSON=function(){return r.validateArgCount("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},t}();e.TransactionResult=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1);e.nextPushId=function(){var t="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",e=0,n=[];return function(i){var o=i===e;e=i;var a,s=new Array(8);for(a=7;a>=0;a--)s[a]=t.charAt(i%64),i=Math.floor(i/64);r.assert(0===i,"Cannot push at time == 0");var u=s.join("");if(o){for(a=11;a>=0&&63===n[a];a--)n[a]=0;n[a]++}else for(a=0;a<12;a++)n[a]=Math.floor(64*Math.random());for(a=0;a<12;a++)u+=t.charAt(n[a]);return r.assert(20===u.length,"nextPushId: Length should be 20."),u}}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(156),i=n(526),o=n(1),a=n(1),s=function(){function t(t,e,n){this.callback_=t,this.cancelCallback_=e,this.context_=n}return t.prototype.respondsTo=function(t){return"value"===t},t.prototype.createEvent=function(t,e){var n=e.getQueryParams().getIndex();return new i.DataEvent("value",this,new r.DataSnapshot(t.snapshotNode,e.getRef(),n))},t.prototype.getEventRunner=function(t){var e=this.context_;if("cancel"===t.getEventType()){a.assert(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(e,t.error)}}var r=this.callback_;return function(){r.call(e,t.snapshot)}},t.prototype.createCancelEvent=function(t,e){return this.cancelCallback_?new i.CancelEvent(this,t,e):null},t.prototype.matches=function(e){return e instanceof t&&(!e.callback_||!this.callback_||e.callback_===this.callback_&&e.context_===this.context_)},t.prototype.hasAnyCallback=function(){return null!==this.callback_},t}();e.ValueEventRegistration=s;var u=function(){function t(t,e,n){this.callbacks_=t,this.cancelCallback_=e,this.context_=n}return t.prototype.respondsTo=function(t){var e="children_added"===t?"child_added":t;return e="children_removed"===e?"child_removed":e,o.contains(this.callbacks_,e)},t.prototype.createCancelEvent=function(t,e){return this.cancelCallback_?new i.CancelEvent(this,t,e):null},t.prototype.createEvent=function(t,e){a.assert(null!=t.childName,"Child events should have a childName.");var n=e.getRef().child(t.childName),o=e.getQueryParams().getIndex();return new i.DataEvent(t.type,this,new r.DataSnapshot(t.snapshotNode,n,o),t.prevName)},t.prototype.getEventRunner=function(t){var e=this.context_;if("cancel"===t.getEventType()){a.assert(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(e,t.error)}}var r=this.callbacks_[t.eventType];return function(){r.call(e,t.snapshot,t.prevName)}},t.prototype.matches=function(e){if(e instanceof t){if(!this.callbacks_||!e.callbacks_)return!0;if(this.context_===e.context_){var n=o.getCount(e.callbacks_);if(n===o.getCount(this.callbacks_)){if(1===n){var r=o.getAnyKey(e.callbacks_),i=o.getAnyKey(this.callbacks_);return!(i!==r||e.callbacks_[r]&&this.callbacks_[i]&&e.callbacks_[r]!==this.callbacks_[i])}return o.every(this.callbacks_,function(t,n){return e.callbacks_[t]===n})}}}return!1},t.prototype.hasAnyCallback=function(){return null!==this.callbacks_},t}();e.ChildEventRegistration=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=function(){function t(t,e,n,r){this.eventType=t,this.eventRegistration=e,this.snapshot=n,this.prevName=r}return t.prototype.getPath=function(){var t=this.snapshot.getRef();return"value"===this.eventType?t.path:t.getParent().path},t.prototype.getEventType=function(){return this.eventType},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+r.stringify(this.snapshot.exportVal())},t}();e.DataEvent=i;var o=function(){function t(t,e,n){this.eventRegistration=t,this.error=e,this.path=n}return t.prototype.getPath=function(){return this.path},t.prototype.getEventType=function(){return"cancel"},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.path.toString()+":cancel"},t}();e.CancelEvent=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=n(4),o=n(528),a=n(24),s=n(1),u=n(157),c=n(529),l=n(530),h=n(64),f=n(230),p=n(13),d=n(231),v=n(536),g=function(){function t(t){this.listenProvider_=t,this.syncPointTree_=u.ImmutableTree.Empty,this.pendingWriteTree_=new v.WriteTree,this.tagToQueryMap_={},this.queryToTagMap_={}}return t.prototype.applyUserOverwrite=function(t,e,n,r){return this.pendingWriteTree_.addOverwrite(t,e,n,r),r?this.applyOperationToSyncPoints_(new f.Overwrite(h.OperationSource.User,t,e)):[]},t.prototype.applyUserMerge=function(t,e,n){this.pendingWriteTree_.addMerge(t,e,n);var r=u.ImmutableTree.fromObject(e);return this.applyOperationToSyncPoints_(new l.Merge(h.OperationSource.User,t,r))},t.prototype.ackUserWrite=function(t,e){void 0===e&&(e=!1);var n=this.pendingWriteTree_.getWrite(t);if(this.pendingWriteTree_.removeWrite(t)){var r=u.ImmutableTree.Empty;return null!=n.snap?r=r.set(p.Path.Empty,!0):s.forEach(n.children,function(t,e){r=r.set(new p.Path(t),e)}),this.applyOperationToSyncPoints_(new o.AckUserWrite(n.path,r,e))}return[]},t.prototype.applyServerOverwrite=function(t,e){return this.applyOperationToSyncPoints_(new f.Overwrite(h.OperationSource.Server,t,e))},t.prototype.applyServerMerge=function(t,e){var n=u.ImmutableTree.fromObject(e);return this.applyOperationToSyncPoints_(new l.Merge(h.OperationSource.Server,t,n))},t.prototype.applyListenComplete=function(t){return this.applyOperationToSyncPoints_(new c.ListenComplete(h.OperationSource.Server,t))},t.prototype.applyTaggedQueryOverwrite=function(e,n,r){var i=this.queryKeyForTag_(r);if(null!=i){var o=t.parseQueryKey_(i),a=o.path,s=o.queryId,u=p.Path.relativePath(a,e),c=new f.Overwrite(h.OperationSource.forServerTaggedQuery(s),u,n);return this.applyTaggedOperation_(a,c)}return[]},t.prototype.applyTaggedQueryMerge=function(e,n,r){var i=this.queryKeyForTag_(r);if(i){var o=t.parseQueryKey_(i),a=o.path,s=o.queryId,c=p.Path.relativePath(a,e),f=u.ImmutableTree.fromObject(n),d=new l.Merge(h.OperationSource.forServerTaggedQuery(s),c,f);return this.applyTaggedOperation_(a,d)}return[]},t.prototype.applyTaggedListenComplete=function(e,n){var r=this.queryKeyForTag_(n);if(r){var i=t.parseQueryKey_(r),o=i.path,a=i.queryId,s=p.Path.relativePath(o,e),u=new c.ListenComplete(h.OperationSource.forServerTaggedQuery(a),s);return this.applyTaggedOperation_(o,u)}return[]},t.prototype.addEventRegistration=function(e,n){var i=e.path,o=null,s=!1;this.syncPointTree_.foreachOnPath(i,function(t,e){var n=p.Path.relativePath(t,i);o=o||e.getCompleteServerCache(n),s=s||e.hasCompleteView()});var u,c=this.syncPointTree_.get(i);c?(s=s||c.hasCompleteView(),o=o||c.getCompleteServerCache(p.Path.Empty)):(c=new d.SyncPoint,this.syncPointTree_=this.syncPointTree_.set(i,c)),null!=o?u=!0:(u=!1,o=a.ChildrenNode.EMPTY_NODE,this.syncPointTree_.subtree(i).foreachChild(function(t,e){var n=e.getCompleteServerCache(p.Path.Empty);n&&(o=o.updateImmediateChild(t,n))}));var l=c.viewExistsForQuery(e);if(!l&&!e.getQueryParams().loadsAllData()){var h=t.makeQueryKey_(e);r.assert(!(h in this.queryToTagMap_),"View does not exist, but we have a tag");var f=t.getNextQueryTag_();this.queryToTagMap_[h]=f,this.tagToQueryMap_["_"+f]=h}var v=this.pendingWriteTree_.childWrites(i),g=c.addEventRegistration(e,n,v,o,u);if(!l&&!s){var y=c.viewForQuery(e);g=g.concat(this.setupListener_(e,y))}return g},t.prototype.removeEventRegistration=function(e,n,r){var i=this,o=e.path,a=this.syncPointTree_.get(o),s=[];if(a&&("default"===e.queryIdentifier()||a.viewExistsForQuery(e))){var u=a.removeEventRegistration(e,n,r);a.isEmpty()&&(this.syncPointTree_=this.syncPointTree_.remove(o));var c=u.removed;s=u.events;var l=-1!==c.findIndex(function(t){return t.getQueryParams().loadsAllData()}),h=this.syncPointTree_.findOnPath(o,function(t,e){return e.hasCompleteView()});if(l&&!h){var f=this.syncPointTree_.subtree(o);if(!f.isEmpty())for(var p=this.collectDistinctViewsForSubTree_(f),d=0;d<p.length;++d){var v=p[d],g=v.getQuery(),y=this.createListenerForView_(v);this.listenProvider_.startListening(t.queryForListening_(g),this.tagForQuery_(g),y.hashFn,y.onComplete)}}!h&&c.length>0&&!r&&(l?this.listenProvider_.stopListening(t.queryForListening_(e),null):c.forEach(function(e){var n=i.queryToTagMap_[t.makeQueryKey_(e)];i.listenProvider_.stopListening(t.queryForListening_(e),n)})),this.removeTags_(c)}return s},t.prototype.calcCompleteEventCache=function(t,e){var n=this.pendingWriteTree_,r=this.syncPointTree_.findOnPath(t,function(e,n){var r=p.Path.relativePath(e,t),i=n.getCompleteServerCache(r);if(i)return i});return n.calcCompleteEventCache(t,r,e,!0)},t.prototype.collectDistinctViewsForSubTree_=function(t){return t.fold(function(t,e,n){if(e&&e.hasCompleteView())return[e.getCompleteView()];var r=[];return e&&(r=e.getQueryViews()),s.forEach(n,function(t,e){r=r.concat(e)}),r})},t.prototype.removeTags_=function(e){for(var n=0;n<e.length;++n){var r=e[n];if(!r.getQueryParams().loadsAllData()){var i=t.makeQueryKey_(r),o=this.queryToTagMap_[i];delete this.queryToTagMap_[i],delete this.tagToQueryMap_["_"+o]}}},t.queryForListening_=function(t){return t.getQueryParams().loadsAllData()&&!t.getQueryParams().isDefault()?t.getRef():t},t.prototype.setupListener_=function(e,n){var i=e.path,o=this.tagForQuery_(e),a=this.createListenerForView_(n),u=this.listenProvider_.startListening(t.queryForListening_(e),o,a.hashFn,a.onComplete),c=this.syncPointTree_.subtree(i);if(o)r.assert(!c.value.hasCompleteView(),"If we're adding a query, it shouldn't be shadowed");else for(var l=c.fold(function(t,e,n){if(!t.isEmpty()&&e&&e.hasCompleteView())return[e.getCompleteView().getQuery()];var r=[];return e&&(r=r.concat(e.getQueryViews().map(function(t){return t.getQuery()}))),s.forEach(n,function(t,e){r=r.concat(e)}),r}),h=0;h<l.length;++h){var f=l[h];this.listenProvider_.stopListening(t.queryForListening_(f),this.tagForQuery_(f))}return u},t.prototype.createListenerForView_=function(t){var e=this,n=t.getQuery(),r=this.tagForQuery_(n);return{hashFn:function(){return(t.getServerCache()||a.ChildrenNode.EMPTY_NODE).hash()},onComplete:function(t){if("ok"===t)return r?e.applyTaggedListenComplete(n.path,r):e.applyListenComplete(n.path);var o=i.errorForServerCode(t,n);return e.removeEventRegistration(n,null,o)}}},t.makeQueryKey_=function(t){return t.path.toString()+"$"+t.queryIdentifier()},t.parseQueryKey_=function(t){var e=t.indexOf("$");return r.assert(-1!==e&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new p.Path(t.substr(0,e))}},t.prototype.queryKeyForTag_=function(t){return this.tagToQueryMap_["_"+t]},t.prototype.tagForQuery_=function(e){var n=t.makeQueryKey_(e);return s.safeGet(this.queryToTagMap_,n)},t.getNextQueryTag_=function(){return t.nextQueryTag_++},t.prototype.applyTaggedOperation_=function(t,e){var n=this.syncPointTree_.get(t);r.assert(n,"Missing sync point for query tag that we're tracking");var i=this.pendingWriteTree_.childWrites(t);return n.applyOperation(e,i,null)},t.prototype.applyOperationToSyncPoints_=function(t){return this.applyOperationHelper_(t,this.syncPointTree_,null,this.pendingWriteTree_.childWrites(p.Path.Empty))},t.prototype.applyOperationHelper_=function(t,e,n,r){if(t.path.isEmpty())return this.applyOperationDescendantsHelper_(t,e,n,r);var i=e.get(p.Path.Empty);null==n&&null!=i&&(n=i.getCompleteServerCache(p.Path.Empty));var o=[],a=t.path.getFront(),s=t.operationForChild(a),u=e.children.get(a);if(u&&s){var c=n?n.getImmediateChild(a):null,l=r.child(a);o=o.concat(this.applyOperationHelper_(s,u,c,l))}return i&&(o=o.concat(i.applyOperation(t,r,n))),o},t.prototype.applyOperationDescendantsHelper_=function(t,e,n,r){var i=this,o=e.get(p.Path.Empty);null==n&&null!=o&&(n=o.getCompleteServerCache(p.Path.Empty));var a=[];return e.children.inorderTraversal(function(e,o){var s=n?n.getImmediateChild(e):null,u=r.child(e),c=t.operationForChild(e);c&&(a=a.concat(i.applyOperationDescendantsHelper_(c,o,s,u)))}),o&&(a=a.concat(o.applyOperation(t,r,n))),a},t.nextQueryTag_=1,t}();e.SyncTree=g},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=n(13),o=n(64),a=function(){function t(t,e,n){this.path=t,this.affectedTree=e,this.revert=n,this.type=o.OperationType.ACK_USER_WRITE,this.source=o.OperationSource.User}return t.prototype.operationForChild=function(e){if(this.path.isEmpty()){if(null!=this.affectedTree.value)return r.assert(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new i.Path(e));return new t(i.Path.Empty,n,this.revert)}return r.assert(this.path.getFront()===e,"operationForChild called for unrelated child."),new t(this.path.popFront(),this.affectedTree,this.revert)},t}();e.AckUserWrite=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(13),i=n(64),o=function(){function t(t,e){this.source=t,this.path=e,this.type=i.OperationType.LISTEN_COMPLETE}return t.prototype.operationForChild=function(e){return this.path.isEmpty()?new t(this.source,r.Path.Empty):new t(this.source,this.path.popFront())},t}();e.ListenComplete=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(64),i=n(230),o=n(13),a=n(1),s=function(){function t(t,e,n){this.source=t,this.path=e,this.children=n,this.type=r.OperationType.MERGE}return t.prototype.operationForChild=function(e){if(this.path.isEmpty()){var n=this.children.subtree(new o.Path(e));return n.isEmpty()?null:n.value?new i.Overwrite(this.source,o.Path.Empty,n.value):new t(this.source,o.Path.Empty,n)}return a.assert(this.path.getFront()===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,this.path.popFront(),this.children)},t.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},t}();e.Merge=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(158),i=n(532),o=n(24),a=n(111),s=n(232),u=n(535),c=n(1),l=n(64),h=n(74),f=n(19),p=function(){function t(t,e){this.query_=t,this.eventRegistrations_=[];var n=this.query_.getQueryParams(),c=new r.IndexedFilter(n.getIndex()),l=n.getNodeFilter();this.processor_=new i.ViewProcessor(l);var h=e.getServerCache(),f=e.getEventCache(),p=c.updateFullNode(o.ChildrenNode.EMPTY_NODE,h.getNode(),null),d=l.updateFullNode(o.ChildrenNode.EMPTY_NODE,f.getNode(),null),v=new a.CacheNode(p,h.isFullyInitialized(),c.filtersNodes()),g=new a.CacheNode(d,f.isFullyInitialized(),l.filtersNodes());this.viewCache_=new s.ViewCache(g,v),this.eventGenerator_=new u.EventGenerator(this.query_)}return t.prototype.getQuery=function(){return this.query_},t.prototype.getServerCache=function(){return this.viewCache_.getServerCache().getNode()},t.prototype.getCompleteServerCache=function(t){var e=this.viewCache_.getCompleteServerSnap();return e&&(this.query_.getQueryParams().loadsAllData()||!t.isEmpty()&&!e.getImmediateChild(t.getFront()).isEmpty())?e.getChild(t):null},t.prototype.isEmpty=function(){return 0===this.eventRegistrations_.length},t.prototype.addEventRegistration=function(t){this.eventRegistrations_.push(t)},t.prototype.removeEventRegistration=function(t,e){var n=[];if(e){c.assert(null==t,"A cancel should cancel all event registrations.");var r=this.query_.path;this.eventRegistrations_.forEach(function(t){e=e;var i=t.createCancelEvent(e,r);i&&n.push(i)})}if(t){for(var i=[],o=0;o<this.eventRegistrations_.length;++o){var a=this.eventRegistrations_[o];if(a.matches(t)){if(t.hasAnyCallback()){i=i.concat(this.eventRegistrations_.slice(o+1));break}}else i.push(a)}this.eventRegistrations_=i}else this.eventRegistrations_=[];return n},t.prototype.applyOperation=function(t,e,n){t.type===l.OperationType.MERGE&&null!==t.source.queryId&&(c.assert(this.viewCache_.getCompleteServerSnap(),"We should always have a full cache before handling merges"),c.assert(this.viewCache_.getCompleteEventSnap(),"Missing event cache, even though we have a server cache"));var r=this.viewCache_,i=this.processor_.applyOperation(r,t,e,n);return this.processor_.assertIndexed(i.viewCache),c.assert(i.viewCache.getServerCache().isFullyInitialized()||!r.getServerCache().isFullyInitialized(),"Once a server snap is complete, it should never go back"),this.viewCache_=i.viewCache,this.generateEventsForChanges_(i.changes,i.viewCache.getEventCache().getNode(),null)},t.prototype.getInitialEvents=function(t){var e=this.viewCache_.getEventCache(),n=[];return e.getNode().isLeafNode()||e.getNode().forEachChild(f.PRIORITY_INDEX,function(t,e){n.push(h.Change.childAddedChange(t,e))}),e.isFullyInitialized()&&n.push(h.Change.valueChange(e.getNode())),this.generateEventsForChanges_(n,e.getNode(),t)},t.prototype.generateEventsForChanges_=function(t,e,n){var r=n?[n]:this.eventRegistrations_;return this.eventGenerator_.generateEventsForChanges(t,e,r)},t}();e.View=p},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(64),i=n(1),o=n(533),a=n(74),s=n(24),u=n(81),c=n(157),l=n(13),h=n(534),f=function(){return function(t,e){this.viewCache=t,this.changes=e}}();e.ProcessorResult=f;var p=function(){function t(t){this.filter_=t}return t.prototype.assertIndexed=function(t){i.assert(t.getEventCache().getNode().isIndexed(this.filter_.getIndex()),"Event snap not indexed"),i.assert(t.getServerCache().getNode().isIndexed(this.filter_.getIndex()),"Server snap not indexed")},t.prototype.applyOperation=function(e,n,a,s){var u,c,l=new o.ChildChangeAccumulator;if(n.type===r.OperationType.OVERWRITE){var h=n;h.source.fromUser?u=this.applyUserOverwrite_(e,h.path,h.snap,a,s,l):(i.assert(h.source.fromServer,"Unknown source."),c=h.source.tagged||e.getServerCache().isFiltered()&&!h.path.isEmpty(),u=this.applyServerOverwrite_(e,h.path,h.snap,a,s,c,l))}else if(n.type===r.OperationType.MERGE){var p=n;p.source.fromUser?u=this.applyUserMerge_(e,p.path,p.children,a,s,l):(i.assert(p.source.fromServer,"Unknown source."),c=p.source.tagged||e.getServerCache().isFiltered(),u=this.applyServerMerge_(e,p.path,p.children,a,s,c,l))}else if(n.type===r.OperationType.ACK_USER_WRITE){var d=n;u=d.revert?this.revertUserWrite_(e,d.path,a,s,l):this.ackUserWrite_(e,d.path,d.affectedTree,a,s,l)}else{if(n.type!==r.OperationType.LISTEN_COMPLETE)throw i.assertionError("Unknown operation type: "+n.type);u=this.listenComplete_(e,n.path,a,l)}var v=l.getChanges();return t.maybeAddValueEvent_(e,u,v),new f(u,v)},t.maybeAddValueEvent_=function(t,e,n){var r=e.getEventCache();if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=t.getCompleteEventSnap();(n.length>0||!t.getEventCache().isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(a.Change.valueChange(e.getCompleteEventSnap()))}},t.prototype.generateEventCacheAfterServerEvent_=function(t,e,n,r,o){var a=t.getEventCache();if(null!=n.shadowingWrite(e))return t;var u=void 0,c=void 0;if(e.isEmpty())if(i.assert(t.getServerCache().isFullyInitialized(),"If change path is empty, we must have complete server data"),t.getServerCache().isFiltered()){var l=t.getCompleteServerSnap(),h=l instanceof s.ChildrenNode?l:s.ChildrenNode.EMPTY_NODE,f=n.calcCompleteEventChildren(h);u=this.filter_.updateFullNode(t.getEventCache().getNode(),f,o)}else{var p=n.calcCompleteEventCache(t.getCompleteServerSnap());u=this.filter_.updateFullNode(t.getEventCache().getNode(),p,o)}else{var d=e.getFront();if(".priority"==d){i.assert(1==e.getLength(),"Can't have a priority with additional path components");var v=a.getNode();c=t.getServerCache().getNode();var g=n.calcEventCacheAfterServerOverwrite(e,v,c);u=null!=g?this.filter_.updatePriority(v,g):a.getNode()}else{var y=e.popFront(),m=void 0;if(a.isCompleteForChild(d)){c=t.getServerCache().getNode();var _=n.calcEventCacheAfterServerOverwrite(e,a.getNode(),c);m=null!=_?a.getNode().getImmediateChild(d).updateChild(y,_):a.getNode().getImmediateChild(d)}else m=n.calcCompleteChild(d,t.getServerCache());u=null!=m?this.filter_.updateChild(a.getNode(),d,m,y,r,o):a.getNode()}}return t.updateEventSnap(u,a.isFullyInitialized()||e.isEmpty(),this.filter_.filtersNodes())},t.prototype.applyServerOverwrite_=function(t,e,n,r,i,o,a){var s,u=t.getServerCache(),c=o?this.filter_:this.filter_.getIndexedFilter();if(e.isEmpty())s=c.updateFullNode(u.getNode(),n,null);else if(c.filtersNodes()&&!u.isFiltered()){var l=u.getNode().updateChild(e,n);s=c.updateFullNode(u.getNode(),l,null)}else{var f=e.getFront();if(!u.isCompleteForPath(e)&&e.getLength()>1)return t;var p=e.popFront(),d=u.getNode().getImmediateChild(f).updateChild(p,n);s=".priority"==f?c.updatePriority(u.getNode(),d):c.updateChild(u.getNode(),f,d,p,h.NO_COMPLETE_CHILD_SOURCE,null)}var v=t.updateServerSnap(s,u.isFullyInitialized()||e.isEmpty(),c.filtersNodes()),g=new h.WriteTreeCompleteChildSource(r,v,i);return this.generateEventCacheAfterServerEvent_(v,e,r,g,a)},t.prototype.applyUserOverwrite_=function(t,e,n,r,i,o){var a,u,c=t.getEventCache(),l=new h.WriteTreeCompleteChildSource(r,t,i);if(e.isEmpty())u=this.filter_.updateFullNode(t.getEventCache().getNode(),n,o),a=t.updateEventSnap(u,!0,this.filter_.filtersNodes());else{var f=e.getFront();if(".priority"===f)u=this.filter_.updatePriority(t.getEventCache().getNode(),n),a=t.updateEventSnap(u,c.isFullyInitialized(),c.isFiltered());else{var p=e.popFront(),d=c.getNode().getImmediateChild(f),v=void 0;if(p.isEmpty())v=n;else{var g=l.getCompleteChild(f);v=null!=g?".priority"===p.getBack()&&g.getChild(p.parent()).isEmpty()?g:g.updateChild(p,n):s.ChildrenNode.EMPTY_NODE}if(d.equals(v))a=t;else{var y=this.filter_.updateChild(c.getNode(),f,v,p,l,o);a=t.updateEventSnap(y,c.isFullyInitialized(),this.filter_.filtersNodes())}}}return a},t.cacheHasChild_=function(t,e){return t.getEventCache().isCompleteForChild(e)},t.prototype.applyUserMerge_=function(e,n,r,i,o,a){var s=this,u=e;return r.foreach(function(r,c){var l=n.child(r);t.cacheHasChild_(e,l.getFront())&&(u=s.applyUserOverwrite_(u,l,c,i,o,a))}),r.foreach(function(r,c){var l=n.child(r);t.cacheHasChild_(e,l.getFront())||(u=s.applyUserOverwrite_(u,l,c,i,o,a))}),u},t.prototype.applyMerge_=function(t,e){return e.foreach(function(e,n){t=t.updateChild(e,n)}),t},t.prototype.applyServerMerge_=function(t,e,n,r,i,o,a){var s=this;if(t.getServerCache().getNode().isEmpty()&&!t.getServerCache().isFullyInitialized())return t;var u,h=t;u=e.isEmpty()?n:c.ImmutableTree.Empty.setTree(e,n);var f=t.getServerCache().getNode();return u.children.inorderTraversal(function(e,n){if(f.hasChild(e)){var u=t.getServerCache().getNode().getImmediateChild(e),c=s.applyMerge_(u,n);h=s.applyServerOverwrite_(h,new l.Path(e),c,r,i,o,a)}}),u.children.inorderTraversal(function(e,n){var u=!t.getServerCache().isCompleteForChild(e)&&null==n.value;if(!f.hasChild(e)&&!u){var c=t.getServerCache().getNode().getImmediateChild(e),p=s.applyMerge_(c,n);h=s.applyServerOverwrite_(h,new l.Path(e),p,r,i,o,a)}}),h},t.prototype.ackUserWrite_=function(t,e,n,r,i,o){if(null!=r.shadowingWrite(e))return t;var a=t.getServerCache().isFiltered(),s=t.getServerCache();if(null!=n.value){if(e.isEmpty()&&s.isFullyInitialized()||s.isCompleteForPath(e))return this.applyServerOverwrite_(t,e,s.getNode().getChild(e),r,i,a,o);if(e.isEmpty()){var h=c.ImmutableTree.Empty;return s.getNode().forEachChild(u.KEY_INDEX,function(t,e){h=h.set(new l.Path(t),e)}),this.applyServerMerge_(t,e,h,r,i,a,o)}return t}var f=c.ImmutableTree.Empty;return n.foreach(function(t,n){var r=e.child(t);s.isCompleteForPath(r)&&(f=f.set(t,s.getNode().getChild(r)))}),this.applyServerMerge_(t,e,f,r,i,a,o)},t.prototype.listenComplete_=function(t,e,n,r){var i=t.getServerCache(),o=t.updateServerSnap(i.getNode(),i.isFullyInitialized()||e.isEmpty(),i.isFiltered());return this.generateEventCacheAfterServerEvent_(o,e,n,h.NO_COMPLETE_CHILD_SOURCE,r)},t.prototype.revertUserWrite_=function(t,e,n,r,o){var a;if(null!=n.shadowingWrite(e))return t;var u=new h.WriteTreeCompleteChildSource(n,t,r),c=t.getEventCache().getNode(),f=void 0;if(e.isEmpty()||".priority"===e.getFront()){var p=void 0;if(t.getServerCache().isFullyInitialized())p=n.calcCompleteEventCache(t.getCompleteServerSnap());else{var d=t.getServerCache().getNode();i.assert(d instanceof s.ChildrenNode,"serverChildren would be complete if leaf node"),p=n.calcCompleteEventChildren(d)}p=p,f=this.filter_.updateFullNode(c,p,o)}else{var v=e.getFront(),g=n.calcCompleteChild(v,t.getServerCache());null==g&&t.getServerCache().isCompleteForChild(v)&&(g=c.getImmediateChild(v)),(f=null!=g?this.filter_.updateChild(c,v,g,e.popFront(),u,o):t.getEventCache().getNode().hasChild(v)?this.filter_.updateChild(c,v,s.ChildrenNode.EMPTY_NODE,e.popFront(),u,o):c).isEmpty()&&t.getServerCache().isFullyInitialized()&&((a=n.calcCompleteEventCache(t.getCompleteServerSnap())).isLeafNode()&&(f=this.filter_.updateFullNode(f,a,o)))}return a=t.getServerCache().isFullyInitialized()||null!=n.shadowingWrite(l.Path.Empty),t.updateEventSnap(f,a,this.filter_.filtersNodes())},t}();e.ViewProcessor=p},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=n(74),o=n(1),a=function(){function t(){this.changeMap_={}}return t.prototype.trackChildChange=function(t){var e=t.type,n=t.childName;o.assert(e==i.Change.CHILD_ADDED||e==i.Change.CHILD_CHANGED||e==i.Change.CHILD_REMOVED,"Only child changes supported for tracking"),o.assert(".priority"!==n,"Only non-priority child changes can be tracked.");var a=r.safeGet(this.changeMap_,n);if(a){var s=a.type;if(e==i.Change.CHILD_ADDED&&s==i.Change.CHILD_REMOVED)this.changeMap_[n]=i.Change.childChangedChange(n,t.snapshotNode,a.snapshotNode);else if(e==i.Change.CHILD_REMOVED&&s==i.Change.CHILD_ADDED)delete this.changeMap_[n];else if(e==i.Change.CHILD_REMOVED&&s==i.Change.CHILD_CHANGED)this.changeMap_[n]=i.Change.childRemovedChange(n,a.oldSnap);else if(e==i.Change.CHILD_CHANGED&&s==i.Change.CHILD_ADDED)this.changeMap_[n]=i.Change.childAddedChange(n,t.snapshotNode);else{if(e!=i.Change.CHILD_CHANGED||s!=i.Change.CHILD_CHANGED)throw o.assertionError("Illegal combination of changes: "+t+" occurred after "+a);this.changeMap_[n]=i.Change.childChangedChange(n,t.snapshotNode,a.oldSnap)}}else this.changeMap_[n]=t},t.prototype.getChanges=function(){return r.getValues(this.changeMap_)},t}();e.ChildChangeAccumulator=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(111),i=function(){function t(){}return t.prototype.getCompleteChild=function(t){return null},t.prototype.getChildAfterChild=function(t,e,n){return null},t}();e.NoCompleteChildSource_=i,e.NO_COMPLETE_CHILD_SOURCE=new i;var o=function(){function t(t,e,n){void 0===n&&(n=null),this.writes_=t,this.viewCache_=e,this.optCompleteServerCache_=n}return t.prototype.getCompleteChild=function(t){var e=this.viewCache_.getEventCache();if(e.isCompleteForChild(t))return e.getNode().getImmediateChild(t);var n=null!=this.optCompleteServerCache_?new r.CacheNode(this.optCompleteServerCache_,!0,!1):this.viewCache_.getServerCache();return this.writes_.calcCompleteChild(t,n)},t.prototype.getChildAfterChild=function(t,e,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:this.viewCache_.getCompleteServerSnap(),i=this.writes_.calcIndexedSlice(r,e,1,n,t);return 0===i.length?null:i[0]},t}();e.WriteTreeCompleteChildSource=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(29),i=n(74),o=n(1),a=function(){function t(t){this.query_=t,this.index_=this.query_.getQueryParams().getIndex()}return t.prototype.generateEventsForChanges=function(t,e,n){var r=this,o=[],a=[];return t.forEach(function(t){t.type===i.Change.CHILD_CHANGED&&r.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&a.push(i.Change.childMovedChange(t.childName,t.snapshotNode))}),this.generateEventsForType_(o,i.Change.CHILD_REMOVED,t,n,e),this.generateEventsForType_(o,i.Change.CHILD_ADDED,t,n,e),this.generateEventsForType_(o,i.Change.CHILD_MOVED,a,n,e),this.generateEventsForType_(o,i.Change.CHILD_CHANGED,t,n,e),this.generateEventsForType_(o,i.Change.VALUE,t,n,e),o},t.prototype.generateEventsForType_=function(t,e,n,r,i){var o=this,a=n.filter(function(t){return t.type===e});a.sort(this.compareChanges_.bind(this)),a.forEach(function(e){var n=o.materializeSingleChange_(e,i);r.forEach(function(r){r.respondsTo(e.type)&&t.push(r.createEvent(n,o.query_))})})},t.prototype.materializeSingleChange_=function(t,e){return"value"===t.type||"child_removed"===t.type?t:(t.prevName=e.getPredecessorChildName(t.childName,t.snapshotNode,this.index_),t)},t.prototype.compareChanges_=function(t,e){if(null==t.childName||null==e.childName)throw o.assertionError("Should only compare child_ events.");var n=new r.NamedNode(t.childName,t.snapshotNode),i=new r.NamedNode(e.childName,e.snapshotNode);return this.index_.compare(n,i)},t}();e.EventGenerator=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=n(1),o=n(13),a=n(537),s=n(19),u=n(24),c=function(){function t(){this.visibleWrites_=a.CompoundWrite.Empty,this.allWrites_=[],this.lastWriteId_=-1}return t.prototype.childWrites=function(t){return new l(t,this)},t.prototype.addOverwrite=function(t,e,n,r){i.assert(n>this.lastWriteId_,"Stacking an older write on top of newer ones"),void 0===r&&(r=!0),this.allWrites_.push({path:t,snap:e,writeId:n,visible:r}),r&&(this.visibleWrites_=this.visibleWrites_.addWrite(t,e)),this.lastWriteId_=n},t.prototype.addMerge=function(t,e,n){i.assert(n>this.lastWriteId_,"Stacking an older merge on top of newer ones"),this.allWrites_.push({path:t,children:e,writeId:n,visible:!0}),this.visibleWrites_=this.visibleWrites_.addWrites(t,e),this.lastWriteId_=n},t.prototype.getWrite=function(t){for(var e=0;e<this.allWrites_.length;e++){var n=this.allWrites_[e];if(n.writeId===t)return n}return null},t.prototype.removeWrite=function(t){var e=this,n=this.allWrites_.findIndex(function(e){return e.writeId===t});i.assert(n>=0,"removeWrite called with nonexistent writeId.");var o=this.allWrites_[n];this.allWrites_.splice(n,1);for(var a=o.visible,s=!1,u=this.allWrites_.length-1;a&&u>=0;){var c=this.allWrites_[u];c.visible&&(u>=n&&this.recordContainsPath_(c,o.path)?a=!1:o.path.contains(c.path)&&(s=!0)),u--}if(a){if(s)return this.resetTree_(),!0;if(o.snap)this.visibleWrites_=this.visibleWrites_.removeWrite(o.path);else{var l=o.children;r.forEach(l,function(t){e.visibleWrites_=e.visibleWrites_.removeWrite(o.path.child(t))})}return!0}return!1},t.prototype.getCompleteWriteData=function(t){return this.visibleWrites_.getCompleteNode(t)},t.prototype.calcCompleteEventCache=function(e,n,r,i){if(r||i){var a=this.visibleWrites_.childCompoundWrite(e);if(!i&&a.isEmpty())return n;if(i||null!=n||a.hasCompleteWrite(o.Path.Empty)){var s=t.layerTree_(this.allWrites_,function(t){return(t.visible||i)&&(!r||!~r.indexOf(t.writeId))&&(t.path.contains(e)||e.contains(t.path))},e),c=n||u.ChildrenNode.EMPTY_NODE;return s.apply(c)}return null}var l=this.visibleWrites_.getCompleteNode(e);if(null!=l)return l;var h=this.visibleWrites_.childCompoundWrite(e);if(h.isEmpty())return n;if(null!=n||h.hasCompleteWrite(o.Path.Empty)){c=n||u.ChildrenNode.EMPTY_NODE;return h.apply(c)}return null},t.prototype.calcCompleteEventChildren=function(t,e){var n=u.ChildrenNode.EMPTY_NODE,r=this.visibleWrites_.getCompleteNode(t);if(r)return r.isLeafNode()||r.forEachChild(s.PRIORITY_INDEX,function(t,e){n=n.updateImmediateChild(t,e)}),n;if(e){var i=this.visibleWrites_.childCompoundWrite(t);return e.forEachChild(s.PRIORITY_INDEX,function(t,e){var r=i.childCompoundWrite(new o.Path(t)).apply(e);n=n.updateImmediateChild(t,r)}),i.getCompleteChildren().forEach(function(t){n=n.updateImmediateChild(t.name,t.node)}),n}return this.visibleWrites_.childCompoundWrite(t).getCompleteChildren().forEach(function(t){n=n.updateImmediateChild(t.name,t.node)}),n},t.prototype.calcEventCacheAfterServerOverwrite=function(t,e,n,r){i.assert(n||r,"Either existingEventSnap or existingServerSnap must exist");var o=t.child(e);if(this.visibleWrites_.hasCompleteWrite(o))return null;var a=this.visibleWrites_.childCompoundWrite(o);return a.isEmpty()?r.getChild(e):a.apply(r.getChild(e))},t.prototype.calcCompleteChild=function(t,e,n){var r=t.child(e),i=this.visibleWrites_.getCompleteNode(r);return null!=i?i:n.isCompleteForChild(e)?this.visibleWrites_.childCompoundWrite(r).apply(n.getNode().getImmediateChild(e)):null},t.prototype.shadowingWrite=function(t){return this.visibleWrites_.getCompleteNode(t)},t.prototype.calcIndexedSlice=function(t,e,n,r,i,a){var s,u=this.visibleWrites_.childCompoundWrite(t),c=u.getCompleteNode(o.Path.Empty);if(null!=c)s=c;else{if(null==e)return[];s=u.apply(e)}if((s=s.withIndex(a)).isEmpty()||s.isLeafNode())return[];for(var l=[],h=a.getCompare(),f=i?s.getReverseIteratorFrom(n,a):s.getIteratorFrom(n,a),p=f.getNext();p&&l.length<r;)0!==h(p,n)&&l.push(p),p=f.getNext();return l},t.prototype.recordContainsPath_=function(t,e){return t.snap?t.path.contains(e):!!r.findKey(t.children,function(n,r){return t.path.child(r).contains(e)})},t.prototype.resetTree_=function(){this.visibleWrites_=t.layerTree_(this.allWrites_,t.DefaultFilter_,o.Path.Empty),this.allWrites_.length>0?this.lastWriteId_=this.allWrites_[this.allWrites_.length-1].writeId:this.lastWriteId_=-1},t.DefaultFilter_=function(t){return t.visible},t.layerTree_=function(t,e,n){for(var s=a.CompoundWrite.Empty,u=0;u<t.length;++u){var c=t[u];if(e(c)){var l=c.path,h=void 0;if(c.snap)n.contains(l)?(h=o.Path.relativePath(n,l),s=s.addWrite(h,c.snap)):l.contains(n)&&(h=o.Path.relativePath(l,n),s=s.addWrite(o.Path.Empty,c.snap.getChild(h)));else{if(!c.children)throw i.assertionError("WriteRecord should have .snap or .children");if(n.contains(l))h=o.Path.relativePath(n,l),s=s.addWrites(h,c.children);else if(l.contains(n))if((h=o.Path.relativePath(l,n)).isEmpty())s=s.addWrites(o.Path.Empty,c.children);else{var f=r.safeGet(c.children,h.getFront());if(f){var p=f.getChild(h.popFront());s=s.addWrite(o.Path.Empty,p)}}}}}return s},t}();e.WriteTree=c;var l=function(){function t(t,e){this.treePath_=t,this.writeTree_=e}return t.prototype.calcCompleteEventCache=function(t,e,n){return this.writeTree_.calcCompleteEventCache(this.treePath_,t,e,n)},t.prototype.calcCompleteEventChildren=function(t){return this.writeTree_.calcCompleteEventChildren(this.treePath_,t)},t.prototype.calcEventCacheAfterServerOverwrite=function(t,e,n){return this.writeTree_.calcEventCacheAfterServerOverwrite(this.treePath_,t,e,n)},t.prototype.shadowingWrite=function(t){return this.writeTree_.shadowingWrite(this.treePath_.child(t))},t.prototype.calcIndexedSlice=function(t,e,n,r,i){return this.writeTree_.calcIndexedSlice(this.treePath_,t,e,n,r,i)},t.prototype.calcCompleteChild=function(t,e){return this.writeTree_.calcCompleteChild(this.treePath_,t,e)},t.prototype.child=function(e){return new t(this.treePath_.child(e),this.writeTree_)},t}();e.WriteTreeRef=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(157),i=n(13),o=n(1),a=n(29),s=n(19),u=n(1),c=function(){function t(t){this.writeTree_=t}return t.prototype.addWrite=function(e,n){if(e.isEmpty())return new t(new r.ImmutableTree(n));var o=this.writeTree_.findRootMostValueAndPath(e);if(null!=o){var a=o.path,s=o.value,u=i.Path.relativePath(a,e);return s=s.updateChild(u,n),new t(this.writeTree_.set(a,s))}var c=new r.ImmutableTree(n);return new t(this.writeTree_.setTree(e,c))},t.prototype.addWrites=function(t,e){var n=this;return o.forEach(e,function(e,r){n=n.addWrite(t.child(e),r)}),n},t.prototype.removeWrite=function(e){return e.isEmpty()?t.Empty:new t(this.writeTree_.setTree(e,r.ImmutableTree.Empty))},t.prototype.hasCompleteWrite=function(t){return null!=this.getCompleteNode(t)},t.prototype.getCompleteNode=function(t){var e=this.writeTree_.findRootMostValueAndPath(t);return null!=e?this.writeTree_.get(e.path).getChild(i.Path.relativePath(e.path,t)):null},t.prototype.getCompleteChildren=function(){var t=[],e=this.writeTree_.value;return null!=e?e.isLeafNode()||e.forEachChild(s.PRIORITY_INDEX,function(e,n){t.push(new a.NamedNode(e,n))}):this.writeTree_.children.inorderTraversal(function(e,n){null!=n.value&&t.push(new a.NamedNode(e,n.value))}),t},t.prototype.childCompoundWrite=function(e){if(e.isEmpty())return this;var n=this.getCompleteNode(e);return new t(null!=n?new r.ImmutableTree(n):this.writeTree_.subtree(e))},t.prototype.isEmpty=function(){return this.writeTree_.isEmpty()},t.prototype.apply=function(e){return t.applySubtreeWrite_(i.Path.Empty,this.writeTree_,e)},t.Empty=new t(new r.ImmutableTree(null)),t.applySubtreeWrite_=function(e,n,r){if(null!=n.value)return r.updateChild(e,n.value);var i=null;return n.children.inorderTraversal(function(n,o){".priority"===n?(u.assert(null!==o.value,"Priority writes must always be leaf nodes"),i=o.value):r=t.applySubtreeWrite_(e.child(n),o,r)}),r.getChild(e).isEmpty()||null===i||(r=r.updateChild(e.child(".priority"),i)),r},t}();e.CompoundWrite=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(24),i=function(){function t(){this.rootNode_=r.ChildrenNode.EMPTY_NODE}return t.prototype.getNode=function(t){return this.rootNode_.getChild(t)},t.prototype.updateSnapshot=function(t,e){this.rootNode_=this.rootNode_.updateChild(t,e)},t}();e.SnapshotHolder=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(4),i=function(){function t(t){this.app_=t}return t.prototype.getToken=function(t){return this.app_.INTERNAL.getToken(t).then(null,function(t){return t&&"auth/token-not-initialized"===t.code?(r.log("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)})},t.prototype.addTokenChangeListener=function(t){this.app_.INTERNAL.addAuthTokenListener(t)},t.prototype.removeTokenChangeListener=function(t){this.app_.INTERNAL.removeAuthTokenListener(t)},t.prototype.notifyForInvalidToken=function(){var t='Provided authentication credentials for the app named "'+this.app_.name+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.app_.options?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.app_.options?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',r.warn(t)},t}();e.AuthTokenProvider=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=n(1),o=function(){function t(){this.counters_={}}return t.prototype.incrementCounter=function(t,e){void 0===e&&(e=1),i.contains(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=e},t.prototype.get=function(){return r.deepCopy(this.counters_)},t}();e.StatsCollection=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=n(4),o=n(233),a=1e4,s=3e4,u=function(){function t(t,e){this.server_=e,this.statsToReport_={},this.statsListener_=new o.StatsListener(t);var n=a+(s-a)*Math.random();i.setTimeoutNonBlocking(this.reportStats_.bind(this),Math.floor(n))}return t.prototype.includeStat=function(t){this.statsToReport_[t]=!0},t.prototype.reportStats_=function(){var t=this,e=this.statsListener_.get(),n={},o=!1;r.forEach(e,function(e,i){i>0&&r.contains(t.statsToReport_,e)&&(n[e]=i,o=!0)}),o&&this.server_.reportStats(n),i.setTimeoutNonBlocking(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))},t}();e.StatsReporter=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(4),i=function(){function t(){this.eventLists_=[],this.recursionDepth_=0}return t.prototype.queueEvents=function(t){for(var e=null,n=0;n<t.length;n++){var r=t[n],i=r.getPath();null===e||i.equals(e.getPath())||(this.eventLists_.push(e),e=null),null===e&&(e=new o(i)),e.add(r)}e&&this.eventLists_.push(e)},t.prototype.raiseEventsAtPath=function(t,e){this.queueEvents(e),this.raiseQueuedEventsMatchingPredicate_(function(e){return e.equals(t)})},t.prototype.raiseEventsForChangedPath=function(t,e){this.queueEvents(e),this.raiseQueuedEventsMatchingPredicate_(function(e){return e.contains(t)||t.contains(e)})},t.prototype.raiseQueuedEventsMatchingPredicate_=function(t){this.recursionDepth_++;for(var e=!0,n=0;n<this.eventLists_.length;n++){var r=this.eventLists_[n];r&&(t(r.getPath())?(this.eventLists_[n].raise(),this.eventLists_[n]=null):e=!1)}e&&(this.eventLists_=[]),this.recursionDepth_--},t}();e.EventQueue=i;var o=function(){function t(t){this.path_=t,this.events_=[]}return t.prototype.add=function(t){this.events_.push(t)},t.prototype.raise=function(){for(var t=0;t<this.events_.length;t++){var e=this.events_[t];if(null!==e){this.events_[t]=null;var n=e.getEventRunner();r.logger&&r.log("event: "+e.toString()),r.exceptionGuard(n)}}},t.prototype.getPath=function(){return this.path_},t}();e.EventList=o},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n(235),o=n(1),a=function(t){function e(){var e,n,r=t.call(this,["visible"])||this;return"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(n="visibilitychange",e="hidden"):void 0!==document.mozHidden?(n="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(n="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(n="webkitvisibilitychange",e="webkitHidden")),r.visible_=!0,n&&document.addEventListener(n,function(){var t=!document[e];t!==r.visible_&&(r.visible_=t,r.trigger("visible",t))},!1),r}return r(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return o.assert("visible"===t,"Unknown event type: "+t),[this.visible_]},e}(i.EventEmitter);e.VisibilityMonitor=a},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),o=n(235),a=n(1),s=function(t){function e(){var e=t.call(this,["online"])||this;return e.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||a.isMobileCordova()||(window.addEventListener("online",function(){e.online_||(e.online_=!0,e.trigger("online",!0))},!1),window.addEventListener("offline",function(){e.online_&&(e.online_=!1,e.trigger("online",!1))},!1)),e}return r(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return i.assert("online"===t,"Unknown event type: "+t),[this.online_]},e.prototype.currentlyOnline=function(){return this.online_},e}(o.EventEmitter);e.OnlineMonitor=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(237),i=n(238),o=n(4),a=function(){function t(t){this.initTransports_(t)}return Object.defineProperty(t,"ALL_TRANSPORTS",{get:function(){return[r.BrowserPollConnection,i.WebSocketConnection]},enumerable:!0,configurable:!0}),t.prototype.initTransports_=function(e){var n=i.WebSocketConnection&&i.WebSocketConnection.isAvailable(),r=n&&!i.WebSocketConnection.previouslyFailed();if(e.webSocketOnly&&(n||o.warn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[i.WebSocketConnection];else{var a=this.transports_=[];o.each(t.ALL_TRANSPORTS,function(t,e){e&&e.isAvailable()&&a.push(e)})}},t.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")},t.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},t}();e.TransportManager=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(4),i=function(){function t(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return t.prototype.closeAfter=function(t,e){this.closeAfterResponse=t,this.onClose=e,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},t.prototype.handleResponse=function(t,e){var n=this;this.pendingResponses[t]=e;for(var i=this;this.pendingResponses[this.currentResponseNum]&&"break"!==function(){var t=i.pendingResponses[i.currentResponseNum];delete i.pendingResponses[i.currentResponseNum];for(var e=0;e<t.length;++e)!function(e){t[e]&&r.exceptionGuard(function(){n.onMessage_(t[e])})}(e);if(i.currentResponseNum===i.closeAfterResponse)return i.onClose&&(i.onClose(),i.onClose=null),"break";i.currentResponseNum++}(););},t}();e.PacketReceiver=i},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),o=n(4),a=n(1),s=n(1),u=n(1),c=function(t){function e(e,n,r){var i=t.call(this)||this;return i.repoInfo_=e,i.onDataUpdate_=n,i.authTokenProvider_=r,i.log_=o.logWrapper("p:rest:"),i.listens_={},i}return r(e,t),e.prototype.reportStats=function(t){throw new Error("Method not implemented.")},e.getListenId_=function(t,e){return void 0!==e?"tag$"+e:(i.assert(t.getQueryParams().isDefault(),"should have a tag if it's not a default query."),t.path.toString())},e.prototype.listen=function(t,n,r,i){var o=this,a=t.path.toString();this.log_("Listen called for "+a+" "+t.queryIdentifier());var u=e.getListenId_(t,r),c={};this.listens_[u]=c;var l=t.getQueryParams().toRestQueryStringParameters();this.restRequest_(a+".json",l,function(t,e){var n=e;(404===t&&(n=null,t=null),null===t&&o.onDataUpdate_(a,n,!1,r),s.safeGet(o.listens_,u)===c)&&i(t?401==t?"permission_denied":"rest_error:"+t:"ok",null)})},e.prototype.unlisten=function(t,n){var r=e.getListenId_(t,n);delete this.listens_[r]},e.prototype.refreshAuthToken=function(t){},e.prototype.restRequest_=function(t,e,n){var r=this;void 0===e&&(e={}),e.format="export",this.authTokenProvider_.getToken(!1).then(function(i){var s=i&&i.accessToken;s&&(e.auth=s);var c=(r.repoInfo_.secure?"https://":"http://")+r.repoInfo_.host+t+"?"+u.querystring(e);r.log_("Sending REST request for "+c);var l=new XMLHttpRequest;l.onreadystatechange=function(){if(n&&4===l.readyState){r.log_("REST Response for "+c+" received. status:",l.status,"response:",l.responseText);var t=null;if(l.status>=200&&l.status<300){try{t=a.jsonEval(l.responseText)}catch(t){o.warn("Failed to parse JSON response for "+c+": "+l.responseText)}n(null,t)}else 401!==l.status&&404!==l.status&&o.warn("Got unsuccessful REST response for "+c+" Status: "+l.status),n(l.status);n=null}},l.open("GET",c,!0),l.send()})},e}(n(239).ServerActions);e.ReadonlyRestClient=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=n(4),o=n(81),a=n(19),s=n(222),u=n(226),c=n(158),l=n(549),h=n(240),f=n(1),p=function(){function t(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=a.PRIORITY_INDEX}return t.prototype.hasStart=function(){return this.startSet_},t.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:this.viewFrom_===t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT},t.prototype.getIndexStartValue=function(){return r.assert(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},t.prototype.getIndexStartName=function(){return r.assert(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:i.MIN_NAME},t.prototype.hasEnd=function(){return this.endSet_},t.prototype.getIndexEndValue=function(){return r.assert(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},t.prototype.getIndexEndName=function(){return r.assert(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:i.MAX_NAME},t.prototype.hasLimit=function(){return this.limitSet_},t.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},t.prototype.getLimit=function(){return r.assert(this.limitSet_,"Only valid if limit has been set"),this.limit_},t.prototype.getIndex=function(){return this.index_},t.prototype.copy_=function(){var e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e},t.prototype.limit=function(t){var e=this.copy_();return e.limitSet_=!0,e.limit_=t,e.viewFrom_="",e},t.prototype.limitToFirst=function(e){var n=this.copy_();return n.limitSet_=!0,n.limit_=e,n.viewFrom_=t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT,n},t.prototype.limitToLast=function(e){var n=this.copy_();return n.limitSet_=!0,n.limit_=e,n.viewFrom_=t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_RIGHT,n},t.prototype.startAt=function(t,e){var n=this.copy_();return n.startSet_=!0,void 0===t&&(t=null),n.indexStartValue_=t,null!=e?(n.startNameSet_=!0,n.indexStartName_=e):(n.startNameSet_=!1,n.indexStartName_=""),n},t.prototype.endAt=function(t,e){var n=this.copy_();return n.endSet_=!0,void 0===t&&(t=null),n.indexEndValue_=t,void 0!==e?(n.endNameSet_=!0,n.indexEndName_=e):(n.endNameSet_=!1,n.indexEndName_=""),n},t.prototype.orderBy=function(t){var e=this.copy_();return e.index_=t,e},t.prototype.getQueryObject=function(){var e=t.WIRE_PROTOCOL_CONSTANTS_,n={};if(this.startSet_&&(n[e.INDEX_START_VALUE]=this.indexStartValue_,this.startNameSet_&&(n[e.INDEX_START_NAME]=this.indexStartName_)),this.endSet_&&(n[e.INDEX_END_VALUE]=this.indexEndValue_,this.endNameSet_&&(n[e.INDEX_END_NAME]=this.indexEndName_)),this.limitSet_){n[e.LIMIT]=this.limit_;var r=this.viewFrom_;""===r&&(r=this.isViewFromLeft()?e.VIEW_FROM_LEFT:e.VIEW_FROM_RIGHT),n[e.VIEW_FROM]=r}return this.index_!==a.PRIORITY_INDEX&&(n[e.INDEX]=this.index_.toString()),n},t.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},t.prototype.isDefault=function(){return this.loadsAllData()&&this.index_==a.PRIORITY_INDEX},t.prototype.getNodeFilter=function(){return this.loadsAllData()?new c.IndexedFilter(this.getIndex()):this.hasLimit()?new l.LimitedFilter(this):new h.RangedFilter(this)},t.prototype.toRestQueryStringParameters=function(){var e,n=t.REST_QUERY_CONSTANTS_,i={};return this.isDefault()?i:(this.index_===a.PRIORITY_INDEX?e=n.PRIORITY_INDEX:this.index_===s.VALUE_INDEX?e=n.VALUE_INDEX:this.index_===o.KEY_INDEX?e=n.KEY_INDEX:(r.assert(this.index_ instanceof u.PathIndex,"Unrecognized index type!"),e=this.index_.toString()),i[n.ORDER_BY]=f.stringify(e),this.startSet_&&(i[n.START_AT]=f.stringify(this.indexStartValue_),this.startNameSet_&&(i[n.START_AT]+=","+f.stringify(this.indexStartName_))),this.endSet_&&(i[n.END_AT]=f.stringify(this.indexEndValue_),this.endNameSet_&&(i[n.END_AT]+=","+f.stringify(this.indexEndName_))),this.limitSet_&&(this.isViewFromLeft()?i[n.LIMIT_TO_FIRST]=this.limit_:i[n.LIMIT_TO_LAST]=this.limit_),i)},t.WIRE_PROTOCOL_CONSTANTS_={INDEX_START_VALUE:"sp",INDEX_START_NAME:"sn",INDEX_END_VALUE:"ep",INDEX_END_NAME:"en",LIMIT:"l",VIEW_FROM:"vf",VIEW_FROM_LEFT:"l",VIEW_FROM_RIGHT:"r",INDEX:"i"},t.REST_QUERY_CONSTANTS_={ORDER_BY:"orderBy",PRIORITY_INDEX:"$priority",VALUE_INDEX:"$value",KEY_INDEX:"$key",START_AT:"startAt",END_AT:"endAt",LIMIT_TO_FIRST:"limitToFirst",LIMIT_TO_LAST:"limitToLast"},t.DEFAULT=new t,t}();e.QueryParams=p},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(240),i=n(24),o=n(29),a=n(1),s=n(74),u=function(){function t(t){this.rangedFilter_=new r.RangedFilter(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft()}return t.prototype.updateChild=function(t,e,n,r,a,s){return this.rangedFilter_.matches(new o.NamedNode(e,n))||(n=i.ChildrenNode.EMPTY_NODE),t.getImmediateChild(e).equals(n)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,e,n,r,a,s):this.fullLimitUpdateChild_(t,e,n,a,s)},t.prototype.updateFullNode=function(t,e,n){var r;if(e.isLeafNode()||e.isEmpty())r=i.ChildrenNode.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<e.numChildren()&&e.isIndexed(this.index_)){r=i.ChildrenNode.EMPTY_NODE.withIndex(this.index_);var o=void 0;o=this.reverse_?e.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):e.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var a=0;o.hasNext()&&a<this.limit_;){var s=o.getNext();if(!(this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),s)<=0:this.index_.compare(s,this.rangedFilter_.getEndPost())<=0))break;r=r.updateImmediateChild(s.name,s.node),a++}}else{r=(r=e.withIndex(this.index_)).updatePriority(i.ChildrenNode.EMPTY_NODE);var u=void 0,c=void 0,l=void 0;o=void 0;if(this.reverse_){o=r.getReverseIterator(this.index_),u=this.rangedFilter_.getEndPost(),c=this.rangedFilter_.getStartPost();var h=this.index_.getCompare();l=function(t,e){return h(e,t)}}else o=r.getIterator(this.index_),u=this.rangedFilter_.getStartPost(),c=this.rangedFilter_.getEndPost(),l=this.index_.getCompare();a=0;for(var f=!1;o.hasNext();){s=o.getNext();!f&&l(u,s)<=0&&(f=!0),f&&a<this.limit_&&l(s,c)<=0?a++:r=r.updateImmediateChild(s.name,i.ChildrenNode.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},t.prototype.getIndex=function(){return this.index_},t.prototype.fullLimitUpdateChild_=function(t,e,n,r,u){var c;if(this.reverse_){var l=this.index_.getCompare();c=function(t,e){return l(e,t)}}else c=this.index_.getCompare();var h=t;a.assert(h.numChildren()==this.limit_,"");var f=new o.NamedNode(e,n),p=this.reverse_?h.getFirstChild(this.index_):h.getLastChild(this.index_),d=this.rangedFilter_.matches(f);if(h.hasChild(e)){for(var v=h.getImmediateChild(e),g=r.getChildAfterChild(this.index_,p,this.reverse_);null!=g&&(g.name==e||h.hasChild(g.name));)g=r.getChildAfterChild(this.index_,g,this.reverse_);var y=null==g?1:c(g,f);if(d&&!n.isEmpty()&&y>=0)return null!=u&&u.trackChildChange(s.Change.childChangedChange(e,n,v)),h.updateImmediateChild(e,n);null!=u&&u.trackChildChange(s.Change.childRemovedChange(e,v));var m=h.updateImmediateChild(e,i.ChildrenNode.EMPTY_NODE);return null!=g&&this.rangedFilter_.matches(g)?(null!=u&&u.trackChildChange(s.Change.childAddedChange(g.name,g.node)),m.updateImmediateChild(g.name,g.node)):m}return n.isEmpty()?t:d&&c(p,f)>=0?(null!=u&&(u.trackChildChange(s.Change.childRemovedChange(p.name,p.node)),u.trackChildChange(s.Change.childAddedChange(e,n))),h.updateImmediateChild(e,n).updateImmediateChild(p.name,i.ChildrenNode.EMPTY_NODE)):t},t}();e.LimitedFilter=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(1),o=n(155),a=n(156),s=n(13),u=n(551),c=n(19),l=n(4),h=n(227),f=n(63),p=n(1),d=n(82),v=n(24),g=n(110);!function(t){t[t.RUN=0]="RUN",t[t.SENT=1]="SENT",t[t.COMPLETED=2]="COMPLETED",t[t.SENT_NEEDS_ABORT=3]="SENT_NEEDS_ABORT",t[t.NEEDS_ABORT=4]="NEEDS_ABORT"}(r=e.TransactionStatus||(e.TransactionStatus={})),g.Repo.MAX_TRANSACTION_RETRIES_=25,g.Repo.prototype.transactions_init_=function(){this.transactionQueueTree_=new u.Tree},g.Repo.prototype.startTransaction=function(t,e,n,s){this.log_("transaction on "+t);var u=function(){},g=new o.Reference(this,t);g.on("value",u);var y={path:t,update:e,onComplete:n,status:null,order:l.LUIDGenerator(),applyLocally:s,retryCount:0,unwatcher:function(){g.off("value",u)},abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},m=this.getLatestState_(t);y.currentInputSnapshot=m;var _=y.update(m.val());if(void 0===_){if(y.unwatcher(),y.currentOutputSnapshotRaw=null,y.currentOutputSnapshotResolved=null,y.onComplete){var b=new a.DataSnapshot(y.currentInputSnapshot,new o.Reference(this,y.path),c.PRIORITY_INDEX);y.onComplete(null,!1,b)}}else{f.validateFirebaseData("transaction failed: Data returned ",_,y.path),y.status=r.RUN;var E=this.transactionQueueTree_.subTree(t),w=E.getValue()||[];w.push(y),E.setValue(w);var S=void 0;"object"==typeof _&&null!==_&&p.contains(_,".priority")?(S=p.safeGet(_,".priority"),i.assert(f.isValidPriority(S),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):S=(this.serverSyncTree_.calcCompleteEventCache(t)||v.ChildrenNode.EMPTY_NODE).getPriority().val(),S=S;var T=this.generateServerValues(),I=d.nodeFromJSON(_,S),A=h.resolveDeferredValueSnapshot(I,T);y.currentOutputSnapshotRaw=I,y.currentOutputSnapshotResolved=A,y.currentWriteId=this.getNextWriteId_();var O=this.serverSyncTree_.applyUserOverwrite(t,A,y.currentWriteId,y.applyLocally);this.eventQueue_.raiseEventsForChangedPath(t,O),this.sendReadyTransactions_()}},g.Repo.prototype.getLatestState_=function(t,e){return this.serverSyncTree_.calcCompleteEventCache(t,e)||v.ChildrenNode.EMPTY_NODE},g.Repo.prototype.sendReadyTransactions_=function(t){var e=this;if(void 0===t&&(t=this.transactionQueueTree_),t||this.pruneCompletedTransactionsBelowNode_(t),null!==t.getValue()){var n=this.buildTransactionQueue_(t);i.assert(n.length>0,"Sending zero length transaction queue"),n.every(function(t){return t.status===r.RUN})&&this.sendTransactionQueue_(t.path(),n)}else t.hasChildren()&&t.forEachChild(function(t){e.sendReadyTransactions_(t)})},g.Repo.prototype.sendTransactionQueue_=function(t,e){for(var n=this,u=e.map(function(t){return t.currentWriteId}),h=this.getLatestState_(t,u),f=h,p=h.hash(),d=0;d<e.length;d++){var v=e[d];i.assert(v.status===r.RUN,"tryToSendTransactionQueue_: items in queue should all be run."),v.status=r.SENT,v.retryCount++;var g=s.Path.relativePath(t,v.path);f=f.updateChild(g,v.currentOutputSnapshotRaw)}var y=f.val(!0),m=t;this.server_.put(m.toString(),y,function(i){n.log_("transaction put response",{path:m.toString(),status:i});var s=[];if("ok"===i){for(var u=[],h=0;h<e.length;h++){if(e[h].status=r.COMPLETED,s=s.concat(n.serverSyncTree_.ackUserWrite(e[h].currentWriteId)),e[h].onComplete){var f=e[h].currentOutputSnapshotResolved,p=new o.Reference(n,e[h].path),d=new a.DataSnapshot(f,p,c.PRIORITY_INDEX);u.push(e[h].onComplete.bind(null,null,!0,d))}e[h].unwatcher()}n.pruneCompletedTransactionsBelowNode_(n.transactionQueueTree_.subTree(t)),n.sendReadyTransactions_(),n.eventQueue_.raiseEventsForChangedPath(t,s);for(h=0;h<u.length;h++)l.exceptionGuard(u[h])}else{if("datastale"===i)for(h=0;h<e.length;h++)e[h].status===r.SENT_NEEDS_ABORT?e[h].status=r.NEEDS_ABORT:e[h].status=r.RUN;else{l.warn("transaction at "+m.toString()+" failed: "+i);for(h=0;h<e.length;h++)e[h].status=r.NEEDS_ABORT,e[h].abortReason=i}n.rerunTransactions_(t)}},p)},g.Repo.prototype.rerunTransactions_=function(t){var e=this.getAncestorTransactionNode_(t),n=e.path(),r=this.buildTransactionQueue_(e);return this.rerunTransactionQueue_(r,n),n},g.Repo.prototype.rerunTransactionQueue_=function(t,e){if(0!==t.length){for(var n=[],u=[],v=t.filter(function(t){return t.status===r.RUN}).map(function(t){return t.currentWriteId}),y=0;y<t.length;y++){var m=t[y],_=s.Path.relativePath(e,m.path),b=!1,E=void 0;if(i.assert(null!==_,"rerunTransactionsUnderNode_: relativePath should not be null."),m.status===r.NEEDS_ABORT)b=!0,E=m.abortReason,u=u.concat(this.serverSyncTree_.ackUserWrite(m.currentWriteId,!0));else if(m.status===r.RUN)if(m.retryCount>=g.Repo.MAX_TRANSACTION_RETRIES_)b=!0,E="maxretry",u=u.concat(this.serverSyncTree_.ackUserWrite(m.currentWriteId,!0));else{var w=this.getLatestState_(m.path,v);m.currentInputSnapshot=w;var S=t[y].update(w.val());if(void 0!==S){f.validateFirebaseData("transaction failed: Data returned ",S,m.path);var T=d.nodeFromJSON(S);"object"==typeof S&&null!=S&&p.contains(S,".priority")||(T=T.updatePriority(w.getPriority()));var I=m.currentWriteId,A=this.generateServerValues(),O=h.resolveDeferredValueSnapshot(T,A);m.currentOutputSnapshotRaw=T,m.currentOutputSnapshotResolved=O,m.currentWriteId=this.getNextWriteId_(),v.splice(v.indexOf(I),1),u=(u=u.concat(this.serverSyncTree_.applyUserOverwrite(m.path,O,m.currentWriteId,m.applyLocally))).concat(this.serverSyncTree_.ackUserWrite(I,!0))}else b=!0,E="nodata",u=u.concat(this.serverSyncTree_.ackUserWrite(m.currentWriteId,!0))}if(this.eventQueue_.raiseEventsForChangedPath(e,u),u=[],b&&(t[y].status=r.COMPLETED,function(t){setTimeout(t,Math.floor(0))}(t[y].unwatcher),t[y].onComplete))if("nodata"===E){var C=new o.Reference(this,t[y].path),R=t[y].currentInputSnapshot,N=new a.DataSnapshot(R,C,c.PRIORITY_INDEX);n.push(t[y].onComplete.bind(null,null,!1,N))}else n.push(t[y].onComplete.bind(null,new Error(E),!1,null))}this.pruneCompletedTransactionsBelowNode_(this.transactionQueueTree_);for(y=0;y<n.length;y++)l.exceptionGuard(n[y]);this.sendReadyTransactions_()}},g.Repo.prototype.getAncestorTransactionNode_=function(t){for(var e,n=this.transactionQueueTree_;null!==(e=t.getFront())&&null===n.getValue();)n=n.subTree(e),t=t.popFront();return n},g.Repo.prototype.buildTransactionQueue_=function(t){var e=[];return this.aggregateTransactionQueuesForNode_(t,e),e.sort(function(t,e){return t.order-e.order}),e},g.Repo.prototype.aggregateTransactionQueuesForNode_=function(t,e){var n=this,r=t.getValue();if(null!==r)for(var i=0;i<r.length;i++)e.push(r[i]);t.forEachChild(function(t){n.aggregateTransactionQueuesForNode_(t,e)})},g.Repo.prototype.pruneCompletedTransactionsBelowNode_=function(t){var e=this,n=t.getValue();if(n){for(var i=0,o=0;o<n.length;o++)n[o].status!==r.COMPLETED&&(n[i]=n[o],i++);n.length=i,t.setValue(n.length>0?n:null)}t.forEachChild(function(t){e.pruneCompletedTransactionsBelowNode_(t)})},g.Repo.prototype.abortTransactions_=function(t){var e=this,n=this.getAncestorTransactionNode_(t).path(),r=this.transactionQueueTree_.subTree(t);return r.forEachAncestor(function(t){e.abortTransactionsOnNode_(t)}),this.abortTransactionsOnNode_(r),r.forEachDescendant(function(t){e.abortTransactionsOnNode_(t)}),n},g.Repo.prototype.abortTransactionsOnNode_=function(t){var e=t.getValue();if(null!==e){for(var n=[],o=[],a=-1,s=0;s<e.length;s++)e[s].status===r.SENT_NEEDS_ABORT||(e[s].status===r.SENT?(i.assert(a===s-1,"All SENT items should be at beginning of queue."),a=s,e[s].status=r.SENT_NEEDS_ABORT,e[s].abortReason="set"):(i.assert(e[s].status===r.RUN,"Unexpected transaction status in abort"),e[s].unwatcher(),o=o.concat(this.serverSyncTree_.ackUserWrite(e[s].currentWriteId,!0)),e[s].onComplete&&n.push(e[s].onComplete.bind(null,new Error("set"),!1,null))));-1===a?t.setValue(null):e.length=a+1,this.eventQueue_.raiseEventsForChangedPath(t.path(),o);for(s=0;s<n.length;s++)l.exceptionGuard(n[s])}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=n(13),o=n(1),a=function(){return function(){this.children={},this.childCount=0,this.value=null}}();e.TreeNode=a;var s=function(){function t(t,e,n){void 0===t&&(t=""),void 0===e&&(e=null),void 0===n&&(n=new a),this.name_=t,this.parent_=e,this.node_=n}return t.prototype.subTree=function(e){for(var n,r=e instanceof i.Path?e:new i.Path(e),s=this;null!==(n=r.getFront());)s=new t(n,s,o.safeGet(s.node_.children,n)||new a),r=r.popFront();return s},t.prototype.getValue=function(){return this.node_.value},t.prototype.setValue=function(t){r.assert(void 0!==t,"Cannot set value to undefined"),this.node_.value=t,this.updateParents_()},t.prototype.clear=function(){this.node_.value=null,this.node_.children={},this.node_.childCount=0,this.updateParents_()},t.prototype.hasChildren=function(){return this.node_.childCount>0},t.prototype.isEmpty=function(){return null===this.getValue()&&!this.hasChildren()},t.prototype.forEachChild=function(e){var n=this;o.forEach(this.node_.children,function(r,i){e(new t(r,n,i))})},t.prototype.forEachDescendant=function(t,e,n){e&&!n&&t(this),this.forEachChild(function(e){e.forEachDescendant(t,!0,n)}),e&&n&&t(this)},t.prototype.forEachAncestor=function(t,e){for(var n=e?this:this.parent();null!==n;){if(t(n))return!0;n=n.parent()}return!1},t.prototype.forEachImmediateDescendantWithValue=function(t){this.forEachChild(function(e){null!==e.getValue()?t(e):e.forEachImmediateDescendantWithValue(t)})},t.prototype.path=function(){return new i.Path(null===this.parent_?this.name_:this.parent_.path()+"/"+this.name_)},t.prototype.name=function(){return this.name_},t.prototype.parent=function(){return this.parent_},t.prototype.updateParents_=function(){null!==this.parent_&&this.parent_.updateChild_(this.name_,this)},t.prototype.updateChild_=function(t,e){var n=e.isEmpty(),r=o.contains(this.node_.children,t);n&&r?(delete this.node_.children[t],this.node_.childCount--,this.updateParents_()):n||r||(this.node_.children[t]=e.node_,this.node_.childCount++,this.updateParents_())},t}();e.Tree=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(238),i=n(237);e.forceLongPolling=function(){r.WebSocketConnection.forceDisallow(),i.BrowserPollConnection.forceAllow()},e.forceWebSockets=function(){i.BrowserPollConnection.forceDisallow()},e.isWebSocketsAvailable=function(){return r.WebSocketConnection.isAvailable()},e.setSecurityDebugCallback=function(t,e){t.repo.persistentConnection_.securityDebugCallback_=e},e.stats=function(t,e){t.repo.stats(e)},e.statsIncrementCounter=function(t,e){t.repo.statsIncrementCounter(e)},e.dataUpdateCount=function(t){return t.repo.dataUpdateCount},e.interceptServerData=function(t,e){return t.repo.interceptServerData_(e)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(218),i=n(234),o=n(160),a=n(236);e.DataConnection=i.PersistentConnection,i.PersistentConnection.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)},i.PersistentConnection.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)},e.RealTimeConnection=a.Connection,e.hijackHash=function(t){var e=i.PersistentConnection.prototype.put;return i.PersistentConnection.prototype.put=function(n,r,i,o){void 0!==o&&(o=t()),e.call(this,n,r,i,o)},function(){i.PersistentConnection.prototype.put=e}},e.ConnectionTarget=r.RepoInfo,e.queryIdentifier=function(t){return t.queryIdentifier()},e.listens=function(t){return t.repo.persistentConnection_.listens_},e.forceRestClient=function(t){o.RepoManager.getInstance().forceRestClient(t)}},function(t,e,n){n(740)},function(t,e,n){n(738)},function(t,e,n){"use strict";function r(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function i(t){return"string"!=typeof t&&(t=String(t)),t}function o(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return y.iterable&&(e[Symbol.iterator]=function(){return e}),e}function a(t){this.map={},t instanceof a?t.forEach(function(t,e){this.append(e,t)},this):Array.isArray(t)?t.forEach(function(t){this.append(t[0],t[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function s(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function u(t){return new Promise(function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}})}function c(t){var e=new FileReader,n=u(e);return e.readAsArrayBuffer(t),n}function l(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function h(){return this.bodyUsed=!1,this._initBody=function(t){this._bodyInit=t,t?"string"==typeof t?this._bodyText=t:y.blob&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:y.formData&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:y.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():y.arrayBuffer&&y.blob&&function(t){return t&&DataView.prototype.isPrototypeOf(t)}(t)?(this._bodyArrayBuffer=l(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):y.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(t)||_(t))?this._bodyArrayBuffer=l(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):y.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},y.blob&&(this.blob=function(){var t=s(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?s(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(c)}),this.text=function(){var t=s(this);if(t)return t;if(this._bodyBlob)return function(t){var e=new FileReader,n=u(e);return e.readAsText(t),n}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),n=new Array(e.length),r=0;r<e.length;r++)n[r]=String.fromCharCode(e[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},y.formData&&(this.formData=function(){return this.text().then(p)}),this.json=function(){return this.text().then(JSON.parse)},this}function f(t,e){var n=(e=e||{}).body;if(t instanceof f){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new a(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,n||null==t._bodyInit||(n=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",!e.headers&&this.headers||(this.headers=new a(e.headers)),this.method=function(t){var e=t.toUpperCase();return b.indexOf(e)>-1?e:t}(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function p(t){var e=new FormData;return t.trim().split("&").forEach(function(t){if(t){var n=t.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(r),decodeURIComponent(i))}}),e}function d(t){var e=new a;return t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(t){var n=t.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();e.append(r,i)}}),e}function v(t,e){e||(e={}),this.type="default",this.status=void 0===e.status?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new a(e.headers),this.url=e.url||"",this._initBody(t)}function g(t,e){return new Promise(function(n,r){function i(){a.abort()}var o=new f(t,e);if(o.signal&&o.signal.aborted)return r(new w("Aborted","AbortError"));var a=new XMLHttpRequest;a.onload=function(){var t={status:a.status,statusText:a.statusText,headers:d(a.getAllResponseHeaders()||"")};t.url="responseURL"in a?a.responseURL:t.headers.get("X-Request-URL");var e="response"in a?a.response:a.responseText;n(new v(e,t))},a.onerror=function(){r(new TypeError("Network request failed"))},a.ontimeout=function(){r(new TypeError("Network request failed"))},a.onabort=function(){r(new w("Aborted","AbortError"))},a.open(o.method,o.url,!0),"include"===o.credentials?a.withCredentials=!0:"omit"===o.credentials&&(a.withCredentials=!1),"responseType"in a&&y.blob&&(a.responseType="blob"),o.headers.forEach(function(t,e){a.setRequestHeader(e,t)}),o.signal&&(o.signal.addEventListener("abort",i),a.onreadystatechange=function(){4===a.readyState&&o.signal.removeEventListener("abort",i)}),a.send(void 0===o._bodyInit?null:o._bodyInit)})}n.r(e),n.d(e,"Headers",function(){return a}),n.d(e,"Request",function(){return f}),n.d(e,"Response",function(){return v}),n.d(e,"DOMException",function(){return w}),n.d(e,"fetch",function(){return g});var y={searchParams:"URLSearchParams"in self,iterable:"Symbol"in self&&"iterator"in Symbol,blob:"FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in self,arrayBuffer:"ArrayBuffer"in self};if(y.arrayBuffer)var m=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],_=ArrayBuffer.isView||function(t){return t&&m.indexOf(Object.prototype.toString.call(t))>-1};a.prototype.append=function(t,e){t=r(t),e=i(e);var n=this.map[t];this.map[t]=n?n+", "+e:e},a.prototype.delete=function(t){delete this.map[r(t)]},a.prototype.get=function(t){return t=r(t),this.has(t)?this.map[t]:null},a.prototype.has=function(t){return this.map.hasOwnProperty(r(t))},a.prototype.set=function(t,e){this.map[r(t)]=i(e)},a.prototype.forEach=function(t,e){for(var n in this.map)this.map.hasOwnProperty(n)&&t.call(e,this.map[n],n,this)},a.prototype.keys=function(){var t=[];return this.forEach(function(e,n){t.push(n)}),o(t)},a.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),o(t)},a.prototype.entries=function(){var t=[];return this.forEach(function(e,n){t.push([n,e])}),o(t)},y.iterable&&(a.prototype[Symbol.iterator]=a.prototype.entries);var b=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];f.prototype.clone=function(){return new f(this,{body:this._bodyInit})},h.call(f.prototype),h.call(v.prototype),v.prototype.clone=function(){return new v(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new a(this.headers),url:this.url})},v.error=function(){var t=new v(null,{status:0,statusText:""});return t.type="error",t};var E=[301,302,303,307,308];v.redirect=function(t,e){if(-1===E.indexOf(e))throw new RangeError("Invalid status code");return new v(null,{status:e,headers:{location:t}})};var w=self.DOMException;try{new w}catch(t){(w=function(t,e){this.message=t,this.name=e;var n=Error(t);this.stack=n.stack}).prototype=Object.create(Error.prototype),w.prototype.constructor=w}g.polyfill=!0,self.fetch||(self.fetch=g,self.Headers=a,self.Request=f,self.Response=v)},function(t,e,n){"use strict";var r=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});var i=n(40);e.UserAsyncFunction={setFreePremiumAsync:function(t,e,n){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){var o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return o=t+"apis/users/freePremium?token="+e+"&month="+n,r.next=3,i(o);case 3:return r.abrupt("return",r.sent);case 4:case"end":return r.stop()}},r,this)}))},sendPaidEmailAsync:function(t,e,n){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){var o,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return o={email:e,senderDisplayName:n},a=t+"apis/mails",r.next=4,i(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});case 4:r.sent;case 5:case"end":return r.stop()}},r,this)}))},sendCollaborationInvitationAsync:function(t,e,n,o,a,s){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){var u,c,l;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return u={email:o,collectionTitle:a,senderDisplayName:s},c=t+"apis/folders/"+n+"/collaboration/invite?token="+e,r.next=4,i(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)});case 4:return l=r.sent,r.next=7,l;case 7:return r.abrupt("return",r.sent);case 8:case"end":return r.stop()}},r,this)}))},cancelCollaborationInvitationsAsync:function(t,e,n,o){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){var a,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return a={emails:o},s=t+"apis/folders/"+n+"/collaboration/invite?token="+e,r.next=4,i(s,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});case 4:return u=r.sent,r.next=7,u.json();case 7:return r.abrupt("return",r.sent);case 8:case"end":return r.stop()}},r,this)}))},removeCollaboratorsAsync:function(t,e,n,o){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){var a,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return a={uids:o},s=t+"apis/folders/"+n+"/collaboration?token="+e,r.next=4,i(s,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});case 4:return u=r.sent,r.next=7,u.json();case 7:return r.abrupt("return",r.sent);case 8:case"end":return r.stop()}},r,this)}))},queryCollaborationinvitationInfoAsync:function(t,e){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function n(){var r,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t+"apis/users/folders/invitations?token="+e,n.next=3,i(r,{method:"GET",headers:{"Content-Type":"application/json"}});case 3:return o=n.sent,n.next=6,o.json();case 6:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}},n,this)}))}}},function(t,e,n){"use strict";var r=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});var i=n(15),o=n(50),a=n(103),s=n(559),u=n(112),c=(n(44),n(562)),l=n(40);e.editFolderOrdersAsync=function(t,e,n){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){var s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return s={},n.forEach(function(n,r){var i=o.getPathFromFolderTree(e.get("folderMetaMap",void 0),n);i&&(s["users/"+t.uid+"/"+i.toArray().join("/")+"/order"]=r)}),s=o.objectUndefinedToNull(s),a.weavaFirebaseLogger.updateFolderOrderingLog(s),r.abrupt("return",i.database().ref("/").update(s));case 5:case"end":return r.stop()}},r,this)}))},e.createFolderAsync=function(t,e,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"root";return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){var s,c,h;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return s=generatePushID(),c={newFolderId:s,data:{title:n,createDate:i.database.ServerValue.TIMESTAMP}},"root"===o?u.TrackerAsyncFunction.trackUsageStat("createFolderCount",1):u.TrackerAsyncFunction.trackUsageStat("createSubFolderCount",1),a.weavaFirebaseLogger.createFolderLog(c),h=t+"apis/folders/"+o+"?token="+e,r.next=7,l(h,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});case 7:return r.abrupt("return",s);case 8:case"end":return r.stop()}},r,this)}))},e.createDefaultFolderAsync=function(t,n){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.createFolderAsync(t,n,"My Research Folder");case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},r,this)}))},e.createSampleFolderAsync=function(t,n,a){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){var s,u,l,h,f;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.createFolderAsync(t,n,"(Sample Folder)");case 2:return s=r.sent,e.createFolderAsync(t,n,"(Sub-folder)",s),u=generatePushID(),"https://cdn-static-1.medium.com/_/fp/icons/favicon-medium.TAS6uQ-Y7kcKgi0xjcYHXw.ico",h="https://medium.com/weava/the-weava-manual-906f8eb719cf","The Weava Manual",(l={})["folders/"+s+"/websiteIds/"+u]={url:UrlUtil.getOriginalUrlForPDF(h),createDate:i.database.ServerValue.TIMESTAMP},(f={})[a.uid]="owner",l["websites/"+u]={accessRight:f,title:"The Weava Manual",url:UrlUtil.getOriginalUrlForPDF(h),favIconUrl:"https://cdn-static-1.medium.com/_/fp/icons/favicon-medium.TAS6uQ-Y7kcKgi0xjcYHXw.ico",createDate:i.database.ServerValue.TIMESTAMP,highlights:c},l=o.objectUndefinedToNull(l),r.abrupt("return",i.database().ref("/").update(l));case 15:case"end":return r.stop()}},r,this)}))},e.switchFolderAsync=function(t,e,n){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){var s,u,c;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(s=o.getPathFromFolderTree(e,n))){r.next=7;break}return(u=s.toArray()).splice(0,1),c=u.join("/").replace(/folderMetaMap/g,"folderIds"),a.weavaFirebaseLogger.switchFolderLog(c),r.abrupt("return",i.database().ref("users/"+t.uid+"/folderIds/activeFolderPath").set(c));case 7:case"end":return r.stop()}},r,this)}))},e.updateRootFolderOrderingAsync=function(t,e){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",i.database().ref("users/"+t.uid+"/folderIds/rootFolderOrdering").set(o.objectUndefinedToNull(e)));case 1:case"end":return n.stop()}},n,this)}))},e.queryFolderCollaborationInfoAsync=function(t,e,n){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){var i,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=t+"apis/folders/"+n+"/collaboration?token="+e,r.next=3,l(i,{method:"GET",headers:{"Content-Type":"application/json"}});case 3:return o=r.sent,r.next=6,o.json();case 6:return r.abrupt("return",r.sent);case 7:case"end":return r.stop()}},r,this)}))},e.editFolderAsync=function(t,e,n,i,o,s){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){var c;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return a.weavaFirebaseLogger.editFolderLog({folderId:n,title:i,colorTags:o,colorCodes:s}),c=t+"apis/folders/"+n+"?token="+e,u.TrackerAsyncFunction.trackUsageStat("editFolderCount",1),r.abrupt("return",l(c,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:i,colorTags:o,colorCodes:s})}));case 4:case"end":return r.stop()}},r,this)}))},e.deleteFolderAsync=function(t,e,n){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return a.weavaFirebaseLogger.deleteFolderLog(n),i=t+"apis/folders/"+n+"?token="+e,r.next=4,l(i,{method:"DELETE"});case 4:401===r.sent.status&&alert("Only owner can delete a folder.");case 6:case"end":return r.stop()}},r,this)}))},e.searchInFolderAsync=function(t,e,n,i,o){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){var a,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return a=t+"apis/search?token="+e+"&folderId="+n+"&searchStr="+i+"&colorFilters="+o,r.next=3,l(a);case 3:return r.next=5,r.sent.json();case 5:return s=r.sent,r.abrupt("return",s);case 7:case"end":return r.stop()}},r,this)}))},e.subscribeFolderIdsAsync=function(t,n){e.unSubscribeFolderIdsAsync(t),a.weavaFirebaseLogger.subscribeFolderIdsLog();var r="users/"+t.uid+"/folderIds/";i.database().ref(r).on("value",function(t){a.weavaFirebaseLogger.folderIdsUpdatedLog(t.val()),n(t.val())})},e.unSubscribeFolderIdsAsync=function(t){a.weavaFirebaseLogger.unSubscribeFolderIdsLog();var e="users/"+t.uid+"/folderIds/";i.database().ref(e).off()},e.unSubscribeActiveFolderAsync=function(){},e.subscribeActiveFolderAsync=function(t,n,r){e.unSubscribeActiveFolderAsync(),a.weavaFirebaseLogger.subscribeActiveFolderLog(n);var u="folders/"+n;i.database().ref(u).on("value",function(t){var e=t.val();a.weavaFirebaseLogger.activeFolderUpdatedLog(e);var u=s.folderMigrationManager.apply(e);u.version===e.version?r(e):i.database().ref("folders/"+n).set(o.objectUndefinedToNull(u))}),e.unSubscribeActiveFolderAsync=function(){a.weavaFirebaseLogger.unSubscribeActiveFolderLog(n),i.database().ref(u).off()}},e.acceptFolderInvitationAsync=function(t,e,n){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:l(t+"apis/folders/"+n+"/collaboration/accept?token="+e,{method:"GET",headers:{"Content-Type":"application/json"}});case 2:case"end":return r.stop()}},r,this)}))},e.declineFolderInvitationAsync=function(t,e,n){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:l(t+"apis/folders/"+n+"/collaboration/decline?token="+e,{method:"GET",headers:{"Content-Type":"application/json"}});case 2:case"end":return r.stop()}},r,this)}))},e.requestFolderIdAsync=function(t,e,n,i){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t+"apis/folders/"+i+"/collaboration/acceptsharelink?token="+e,n.next=3,l(r,{method:"GET",headers:{"Content-Type":"application/json"}});case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}},n,this)}))},e.moveFolderAsync=function(t,e,n,i,o){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a.weavaFirebaseLogger.moveFolderLog({fromFolderId:i,toFolderId:o}),r=t+"apis/folders/"+i+"/move/"+o+"?token="+e,n.next=4,l(r,{method:"POST",headers:{"Content-Type":"application/json"}});case 4:400===n.sent.status&&alert("Moving collaborative folder is currently not supported");case 6:case"end":return n.stop()}},n,this)}))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(243),i=n(244),o=n(560),a=n(561);e.folderMigrations=[new r.default(a.migrationParams_0_0_2),new r.default(o.migrationParams_0_0_1)],e.folderMigrationManager=new i.default("Folder",e.folderMigrations)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.migrationParams_0_0_1={version:"0.0.1",transform:function(t){var e=t.accessRight;if(!e||!e.read)return t;var n=Object.keys(e.read)[0];return t.accessRight={},t.accessRight[n]="owner",t.creator=n,t}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.migrationParams_0_0_2={version:"0.0.2",transform:function(t){var e=t.websiteIds;if(e)for(var n=Object.keys(e),r=0;r<n.length;r++){var i=t.websiteIds[n[r]].url;if(i&&-1!==i.indexOf("weavatools.com")&&-1!==i.indexOf("pdfstorage")){var o=decodeURIComponent(i).match(/.*\\?file=http[^?^;]*/);o&&(t.websiteIds[n[r]].url=o[0])}}return t}}},function(t){t.exports={"16dcbca3-e997-49e4-96f0-b23d6d9cbe9f":{colorNum:3,date:1500902614111,endStr:'<imgclass="progressivemedia-no',paragraph:"Click on the blue toggle button on the bottom right hand corner of the sidebar to disable / enable the Weava highlighter.",startStr:'">4.turningweavahighlighteroff',text:"Click on the blue toggle button on the bottom right hand corner of the sidebar to disable / enable the Weava highlighter."},"36b3ae71-b52f-4566-8b73-f3edde1ba18e":{colorNum:2,date:1500902594757,endStr:"clickonthehighlightandaddnotes",paragraph:"2. Annotate Highlights",startStr:'1*a9c6wv8nmda0foicvwpfca.gif">',text:"2. Annotate Highlights"},"56ce2165-ab83-4187-bb13-dfc3465a3ef3":{colorNum:3,date:1500902579426,endStr:'<imgclass="progressivemedia-no',paragraph:"When you are on an online PDF, press the blue “Highlight” Button on the top right corner of the toolbar.",startStr:'dq.png">1b.highlightonlinepdfs',text:"When you are on an online PDF, press the blue “Highlight” Button on the top right corner of the toolbar."},"7074349e-8b50-40a7-8e5f-ad547d967b19":{colorNum:3,date:1500902569109,endStr:'<imgclass="progressivemedia-no',paragraph:"Drag your mouse across paragraph that you would like to highlight, then pick the color you want on the highlighter popup.",startStr:"highlight1a.highlightwebsites:",text:"Drag your mouse across paragraph that you would like to highlight, then pick the color you want on the highlighter popup."},"76215078-e070-47f3-8f2d-efaac2bbb2ce":{colorNum:3,date:1500902644350,endStr:'<imgclass="progressivemedia-no',paragraph:"Finally export your work into Microsoft Word, Excel,&nbsp;.csv, or&nbsp;.txt by clicking the export button on your dashboard.",startStr:'-122-afv--ogu6_a.gif">8.export',text:"Finally export your work into Microsoft Word, Excel, .csv, or .txt by clicking the export button on your dashboard."},"9c8cb344-da8e-4494-8fbf-5f807dd0b945":{colorNum:2,date:1500902585394,endStr:"tohighlightlocalpdfssavedinyou",paragraph:"1c. Highlight local PDFs saved in your&nbsp;computer",startStr:"pdfvieweranditwillshowupagain~",text:"1c. Highlight local PDFs saved in your computer"},"ad0a3088-bf28-4a9b-b5c1-bebe8eadf628":{colorNum:1,date:1500902631412,endStr:"orsimplygotohttps://www.weavat",paragraph:"Click the home button on the Chrome extension sidebar to head to the web dashboard, or simply go to https://www.weavatools.com/dashboard",startStr:"webdashboardtoorganizefurther.",text:"Click the home button on the Chrome extension sidebar to head to the web dashboard,"},"ce99e75f-9e4e-4cdc-908f-8158518355cb":{colorNum:2,date:1500902564766,endStr:"dragyourmouseacrossparagraphth",paragraph:"1a. Highlight Websites:",startStr:".www.weavatools.com1.highlight",text:"1a. Highlight Websites:"},"d66809c8-8cfd-407b-918c-eb7f56a80eb5":{colorNum:2,date:1500902640049,endStr:"finallyexportyourworkintomicro",paragraph:"8. Export",startStr:'1*siktfl-122-afv--ogu6_a.gif">',text:"8. Export"},"e21ae475-2436-4f15-a237-ac3e6b0cff0b":{colorNum:2,date:1500902607785,endStr:"clickonthebluetogglebuttononth",paragraph:"4. Turning Weava highlighter OFF",startStr:'1*xak55evawhckeiwje6tloq.gif">',text:"4. Turning Weava highlighter OFF"},"f56d7a59-3be2-49fc-ab07-118ec828d6b5":{colorNum:2,date:1500902576206,endStr:"whenyouareonanonlinepdf,presst",paragraph:"1b. Highlight online&nbsp;PDFs",startStr:'1*ugb9s04oyhizi1j2lcaodq.png">',text:"1b. Highlight online PDFs"},"f5c8b6d1-2925-4a48-ba47-919678fc87f5":{colorNum:2,date:1500902621458,endStr:"withsufficienthighlightsit’sti",paragraph:"6. Web Dashboard",startStr:'1*_15pyvgmm5glv9ootwvpua.gif">',text:"6. Web Dashboard"}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(243),i=n(564),o=n(565),a=n(566),s=n(244);e.websiteMigrations=[new r.default(a.migrationParams_0_0_3),new r.default(o.migrationParams_0_0_2),new r.default(i.migrationParams_0_0_1)],e.websiteMigrationManager=new s.default("Website",e.websiteMigrations)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.migrationParams_0_0_1={version:"0.0.1",transform:function(t){return t}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.migrationParams_0_0_2={version:"0.0.2",transform:function(t){var e=t.accessRight;if(!e||!e.read)return t;var n=Object.keys(e.read)[0];if(t.accessRight={},t.accessRight[n]="owner",t.creator=n,t.highlights&&n){var r=Object.keys(t.highlights),i=!0,o=!1,a=void 0;try{for(var s,u=r[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value;t.highlights[c].creator=n}}catch(t){o=!0,a=t}finally{try{!i&&u.return&&u.return()}finally{if(o)throw a}}}return t}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.migrationParams_0_0_3={version:"0.0.3",transform:function(t){if(t.url&&-1!==t.url.indexOf("weavatools.com")&&-1!==t.url.indexOf("pdfstorage")){var e=decodeURIComponent(t.url).match(/.*\\?file=http[^?^;]*/);e&&(t.url=e[0])}return t}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(9),i={title:null,colorCodes:null,colorTags:null,createDate:null,lastModifiedDate:null,active:null,folderMetaMap:null,shared:!1},o=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r.Record(i)),e}();e.FolderMetaRecord=o,e.folderMetaJsonToRecord=function(t,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new o({title:t.title,colorCodes:r.fromJS(t.colorCodes)||i.colorCodes,colorTags:r.fromJS(t.colorTags)||i.colorTags,createDate:t.createDate||i.createDate,lastModifiedDate:t.lastModifiedDate||i.lastModifiedDate,active:n===a,folderMetaMap:e.folderMetaTreeJsonToRecord(t.folderIds,a),shared:t.shared})},e.folderMetaTreeJsonToRecord=function(t,n){if(t){var i=r.Map();for(var o in t)if(t){var a=e.folderMetaJsonToRecord(t[o],o,n);i=i.set(o,a)}return i}return r.Map()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(9),i={title:null,creator:null,accessRight:r.Map(),colorCodes:null,colorTags:null,createDate:null,lastModifiedDate:null,essayIds_:r.Map(),activeEssayId:null,websiteIds:r.Map(),version:null},o=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r.Record(i)),e}();e.FolderBodyRecord=o,e.folderBodyJsonToRecord=function(t){return new o({title:t.title,creator:t.creator,accessRight:r.fromJS(t.accessRight),colorCodes:r.fromJS(t.colorCodes)||i.colorCodes,colorTags:r.fromJS(t.colorTags)||i.colorTags,createDate:t.createDate||i.createDate,lastModifiedDate:t.lastModifiedDate||i.lastModifiedDate,essayIds_:r.fromJS(t.essayIds_),activeEssayId:t.activeEssayId,websiteIds:r.fromJS(t.websiteIds),version:t.version})}},function(module,exports,__webpack_require__){(function(global){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;!function(global,factory){module.exports=function(global){"use strict";var _Base64=global.Base64,version="2.4.9",buffer;if(module.exports)try{buffer=eval("require('buffer').Buffer")}catch(t){buffer=void 0}var b64chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b64tab=function(t){for(var e={},n=0,r=t.length;n<r;n++)e[t.charAt(n)]=n;return e}(b64chars),fromCharCode=String.fromCharCode,cb_utob=function(t){if(t.length<2)return(e=t.charCodeAt(0))<128?t:e<2048?fromCharCode(192|e>>>6)+fromCharCode(128|63&e):fromCharCode(224|e>>>12&15)+fromCharCode(128|e>>>6&63)+fromCharCode(128|63&e);var e=65536+1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320);return fromCharCode(240|e>>>18&7)+fromCharCode(128|e>>>12&63)+fromCharCode(128|e>>>6&63)+fromCharCode(128|63&e)},re_utob=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,utob=function(t){return t.replace(re_utob,cb_utob)},cb_encode=function(t){var e=[0,2,1][t.length%3],n=t.charCodeAt(0)<<16|(t.length>1?t.charCodeAt(1):0)<<8|(t.length>2?t.charCodeAt(2):0);return[b64chars.charAt(n>>>18),b64chars.charAt(n>>>12&63),e>=2?"=":b64chars.charAt(n>>>6&63),e>=1?"=":b64chars.charAt(63&n)].join("")},btoa=global.btoa?function(t){return global.btoa(t)}:function(t){return t.replace(/[\s\S]{1,3}/g,cb_encode)},_encode=buffer?buffer.from&&Uint8Array&&buffer.from!==Uint8Array.from?function(t){return(t.constructor===buffer.constructor?t:buffer.from(t)).toString("base64")}:function(t){return(t.constructor===buffer.constructor?t:new buffer(t)).toString("base64")}:function(t){return btoa(utob(t))},encode=function(t,e){return e?_encode(String(t)).replace(/[+\/]/g,function(t){return"+"==t?"-":"_"}).replace(/=/g,""):_encode(String(t))},encodeURI=function(t){return encode(t,!0)},re_btou=new RegExp(["[À-ß][-¿]","[à-ï][-¿]{2}","[ð-÷][-¿]{3}"].join("|"),"g"),cb_btou=function(t){switch(t.length){case 4:var e=((7&t.charCodeAt(0))<<18|(63&t.charCodeAt(1))<<12|(63&t.charCodeAt(2))<<6|63&t.charCodeAt(3))-65536;return fromCharCode(55296+(e>>>10))+fromCharCode(56320+(1023&e));case 3:return fromCharCode((15&t.charCodeAt(0))<<12|(63&t.charCodeAt(1))<<6|63&t.charCodeAt(2));default:return fromCharCode((31&t.charCodeAt(0))<<6|63&t.charCodeAt(1))}},btou=function(t){return t.replace(re_btou,cb_btou)},cb_decode=function(t){var e=t.length,n=e%4,r=(e>0?b64tab[t.charAt(0)]<<18:0)|(e>1?b64tab[t.charAt(1)]<<12:0)|(e>2?b64tab[t.charAt(2)]<<6:0)|(e>3?b64tab[t.charAt(3)]:0),i=[fromCharCode(r>>>16),fromCharCode(r>>>8&255),fromCharCode(255&r)];return i.length-=[0,0,2,1][n],i.join("")},atob=global.atob?function(t){return global.atob(t)}:function(t){return t.replace(/[\s\S]{1,4}/g,cb_decode)},_decode=buffer?buffer.from&&Uint8Array&&buffer.from!==Uint8Array.from?function(t){return(t.constructor===buffer.constructor?t:buffer.from(t,"base64")).toString()}:function(t){return(t.constructor===buffer.constructor?t:new buffer(t,"base64")).toString()}:function(t){return btou(atob(t))},decode=function(t){return _decode(String(t).replace(/[-_]/g,function(t){return"-"==t?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,""))},noConflict=function(){var t=global.Base64;return global.Base64=_Base64,t};if(global.Base64={VERSION:version,atob:atob,btoa:btoa,fromBase64:decode,toBase64:encode,utob:utob,encode:encode,encodeURI:encodeURI,btou:btou,decode:decode,noConflict:noConflict,__buffer__:buffer},"function"==typeof Object.defineProperty){var noEnum=function(t){return{value:t,enumerable:!1,writable:!0,configurable:!0}};global.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",noEnum(function(){return decode(this)})),Object.defineProperty(String.prototype,"toBase64",noEnum(function(t){return encode(this,t)})),Object.defineProperty(String.prototype,"toBase64URI",noEnum(function(){return encode(this,!0)}))}}return global.Meteor&&(Base64=global.Base64),module.exports?module.exports.Base64=global.Base64:(__WEBPACK_AMD_DEFINE_ARRAY__=[],void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(){return global.Base64}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)),{Base64:global.Base64}}(global)}("undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==global?global:this)}).call(this,__webpack_require__(8))},function(t,e,n){"use strict";var r=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});var i=n(571),o=n(18),a=n(85);n(40),n(23),n(44),e.updateHighlightColor=function(t,e,n,o){return function(a){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:i.updateHighlightColorAsync(t,e,n,o);case 1:case"end":return r.stop()}},r,this)}))}},e.deleteHighlight=function(t,e,n,o){return function(a){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:i.deleteHighlightAsync(t,e,n,o);case 1:case"end":return r.stop()}},r,this)}))}},e.createHighlight=function(t,e,n,s,u,c,l,h){return function(h){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function f(){var p=this;return regeneratorRuntime.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:i.createHighlightAsync(t,e,n,s,u,c,l,function(){return r(p,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:h(o.TrackerActions.trackEvent("CREATE_WEBSITE",{source:a.MetaConstants.SOURCE_CONSTANTS.EXTENSION_BACKGROUND,reason:a.MetaConstants.CREATE_WEBSITE_REASON.FIRST_HIGHLIGHT}));case 1:case"end":return t.stop()}},t,this)}))});case 1:case"end":return f.stop()}},f,this)}))}},e.moveHighlight=function(t,e,n,o,a,s){return function(u){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:i.moveHighlightAsync(t,e,n,o,a,s);case 1:case"end":return r.stop()}},r,this)}))}},e.moveHighlights=function(t,e,n,o,a){return function(s){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){var s,u,c,l,h,f;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:s=!0,u=!1,c=void 0,r.prev=3,l=a[Symbol.iterator]();case 5:if(s=(h=l.next()).done){r.next=12;break}return f=h.value,r.next=9,i.moveHighlightAsync(t,e,n,o,f.website.websiteId,f.highlight.highlightId);case 9:s=!0,r.next=5;break;case 12:r.next=18;break;case 14:r.prev=14,r.t0=r.catch(3),u=!0,c=r.t0;case 18:r.prev=18,r.prev=19,!s&&l.return&&l.return();case 21:if(r.prev=21,!u){r.next=24;break}throw c;case 24:return r.finish(21);case 25:return r.finish(18);case 26:case"end":return r.stop()}},r,this,[[3,14,18,26],[19,,21,25]])}))}},e.editNote=function(t,e,n,o,a){return function(s){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,i.editNoteAsync(t,e,n,o,a);case 2:case"end":return r.stop()}},r,this)}))}}},function(t,e,n){"use strict";var r=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});var i=n(15),o=n(50),a=n(161),s=n(112),u=n(44);e.deleteHighlightAsync=function(t,e,n,a){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){var s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!o.getWebsiteIdsState(t)){r.next=8;break}return!n&&e&&(n=o.getWebsiteFromStateByUrl(t,e)),(s={})["websites/"+n+"/highlights/"+a]=null,s=o.objectUndefinedToNull(s),console.log("[Highlight Action] / [Delete Highlight] ==> Firebase",s),r.abrupt("return",i.database().ref("/").update(s));case 8:case"end":return r.stop()}},r,this)}))},e.createHighlightAsync=function(t,e,n,u,c,l,h,f){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){var p,d,v,g,y;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(p=o.getWebsiteIdsState(e),d=o.getActiveFolderIdFromState(e),!p||!d){r.next=20;break}if(v=o.getWebsiteFromStateByUrl(e,n),g=!1,v||(g=!0,v=generatePushID()),s.TrackerAsyncFunction.trackUsageStat("highlightCount",1),y={},l.creator=t.uid,console.log("[Highlight Action] / [Create Highlight] ==> Firebase",y),!g){r.next=17;break}return f(),r.next=14,a.createWebsiteWithHighlightAsync(t,d,n,u,h,v,c,l);case 14:return r.abrupt("return",i.database().ref("/").update(y));case 17:return y["websites/"+v+"/highlights/"+c]=l,y=o.objectUndefinedToNull(y),r.abrupt("return",i.database().ref("/").update(y));case 20:case"end":return r.stop()}},r,this)}))},e.updateHighlightColorAsync=function(t,e,n,a){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){var s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!o.getWebsiteIdsState(t)){r.next=8;break}return s=o.getWebsiteFromStateByUrl(t,e),(u={})["websites/"+s+"/highlights/"+n+"/colorNum"]=a,u=o.objectUndefinedToNull(u),console.log("[Highlight Action] / [Update Highlight Color] ==> Firebase",u),r.abrupt("return",i.database().ref("/").update(u));case 8:case"end":return r.stop()}},r,this)}))},e.moveHighlightAsync=function(t,e,n,c,l,h){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function e(){var r,f,p,d,v,g,y;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n!==c){e.next=2;break}return e.abrupt("return");case 2:return r=(r=(r=[]).concat(i.database().ref("/websites/"+l).once("value"))).concat(i.database().ref("/folders/"+c).once("value")),e.next=7,Promise.all(r);case 7:if(f=e.sent,p=f[0].val(),d=p.highlights[h],v=f[1].val(),g=u.findKey(v?v.websiteIds:[],function(t,e){return t.url===p.url}),y={},g){e.next=17;break}return e.next=16,a.createWebsiteInFolderAsync(t,c,p.url,p.title,p.favIconUrl);case 16:g=e.sent;case 17:return s.TrackerAsyncFunction.trackUsageStat("moveHighlightCount",1),y["websites/"+g+"/highlights/"+h]=d,y["websites/"+l+"/highlights/"+h]=null,y=o.objectUndefinedToNull(y),console.log("[Highlight Action] / [Move Highlight] ==> Firebase",y),e.abrupt("return",i.database().ref("/").update(y));case 23:case"end":return e.stop()}},e,this)}))},e.editNoteAsync=function(t,e,n,a,u){return r(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){var c;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!o.getWebsiteIdsState(t)){r.next=9;break}return!n&&e&&(n=o.getWebsiteFromStateByUrl(t,e)),s.TrackerAsyncFunction.trackUsageStat("editNoteCount",1),(c={})["websites/"+n+"/highlights/"+a+"/note"]=u,c=o.objectUndefinedToNull(c),console.log("[Highlight Action] / [Update Note] ==> Firebase",c),r.abrupt("return",i.database().ref("/").update(c));case 9:case"end":return r.stop()}},r,this)}))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){var e=this,n=function(t,e){return"mac"===t&&(e=(e=(e=(e=(e=e.replace(/\+/g,"")).replace(/Alt/g,"⌥")).replace(/Command/g,"⌘")).replace(/Shift/g,"⇧")).replace(/Ctrl/g,"⌃")),e},r=function(t){chrome.runtime.getPlatformInfo(function(e){chrome.commands.getAll(function(r){for(var i={},o=0;o<r.length;o++){var a=r[o];i[a.name]=n(e.os,a.shortcut)}t(i)})})};t.getAllCommands=function(){return function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})}(e,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(t){r(t)}));case 1:case"end":return t.stop()}},t,this)}))}}(e.ShortcutAsyncFunction||(e.ShortcutAsyncFunction={}))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(40);e.MailsActions={sendAddColorReferralEmails:function(t,e,n){return function(i){return function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})}(void 0,void 0,void 0,regeneratorRuntime.mark(function i(){var o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return o=t+"apis/mails/addcolorreferral?token="+e,i.next=3,r(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({emails:n})});case 3:case"end":return i.stop()}},i,this)}))}}}},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n(43),o=n(86),a=n(18),s=n(248),u=n(80),c=n(66),l=n(151),h=n(85),f=n(15),p=n(87),d=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.bindStore(),n.bindListeners(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i.BaseView),r(e,[{key:"handleStoreChange",value:function(){var t=this;this.currentState.chromeIconReducer.get("iconPathStatus").forEach(function(e,n){chrome.browserAction.setIcon({tabId:n,path:e},function(){chrome.runtime.lastError&&t.store.dispatch(o.removeIconStatus(n))})})}},{key:"bindListeners",value:function(){var t=this;chrome.browserAction.onClicked.addListener(function(){var e=t.currentState.onboardingReducer.getIn(["onboarding","extensionGuideState"]);2!==e&&2.5!==e||t.store.dispatch(p.updateExtensionGuideState(f.auth().currentUser,3)),3!==e&&chrome.tabs.query({active:!0,currentWindow:!0},function(e){if(0!==e.length){var n=e[0],r=l.isBannedSite(n.url);if(t.store.dispatch(a.TrackerActions.trackEvent("CHROME_ICON_CLICKED",{isBanned:r})),r)return void(-1!==n.url.indexOf("webstore")?chrome.tabs.create({url:StaticConstants.APP_BASE_PATH+"app/signup",selected:!0},function(e){t.store.dispatch(a.TrackerActions.trackEvent("OPEN_SIGNUP_PAGE_IN_WEB_STORE"))}):alert("Go to other websites to start highlighting!"));chrome.extension.isAllowedFileSchemeAccess(function(r){0!==n.url.indexOf("file:///")||r?0===n.url.indexOf("file:///")&&r?chrome.tabs.update(n.id,{url:chrome.extension.getURL("src/pdfviewer/web/viewer.html")+"?file="+n.url.replace("?forcedefault=true","")}):n.url.toLowerCase().endsWith(".pdf")&&!n.url.startsWith(chrome.extension.getURL("src/pdfviewer/web/viewer.html"))?(chrome.tabs.update(n.id,{url:chrome.extension.getURL("src/pdfviewer/web/viewer.html")+"?file="+n.url.replace("?forcedefault=true","")}),t.store.dispatch(u.ChromeMessageAction.sendReloadMessage(n.id))):(t.currentState.workspaceReducer.get("highlightMode")||t.currentState.workspaceReducer.getIn(["sidebarStatus",e[0].id])!==s.sideBarStateOptions.HIDDEN||(t.store.dispatch(a.TrackerActions.trackEvent("TOGGLE_HIGHLIGHT_MODE",{source:h.MetaConstants.SOURCE_CONSTANTS.EXTENSION_ICON,mode:!0})),t.store.dispatch(c.updateHighlightModeSetting(f.auth().currentUser,!0)),t.store.dispatch(u.ChromeMessageAction.sendShowNotificationMessage("HIGHLIGHT_MODE_ON"))),t.store.dispatch(o.onIconClicked(e))):chrome.tabs.update(n.id,{url:chrome.extension.getURL("src/pdfviewer/web/viewer.html")+"?file="+n.url.replace("?forcedefault=true","")})})}})})}}]),e}();e.ChromeIconView=d},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n(576),o=n(43),a=n(163),s=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.bindStore(),n.bindListeners(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.BaseView),r(e,[{key:"handleStoreChange",value:function(){}},{key:"bindListeners",value:function(){var t=this;chrome.webRequest.onHeadersReceived.addListener(this.onHeadersReceivedListener.bind(this),{urls:["<all_urls>"],types:["main_frame"]},["blocking","responseHeaders"]),chrome.webRequest.onBeforeRequest.addListener(function(e){return t.onBeforeRequestListener(e)},{urls:["file://*/*.pdf","file://*/*.PDF","file://*/*.pdf&webapp=true","file://*/*.PDF&webapp=true"],types:["main_frame","sub_frame"]},["blocking"]),chrome.tabs.onUpdated.addListener(function(e,n,r){0===r.url.indexOf("chrome-extension://cbnaodkpfinfiipjblikofhlhlcickei/src/pdfviewer")&&t.store.dispatch(a.setPdfMode(e,a.pdfModeOptions.PDF_JS))})}},{key:"onHeadersReceivedListener",value:function(t){var e=this;if(console.log("PDF Handler","onHeaderReceived",t),-1!==t.url.indexOf("weavatools.com/apis/pdfstorage")||-1!==t.url.indexOf("weavatools.com/pdfstorage"))return{redirectUrl:i.getViewerURL(t.url)};if(-1!==t.url.indexOf("https://weava-files-storage")&&-1===t.url.indexOf("Signature")){var n=/https:\/\/weava-files-storage.*\/pdf\/(.*).pdf.*/g.exec(t.url);if(n){var r=n[1];return{redirectUrl:StaticConstants.SERVER_BASE_PATH+"apis/pdfstorage/"+r}}}return"GET"===t.method&&-1===t.url.indexOf("mail-attachment")&&-1===t.url.indexOf("attachment.outlook.office.net")&&i.isPdfFile(t)?i.isPdfDownloadable(t)?(setTimeout(function(){e.store.dispatch(a.setPdfMode(t.tabId,a.pdfModeOptions.FALSE))},100),i.getHeadersWithContentDispositionAttachment(t)):-1===t.url.indexOf("?forcedefault=true")&&this.currentState.workspaceReducer.get("autoPdf")?(setTimeout(function(){e.store.dispatch(a.setPdfMode(t.tabId,a.pdfModeOptions.PDF_JS))},100),{redirectUrl:i.getViewerURL(t.url)}):void setTimeout(function(){e.store.dispatch(a.setPdfMode(t.tabId,a.pdfModeOptions.DEFAULT))},100):void setTimeout(function(){e.store.dispatch(a.setPdfMode(t.tabId,a.pdfModeOptions.FALSE))},100)}},{key:"onBeforeRequestListener",value:function(t){var e=this;return console.log("PDF Handler","onBeforeRequest"),-1!==t.url.indexOf("mail-attachment")||-1!==t.url.indexOf("attachment.outlook.office.net")||i.isPdfDownloadable(t)?void setTimeout(function(){e.store.dispatch(a.setPdfMode(t.tabId,a.pdfModeOptions.FALSE))},100):-1===t.url.indexOf("?forcedefault=true")&&this.currentState.workspaceReducer.get("autoPdf")?(setTimeout(function(){e.store.dispatch(a.setPdfMode(t.tabId,a.pdfModeOptions.PDF_JS))},100),{redirectUrl:i.getViewerURL(t.url)}):void setTimeout(function(){e.store.dispatch(a.setPdfMode(t.tabId,a.pdfModeOptions.DEFAULT))},100)}}]),e}();e.PdfHandlerView=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isUrlGIstnotePDFViewer=function(t){return/.*viewer\.html\?file=/i.test(t)},e.isPdfJS=function(t){return/.*viewer\.html\?file=/i.test(t)},e.getViewerURL=function(t){return chrome.extension.getURL("src/pdfviewer/web/viewer.html")+"?file="+t},e.isPdfFile=function(t){var n=e.getHeaderFromHeaders(t.responseHeaders,"content-type");if(n){var r=n.value.toLowerCase().split(";",1)[0].trim();if("application/pdf"===r)return!0;if("application/octet-stream"===r){if(t.url.toLowerCase().indexOf(".pdf")>0)return!0;var i=e.getHeaderFromHeaders(t.responseHeaders,"content-disposition");if(i&&/\.pdf(["']|$)/i.test(i.value))return!0}}},e.isPdfDownloadable=function(t){if(t.url.indexOf("pdfjs.action=download")>=0)return!0;if("main_frame"===t.type&&-1===t.url.indexOf("=download"))return!1;var n=t.responseHeaders&&e.getHeaderFromHeaders(t.responseHeaders,"content-disposition");return n&&/^attachment/i.test(n.value)},e.getHeadersWithContentDispositionAttachment=function(t){var n=t.responseHeaders,r=e.getHeaderFromHeaders(n,"content-disposition");if(r||(r={name:"Content-Disposition"},n.push(r)),!/^attachment/i.test(r.value))return r.value="attachment"+r.value.replace(/^[^;]+/i,""),{responseHeaders:n}},e.getHeaderFromHeaders=function(t,e){for(var n=0;n<t.length;++n){var r=t[n];if(r.name.toLowerCase()===e)return r}}},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});var o=n(9),a=n(43),s=n(18),u=(n(87),n(49)),c=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));n.reducers=["workspaceReducer","firebaseAuthReducer","dataReducer","questionnaireReducer","syncProcessReducer","stripeReducer","onboardingReducer"];return chrome.runtime.onInstalled.addListener(function(t){return i(n,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:"install"===t.reason&&i(n,void 0,void 0,regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.store.dispatch(s.TrackerActions.trackEvent("BG_INSTALL_TO_CHROME")),chrome.tabs.query({},function(t){var n=!0,r=!0,i=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done);r=!0){var c=a.value;if(-1!==c.url.indexOf("weavatools.com/app/dashboard")||-1!==c.url.indexOf("weavatools.com/app/onboarding")||-1!==c.url.indexOf("weavatools.com/dashboard")||-1!==c.url.indexOf("weavatools.com/onboarding")||-1!==c.url.indexOf("localhost:4200/app/dashboard")||-1!==c.url.indexOf("localhost:4200/app/onboarding")||-1!==c.url.indexOf("localhost:3000/app/onboarding")||-1!==c.url.indexOf("localhost:3000/app/dashboard")){n=!1,chrome.tabs.update(c.id,{active:!0});break}}}catch(t){i=!0,o=t}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}n&&chrome.tabs.create({url:StaticConstants.APP_BASE_PATH+"app/signup",selected:!0},function(t){var n=function n(r){r===t.id&&(e.store.dispatch(s.TrackerActions.trackEvent("INSTALL_NEW_TAB_CLOSED_IMMEDIATELY")),chrome.storage.local.set({WEAVA_INSTALLATION_SHOW_SIDEBAR:!0}),chrome.tabs.onRemoved.removeListener(n))};chrome.tabs.onRemoved.addListener(n),window.setTimeout(function(){chrome.tabs.onRemoved.removeListener(n)},5e3),e.store.dispatch(s.TrackerActions.trackEvent("AUTO_OPEN_SIGNUP_PAGE"))})}),chrome.storage.local.set({WEAVA_INSTALLATION_TIME:Date.now()});case 3:case"end":return t.stop()}},t,this)}));case 1:case"end":return e.stop()}},e,this)}))}),n.handlePreviousLocalStorage().then(function(){n.bindStore(),n.bindListeners()}),n.setReducerNames(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.BaseView),r(e,[{key:"handleStoreChange",value:function(){var t=this,e=this.currentState;this.user=e.firebaseAuthReducer.get("user"),this.reducers.forEach(function(n){var r=t.previousState[n],i=e[n];if(!o.is(i,r)){var a={},s=i.toJS();a[n]=s,chrome.storage.local.set(a),chrome.storage.local.getBytesInUse(n,function(e){u.weavaLogger.log(n,"green","white",t.formatBytes(e),a)})}})}},{key:"formatBytes",value:function(t){for(var e=0;t/1024>1;)t/=1024,e++;return 0===e?t+" B":1===e?t+" KB":2===e?t+" MB":void 0}},{key:"bindListeners",value:function(){}},{key:"handlePreviousLocalStorage",value:function(){var t=this,e=[];return this.reducers.forEach(function(n){e=e.concat(new Promise(function(e,r){chrome.storage.local.remove(n,function(){var r={},i=t.currentState[n].toJS();r[n]=i,chrome.storage.local.set(r),e()})}))}),Promise.all(e)}},{key:"setReducerNames",value:function(){var t={};t.reducers=this.reducers,chrome.storage.local.set(t)}}]),e}();e.ChromeLocalStorageView=c},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n(43),o=n(15);n(154),n(215),n(241);var a=n(579),s=n(83),u=n(65),c=n(249),l=n(87),h=n(66),f=n(62),p=n(250),d=n(114),v=n(162),g=n(18),y=n(245),m=n(44),_=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.firebaseListening=!1,n.checkedUpdate=!1,n.checkUpdate=m.debounce(function(){console.log("register update check"),chrome.runtime.requestUpdateCheck(function(t){"update_available"===t?console.log("update pending..."):"no_update"===t?console.log("no update found"):"throttled"===t&&console.log("Oops, I'm asking too frequently - I need to back off.")})},2e3),n.app=o.initializeApp(StaticConstants.FIREBASE_CONFIG),n.versionCheckView=new a.VersionCheckView(t,n.app),n.bindStore(),n.bindListeners(),n.store.dispatch(f.subscribeAuthChange(StaticConstants.SERVER_BASE_PATH)),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i.BaseView),r(e,[{key:"handleStoreChange",value:function(){var t=this;if(this.handleSync(),this.currentState.dataReducer.getIn(["searchState","searching"])?this.handleSearchResult():(this.handlenonActiveWebsiteBodies(),this.handleActiveWebsites()),this.currentState.syncProcessReducer.get("latestVersion")&&!this.checkedUpdate){this.checkedUpdate=!0;var e=this.currentState.syncProcessReducer.get("latestVersion").get("chromeExtension"),n=chrome.runtime.getManifest().version;if(y.lt(n,e)){var r=3*Math.floor(10*Math.random());console.log("Queued update after",r,"minutes"),this.store.dispatch(g.TrackerActions.trackEvent("APPLICATION_UPDATE_QUEUED",{timeout:r})),window.setTimeout(function(){t.checkUpdate()},1e3*r*60)}}}},{key:"bindListeners",value:function(){var t=this;this.app.database().ref(".info/connected").on("value",function(e){t.user&&(!0===e.val()?t.store.dispatch(s.reconnect()):t.store.dispatch(s.offline()))}),this.store.dispatch(s.subscriptLatestVersion()),chrome.runtime.onUpdateAvailable.addListener(function(t){console.log("updating to version "+t.version),chrome.runtime.reload()});var e=Date.now();window.setInterval(function(){var n=(Date.now()-e)/1e3,r=Math.round(n/10),i=t.currentState.loggerRedcuer.get("previousActions").toJS().join(" > ");n>=30&&n<=60&&(console.log("hang",n,r),chrome.tabs.query({},function(e){t.store.dispatch(g.TrackerActions.trackEvent("BACKGROUND_PAGE_HANG",{time:n,timeGroup:r,previousActions:i,syncProcessReducer:JSON.stringify(t.currentState.syncProcessReducer.toJS()),firebaseAuthReducer:JSON.stringify(t.currentState.firebaseAuthReducer.toJS()),url:e.map(function(t){return t.url})}))})),e=Date.now()},8e3)}},{key:"sync",value:function(t){return function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})}(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.store.dispatch(u.subscribeUserMeta(t)),this.store.dispatch(u.subscribeUserProfile(StaticConstants.SERVER_BASE_PATH,t)),this.store.dispatch(c.subscribeStripe(t)),this.store.dispatch(l.subscribeOnboarding(t)),this.store.dispatch(h.subscribeWorkspace(t)),this.store.dispatch(p.subscribeQuestionnaire(t)),e.t0=this.store,e.t1=d,e.t2=StaticConstants.SERVER_BASE_PATH,e.next=11,o.auth().currentUser.getIdToken(!0);case 11:e.t3=e.sent,e.t4=t,e.t5=e.t1.subscribeFolderIds.call(e.t1,e.t2,e.t3,e.t4,!1),e.t0.dispatch.call(e.t0,e.t5),this.store.dispatch(u.subscribeUserNotifications(StaticConstants.ENVIRONMENT,t));case 16:case"end":return e.stop()}},e,this)}))}},{key:"unSync",value:function(){this.firebaseListening=!1,this.store.dispatch(u.unSubscribeUserMeta(this.user)),this.store.dispatch(u.unSubscribeUserProfile(this.user)),this.store.dispatch(c.unSubscribeStripe(this.user)),this.store.dispatch(l.unSubscribeOnboarding(this.user)),this.store.dispatch(h.unSubscribeWorkspace(this.user)),this.store.dispatch(p.unSubscribeQuestionnaire(this.user)),this.store.dispatch(d.unSubscribeFolderIds(this.user)),this.store.dispatch(u.unSubscribeUserNotifications(StaticConstants.ENVIRONMENT,this.user))}},{key:"handleSync",value:function(){var t=o.auth().currentUser;switch(this.currentState.syncProcessReducer.get("syncProcessStatus")){case s.syncProcessStatusOption.START:this.firebaseListening||(this.firebaseListening=!0,this.sync(t));break;default:this.firebaseListening&&this.user&&this.unSync()}this.user=t}},{key:"handlenonActiveWebsiteBodies",value:function(){var t=this;if(this.currentState.dataReducer.activeFolderMap&&0!==this.currentState.dataReducer.activeFolderMap.size){var e=this.currentState.dataReducer.activeFolderMap.first(null),n=e.websiteIds;e.websiteIds&&(n=e.websiteIds.filter(function(e,n){return!t.currentState.dataReducer.activeWebsiteIdList.includes(n)})),this.store.dispatch(v.subscribenonActiveWebsiteBodies(this.currentState.dataReducer,n,this.currentState.dataReducer.websiteListPaginationMap))}}},{key:"handleActiveWebsites",value:function(){this.currentState.dataReducer.activeFolderMap&&0!==this.currentState.dataReducer.activeFolderMap.size&&this.store.dispatch(v.subscribeActiveWebsites(this.currentState.dataReducer,this.currentState.dataReducer.activeWebsiteIdList))}},{key:"handleSearchResult",value:function(){var t=this.currentState.dataReducer.searchState.searchResult.get("websiteIds");t&&(t=t.sortBy(function(t){return-t.score}).takeWhile(function(t,e){return e<5}),this.store.dispatch(v.subscribeSearchWebsites(this.currentState.dataReducer,t.map(function(t){return t.websiteId}))))}}]),e}();e.FirebaseView=_},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n(43),o=n(83),a=n(15),s=n(18),u=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return r.versionChecking=!1,r.retryingTime=0,r.migrating=!1,r.app=n,r.bindStore(),r.bindListeners(),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i.BaseView),r(e,[{key:"handleStoreChange",value:function(){var t=this,e=this.currentState,n=e.syncProcessReducer.get("syncProcessStatus");e.syncProcessReducer.get("error"),n===o.syncProcessStatusOption.RETRY&&a.auth().currentUser&&this.retryingTime!==this.currentState.syncProcessReducer.get("triedTime")&&(this.retryingTime=this.currentState.syncProcessReducer.get("triedTime"),setTimeout(function(){a.auth().currentUser.getIdToken(!0).then(function(e){t.store.dispatch(o.versionCheckRequest(e,chrome.runtime.getManifest().version)),t.store.dispatch(o.notificationRequest(e))})},5e3)),n===o.syncProcessStatusOption.VERSION_CHECK&&!this.versionChecking&&a.auth().currentUser&&(this.versionChecking=!0,a.auth().currentUser.getIdToken(!0).then(function(e){t.store.dispatch(o.versionCheckRequest(e,chrome.runtime.getManifest().version)),t.store.dispatch(o.notificationRequest(e))})),n!==o.syncProcessStatusOption.MIGRATING||this.migrating||(this.versionChecking=!1,this.migrating=!0,this.waitForMigration(e.firebaseAuthReducer.get("user").get("uid"))),n!==o.syncProcessStatusOption.START&&n!==o.syncProcessStatusOption.STOP&&n!==o.syncProcessStatusOption.ERROR||(this.versionChecking=!1,this.migrating=!1)}},{key:"bindListeners",value:function(){}},{key:"waitForMigration",value:function(t){var e=this,n=chrome.runtime.getManifest().version,r="users/"+t+"/version";this.app.database().ref(r).on("value",function t(i){var a=i.val();n===a&&(e.app.database().ref(r).off("value",t),e.store.dispatch(o.migrationDone()),e.store.dispatch(s.TrackerActions.trackEvent("MIGRATION_DONE",{version:chrome.runtime.getManifest().version,duration:Date.now()-e.currentState.syncProcessReducer.get("startingTime"),triedTime:e.currentState.syncProcessReducer.get("triedTime")})))})}}]),e}();e.VersionCheckView=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(40);e.SlackAsyncFunction={hookAPI:{NEW_USER_SIGNUP_CHANNEL:"https://hooks.slack.com/services/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"},_postMessage:function(t,e){return function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})}(void 0,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:r(t,{method:"POST",body:JSON.stringify({text:e})});case 1:case"end":return n.stop()}},n,this)}))},postNewQuestionnaireMessage:function(t){e.SlackAsyncFunction._postMessage(e.SlackAsyncFunction.hookAPI.NEW_USER_SIGNUP_CHANNEL,t)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(9),i=n(62),o=n(83),a=n(582),s=r.Map({syncProcessStatus:o.syncProcessStatusOption.STOP,offline:!1,error:null,startingTime:0,triedTime:0,latestVersion:null});e.syncProcessReducer=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,e=arguments[1],n=t;switch(e.type){case i.firebaseAuthActionsConstants.USER_CHANGED:return e.user||(n=(n=n.set("syncProcessStatus",o.syncProcessStatusOption.STOP)).set("error",null)),n;case o.syncProcessActionsConstants.START_VERSION_CHECK:return(n=(n=n.set("syncProcessStatus",o.syncProcessStatusOption.VERSION_CHECK)).set("startingTime",Date.now())).set("error",null);case o.syncProcessActionsConstants.VERSION_CHECK_DONE:switch(e.response.msg){case"NO_NEED_MIGRATION":return(n=n.set("syncProcessStatus",o.syncProcessStatusOption.START)).set("error",null);case"NEED_MIGRATION":return(n=n.set("syncProcessStatus",o.syncProcessStatusOption.MIGRATING)).set("error",null);case"APP_OLDER_THAN_DATA":return n=n.set("syncProcessStatus",o.syncProcessStatusOption.ERROR),alert("Please update the Weava extension."),n.set("error","Please update the extension.");default:return a.captureException(new Error("MIGRATION_FAIL"),{extra:e}),(n=n.set("syncProcessStatus",o.syncProcessStatusOption.ERROR)).set("error","Cannot reach remote server.")}case o.syncProcessActionsConstants.OFFLINE:return(n=(n=n.set("syncProcessStatus",o.syncProcessStatusOption.STOP)).set("offline",!0)).set("error",null);case o.syncProcessActionsConstants.RECONNECT:return(n=(n=n.set("syncProcessStatus",o.syncProcessStatusOption.START)).set("offline",!1)).set("error",null);case o.syncProcessActionsConstants.VERSION_CHECK_FAIL:return(n=n.set("triedTime",n.get("triedTime")+1)).get("triedTime")>=24?(a.captureException(new Error("MIGRATION_FAIL"),{extra:e}),n=(n=n.set("syncProcessStatus",o.syncProcessStatusOption.ERROR)).set("error",e.error+". Please contact support.")):n=(n=n.set("error",e.error+". Retrying...("+n.get("triedTime")+")")).set("syncProcessStatus",o.syncProcessStatusOption.RETRY),n;case o.syncProcessActionsConstants.MIGRATION_DONE:return(n=n.set("syncProcessStatus",o.syncProcessStatusOption.START)).set("error",null);case o.syncProcessActionsConstants.LATEST_VERSION_UPDATED:return n.set("latestVersion",e.versions);default:return n}}},function(t,e,n){(function(e){var r=n(583),i="undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{},o=i.Raven,a=new r;a.noConflict=function(){return i.Raven=o,a},a.afterLoad(),t.exports=a,t.exports.Client=r}).call(this,n(8))},function(t,e,n){(function(e){function r(){return+new Date}function i(t,e){return m(e)?function(n){return e(n,t)}:e}function o(){for(var t in this._hasJSON=!("object"!=typeof JSON||!JSON.stringify),this._hasDocument=!y(H),this._hasNavigator=!y(G),this._lastCapturedException=null,this._lastData=null,this._lastEventId=null,this._globalServer=null,this._globalKey=null,this._globalProject=null,this._globalContext={},this._globalOptions={release:q.SENTRY_RELEASE&&q.SENTRY_RELEASE.id,logger:"javascript",ignoreErrors:[],ignoreUrls:[],whitelistUrls:[],includePaths:[],headers:null,collectWindowErrors:!0,captureUnhandledRejections:!0,maxMessageLength:0,maxUrlLength:250,stackTraceLimit:50,autoBreadcrumbs:!0,instrument:!0,sampleRate:1,sanitizeKeys:[]},this._fetchDefaults={method:"POST",referrerPolicy:L()?"origin":""},this._ignoreOnError=0,this._isRavenInstalled=!1,this._originalErrorStackTraceLimit=Error.stackTraceLimit,this._originalConsole=q.console||{},this._originalConsoleMethods={},this._plugins=[],this._startTime=r(),this._wrappedBuiltIns=[],this._breadcrumbs=[],this._lastCapturedEvent=null,this._keypressTimeout,this._location=q.location,this._lastHref=this._location&&this._location.href,this._resetBackoff(),this._originalConsole)this._originalConsoleMethods[t]=this._originalConsole[t]}var a=n(584),s=n(251),u=n(585),c=n(586),l=n(164),h=l.isErrorEvent,f=l.isDOMError,p=l.isDOMException,d=l.isError,v=l.isObject,g=l.isPlainObject,y=l.isUndefined,m=l.isFunction,_=l.isString,b=l.isArray,E=l.isEmptyObject,w=l.each,S=l.objectMerge,T=l.truncate,I=l.objectFrozen,A=l.hasKey,O=l.joinRegExp,C=l.urlencode,R=l.uuid4,N=l.htmlTreeAsString,k=l.isSameException,P=l.isSameStacktrace,D=l.parseUrl,x=l.fill,M=l.supportsFetch,L=l.supportsReferrerPolicy,F=l.serializeKeysForMessage,U=l.serializeException,j=l.sanitize,B=n(587).wrapMethod,V="source protocol user pass host port path".split(" "),W=/^(?:(\w+):)?\/\/(?:(\w+)(:\w+)?@)?([\w\.-]+)(?::(\d+))?(\/.*)/,q="undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{},H=q.document,G=q.navigator;o.prototype={VERSION:"3.27.0",debug:!1,TraceKit:a,config:function(t,e){var n=this;if(n._globalServer)return this._logDebug("error","Error: Raven has already been configured"),n;if(!t)return n;var r=n._globalOptions;e&&w(e,function(t,e){"tags"===t||"extra"===t||"user"===t?n._globalContext[t]=e:r[t]=e}),n.setDSN(t),r.ignoreErrors.push(/^Script error\.?$/),r.ignoreErrors.push(/^Javascript error: Script error\.? on line 0$/),r.ignoreErrors=O(r.ignoreErrors),r.ignoreUrls=!!r.ignoreUrls.length&&O(r.ignoreUrls),r.whitelistUrls=!!r.whitelistUrls.length&&O(r.whitelistUrls),r.includePaths=O(r.includePaths),r.maxBreadcrumbs=Math.max(0,Math.min(r.maxBreadcrumbs||100,100));var i={xhr:!0,console:!0,dom:!0,location:!0,sentry:!0},o=r.autoBreadcrumbs;"[object Object]"==={}.toString.call(o)?o=S(i,o):!1!==o&&(o=i),r.autoBreadcrumbs=o;var s={tryCatch:!0},u=r.instrument;return"[object Object]"==={}.toString.call(u)?u=S(s,u):!1!==u&&(u=s),r.instrument=u,a.collectWindowErrors=!!r.collectWindowErrors,n},install:function(){var t=this;return t.isSetup()&&!t._isRavenInstalled&&(a.report.subscribe(function(){t._handleOnErrorStackInfo.apply(t,arguments)}),t._globalOptions.captureUnhandledRejections&&t._attachPromiseRejectionHandler(),t._patchFunctionToString(),t._globalOptions.instrument&&t._globalOptions.instrument.tryCatch&&t._instrumentTryCatch(),t._globalOptions.autoBreadcrumbs&&t._instrumentBreadcrumbs(),t._drainPlugins(),t._isRavenInstalled=!0),Error.stackTraceLimit=t._globalOptions.stackTraceLimit,this},setDSN:function(t){var e=this,n=e._parseDSN(t),r=n.path.lastIndexOf("/"),i=n.path.substr(1,r);e._dsn=t,e._globalKey=n.user,e._globalSecret=n.pass&&n.pass.substr(1),e._globalProject=n.path.substr(r+1),e._globalServer=e._getGlobalServer(n),e._globalEndpoint=e._globalServer+"/"+i+"api/"+e._globalProject+"/store/",this._resetBackoff()},context:function(t,e,n){return m(t)&&(n=e||[],e=t,t={}),this.wrap(t,e).apply(this,n)},wrap:function(t,e,n){function r(){var r=[],o=arguments.length,a=!t||t&&!1!==t.deep;for(n&&m(n)&&n.apply(this,arguments);o--;)r[o]=a?i.wrap(t,arguments[o]):arguments[o];try{return e.apply(this,r)}catch(e){throw i._ignoreNextOnError(),i.captureException(e,t),e}}var i=this;if(y(e)&&!m(t))return t;if(m(t)&&(e=t,t=void 0),!m(e))return e;try{if(e.__raven__)return e;if(e.__raven_wrapper__)return e.__raven_wrapper__}catch(t){return e}for(var o in e)A(e,o)&&(r[o]=e[o]);return r.prototype=e.prototype,e.__raven_wrapper__=r,r.__raven__=!0,r.__orig__=e,r},uninstall:function(){return a.report.uninstall(),this._detachPromiseRejectionHandler(),this._unpatchFunctionToString(),this._restoreBuiltIns(),this._restoreConsole(),Error.stackTraceLimit=this._originalErrorStackTraceLimit,this._isRavenInstalled=!1,this},_promiseRejectionHandler:function(t){this._logDebug("debug","Raven caught unhandled promise rejection:",t),this.captureException(t.reason,{mechanism:{type:"onunhandledrejection",handled:!1}})},_attachPromiseRejectionHandler:function(){return this._promiseRejectionHandler=this._promiseRejectionHandler.bind(this),q.addEventListener&&q.addEventListener("unhandledrejection",this._promiseRejectionHandler),this},_detachPromiseRejectionHandler:function(){return q.removeEventListener&&q.removeEventListener("unhandledrejection",this._promiseRejectionHandler),this},captureException:function(t,e){if(e=S({trimHeadFrames:0},e||{}),h(t)&&t.error)t=t.error;else{if(f(t)||p(t)){var n=t.name||(f(t)?"DOMError":"DOMException"),r=t.message?n+": "+t.message:n;return this.captureMessage(r,S(e,{stacktrace:!0,trimHeadFrames:e.trimHeadFrames+1}))}if(d(t))t=t;else{if(!g(t))return this.captureMessage(t,S(e,{stacktrace:!0,trimHeadFrames:e.trimHeadFrames+1}));e=this._getCaptureExceptionOptionsFromPlainObject(e,t),t=new Error(e.message)}}this._lastCapturedException=t;try{var i=a.computeStackTrace(t);this._handleStackInfo(i,e)}catch(e){if(t!==e)throw e}return this},_getCaptureExceptionOptionsFromPlainObject:function(t,e){var n=Object.keys(e).sort(),r=S(t,{message:"Non-Error exception captured with keys: "+F(n),fingerprint:[u(n)],extra:t.extra||{}});return r.extra.__serialized__=U(e),r},captureMessage:function(t,e){if(!this._globalOptions.ignoreErrors.test||!this._globalOptions.ignoreErrors.test(t)){var n,r=S({message:t+=""},e=e||{});try{throw new Error(t)}catch(t){n=t}n.name=null;var i=a.computeStackTrace(n),o=b(i.stack)&&i.stack[1];o&&"Raven.captureException"===o.func&&(o=i.stack[2]);var s=o&&o.url||"";if((!this._globalOptions.ignoreUrls.test||!this._globalOptions.ignoreUrls.test(s))&&(!this._globalOptions.whitelistUrls.test||this._globalOptions.whitelistUrls.test(s))){if(this._globalOptions.stacktrace||e.stacktrace||""===r.message){r.fingerprint=null==r.fingerprint?t:r.fingerprint,(e=S({trimHeadFrames:0},e)).trimHeadFrames+=1;var u=this._prepareFrames(i,e);r.stacktrace={frames:u.reverse()}}return r.fingerprint&&(r.fingerprint=b(r.fingerprint)?r.fingerprint:[r.fingerprint]),this._send(r),this}}},captureBreadcrumb:function(t){var e=S({timestamp:r()/1e3},t);if(m(this._globalOptions.breadcrumbCallback)){var n=this._globalOptions.breadcrumbCallback(e);if(v(n)&&!E(n))e=n;else if(!1===n)return this}return this._breadcrumbs.push(e),this._breadcrumbs.length>this._globalOptions.maxBreadcrumbs&&this._breadcrumbs.shift(),this},addPlugin:function(t){var e=[].slice.call(arguments,1);return this._plugins.push([t,e]),this._isRavenInstalled&&this._drainPlugins(),this},setUserContext:function(t){return this._globalContext.user=t,this},setExtraContext:function(t){return this._mergeContext("extra",t),this},setTagsContext:function(t){return this._mergeContext("tags",t),this},clearContext:function(){return this._globalContext={},this},getContext:function(){return JSON.parse(s(this._globalContext))},setEnvironment:function(t){return this._globalOptions.environment=t,this},setRelease:function(t){return this._globalOptions.release=t,this},setDataCallback:function(t){var e=this._globalOptions.dataCallback;return this._globalOptions.dataCallback=i(e,t),this},setBreadcrumbCallback:function(t){var e=this._globalOptions.breadcrumbCallback;return this._globalOptions.breadcrumbCallback=i(e,t),this},setShouldSendCallback:function(t){var e=this._globalOptions.shouldSendCallback;return this._globalOptions.shouldSendCallback=i(e,t),this},setTransport:function(t){return this._globalOptions.transport=t,this},lastException:function(){return this._lastCapturedException},lastEventId:function(){return this._lastEventId},isSetup:function(){return!(!this._hasJSON||!this._globalServer&&(this.ravenNotConfiguredError||(this.ravenNotConfiguredError=!0,this._logDebug("error","Error: Raven has not been configured.")),1))},afterLoad:function(){var t=q.RavenConfig;t&&this.config(t.dsn,t.config).install()},showReportDialog:function(t){if(H){if(!(t=S({eventId:this.lastEventId(),dsn:this._dsn,user:this._globalContext.user||{}},t)).eventId)throw new c("Missing eventId");if(!t.dsn)throw new c("Missing DSN");var e=encodeURIComponent,n=[];for(var r in t)if("user"===r){var i=t.user;i.name&&n.push("name="+e(i.name)),i.email&&n.push("email="+e(i.email))}else n.push(e(r)+"="+e(t[r]));var o=this._getGlobalServer(this._parseDSN(t.dsn)),a=H.createElement("script");a.async=!0,a.src=o+"/api/embed/error-page/?"+n.join("&"),(H.head||H.body).appendChild(a)}},_ignoreNextOnError:function(){var t=this;this._ignoreOnError+=1,setTimeout(function(){t._ignoreOnError-=1})},_triggerEvent:function(t,e){var n,r;if(this._hasDocument){for(r in e=e||{},t="raven"+t.substr(0,1).toUpperCase()+t.substr(1),H.createEvent?(n=H.createEvent("HTMLEvents")).initEvent(t,!0,!0):(n=H.createEventObject()).eventType=t,e)A(e,r)&&(n[r]=e[r]);if(H.createEvent)H.dispatchEvent(n);else try{H.fireEvent("on"+n.eventType.toLowerCase(),n)}catch(t){}}},_breadcrumbEventHandler:function(t){var e=this;return function(n){if(e._keypressTimeout=null,e._lastCapturedEvent!==n){var r;e._lastCapturedEvent=n;try{r=N(n.target)}catch(t){r="<unknown>"}e.captureBreadcrumb({category:"ui."+t,message:r})}}},_keypressEventHandler:function(){var t=this;return function(e){var n;try{n=e.target}catch(t){return}var r=n&&n.tagName;if(r&&("INPUT"===r||"TEXTAREA"===r||n.isContentEditable)){var i=t._keypressTimeout;i||t._breadcrumbEventHandler("input")(e),clearTimeout(i),t._keypressTimeout=setTimeout(function(){t._keypressTimeout=null},1e3)}}},_captureUrlChange:function(t,e){var n=D(this._location.href),r=D(e),i=D(t);this._lastHref=e,n.protocol===r.protocol&&n.host===r.host&&(e=r.relative),n.protocol===i.protocol&&n.host===i.host&&(t=i.relative),this.captureBreadcrumb({category:"navigation",data:{to:e,from:t}})},_patchFunctionToString:function(){var t=this;t._originalFunctionToString=Function.prototype.toString,Function.prototype.toString=function(){return"function"==typeof this&&this.__raven__?t._originalFunctionToString.apply(this.__orig__,arguments):t._originalFunctionToString.apply(this,arguments)}},_unpatchFunctionToString:function(){this._originalFunctionToString&&(Function.prototype.toString=this._originalFunctionToString)},_instrumentTryCatch:function(){function t(t){return function(n,r){for(var i=new Array(arguments.length),o=0;o<i.length;++o)i[o]=arguments[o];var a=i[0];return m(a)&&(i[0]=e.wrap({mechanism:{type:"instrument",data:{function:t.name||"<anonymous>"}}},a)),t.apply?t.apply(this,i):t(i[0],i[1])}}var e=this,n=e._wrappedBuiltIns,r=this._globalOptions.autoBreadcrumbs;x(q,"setTimeout",t,n),x(q,"setInterval",t,n),q.requestAnimationFrame&&x(q,"requestAnimationFrame",function(t){return function(n){return t(e.wrap({mechanism:{type:"instrument",data:{function:"requestAnimationFrame",handler:t&&t.name||"<anonymous>"}}},n))}},n);for(var i=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],o=0;o<i.length;o++)!function(t){var i=q[t]&&q[t].prototype;i&&i.hasOwnProperty&&i.hasOwnProperty("addEventListener")&&(x(i,"addEventListener",function(n){return function(i,o,a,s){try{o&&o.handleEvent&&(o.handleEvent=e.wrap({mechanism:{type:"instrument",data:{target:t,function:"handleEvent",handler:o&&o.name||"<anonymous>"}}},o.handleEvent))}catch(t){}var u,c,l;return r&&r.dom&&("EventTarget"===t||"Node"===t)&&(c=e._breadcrumbEventHandler("click"),l=e._keypressEventHandler(),u=function(t){if(t){var e;try{e=t.type}catch(t){return}return"click"===e?c(t):"keypress"===e?l(t):void 0}}),n.call(this,i,e.wrap({mechanism:{type:"instrument",data:{target:t,function:"addEventListener",handler:o&&o.name||"<anonymous>"}}},o,u),a,s)}},n),x(i,"removeEventListener",function(t){return function(e,n,r,i){try{n=n&&(n.__raven_wrapper__?n.__raven_wrapper__:n)}catch(t){}return t.call(this,e,n,r,i)}},n))}(i[o])},_instrumentBreadcrumbs:function(){function t(t,n){t in n&&m(n[t])&&x(n,t,function(n){return e.wrap({mechanism:{type:"instrument",data:{function:t,handler:n&&n.name||"<anonymous>"}}},n)})}var e=this,n=this._globalOptions.autoBreadcrumbs,r=e._wrappedBuiltIns;if(n.xhr&&"XMLHttpRequest"in q){var i=q.XMLHttpRequest&&q.XMLHttpRequest.prototype;x(i,"open",function(t){return function(n,r){return _(r)&&-1===r.indexOf(e._globalKey)&&(this.__raven_xhr={method:n,url:r,status_code:null}),t.apply(this,arguments)}},r),x(i,"send",function(n){return function(){function r(){if(i.__raven_xhr&&4===i.readyState){try{i.__raven_xhr.status_code=i.status}catch(t){}e.captureBreadcrumb({type:"http",category:"xhr",data:i.__raven_xhr})}}for(var i=this,o=["onload","onerror","onprogress"],a=0;a<o.length;a++)t(o[a],i);return"onreadystatechange"in i&&m(i.onreadystatechange)?x(i,"onreadystatechange",function(t){return e.wrap({mechanism:{type:"instrument",data:{function:"onreadystatechange",handler:t&&t.name||"<anonymous>"}}},t,r)}):i.onreadystatechange=r,n.apply(this,arguments)}},r)}n.xhr&&M()&&x(q,"fetch",function(t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;++r)n[r]=arguments[r];var i,o=n[0],a="GET";if("string"==typeof o?i=o:"Request"in q&&o instanceof q.Request?(i=o.url,o.method&&(a=o.method)):i=""+o,-1!==i.indexOf(e._globalKey))return t.apply(this,n);n[1]&&n[1].method&&(a=n[1].method);var s={method:a,url:i,status_code:null};return t.apply(this,n).then(function(t){return s.status_code=t.status,e.captureBreadcrumb({type:"http",category:"fetch",data:s}),t}).catch(function(t){throw e.captureBreadcrumb({type:"http",category:"fetch",data:s,level:"error"}),t})}},r),n.dom&&this._hasDocument&&(H.addEventListener?(H.addEventListener("click",e._breadcrumbEventHandler("click"),!1),H.addEventListener("keypress",e._keypressEventHandler(),!1)):H.attachEvent&&(H.attachEvent("onclick",e._breadcrumbEventHandler("click")),H.attachEvent("onkeypress",e._keypressEventHandler())));var o=q.chrome,a=!(o&&o.app&&o.app.runtime)&&q.history&&q.history.pushState&&q.history.replaceState;if(n.location&&a){var s=q.onpopstate;q.onpopstate=function(){var t=e._location.href;if(e._captureUrlChange(e._lastHref,t),s)return s.apply(this,arguments)};var u=function(t){return function(){var n=arguments.length>2?arguments[2]:void 0;return n&&e._captureUrlChange(e._lastHref,n+""),t.apply(this,arguments)}};x(q.history,"pushState",u,r),x(q.history,"replaceState",u,r)}if(n.console&&"console"in q&&console.log){var c=function(t,n){e.captureBreadcrumb({message:t,level:n.level,category:"console"})};w(["debug","info","warn","error","log"],function(t,e){B(console,e,c)})}},_restoreBuiltIns:function(){for(var t;this._wrappedBuiltIns.length;){var e=(t=this._wrappedBuiltIns.shift())[0],n=t[1],r=t[2];e[n]=r}},_restoreConsole:function(){for(var t in this._originalConsoleMethods)this._originalConsole[t]=this._originalConsoleMethods[t]},_drainPlugins:function(){var t=this;w(this._plugins,function(e,n){var r=n[0],i=n[1];r.apply(t,[t].concat(i))})},_parseDSN:function(t){var e=W.exec(t),n={},r=7;try{for(;r--;)n[V[r]]=e[r]||""}catch(e){throw new c("Invalid DSN: "+t)}if(n.pass&&!this._globalOptions.allowSecretKey)throw new c("Do not specify your secret key in the DSN. See: http://bit.ly/raven-secret-key");return n},_getGlobalServer:function(t){var e="//"+t.host+(t.port?":"+t.port:"");return t.protocol&&(e=t.protocol+":"+e),e},_handleOnErrorStackInfo:function(t,e){(e=e||{}).mechanism=e.mechanism||{type:"onerror",handled:!1},this._ignoreOnError||this._handleStackInfo(t,e)},_handleStackInfo:function(t,e){var n=this._prepareFrames(t,e);this._triggerEvent("handle",{stackInfo:t,options:e}),this._processException(t.name,t.message,t.url,t.lineno,n,e)},_prepareFrames:function(t,e){var n=this,r=[];if(t.stack&&t.stack.length&&(w(t.stack,function(e,i){var o=n._normalizeFrame(i,t.url);o&&r.push(o)}),e&&e.trimHeadFrames))for(var i=0;i<e.trimHeadFrames&&i<r.length;i++)r[i].in_app=!1;return r=r.slice(0,this._globalOptions.stackTraceLimit)},_normalizeFrame:function(t,e){var n={filename:t.url,lineno:t.line,colno:t.column,function:t.func||"?"};return t.url||(n.filename=e),n.in_app=!(this._globalOptions.includePaths.test&&!this._globalOptions.includePaths.test(n.filename)||/(Raven|TraceKit)\./.test(n.function)||/raven\.(min\.)?js$/.test(n.filename)),n},_processException:function(t,e,n,r,i,o){var a,s=(t?t+": ":"")+(e||"");if((!this._globalOptions.ignoreErrors.test||!this._globalOptions.ignoreErrors.test(e)&&!this._globalOptions.ignoreErrors.test(s))&&(i&&i.length?(n=i[0].filename||n,i.reverse(),a={frames:i}):n&&(a={frames:[{filename:n,lineno:r,in_app:!0}]}),(!this._globalOptions.ignoreUrls.test||!this._globalOptions.ignoreUrls.test(n))&&(!this._globalOptions.whitelistUrls.test||this._globalOptions.whitelistUrls.test(n)))){var u=S({exception:{values:[{type:t,value:e,stacktrace:a}]},transaction:n},o),c=u.exception.values[0];null==c.type&&""===c.value&&(c.value="Unrecoverable error caught"),!u.exception.mechanism&&u.mechanism&&(u.exception.mechanism=u.mechanism,delete u.mechanism),u.exception.mechanism=S({type:"generic",handled:!0},u.exception.mechanism||{}),this._send(u)}},_trimPacket:function(t){var e=this._globalOptions.maxMessageLength;if(t.message&&(t.message=T(t.message,e)),t.exception){var n=t.exception.values[0];n.value=T(n.value,e)}var r=t.request;return r&&(r.url&&(r.url=T(r.url,this._globalOptions.maxUrlLength)),r.Referer&&(r.Referer=T(r.Referer,this._globalOptions.maxUrlLength))),t.breadcrumbs&&t.breadcrumbs.values&&this._trimBreadcrumbs(t.breadcrumbs),t},_trimBreadcrumbs:function(t){for(var e,n,r,i=["to","from","url"],o=0;o<t.values.length;++o)if((n=t.values[o]).hasOwnProperty("data")&&v(n.data)&&!I(n.data)){r=S({},n.data);for(var a=0;a<i.length;++a)e=i[a],r.hasOwnProperty(e)&&r[e]&&(r[e]=T(r[e],this._globalOptions.maxUrlLength));t.values[o].data=r}},_getHttpData:function(){if(this._hasNavigator||this._hasDocument){var t={};return this._hasNavigator&&G.userAgent&&(t.headers={"User-Agent":G.userAgent}),q.location&&q.location.href&&(t.url=q.location.href),this._hasDocument&&H.referrer&&(t.headers||(t.headers={}),t.headers.Referer=H.referrer),t}},_resetBackoff:function(){this._backoffDuration=0,this._backoffStart=null},_shouldBackoff:function(){return this._backoffDuration&&r()-this._backoffStart<this._backoffDuration},_isRepeatData:function(t){var e=this._lastData;return!(!e||t.message!==e.message||t.transaction!==e.transaction)&&(t.stacktrace||e.stacktrace?P(t.stacktrace,e.stacktrace):!t.exception&&!e.exception||k(t.exception,e.exception))},_setBackoffState:function(t){if(!this._shouldBackoff()){var e=t.status;if(400===e||401===e||429===e){var n;try{n=M()?t.headers.get("Retry-After"):t.getResponseHeader("Retry-After"),n=1e3*parseInt(n,10)}catch(t){}this._backoffDuration=n||2*this._backoffDuration||1e3,this._backoffStart=r()}}},_send:function(t){var e=this._globalOptions,n={project:this._globalProject,logger:e.logger,platform:"javascript"},i=this._getHttpData();if(i&&(n.request=i),t.trimHeadFrames&&delete t.trimHeadFrames,(t=S(n,t)).tags=S(S({},this._globalContext.tags),t.tags),t.extra=S(S({},this._globalContext.extra),t.extra),t.extra["session:duration"]=r()-this._startTime,this._breadcrumbs&&this._breadcrumbs.length>0&&(t.breadcrumbs={values:[].slice.call(this._breadcrumbs,0)}),this._globalContext.user&&(t.user=this._globalContext.user),e.environment&&(t.environment=e.environment),e.release&&(t.release=e.release),e.serverName&&(t.server_name=e.serverName),t=this._sanitizeData(t),Object.keys(t).forEach(function(e){(null==t[e]||""===t[e]||E(t[e]))&&delete t[e]}),m(e.dataCallback)&&(t=e.dataCallback(t)||t),t&&!E(t)&&(!m(e.shouldSendCallback)||e.shouldSendCallback(t)))return this._shouldBackoff()?void this._logDebug("warn","Raven dropped error due to backoff: ",t):void("number"==typeof e.sampleRate?Math.random()<e.sampleRate&&this._sendProcessedPayload(t):this._sendProcessedPayload(t))},_sanitizeData:function(t){return j(t,this._globalOptions.sanitizeKeys)},_getUuid:function(){return R()},_sendProcessedPayload:function(t,e){var n=this,r=this._globalOptions;if(this.isSetup()){if(t=this._trimPacket(t),!this._globalOptions.allowDuplicates&&this._isRepeatData(t))return void this._logDebug("warn","Raven dropped repeat event: ",t);this._lastEventId=t.event_id||(t.event_id=this._getUuid()),this._lastData=t,this._logDebug("debug","Raven about to send:",t);var i={sentry_version:"7",sentry_client:"raven-js/"+this.VERSION,sentry_key:this._globalKey};this._globalSecret&&(i.sentry_secret=this._globalSecret);var o=t.exception&&t.exception.values[0];this._globalOptions.autoBreadcrumbs&&this._globalOptions.autoBreadcrumbs.sentry&&this.captureBreadcrumb({category:"sentry",message:o?(o.type?o.type+": ":"")+o.value:t.message,event_id:t.event_id,level:t.level||"error"});var a=this._globalEndpoint;(r.transport||this._makeRequest).call(this,{url:a,auth:i,data:t,options:r,onSuccess:function(){n._resetBackoff(),n._triggerEvent("success",{data:t,src:a}),e&&e()},onError:function(r){n._logDebug("error","Raven transport failed to send: ",r),r.request&&n._setBackoffState(r.request),n._triggerEvent("failure",{data:t,src:a}),r=r||new Error("Raven send failed (no additional details provided)"),e&&e(r)}})}},_makeRequest:function(t){var e=t.url+"?"+C(t.auth),n=null,r={};if(t.options.headers&&(n=this._evaluateHash(t.options.headers)),t.options.fetchParameters&&(r=this._evaluateHash(t.options.fetchParameters)),M()){r.body=s(t.data);var i=S({},this._fetchDefaults),o=S(i,r);return n&&(o.headers=n),q.fetch(e,o).then(function(e){if(e.ok)t.onSuccess&&t.onSuccess();else{var n=new Error("Sentry error code: "+e.status);n.request=e,t.onError&&t.onError(n)}}).catch(function(){t.onError&&t.onError(new Error("Sentry error code: network unavailable"))})}var a=q.XMLHttpRequest&&new q.XMLHttpRequest;a&&("withCredentials"in a||"undefined"!=typeof XDomainRequest)&&("withCredentials"in a?a.onreadystatechange=function(){if(4===a.readyState)if(200===a.status)t.onSuccess&&t.onSuccess();else if(t.onError){var e=new Error("Sentry error code: "+a.status);e.request=a,t.onError(e)}}:(a=new XDomainRequest,e=e.replace(/^https?:/,""),t.onSuccess&&(a.onload=t.onSuccess),t.onError&&(a.onerror=function(){var e=new Error("Sentry error code: XDomainRequest");e.request=a,t.onError(e)})),a.open("POST",e),n&&w(n,function(t,e){a.setRequestHeader(t,e)}),a.send(s(t.data)))},_evaluateHash:function(t){var e={};for(var n in t)if(t.hasOwnProperty(n)){var r=t[n];e[n]="function"==typeof r?r():r}return e},_logDebug:function(t){this._originalConsoleMethods[t]&&(this.debug||this._globalOptions.debug)&&Function.prototype.apply.call(this._originalConsoleMethods[t],this._originalConsole,[].slice.call(arguments,1))},_mergeContext:function(t,e){y(e)?delete this._globalContext[t]:this._globalContext[t]=S(this._globalContext[t]||{},e)}},o.prototype.setUser=o.prototype.setUserContext,o.prototype.setReleaseContext=o.prototype.setRelease,t.exports=o}).call(this,n(8))},function(t,e,n){(function(e){function r(){return"undefined"==typeof document||null==document.location?"":document.location.href}var i=n(164),o={collectWindowErrors:!0,debug:!1},a="undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{},s=[].slice,u="?",c=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/;o.report=function(){function t(t,e){var n=null;if(!e||o.collectWindowErrors){for(var r in p)if(p.hasOwnProperty(r))try{p[r].apply(null,[t].concat(s.call(arguments,2)))}catch(t){n=t}if(n)throw n}}function e(e,a,s,l,f){var p=i.isErrorEvent(f)?f.error:f,d=i.isErrorEvent(e)?e.message:e;if(g)o.computeStackTrace.augmentStackTraceWithInitialElement(g,a,s,d),n();else if(p&&i.isError(p))t(o.computeStackTrace(p),!0);else{var v,y={url:a,line:s,column:l},m=void 0;if("[object String]"==={}.toString.call(d))(v=d.match(c))&&(m=v[1],d=v[2]);y.func=u,t({name:m,message:d,url:r(),stack:[y]},!0)}return!!h&&h.apply(this,arguments)}function n(){var e=g,n=d;d=null,g=null,v=null,t.apply(null,[e,!1].concat(n))}function l(t,e){var r=s.call(arguments,1);if(g){if(v===t)return;n()}var i=o.computeStackTrace(t);if(g=i,v=t,d=r,setTimeout(function(){v===t&&n()},i.incomplete?2e3:0),!1!==e)throw t}var h,f,p=[],d=null,v=null,g=null;return l.subscribe=function(t){f||(h=a.onerror,a.onerror=e,f=!0),p.push(t)},l.unsubscribe=function(t){for(var e=p.length-1;e>=0;--e)p[e]===t&&p.splice(e,1)},l.uninstall=function(){f&&(a.onerror=h,f=!1,h=void 0),p=[]},l}(),o.computeStackTrace=function(){function t(t){if(void 0!==t.stack&&t.stack){for(var e,n,i,o=/^\s*at (?:(.*?) ?\()?((?:file|https?|blob|chrome-extension|native|eval|webpack|<anonymous>|[a-z]:|\/).*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,a=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:file|ms-appx(?:-web)|https?|webpack|blob):.*?):(\d+)(?::(\d+))?\)?\s*$/i,s=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)((?:file|https?|blob|chrome|webpack|resource|moz-extension).*?:\/.*?|\[native code\]|[^@]*bundle)(?::(\d+))?(?::(\d+))?\s*$/i,c=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,l=/\((\S*)(?::(\d+))(?::(\d+))\)/,h=t.stack.split("\n"),f=[],p=(/^(.*) is undefined$/.exec(t.message),0),d=h.length;p<d;++p){if(n=o.exec(h[p])){var v=n[2]&&0===n[2].indexOf("native");n[2]&&0===n[2].indexOf("eval")&&(e=l.exec(n[2]))&&(n[2]=e[1],n[3]=e[2],n[4]=e[3]),i={url:v?null:n[2],func:n[1]||u,args:v?[n[2]]:[],line:n[3]?+n[3]:null,column:n[4]?+n[4]:null}}else if(n=a.exec(h[p]))i={url:n[2],func:n[1]||u,args:[],line:+n[3],column:n[4]?+n[4]:null};else{if(!(n=s.exec(h[p])))continue;n[3]&&n[3].indexOf(" > eval")>-1&&(e=c.exec(n[3]))?(n[3]=e[1],n[4]=e[2],n[5]=null):0!==p||n[5]||void 0===t.columnNumber||(f[0].column=t.columnNumber+1),i={url:n[3],func:n[1]||u,args:n[2]?n[2].split(","):[],line:n[4]?+n[4]:null,column:n[5]?+n[5]:null}}if(!i.func&&i.line&&(i.func=u),i.url&&"blob:"===i.url.substr(0,5)){var g=new XMLHttpRequest;if(g.open("GET",i.url,!1),g.send(null),200===g.status){var y=g.responseText||"",m=(y=y.slice(-300)).match(/\/\/# sourceMappingURL=(.*)$/);if(m){var _=m[1];"~"===_.charAt(0)&&(_=("undefined"==typeof document||null==document.location?"":document.location.origin?document.location.origin:document.location.protocol+"//"+document.location.hostname+(document.location.port?":"+document.location.port:""))+_.slice(1)),i.url=_.slice(0,-4)}}}f.push(i)}return f.length?{name:t.name,message:t.message,url:r(),stack:f}:null}}function e(t,e,n,r){var i={url:e,line:n};if(i.url&&i.line){if(t.incomplete=!1,i.func||(i.func=u),t.stack.length>0&&t.stack[0].url===i.url){if(t.stack[0].line===i.line)return!1;if(!t.stack[0].line&&t.stack[0].func===i.func)return t.stack[0].line=i.line,!1}return t.stack.unshift(i),t.partial=!0,!0}return t.incomplete=!0,!1}function n(t,a){for(var s,c,l=/function\s+([_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*)?\s*\(/i,h=[],f={},p=!1,d=n.caller;d&&!p;d=d.caller)if(d!==i&&d!==o.report){if(c={url:null,func:u,line:null,column:null},d.name?c.func=d.name:(s=l.exec(d.toString()))&&(c.func=s[1]),void 0===c.func)try{c.func=s.input.substring(0,s.input.indexOf("{"))}catch(t){}f[""+d]?p=!0:f[""+d]=!0,h.push(c)}a&&h.splice(0,a);var v={name:t.name,message:t.message,url:r(),stack:h};return e(v,t.sourceURL||t.fileName,t.line||t.lineNumber,t.message||t.description),v}function i(e,i){var a=null;i=null==i?0:+i;try{if(a=t(e))return a}catch(t){if(o.debug)throw t}try{if(a=n(e,i+1))return a}catch(t){if(o.debug)throw t}return{name:e.name,message:e.message,url:r()}}return i.augmentStackTraceWithInitialElement=e,i.computeStackTraceFromStackProp=t,i}(),t.exports=o}).call(this,n(8))},function(t,e){function n(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}function r(t,e,r,i,o,a){return n(function(t,e){return t<<e|t>>>32-e}(n(n(e,t),n(i,a)),o),r)}function i(t,e,n,i,o,a,s){return r(e&n|~e&i,t,e,o,a,s)}function o(t,e,n,i,o,a,s){return r(e&i|n&~i,t,e,o,a,s)}function a(t,e,n,i,o,a,s){return r(e^n^i,t,e,o,a,s)}function s(t,e,n,i,o,a,s){return r(n^(e|~i),t,e,o,a,s)}function u(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;var r,u,c,l,h,f=1732584193,p=-271733879,d=-1732584194,v=271733878;for(r=0;r<t.length;r+=16)u=f,c=p,l=d,h=v,f=i(f,p,d,v,t[r],7,-680876936),v=i(v,f,p,d,t[r+1],12,-389564586),d=i(d,v,f,p,t[r+2],17,606105819),p=i(p,d,v,f,t[r+3],22,-1044525330),f=i(f,p,d,v,t[r+4],7,-176418897),v=i(v,f,p,d,t[r+5],12,1200080426),d=i(d,v,f,p,t[r+6],17,-1473231341),p=i(p,d,v,f,t[r+7],22,-45705983),f=i(f,p,d,v,t[r+8],7,1770035416),v=i(v,f,p,d,t[r+9],12,-1958414417),d=i(d,v,f,p,t[r+10],17,-42063),p=i(p,d,v,f,t[r+11],22,-1990404162),f=i(f,p,d,v,t[r+12],7,1804603682),v=i(v,f,p,d,t[r+13],12,-40341101),d=i(d,v,f,p,t[r+14],17,-1502002290),f=o(f,p=i(p,d,v,f,t[r+15],22,1236535329),d,v,t[r+1],5,-165796510),v=o(v,f,p,d,t[r+6],9,-1069501632),d=o(d,v,f,p,t[r+11],14,643717713),p=o(p,d,v,f,t[r],20,-373897302),f=o(f,p,d,v,t[r+5],5,-701558691),v=o(v,f,p,d,t[r+10],9,38016083),d=o(d,v,f,p,t[r+15],14,-660478335),p=o(p,d,v,f,t[r+4],20,-405537848),f=o(f,p,d,v,t[r+9],5,568446438),v=o(v,f,p,d,t[r+14],9,-1019803690),d=o(d,v,f,p,t[r+3],14,-187363961),p=o(p,d,v,f,t[r+8],20,1163531501),f=o(f,p,d,v,t[r+13],5,-1444681467),v=o(v,f,p,d,t[r+2],9,-51403784),d=o(d,v,f,p,t[r+7],14,1735328473),f=a(f,p=o(p,d,v,f,t[r+12],20,-1926607734),d,v,t[r+5],4,-378558),v=a(v,f,p,d,t[r+8],11,-2022574463),d=a(d,v,f,p,t[r+11],16,1839030562),p=a(p,d,v,f,t[r+14],23,-35309556),f=a(f,p,d,v,t[r+1],4,-1530992060),v=a(v,f,p,d,t[r+4],11,1272893353),d=a(d,v,f,p,t[r+7],16,-155497632),p=a(p,d,v,f,t[r+10],23,-1094730640),f=a(f,p,d,v,t[r+13],4,681279174),v=a(v,f,p,d,t[r],11,-358537222),d=a(d,v,f,p,t[r+3],16,-722521979),p=a(p,d,v,f,t[r+6],23,76029189),f=a(f,p,d,v,t[r+9],4,-640364487),v=a(v,f,p,d,t[r+12],11,-421815835),d=a(d,v,f,p,t[r+15],16,530742520),f=s(f,p=a(p,d,v,f,t[r+2],23,-995338651),d,v,t[r],6,-198630844),v=s(v,f,p,d,t[r+7],10,1126891415),d=s(d,v,f,p,t[r+14],15,-1416354905),p=s(p,d,v,f,t[r+5],21,-57434055),f=s(f,p,d,v,t[r+12],6,1700485571),v=s(v,f,p,d,t[r+3],10,-1894986606),d=s(d,v,f,p,t[r+10],15,-1051523),p=s(p,d,v,f,t[r+1],21,-2054922799),f=s(f,p,d,v,t[r+8],6,1873313359),v=s(v,f,p,d,t[r+15],10,-30611744),d=s(d,v,f,p,t[r+6],15,-1560198380),p=s(p,d,v,f,t[r+13],21,1309151649),f=s(f,p,d,v,t[r+4],6,-145523070),v=s(v,f,p,d,t[r+11],10,-1120210379),d=s(d,v,f,p,t[r+2],15,718787259),p=s(p,d,v,f,t[r+9],21,-343485551),f=n(f,u),p=n(p,c),d=n(d,l),v=n(v,h);return[f,p,d,v]}function c(t){var e,n="",r=32*t.length;for(e=0;e<r;e+=8)n+=String.fromCharCode(t[e>>5]>>>e%32&255);return n}function l(t){var e,n=[];for(n[(t.length>>2)-1]=void 0,e=0;e<n.length;e+=1)n[e]=0;var r=8*t.length;for(e=0;e<r;e+=8)n[e>>5]|=(255&t.charCodeAt(e/8))<<e%32;return n}function h(t){var e,n,r="0123456789abcdef",i="";for(n=0;n<t.length;n+=1)e=t.charCodeAt(n),i+=r.charAt(e>>>4&15)+r.charAt(15&e);return i}function f(t){return unescape(encodeURIComponent(t))}function p(t){return function(t){return c(u(l(t),8*t.length))}(f(t))}function d(t,e){return function(t,e){var n,r,i=l(t),o=[],a=[];for(o[15]=a[15]=void 0,i.length>16&&(i=u(i,8*t.length)),n=0;n<16;n+=1)o[n]=909522486^i[n],a[n]=1549556828^i[n];return r=u(o.concat(l(e)),512+8*e.length),c(u(a.concat(r),640))}(f(t),f(e))}t.exports=function(t,e,n){return e?n?d(e,t):function(t,e){return h(d(t,e))}(e,t):n?p(t):function(t){return h(p(t))}(t)}},function(t,e){function n(t){this.name="RavenConfigError",this.message=t}n.prototype=new Error,n.prototype.constructor=n,t.exports=n},function(t,e,n){var r=n(164);t.exports={wrapMethod:function(t,e,n){var i=t[e],o=t;if(e in t){var a="warn"===e?"warning":e;t[e]=function(){var t=[].slice.call(arguments),s=r.safeJoin(t," "),u={level:a,logger:"console",extra:{arguments:t}};"assert"===e?!1===t[0]&&(s="Assertion failed: "+(r.safeJoin(t.slice(1)," ")||"console.assert"),u.extra.arguments=t.slice(1),n&&n(s,u)):n&&n(s,u),i&&Function.prototype.apply.call(i,o,t)}}}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(9),i=n(163),o=r.Map({tabsPdfMode:r.Map({})});e.pdfReducer=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o,e=arguments[1],n=t;switch(e.type){case i.pdfActionConstants.SET_PDF_MODE:return n.setIn(["tabsPdfMode",e.tabId],e.mode);default:return n}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(9),i=n(104),o=n(249),a=r.fromJS({customerId:null,stripeData:{}});e.stripeReducer=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,e=arguments[1],n=t;switch(e.type){case o.stripeActionConstants.STRIPE_UPDATED:return e.stripeData?n=(n=n.set("customerId",e.stripeData.get("customerId"))).set("stripeData",e.stripeData.get("subscription")||r.fromJS({plan:{name:"Free"}})):n=n.set("stripeData",r.fromJS({plan:{name:"Free"}})),n;case i.firebaseDatabaseActionConstants.SIGN_OUT:return n.set("stripeData",r.fromJS({}));default:return n}}},function(t,e,n){"use strict";e.__esModule=!0,e.composeWithDevTools=e.default=void 0;var r=n(591);Object.defineProperty(e,"composeWithDevTools",{enumerable:!0,get:function(){return r.composeWithDevTools}});var i=function(t){return t&&t.__esModule?t:{default:t}}(r);e.default=i.default},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(){return(0,A.filterStagedActions)(x.liftedStore.getState(),L)}function o(){O||(O=P&&P.id||Math.random().toString(36).substr(2));try{fetch(H,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({type:"STATE",id:O,name:C,payload:(0,_.stringify)(i())})}).catch(function(t){console.log(t)})}catch(t){console.log(t)}}function a(t,e,n,r){var i={type:t,id:P.id,name:C};e&&(i.payload="ERROR"===t?e:(0,_.stringify)((0,A.filterState)(e,t,L,X,Y,r))),"ACTION"===t?(i.action=(0,_.stringify)(Y?Y(n.action,r-1):n),i.isExcess=F,i.nextActionId=r):n&&(i.action=n),P.emit(P.id?"log":"log-noid",i)}function s(t){"IMPORT"===t.type||"SYNC"===t.type&&P.id&&t.id!==P.id?x.liftedStore.dispatch({type:"IMPORT_STATE",nextLiftedState:(0,_.parse)(t.state)}):"UPDATE"===t.type?a("STATE",i()):"START"===t.type?(U=!0,"function"==typeof Q&&(Q=Q()),a("STATE",i(),Q)):"STOP"===t.type||"DISCONNECTED"===t.type?(U=!1,a("STOP")):"ACTION"===t.type?function(t){try{var e=(0,T.evalAction)(t,Q);x.dispatch(e)}catch(t){a("ERROR",t.message)}}(t.action):"DISPATCH"===t.type&&x.liftedStore.dispatch(t.action)}function u(t){setTimeout(t,0)}function c(t){t.message&&t.message===G||(G=t.message,u(function(){x.dispatch(t),j||o()}))}function l(t){return"string"==typeof t?[t]:t&&t.length}function h(t){j=!1,U=!1,P&&(P.destroyChannel(D),t?P.off(D,s):(P.off(),P.disconnect()))}function f(){j||P&&P.getState()===P.CONNECTING||((P=b.default.connect(k)).on("error",function(t){N[t.name]=N.hasOwnProperty(t.name)?N[t.name]+1:1,R?1===N[t.name]&&(console.log("remote-redux-devtools: Socket connection errors are being suppressed. \nThis can be disabled by setting suppressConnectErrors to 'false'."),console.log(t)):console.log(t)}),P.on("connect",function(){console.log("connected to remotedev-server"),N={},P.emit("login","master",function(t,e){t?console.log(t):(D=e,P.subscribe(e).watch(s),P.on(e,s))}),j=!0,a("START")}),P.on("disconnect",function(){h(!0)}))}function p(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x.liftedStore.getState();return!!t.computedStates[t.currentStateIndex].error&&(j?a("STATE",(0,A.filterStagedActions)(t,L)):o(),!0)}function d(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1];return M=e.type,!j&&2===q&&x.liftedStore?u(p):e.action&&(B&&!j&&-1!==B.indexOf(e.action.type)?u(f):V&&j&&-1!==V.indexOf(e.action.type)?u(h):W&&!j&&-1!==W.indexOf(e.action.type)&&u(o)),t}function v(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t){C=t.name;var e=t.filters||{},n=e.blacklist,r=e.whitelist;L=(0,A.getLocalFilter)({actionsBlacklist:n||t.actionsBlacklist,actionsWhitelist:r||t.actionsWhitelist}),k=t.port?{port:t.port,hostname:t.hostname||"localhost",secure:t.secure}:w.defaultSocketOptions,R=void 0===t.suppressConnectErrors||t.suppressConnectErrors,B=l(t.startOn),V=l(t.stopOn),W=l(t.sendOn),q=t.sendOnError,(W||q)&&(H=t.sendTo||(k.secure?"https":"http")+"://"+k.hostname+":"+k.port,O=t.id),1===q&&(0,I.default)(c),t.actionCreators&&(Q=function(){return(0,T.getActionsArray)(t.actionCreators)}),X=t.stateSanitizer,Y=t.actionSanitizer}(m({},t,{hostname:(0,S.default)(t.hostname||"localhost")}));var e=void 0!==t.realtime&&t.realtime;if(!e&&!(B||W||q))return function(t){return t};var n=t.maxAge||30;return function(r){return function(i,o){return x=(0,E.default)(r,d,{maxAge:n,shouldCatchErrors:!!q,shouldHotReload:t.shouldHotReload,shouldRecordChanges:t.shouldRecordChanges,shouldStartLocked:t.shouldStartLocked,pauseActionType:t.pauseActionType||"@@PAUSED"})(i,o),e&&f(),x.subscribe(function(){U&&function(t,e,n){if(!p(e))if("PERFORM_ACTION"===M){var r=e.nextActionId,i=e.actionsById[r-1];if((0,A.isFiltered)(i.action,L))return;a("ACTION",t,i,r),!F&&n&&(F=e.stagedActionIds.length>=n)}else{if("JUMP_TO_STATE"===M)return;if("PAUSE_RECORDING"===M?z=e.isPaused:"LOCK_CHANGES"===M&&(K=e.isLocked),z||K){if(!M)return;M=void 0}a("STATE",(0,A.filterStagedActions)(e,L))}}(x.getState(),x.liftedStore.getState(),n)}),x}}}function g(t){return function(e,n,r){return x=t(e,n,r),m({},x,{dispatch:function(t){return K?t:x.dispatch(t)}})}}e.__esModule=!0;var y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};e.default=v,e.preEnhancer=g,e.composeWithDevTools=function(){return 0===arguments.length?v():1===arguments.length&&"object"===y(arguments.length<=0?void 0:arguments[0])?J(arguments.length<=0?void 0:arguments[0]):J({}).apply(void 0,arguments)};var _=n(252),b=r(n(594)),E=r(n(614)),w=n(661),S=r(n(662)),T=n(663),I=r(n(676)),A=n(677),O=void 0,C=void 0,R=void 0,N={},k=void 0,P=void 0,D=void 0,x={},M=void 0,L=void 0,F=void 0,U=void 0,j=void 0,B=void 0,V=void 0,W=void 0,q=void 0,H=void 0,G=void 0,K=void 0,z=void 0,Q=void 0,X=void 0,Y=void 0;v.updateStore=function(t){console.warn("devTools.updateStore is deprecated use composeWithDevTools instead: https://github.com/zalmoxisus/remote-redux-devtools#use-devtools-compose-helper"),x=t};var J=function(t){return function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return function(){return[g].concat(n).reduceRight(function(t,e){return e(t)},v(t).apply(void 0,arguments))}}}},function(t,e,n){var r=(n(254),n(593)),i="undefined"!=typeof WeakMap?WeakMap:function(){var t=[],e=[];return{set:function(n,r){t.push(n),e.push(r)},get:function(n){for(var r=0;r<t.length;r++)if(t[r]===n)return e[r]}}};e.decycle=function t(e,n,o){"use strict";var a=new i,s=Object.prototype.hasOwnProperty.call(n,"circular");return function e(i,u,c){var l,h,f,p=o?o(c||"",i):i;if(n.date&&p instanceof Date)return{$jsan:"d"+p.getTime()};if(n.regex&&p instanceof RegExp)return{$jsan:"r"+r.getRegexFlags(p)+","+p.source};if(n.function&&"function"==typeof p)return{$jsan:"f"+r.stringifyFunction(p,n.function)};if(n.nan&&"number"==typeof p&&isNaN(p))return{$jsan:"n"};if(n.infinity){if(Number.POSITIVE_INFINITY===p)return{$jsan:"i"};if(Number.NEGATIVE_INFINITY===p)return{$jsan:"y"}}if(n.undefined&&void 0===p)return{$jsan:"u"};if(n.error&&p instanceof Error)return{$jsan:"e"+p.message};if(n.symbol&&"symbol"==typeof p){var d=Symbol.keyFor(p);return void 0!==d?{$jsan:"g"+d}:{$jsan:"s"+p.toString().slice(7,-1)}}if(n.map&&"function"==typeof Map&&p instanceof Map&&"function"==typeof Array.from)return{$jsan:"m"+JSON.stringify(t(Array.from(p),n,o))};if(n.set&&"function"==typeof Set&&p instanceof Set&&"function"==typeof Array.from)return{$jsan:"l"+JSON.stringify(t(Array.from(p),n,o))};if(p&&"function"==typeof p.toJSON)try{p=p.toJSON(c)}catch(t){var v=c||"$";return"toJSON failed for '"+(a.get(p)||v)+"'"}if(!("object"!=typeof p||null===p||p instanceof Boolean||p instanceof Date||p instanceof Number||p instanceof RegExp||p instanceof String||"symbol"==typeof p||p instanceof Error)){if("object"==typeof p&&null!==p){var g=a.get(p);if(g)return s&&0===u.indexOf(g)?"function"==typeof n.circular?n.circular(p,u,g):n.circular:{$jsan:g};a.set(p,u)}if("[object Array]"===Object.prototype.toString.apply(p))for(f=[],l=0;l<p.length;l+=1)f[l]=e(p[l],u+"["+l+"]",l);else for(h in f={},p)if(Object.prototype.hasOwnProperty.call(p,h)){var y=/^\w+$/.test(h)?"."+h:"["+JSON.stringify(h)+"]";f[h]="$jsan"===h?[e(p[h],u+y)]:e(p[h],u+y,h)}return f}return p}(e,"$")},e.retrocycle=function(t){"use strict";return function e(n){var i,o,a;if(n&&"object"==typeof n)if("[object Array]"===Object.prototype.toString.apply(n))for(i=0;i<n.length;i+=1)(o=n[i])&&"object"==typeof o&&(o.$jsan?n[i]=r.restore(o.$jsan,t):e(o));else for(a in n){if("string"==typeof n[a]&&"$jsan"===a)return r.restore(n.$jsan,t);"$jsan"===a&&(n[a]=n[a][0]),"object"==typeof n[a]&&(o=n[a])&&"object"==typeof o&&(o.$jsan?n[a]=r.restore(o.$jsan,t):e(o))}return n}(t)}},function(t,e,n){var r=n(254),i=n(253);e.getRegexFlags=function(t){var e="";return t.ignoreCase&&(e+="i"),t.global&&(e+="g"),t.multiline&&(e+="m"),e},e.stringifyFunction=function(t,e){if("function"==typeof e)return e(t);var n=t.toString(),r=n.match(/^[^{]*{|^[^=]*=>/),i=r?r[0]:"<function> ",o="}"===n[n.length-1]?"}":"";return i.replace(/\r\n|\n/g," ").replace(/\s+/g," ")+" /* ... */ "+o},e.restore=function(t,e){var n=t[0],o=t.slice(1);switch(n){case"$":return r(e,t);case"r":var a=o.indexOf(","),s=o.slice(0,a),u=o.slice(a+1);return RegExp(u,s);case"d":return new Date(+o);case"f":var c=function(){throw new Error("can't run jsan parsed function")};return c.toString=function(){return o},c;case"u":return;case"e":var l=new Error(o);return l.stack="Stack is unavailable for jsan parsed errors",l;case"s":return Symbol(o);case"g":return Symbol.for(o);case"m":return new Map(i.parse(o));case"l":return new Set(i.parse(o));case"n":return NaN;case"i":return 1/0;case"y":return-1/0;default:return console.warn("unknown type",t),t}}},function(t,e,n){var r=n(255),i=n(610);t.exports.factory=i,t.exports.SCClientSocket=r,t.exports.Emitter=n(115),t.exports.create=function(t){return i.create(t)},t.exports.connect=t.exports.create,t.exports.destroy=function(t){return i.destroy(t)},t.exports.clients=i.clients,t.exports.version="13.0.1"},function(t,e,n){"use strict";function r(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function i(t){return a[t>>18&63]+a[t>>12&63]+a[t>>6&63]+a[63&t]}function o(t,e,n){for(var r,o=[],a=e;a<n;a+=3)r=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),o.push(i(r));return o.join("")}e.byteLength=function(t){var e=r(t),n=e[0],i=e[1];return 3*(n+i)/4-i},e.toByteArray=function(t){for(var e,n=r(t),i=n[0],o=n[1],a=new u(function(t,e,n){return 3*(e+n)/4-n}(0,i,o)),c=0,l=o>0?i-4:i,h=0;h<l;h+=4)e=s[t.charCodeAt(h)]<<18|s[t.charCodeAt(h+1)]<<12|s[t.charCodeAt(h+2)]<<6|s[t.charCodeAt(h+3)],a[c++]=e>>16&255,a[c++]=e>>8&255,a[c++]=255&e;return 2===o&&(e=s[t.charCodeAt(h)]<<2|s[t.charCodeAt(h+1)]>>4,a[c++]=255&e),1===o&&(e=s[t.charCodeAt(h)]<<10|s[t.charCodeAt(h+1)]<<4|s[t.charCodeAt(h+2)]>>2,a[c++]=e>>8&255,a[c++]=255&e),a},e.fromByteArray=function(t){for(var e,n=t.length,r=n%3,i=[],s=0,u=n-r;s<u;s+=16383)i.push(o(t,s,s+16383>u?u:s+16383));return 1===r?(e=t[n-1],i.push(a[e>>2]+a[e<<4&63]+"==")):2===r&&(e=(t[n-2]<<8)+t[n-1],i.push(a[e>>10]+a[e>>4&63]+a[e<<2&63]+"=")),i.join("")};for(var a=[],s=[],u="undefined"!=typeof Uint8Array?Uint8Array:Array,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l=0,h=c.length;l<h;++l)a[l]=c[l],s[c.charCodeAt(l)]=l;s["-".charCodeAt(0)]=62,s["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,n,r,i){var o,a,s=8*i-r-1,u=(1<<s)-1,c=u>>1,l=-7,h=n?i-1:0,f=n?-1:1,p=t[e+h];for(h+=f,o=p&(1<<-l)-1,p>>=-l,l+=s;l>0;o=256*o+t[e+h],h+=f,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=r;l>0;a=256*a+t[e+h],h+=f,l-=8);if(0===o)o=1-c;else{if(o===u)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,r),o-=c}return(p?-1:1)*a*Math.pow(2,o-r)},e.write=function(t,e,n,r,i,o){var a,s,u,c=8*o-i-1,l=(1<<c)-1,h=l>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,d=r?1:-1,v=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=l):(a=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-a))<1&&(a--,u*=2),(e+=a+h>=1?f/u:f*Math.pow(2,1-h))*u>=2&&(a++,u/=2),a+h>=l?(s=0,a=l):a+h>=1?(s=(e*u-1)*Math.pow(2,i),a+=h):(s=e*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;t[n+p]=255&s,p+=d,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;t[n+p]=255&a,p+=d,a/=256,c-=8);t[n+p-d]|=128*v}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e,n){var r=n(115),i=function(t,e,n){r.call(this),this.PENDING="pending",this.SUBSCRIBED="subscribed",this.UNSUBSCRIBED="unsubscribed",this.name=t,this.state=this.UNSUBSCRIBED,this.client=e,this.options=n||{},this.setOptions(this.options)};(i.prototype=Object.create(r.prototype)).setOptions=function(t){t||(t={}),this.waitForAuth=t.waitForAuth||!1,this.batch=t.batch||!1,void 0!==t.data&&(this.data=t.data)},i.prototype.getState=function(){return this.state},i.prototype.subscribe=function(t){this.client.subscribe(this.name,t)},i.prototype.unsubscribe=function(){this.client.unsubscribe(this.name)},i.prototype.isSubscribed=function(t){return this.client.isSubscribed(this.name,t)},i.prototype.publish=function(t,e){this.client.publish(this.name,t,e)},i.prototype.watch=function(t){this.client.watch(this.name,t)},i.prototype.unwatch=function(t){this.client.unwatch(this.name,t)},i.prototype.watchers=function(){return this.client.watchers(this.name)},i.prototype.destroy=function(){this.client.destroyChannel(this.name)},t.exports.SCChannel=i},function(t,e){t.exports=function(t){var e=[],n=[];return function t(r,i){var o,a,s;if(!("object"!=typeof r||null===r||r instanceof Boolean||r instanceof Date||r instanceof Number||r instanceof RegExp||r instanceof String)){for(o=0;o<e.length;o+=1)if(e[o]===r)return{$ref:n[o]};if(e.push(r),n.push(i),"[object Array]"===Object.prototype.toString.apply(r))for(s=[],o=0;o<r.length;o+=1)s[o]=t(r[o],i+"["+o+"]");else for(a in s={},r)Object.prototype.hasOwnProperty.call(r,a)&&(s[a]=t(r[a],i+"["+JSON.stringify(a)+"]"));return s}return r}(t,"$")}},function(t,e,n){(function(e){var n=function(){this._internalStorage={},this.isLocalStorageEnabled=this._checkLocalStorageEnabled()};n.prototype._checkLocalStorageEnabled=function(){var t;try{e.localStorage,e.localStorage.setItem("__scLocalStorageTest",1),e.localStorage.removeItem("__scLocalStorageTest")}catch(e){t=e}return!t},n.prototype.saveToken=function(t,n,r,i){this.isLocalStorageEnabled&&e.localStorage?e.localStorage.setItem(t,n):this._internalStorage[t]=n,i&&i(null,n)},n.prototype.removeToken=function(t,n){var r;this.loadToken(t,function(t,e){r=e}),this.isLocalStorageEnabled&&e.localStorage?e.localStorage.removeItem(t):delete this._internalStorage[t],n&&n(null,r)},n.prototype.loadToken=function(t,n){n(null,this.isLocalStorageEnabled&&e.localStorage?e.localStorage.getItem(t):this._internalStorage[t]||null)},t.exports.AuthEngine=n}).call(this,n(8))},function(t,e,n){(function(e){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=/^[ \n\r\t]*[{\[]/,i=function(t){for(var e=new Uint8Array(t),r=e.length,i="",o=0;o<r;o+=3)i+=n[e[o]>>2],i+=n[(3&e[o])<<4|e[o+1]>>4],i+=n[(15&e[o+1])<<2|e[o+2]>>6],i+=n[63&e[o+2]];return r%3==2?i=i.substring(0,i.length-1)+"=":r%3==1&&(i=i.substring(0,i.length-2)+"=="),i},o=function(t,n){if(e.ArrayBuffer&&n instanceof e.ArrayBuffer)return{base64:!0,data:i(n)};if(e.Buffer){if(n instanceof e.Buffer)return{base64:!0,data:n.toString("base64")};if(n&&"Buffer"===n.type&&Array.isArray(n.data))return{base64:!0,data:(e.Buffer.from?e.Buffer.from(n.data):new e.Buffer(n.data)).toString("base64")}}return n};t.exports.decode=function(t){if(null==t)return null;if("#1"===t||"#2"===t)return t;var e=t.toString();if(!r.test(e))return e;try{return JSON.parse(e)}catch(t){}return e},t.exports.encode=function(t){return"#1"===t||"#2"===t?t:JSON.stringify(t,o)}}).call(this,n(8))},function(t,e,n){(function(e){var r,i,o=n(115),a=n(257).Response,s=n(258);e.WebSocket?(r=e.WebSocket,i=function(t,e){return new r(t)}):(r=n(605),i=function(t,e){return new r(t,null,e)});var u=n(116),c=u.TimeoutError,l=u.BadConnectionError,h=function(t,e,n){var r=this;this.state=this.CLOSED,this.auth=t,this.codec=e,this.options=n,this.connectTimeout=n.connectTimeout,this.pingTimeout=n.ackTimeout,this.pingTimeoutDisabled=!!n.pingTimeoutDisabled,this.callIdGenerator=n.callIdGenerator,this.authTokenName=n.authTokenName,this._pingTimeoutTicker=null,this._callbackMap={},this._batchSendList=[],this.state=this.CONNECTING;var o=this.uri(),a=i(o,this.options);a.binaryType=this.options.binaryType,this.socket=a,a.onopen=function(){r._onOpen()},a.onclose=function(t){var e;e=null==t.code?1005:t.code,r._onClose(e,t.reason)},a.onmessage=function(t,e){r._onMessage(t.data)},a.onerror=function(t){r.state===r.CONNECTING&&r._onClose(1006)},this._connectTimeoutRef=setTimeout(function(){r._onClose(4007),r.socket.close(4007)},this.connectTimeout)};h.prototype=Object.create(o.prototype),h.CONNECTING=h.prototype.CONNECTING="connecting",h.OPEN=h.prototype.OPEN="open",h.CLOSED=h.prototype.CLOSED="closed",h.prototype.uri=function(){var t,e=this.options.query||{},n=this.options.secure?"wss":"ws";if(this.options.timestampRequests&&(e[this.options.timestampParam]=(new Date).getTime()),(e=s.encode(e)).length&&(e="?"+e),this.options.host)t=this.options.host;else{var r="";this.options.port&&("wss"==n&&443!=this.options.port||"ws"==n&&80!=this.options.port)&&(r=":"+this.options.port),t=this.options.hostname+r}return n+"://"+t+this.options.path+e},h.prototype._onOpen=function(){var t=this;clearTimeout(this._connectTimeoutRef),this._resetPingTimeout(),this._handshake(function(e,n){var r;e?(r=n&&n.code?n.code:4003,t._onError(e),t._onClose(r,e.toString()),t.socket.close(r)):(t.state=t.OPEN,o.prototype.emit.call(t,"open",n),t._resetPingTimeout())})},h.prototype._handshake=function(t){var e=this;this.auth.loadToken(this.authTokenName,function(n,r){if(n)t(n);else{e.emit("#handshake",{authToken:r},{force:!0},function(e,n){n&&(n.authToken=r,n.authError&&(n.authError=u.hydrateError(n.authError))),t(e,n)})}})},h.prototype._abortAllPendingEventsDueToBadConnection=function(t){for(var e in this._callbackMap)if(this._callbackMap.hasOwnProperty(e)){var n=this._callbackMap[e];delete this._callbackMap[e],clearTimeout(n.timeout),delete n.timeout;var r="Event '"+n.event+"' was aborted due to a bad connection",i=new l(r,t),o=n.callback;delete n.callback,o.call(n,i,n)}},h.prototype._onClose=function(t,e){delete this.socket.onopen,delete this.socket.onclose,delete this.socket.onmessage,delete this.socket.onerror,clearTimeout(this._connectTimeoutRef),clearTimeout(this._pingTimeoutTicker),clearTimeout(this._batchTimeout),this.state==this.OPEN?(this.state=this.CLOSED,o.prototype.emit.call(this,"close",t,e),this._abortAllPendingEventsDueToBadConnection("disconnect")):this.state==this.CONNECTING&&(this.state=this.CLOSED,o.prototype.emit.call(this,"openAbort",t,e),this._abortAllPendingEventsDueToBadConnection("connectAbort"))},h.prototype._handleEventObject=function(t,e){if(t&&null!=t.event){var n=new a(this,t.cid);o.prototype.emit.call(this,"event",t.event,t.data,n)}else if(t&&null!=t.rid){var r=this._callbackMap[t.rid];if(r&&(clearTimeout(r.timeout),delete r.timeout,delete this._callbackMap[t.rid],r.callback)){var i=u.hydrateError(t.error);r.callback(i,t.data)}}else o.prototype.emit.call(this,"event","raw",e)},h.prototype._onMessage=function(t){o.prototype.emit.call(this,"event","message",t);var e=this.decode(t);if("#1"==e)this._resetPingTimeout(),this.socket.readyState==this.socket.OPEN&&this.sendObject("#2");else if(Array.isArray(e))for(var n=e.length,r=0;r<n;r++)this._handleEventObject(e[r],t);else this._handleEventObject(e,t)},h.prototype._onError=function(t){o.prototype.emit.call(this,"error",t)},h.prototype._resetPingTimeout=function(){if(!this.pingTimeoutDisabled){var t=this;(new Date).getTime(),clearTimeout(this._pingTimeoutTicker),this._pingTimeoutTicker=setTimeout(function(){t._onClose(4e3),t.socket.close(4e3)},this.pingTimeout)}},h.prototype.getBytesReceived=function(){return this.socket.bytesReceived},h.prototype.close=function(t,e){if(t=t||1e3,this.state==this.OPEN){var n={code:t,data:e};this.emit("#disconnect",n),this._onClose(t,e),this.socket.close(t)}else this.state==this.CONNECTING&&(this._onClose(t,e),this.socket.close(t))},h.prototype.emitObject=function(t,e){var n={event:t.event,data:t.data};return t.callback&&(n.cid=t.cid=this.callIdGenerator(),this._callbackMap[t.cid]=t),this.sendObject(n,e),t.cid||null},h.prototype._handleEventAckTimeout=function(t){t.cid&&delete this._callbackMap[t.cid],delete t.timeout;var e=t.callback;if(e){delete t.callback;var n=new c("Event response for '"+t.event+"' timed out");e.call(t,n,t)}},h.prototype.emit=function(t,e,n,r){var i,o,a=this;r?(o=n,i=r):n instanceof Function?(o={},i=n):o=n;var s={event:t,data:e,callback:i};i&&!o.noTimeout&&(s.timeout=setTimeout(function(){a._handleEventAckTimeout(s)},this.options.ackTimeout));var u=null;return(this.state==this.OPEN||o.force)&&(u=this.emitObject(s,o)),u},h.prototype.cancelPendingResponse=function(t){delete this._callbackMap[t]},h.prototype.decode=function(t){return this.codec.decode(t)},h.prototype.encode=function(t){return this.codec.encode(t)},h.prototype.send=function(t){this.socket.readyState!=this.socket.OPEN?this._onClose(1005):this.socket.send(t)},h.prototype.serializeObject=function(t){var e,n;try{e=this.encode(t)}catch(t){n=t,this._onError(n)}return n?null:e},h.prototype.sendObjectBatch=function(t){var e=this;this._batchSendList.push(t),this._batchTimeout||(this._batchTimeout=setTimeout(function(){if(delete e._batchTimeout,e._batchSendList.length){var t=e.serializeObject(e._batchSendList);null!=t&&e.send(t),e._batchSendList=[]}},this.options.pubSubBatchDuration||0))},h.prototype.sendObjectSingle=function(t){var e=this.serializeObject(t);null!=e&&this.send(e)},h.prototype.sendObject=function(t,e){e&&e.batch?this.sendObjectBatch(t):this.sendObjectSingle(t)},t.exports.SCTransport=h}).call(this,n(8))},function(t,e,n){"use strict";function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,e,n,o){e=e||"&",n=n||"=";var a={};if("string"!=typeof t||0===t.length)return a;var s=/\+/g;t=t.split(e);var u=1e3;o&&"number"==typeof o.maxKeys&&(u=o.maxKeys);var c=t.length;u>0&&c>u&&(c=u);for(var l=0;l<c;++l){var h,f,p,d,v=t[l].replace(s,"%20"),g=v.indexOf(n);g>=0?(h=v.substr(0,g),f=v.substr(g+1)):(h=v,f=""),p=decodeURIComponent(h),d=decodeURIComponent(f),r(a,p)?i(a[p])?a[p].push(d):a[p]=[a[p],d]:a[p]=d}return a};var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},function(t,e,n){"use strict";function r(t,e){if(t.map)return t.map(e);for(var n=[],r=0;r<t.length;r++)n.push(e(t[r],r));return n}var i=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,e,n,s){return e=e||"&",n=n||"=",null===t&&(t=void 0),"object"==typeof t?r(a(t),function(a){var s=encodeURIComponent(i(a))+n;return o(t[a])?r(t[a],function(t){return s+encodeURIComponent(i(t))}).join(e):s+encodeURIComponent(i(t[a]))}).join(e):s?encodeURIComponent(i(s))+n+encodeURIComponent(i(t)):""};var o=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},a=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return e}},function(t,e){function n(t,e,n){return e?new i(t,e):new i(t)}var r,i=(r="undefined"!=typeof WorkerGlobalScope?self:"undefined"!=typeof window&&window||function(){return this}()).WebSocket||r.MozWebSocket;i&&(n.prototype=i.prototype),t.exports=i?n:null},function(t,e,n){"use strict";t.exports=n(607)},function(t,e,n){"use strict";function r(){if(arguments.length)return r.from(arguments)}function i(){}var o,a;o="An argument without append, prepend, or detach methods was given to `List",a=r.prototype,r.of=function(){return r.from.call(this,arguments)},r.from=function(t){var e,n,r,i=new this;if(t&&(e=t.length))for(n=-1;++n<e;)null!==(r=t[n])&&void 0!==r&&i.append(r);return i},a.head=null,a.tail=null,a.toArray=function(){for(var t=this.head,e=[];t;)e.push(t),t=t.next;return e},a.prepend=function(t){if(!t)return!1;if(!t.append||!t.prepend||!t.detach)throw new Error(o+"#prepend`.");var e,n;return(n=(e=this).head)?n.prepend(t):(t.detach(),t.list=e,e.head=t,t)},a.append=function(t){if(!t)return!1;if(!t.append||!t.prepend||!t.detach)throw new Error(o+"#append`.");var e,n,r;return(r=(e=this).tail)?r.append(t):(n=e.head)?n.append(t):(t.detach(),t.list=e,e.head=t,t)},r.Item=i;var s=i.prototype;s.next=null,s.prev=null,s.list=null,s.detach=function(){var t=this,e=t.list,n=t.prev,r=t.next;return e?(e.tail===t&&(e.tail=n),e.head===t&&(e.head=r),e.tail===e.head&&(e.tail=null),n&&(n.next=r),r&&(r.prev=n),t.prev=t.next=t.list=null,t):t},s.prepend=function(t){if(!(t&&t.append&&t.prepend&&t.detach))throw new Error(o+"Item#prepend`.");var e=this,n=e.list,r=e.prev;return!!n&&(t.detach(),r&&(t.prev=r,r.next=t),t.next=e,t.list=n,e.prev=t,e===n.head&&(n.head=t),n.tail||(n.tail=e),t)},s.append=function(t){if(!(t&&t.append&&t.prepend&&t.detach))throw new Error(o+"Item#append`.");var e=this,n=e.list,r=e.next;return!!n&&(t.detach(),r&&(t.next=r,r.prev=t),t.prev=e,t.list=n,e.next=t,e!==n.tail&&n.tail||(n.tail=t),t)},t.exports=r},function(t,e,n){(function(t,r){var i;!function(r){t&&t.exports;var o=function(t){this.message=t};(o.prototype=new Error).name="InvalidCharacterError";var a=function(t){throw new o(t)},s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u=/[\t\n\f\r ]/g,c={encode:function(t){t=String(t),/[^\0-\xFF]/.test(t)&&a("The string to be encoded contains characters outside of the Latin1 range.");for(var e,n,r,i,o=t.length%3,u="",c=-1,l=t.length-o;++c<l;)e=t.charCodeAt(c)<<16,n=t.charCodeAt(++c)<<8,r=t.charCodeAt(++c),u+=s.charAt((i=e+n+r)>>18&63)+s.charAt(i>>12&63)+s.charAt(i>>6&63)+s.charAt(63&i);return 2==o?(e=t.charCodeAt(c)<<8,n=t.charCodeAt(++c),u+=s.charAt((i=e+n)>>10)+s.charAt(i>>4&63)+s.charAt(i<<2&63)+"="):1==o&&(i=t.charCodeAt(c),u+=s.charAt(i>>2)+s.charAt(i<<4&63)+"=="),u},decode:function(t){var e=(t=String(t).replace(u,"")).length;e%4==0&&(e=(t=t.replace(/==?$/,"")).length),(e%4==1||/[^+a-zA-Z0-9\/]/.test(t))&&a("Invalid character: the string to be decoded is not correctly encoded.");for(var n,r,i=0,o="",c=-1;++c<e;)r=s.indexOf(t.charAt(c)),n=i%4?64*n+r:r,i++%4&&(o+=String.fromCharCode(255&n>>(-2*i&6)));return o},version:"0.1.0"};void 0!==(i=function(){return c}.call(e,n,e,t))&&(t.exports=i)}()}).call(this,n(113)(t),n(8))},function(t,e,n){(function(e){var n=function(){"use strict";function t(t,e){return null!=e&&t instanceof e}function n(r,u,c,l,h){"object"==typeof u&&(c=u.depth,l=u.prototype,h=u.includeNonEnumerable,u=u.circular);var f=[],p=[],d=void 0!==e;return void 0===u&&(u=!0),void 0===c&&(c=1/0),function r(c,v){if(null===c)return null;if(0===v)return c;var g,y;if("object"!=typeof c)return c;if(t(c,o))g=new o;else if(t(c,a))g=new a;else if(t(c,s))g=new s(function(t,e){c.then(function(e){t(r(e,v-1))},function(t){e(r(t,v-1))})});else if(n.__isArray(c))g=[];else if(n.__isRegExp(c))g=new RegExp(c.source,i(c)),c.lastIndex&&(g.lastIndex=c.lastIndex);else if(n.__isDate(c))g=new Date(c.getTime());else{if(d&&e.isBuffer(c))return g=new e(c.length),c.copy(g),g;t(c,Error)?g=Object.create(c):void 0===l?(y=Object.getPrototypeOf(c),g=Object.create(y)):(g=Object.create(l),y=l)}if(u){var m=f.indexOf(c);if(-1!=m)return p[m];f.push(c),p.push(g)}for(var _ in t(c,o)&&c.forEach(function(t,e){var n=r(e,v-1),i=r(t,v-1);g.set(n,i)}),t(c,a)&&c.forEach(function(t){var e=r(t,v-1);g.add(e)}),c){var b;y&&(b=Object.getOwnPropertyDescriptor(y,_)),b&&null==b.set||(g[_]=r(c[_],v-1))}if(Object.getOwnPropertySymbols){var E=Object.getOwnPropertySymbols(c);for(_=0;_<E.length;_++){var w=E[_];(!(T=Object.getOwnPropertyDescriptor(c,w))||T.enumerable||h)&&(g[w]=r(c[w],v-1),T.enumerable||Object.defineProperty(g,w,{enumerable:!1}))}}if(h){var S=Object.getOwnPropertyNames(c);for(_=0;_<S.length;_++){var T,I=S[_];(T=Object.getOwnPropertyDescriptor(c,I))&&T.enumerable||(g[I]=r(c[I],v-1),Object.defineProperty(g,I,{enumerable:!1}))}}return g}(r,c)}function r(t){return Object.prototype.toString.call(t)}function i(t){var e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),e}var o,a,s;try{o=Map}catch(t){o=function(){}}try{a=Set}catch(t){a=function(){}}try{s=Promise}catch(t){s=function(){}}return n.clonePrototype=function(t){if(null===t)return null;var e=function(){};return e.prototype=t,new e},n.__objToStr=r,n.__isDate=function(t){return"object"==typeof t&&"[object Date]"===r(t)},n.__isArray=function(t){return"object"==typeof t&&"[object Array]"===r(t)},n.__isRegExp=function(t){return"object"==typeof t&&"[object RegExp]"===r(t)},n.__getRegExpFlags=i,n}();t.exports&&(t.exports=n)}).call(this,n(256).Buffer)},function(t,e,n){(function(e){function r(t,n){var r=null==t.secure?n:t.secure;return t.port||(e.location&&location.port?location.port:r?443:80)}var i=n(255),o=n(116),a=n(611),s=o.InvalidArgumentsError,u={};t.exports={create:function(t){if((t=t||{}).host&&!t.host.match(/[^:]+:\d{2,5}/))throw new s('The host option should include both the hostname and the port number in the format "hostname:port"');if(t.host&&t.hostname)throw new s('The host option should already include the hostname and the port number in the format "hostname:port" - Because of this, you should never use host and hostname options together');if(t.host&&t.port)throw new s('The host option should already include the hostname and the port number in the format "hostname:port" - Because of this, you should never use host and port options together');var n=e.location&&"https:"==location.protocol,o={port:r(t,n),hostname:e.location&&location.hostname||"localhost",path:"/socketcluster/",secure:n,autoConnect:!0,autoReconnect:!0,autoSubscribeOnConnect:!0,connectTimeout:2e4,ackTimeout:1e4,timestampRequests:!1,timestampParam:"t",authEngine:null,authTokenName:"socketCluster.authToken",binaryType:"arraybuffer",multiplex:!0,pubSubBatchDuration:null,cloneData:!1};for(var c in t)t.hasOwnProperty(c)&&(o[c]=t[c]);if(o.clientMap=u,!1===o.multiplex){o.clientId=a.v4();var l=new i(o);return u[o.clientId]=l,l}return o.clientId=function(t){var e=t.secure?"https://":"http://",n="";if(t.query)if("string"==typeof t.query)n=t.query;else{var r=[],i=t.query;for(var o in i)i.hasOwnProperty(o)&&r.push(o+"="+i[o]);r.length&&(n="?"+r.join("&"))}return e+(t.host?t.host:t.hostname+":"+t.port)+t.path+n}(o),u[o.clientId]?o.autoConnect&&u[o.clientId].connect():u[o.clientId]=new i(o),u[o.clientId]},destroy:function(t){t.destroy()},clients:u}}).call(this,n(8))},function(t,e,n){var r=n(612),i=n(613),o=i;o.v1=r,o.v4=i,t.exports=o},function(t,e,n){var r,i,o=n(259),a=n(260),s=0,u=0;t.exports=function(t,e,n){var c=e&&n||0,l=e||[],h=(t=t||{}).node||r,f=void 0!==t.clockseq?t.clockseq:i;if(null==h||null==f){var p=o();null==h&&(h=r=[1|p[0],p[1],p[2],p[3],p[4],p[5]]),null==f&&(f=i=16383&(p[6]<<8|p[7]))}var d=void 0!==t.msecs?t.msecs:(new Date).getTime(),v=void 0!==t.nsecs?t.nsecs:u+1,g=d-s+(v-u)/1e4;if(g<0&&void 0===t.clockseq&&(f=f+1&16383),(g<0||d>s)&&void 0===t.nsecs&&(v=0),v>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=d,u=v,i=f;var y=(1e4*(268435455&(d+=122192928e5))+v)%4294967296;l[c++]=y>>>24&255,l[c++]=y>>>16&255,l[c++]=y>>>8&255,l[c++]=255&y;var m=d/4294967296*1e4&268435455;l[c++]=m>>>8&255,l[c++]=255&m,l[c++]=m>>>24&15|16,l[c++]=m>>>16&255,l[c++]=f>>>8|128,l[c++]=255&f;for(var _=0;_<6;++_)l[c+_]=h[_];return e||a(l)}},function(t,e,n){var r=n(259),i=n(260);t.exports=function(t,e,n){var o=e&&n||0;"string"==typeof t&&(e="binary"===t?new Array(16):null,t=null);var a=(t=t||{}).random||(t.rng||r)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,e)for(var s=0;s<16;++s)e[o+s]=a[s];return e||i(a)}},function(t,e,n){"use strict";e.__esModule=!0,e.default=function(t,e,n){return(0,r.default)(e,n)(t)};var r=function(t){return t&&t.__esModule?t:{default:t}}(n(615))},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e,n,r){return r?function(t,e,n){var r=n,i=void 0;try{r=t(n,e)}catch(t){i=t.toString(),"object"===("undefined"==typeof window?"undefined":h(window))&&(void 0!==window.chrome||void 0!==window.process&&"renderer"===window.process.type)?setTimeout(function(){throw t}):console.error(t)}return{state:r,error:i}}(t,e,n):{state:t(n,e)}}function o(t,e,n,r,o,a,s,u){if(!t||-1===e||e>=t.length&&t.length===a.length)return t;for(var c=t.slice(0,e),l=e;l<a.length;l++){var h,f=a[l],p=o[f].action,d=c[l-1],v=d?d.state:r;h=s.indexOf(f)>-1?d:u&&d&&d.error?{state:v,error:"Interrupted by an error up the chain"}:i(n,p,v,u),c.push(h)}return c}function a(t){return y.performAction(t)}function s(t,e,n,r){var s={monitorState:n(void 0,{}),nextActionId:1,actionsById:{0:a(m)},stagedActionIds:[0],skippedActionIds:[],committedState:e,currentStateIndex:0,computedStates:[],isLocked:!0===r.shouldStartLocked,isPaused:!1===r.shouldRecordChanges};return function(u,c){function h(t){for(var e=t,n=E.slice(1,e+1),r=0;r<n.length;r++){if(I[r+1].error){e=r,n=E.slice(1,e+1);break}delete _[n[r]]}w=w.filter(function(t){return-1===n.indexOf(t)}),E=[0].concat(E.slice(e+1)),S=I[e].state,I=I.slice(e),T=T>e?T-e:0}function d(e){var o,s=void 0;return e?(s=I[T],y=n(y,c)):s=i(t,c.action,I[T].state,!1),r.pauseActionType&&1!==b?(e&&(T===E.length-1&&T++,E=[].concat(E,[b]),b++),{monitorState:y,actionsById:l({},_,(o={},o[b-1]=a({type:r.pauseActionType}),o)),nextActionId:b,stagedActionIds:E,skippedActionIds:w,committedState:S,currentStateIndex:T,computedStates:[].concat(I.slice(0,E.length-1),[s]),isLocked:A,isPaused:!0}):{monitorState:y,actionsById:{0:a(m)},nextActionId:1,stagedActionIds:[0],skippedActionIds:[],committedState:s.state,currentStateIndex:0,computedStates:[s],isLocked:A,isPaused:!0}}var v=u||s,y=v.monitorState,_=v.actionsById,b=v.nextActionId,E=v.stagedActionIds,w=v.skippedActionIds,S=v.committedState,T=v.currentStateIndex,I=v.computedStates,A=v.isLocked,O=v.isPaused;u||(_=l({},_));var C=0;if(/^@@redux\/(INIT|REPLACE)/.test(c.type))!1===r.shouldHotReload&&(_={0:a(m)},b=1,E=[0],w=[],S=0===I.length?e:I[T].state,T=0,I=[]),C=0,r.maxAge&&E.length>r.maxAge&&(I=o(I,C,t,S,_,E,w,r.shouldCatchErrors),h(E.length-r.maxAge),C=1/0);else switch(c.type){case g.PERFORM_ACTION:if(A)return u||s;if(O)return d();r.maxAge&&E.length===r.maxAge&&h(1),T===E.length-1&&T++;var R=b++;_[R]=c,C=(E=[].concat(E,[R])).length-1;break;case g.RESET:_={0:a(m)},b=1,E=[0],w=[],S=e,T=0,I=[];break;case g.COMMIT:_={0:a(m)},b=1,E=[0],w=[],S=I[T].state,T=0,I=[];break;case g.ROLLBACK:_={0:a(m)},b=1,E=[0],w=[],T=0,I=[];break;case g.TOGGLE_ACTION:var N=c.id,k=w.indexOf(N);w=-1===k?[N].concat(w):w.filter(function(t){return t!==N}),C=E.indexOf(N);break;case g.SET_ACTIONS_ACTIVE:for(var P=c.start,D=c.end,x=c.active,M=[],L=P;L<D;L++)M.push(L);w=x?(0,f.default)(w,M):(0,p.default)(w,M),C=E.indexOf(P);break;case g.JUMP_TO_STATE:T=c.index,C=1/0;break;case g.JUMP_TO_ACTION:var F=E.indexOf(c.actionId);-1!==F&&(T=F),C=1/0;break;case g.SWEEP:E=(0,f.default)(E,w),w=[],T=Math.min(T,E.length-1);break;case g.REORDER_ACTION:var U=c.actionId,j=E.indexOf(U);if(j<1)break;var B=c.beforeActionId,V=E.indexOf(B);if(V<1){var W=E.length;V=B>E[W-1]?W:1}var q=j-V;q>0?(E=[].concat(E.slice(0,V),[U],E.slice(V,j),E.slice(j+1)),C=V):q<0&&(E=[].concat(E.slice(0,j),E.slice(j+1,V),[U],E.slice(V)),C=j);break;case g.IMPORT_STATE:if(Array.isArray(c.nextLiftedState))_={0:a(m)},b=1,E=[0],w=[],T=c.nextLiftedState.length,I=[],S=c.preloadedState,C=0,c.nextLiftedState.forEach(function(t){_[b]=a(t),E.push(b),b++});else{var H=c.nextLiftedState;y=H.monitorState,_=H.actionsById,b=H.nextActionId,E=H.stagedActionIds,w=H.skippedActionIds,S=H.committedState,T=H.currentStateIndex,I=H.computedStates,c.noRecompute&&(C=1/0)}break;case g.LOCK_CHANGES:A=c.status,C=1/0;break;case g.PAUSE_RECORDING:if(O=c.status)return d(!0);_={0:a(m)},b=1,E=[0],w=[],S=I[T].state,T=0,I=[];break;default:C=1/0}return I=o(I,C,t,S,_,E,w,r.shouldCatchErrors),{monitorState:y=n(y,c),actionsById:_,nextActionId:b,stagedActionIds:E,skippedActionIds:w,committedState:S,currentStateIndex:T,computedStates:I,isLocked:A,isPaused:O}}}function u(t){return t.computedStates[t.currentStateIndex].state}function c(t,e){function n(){var e=u(t.getState());return void 0!==e&&(i=e),i}var r,i=void 0;return l({},t,((r={liftedStore:t,dispatch:function(e){return t.dispatch(a(e)),e},getState:n,replaceReducer:function(n){t.replaceReducer(e(n))}})[v.default]=function(){return l({},t[v.default](),{subscribe:function(e){function r(){e.next&&e.next(n())}if("object"!==(void 0===e?"undefined":h(e)))throw new TypeError("Expected the observer to be an object.");return r(),{unsubscribe:t.subscribe(r)}}})},r))}e.__esModule=!0,e.INIT_ACTION=e.ActionCreators=e.ActionTypes=void 0;var l=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.liftAction=a,e.liftReducerWith=s,e.unliftState=u,e.unliftStore=c,e.default=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){return null},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null!=e.maxAge&&e.maxAge<2)throw new Error("DevTools.instrument({ maxAge }) option, if specified, may not be less than 2.");return function(n){return function(r,i,o){function a(n){if("function"!=typeof n){if(n&&"function"==typeof n.default)throw new Error('Expected the reducer to be a function. Instead got an object with a "default" field. Did you pass a module instead of the default export? Try passing require(...).default instead.');throw new Error("Expected the reducer to be a function.")}return s(n,i,t,e)}var u=n(a(r),o);if(u.liftedStore)throw new Error("DevTools instrumentation should not be applied more than once. Check your store configuration.");return c(u,a)}}};var f=r(n(616)),p=r(n(655)),d=r(n(659)),v=r(n(123)),g=e.ActionTypes={PERFORM_ACTION:"PERFORM_ACTION",RESET:"RESET",ROLLBACK:"ROLLBACK",COMMIT:"COMMIT",SWEEP:"SWEEP",TOGGLE_ACTION:"TOGGLE_ACTION",SET_ACTIONS_ACTIVE:"SET_ACTIONS_ACTIVE",JUMP_TO_STATE:"JUMP_TO_STATE",JUMP_TO_ACTION:"JUMP_TO_ACTION",REORDER_ACTION:"REORDER_ACTION",IMPORT_STATE:"IMPORT_STATE",LOCK_CHANGES:"LOCK_CHANGES",PAUSE_RECORDING:"PAUSE_RECORDING"},y=e.ActionCreators={performAction:function(t){if(!(0,d.default)(t))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===t.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');return{type:g.PERFORM_ACTION,action:t,timestamp:Date.now()}},reset:function(){return{type:g.RESET,timestamp:Date.now()}},rollback:function(){return{type:g.ROLLBACK,timestamp:Date.now()}},commit:function(){return{type:g.COMMIT,timestamp:Date.now()}},sweep:function(){return{type:g.SWEEP}},toggleAction:function(t){return{type:g.TOGGLE_ACTION,id:t}},setActionsActive:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return{type:g.SET_ACTIONS_ACTIVE,start:t,end:e,active:n}},reorderAction:function(t,e){return{type:g.REORDER_ACTION,actionId:t,beforeActionId:e}},jumpToState:function(t){return{type:g.JUMP_TO_STATE,index:t}},jumpToAction:function(t){return{type:g.JUMP_TO_ACTION,actionId:t}},importState:function(t,e){return{type:g.IMPORT_STATE,nextLiftedState:t,noRecompute:e}},lockChanges:function(t){return{type:g.LOCK_CHANGES,status:t}},pauseRecording:function(t){return{type:g.PAUSE_RECORDING,status:t}}},m=e.INIT_ACTION={type:"@@INIT"}},function(t,e,n){var r=n(617),i=n(269),o=n(271),a=n(273),s=o(function(t,e){return a(t)?r(t,i(e,1,a,!0)):[]});t.exports=s},function(t,e,n){var r=n(165),i=n(265),o=n(266),a=n(267),s=n(268),u=n(169),c=200;t.exports=function(t,e,n,l){var h=-1,f=i,p=!0,d=t.length,v=[],g=e.length;if(!d)return v;n&&(e=a(e,s(n))),l?(f=o,p=!1):e.length>=c&&(f=u,p=!1,e=new r(e));t:for(;++h<d;){var y=t[h],m=null==n?y:n(y);if(y=l||0!==y?y:0,p&&m==m){for(var _=g;_--;)if(e[_]===m)continue t;v.push(y)}else f(e,m,l)||v.push(y)}return v}},function(t,e,n){var r=n(619),i=n(118),o=n(168);t.exports=function(){this.size=0,this.__data__={hash:new r,map:new(o||i),string:new r}}},function(t,e,n){function r(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}var i=n(620),o=n(627),a=n(628),s=n(629),u=n(630);r.prototype.clear=i,r.prototype.delete=o,r.prototype.get=a,r.prototype.has=s,r.prototype.set=u,t.exports=r},function(t,e,n){var r=n(117);t.exports=function(){this.__data__=r?r(null):{},this.size=0}},function(t,e,n){var r=n(261),i=n(624),o=n(167),a=n(263),s=/^\[object .+?Constructor\]$/,u=Function.prototype,c=Object.prototype,l=u.toString,h=c.hasOwnProperty,f=RegExp("^"+l.call(h).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!(!o(t)||i(t))&&(r(t)?f:s).test(a(t))}},function(t,e,n){var r=n(88),i=Object.prototype,o=i.hasOwnProperty,a=i.toString,s=r?r.toStringTag:void 0;t.exports=function(t){var e=o.call(t,s),n=t[s];try{t[s]=void 0;var r=!0}catch(t){}var i=a.call(t);return r&&(e?t[s]=n:delete t[s]),i}},function(t,e){var n=Object.prototype.toString;t.exports=function(t){return n.call(t)}},function(t,e,n){var r=n(625),i=function(){var t=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();t.exports=function(t){return!!i&&i in t}},function(t,e,n){var r=n(45)["__core-js_shared__"];t.exports=r},function(t,e){t.exports=function(t,e){return null==t?void 0:t[e]}},function(t,e){t.exports=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}},function(t,e,n){var r=n(117),i="__lodash_hash_undefined__",o=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;if(r){var n=e[t];return n===i?void 0:n}return o.call(e,t)?e[t]:void 0}},function(t,e,n){var r=n(117),i=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;return r?void 0!==e[t]:i.call(e,t)}},function(t,e,n){var r=n(117),i="__lodash_hash_undefined__";t.exports=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=r&&void 0===e?i:e,this}},function(t,e){t.exports=function(){this.__data__=[],this.size=0}},function(t,e,n){var r=n(119),i=Array.prototype.splice;t.exports=function(t){var e=this.__data__,n=r(e,t);return!(n<0||(n==e.length-1?e.pop():i.call(e,n,1),--this.size,0))}},function(t,e,n){var r=n(119);t.exports=function(t){var e=this.__data__,n=r(e,t);return n<0?void 0:e[n][1]}},function(t,e,n){var r=n(119);t.exports=function(t){return r(this.__data__,t)>-1}},function(t,e,n){var r=n(119);t.exports=function(t,e){var n=this.__data__,i=r(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this}},function(t,e,n){var r=n(120);t.exports=function(t){var e=r(this,t).delete(t);return this.size-=e?1:0,e}},function(t,e){t.exports=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},function(t,e,n){var r=n(120);t.exports=function(t){return r(this,t).get(t)}},function(t,e,n){var r=n(120);t.exports=function(t){return r(this,t).has(t)}},function(t,e,n){var r=n(120);t.exports=function(t,e){var n=r(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this}},function(t,e){var n="__lodash_hash_undefined__";t.exports=function(t){return this.__data__.set(t,n),this}},function(t,e){t.exports=function(t){return this.__data__.has(t)}},function(t,e,n){var r=n(644),i=n(645),o=n(646);t.exports=function(t,e,n){return e==e?o(t,e,n):r(t,i,n)}},function(t,e){t.exports=function(t,e,n,r){for(var i=t.length,o=n+(r?1:-1);r?o--:++o<i;)if(e(t[o],o,t))return o;return-1}},function(t,e){t.exports=function(t){return t!=t}},function(t,e){t.exports=function(t,e,n){for(var r=n-1,i=t.length;++r<i;)if(t[r]===e)return r;return-1}},function(t,e,n){var r=n(88),i=n(170),o=n(46),a=r?r.isConcatSpreadable:void 0;t.exports=function(t){return o(t)||i(t)||!!(a&&t&&t[a])}},function(t,e,n){var r=n(75),i=n(68),o="[object Arguments]";t.exports=function(t){return i(t)&&r(t)==o}},function(t,e,n){var r=n(650),i=Math.max;t.exports=function(t,e,n){return e=i(void 0===e?t.length-1:e,0),function(){for(var o=arguments,a=-1,s=i(o.length-e,0),u=Array(s);++a<s;)u[a]=o[e+a];a=-1;for(var c=Array(e+1);++a<e;)c[a]=o[a];return c[e]=n(u),r(t,this,c)}}},function(t,e){t.exports=function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}},function(t,e,n){var r=n(652),i=n(654)(r);t.exports=i},function(t,e,n){var r=n(653),i=n(272),o=n(171),a=i?function(t,e){return i(t,"toString",{configurable:!0,enumerable:!1,value:r(e),writable:!0})}:o;t.exports=a},function(t,e){t.exports=function(t){return function(){return t}}},function(t,e){var n=800,r=16,i=Date.now;t.exports=function(t){var e=0,o=0;return function(){var a=i(),s=r-(a-o);if(o=a,s>0){if(++e>=n)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}},function(t,e,n){var r=n(269),i=n(271),o=n(656),a=n(273),s=i(function(t){return o(r(t,1,a,!0))});t.exports=s},function(t,e,n){var r=n(165),i=n(265),o=n(266),a=n(169),s=n(657),u=n(173),c=200;t.exports=function(t,e,n){var l=-1,h=i,f=t.length,p=!0,d=[],v=d;if(n)p=!1,h=o;else if(f>=c){var g=e?null:s(t);if(g)return u(g);p=!1,h=a,v=new r}else v=e?[]:d;t:for(;++l<f;){var y=t[l],m=e?e(y):y;if(y=n||0!==y?y:0,p&&m==m){for(var _=v.length;_--;)if(v[_]===m)continue t;e&&v.push(m),d.push(y)}else h(v,m,n)||(v!==d&&v.push(m),d.push(y))}return d}},function(t,e,n){var r=n(275),i=n(658),o=n(173),a=r&&1/o(new r([,-0]))[1]==1/0?function(t){return new r(t)}:i;t.exports=a},function(t,e){t.exports=function(){}},function(t,e,n){var r=n(75),i=n(660),o=n(68),a="[object Object]",s=Function.prototype,u=Object.prototype,c=s.toString,l=u.hasOwnProperty,h=c.call(Object);t.exports=function(t){if(!o(t)||r(t)!=a)return!1;var e=i(t);if(null===e)return!0;var n=l.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&c.call(n)==h}},function(t,e,n){var r=n(276)(Object.getPrototypeOf,Object);t.exports=r},function(t,e,n){"use strict";e.__esModule=!0,e.defaultSocketOptions={secure:!0,hostname:"remotedev.io",port:443,autoReconnect:!0,autoReconnectOptions:{randomness:3e4}}},function(t,e,n){"use strict";function r(t){return t&&("AndroidConstants"===t[0]||"PlatformConstants"===t[0])}t.exports=function(t){if("object"!=typeof __fbBatchedBridge||"localhost"!==t&&"127.0.0.1"!==t)return t;var e=function(t){var e="undefined"!=typeof window&&window.__fbBatchedBridgeConfig&&window.__fbBatchedBridgeConfig.remoteModuleConfig;if(!Array.isArray(e)||"localhost"!==t&&"127.0.0.1"!==t)return{hostname:t,passed:!1};var n=(e.find(r)||[])[1];return n?{hostname:(n.ServerHost||t).split(":")[0],passed:!0}:{hostname:t,passed:!1}}(t);return e.passed?e.hostname:function(t){var e,n,r,i=console.warn;return console.warn=function(){if(!(arguments[0]&&arguments[0].indexOf("Requiring module 'NativeModules' by name")>-1))return i.apply(console,arguments)},"undefined"!=typeof window&&window.__DEV__&&"function"==typeof window.require&&"metroRequire"!==window.require.name?(e=window.require("NativeModules"),console.warn=i,e&&(e.PlatformConstants||e.AndroidConstants)?(n=e.PlatformConstants,r=e.AndroidConstants,((n?n.ServerHost:r.ServerHost)||t).split(":")[0]):t):t}(t)}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){var n=t.map(l);if(!e)return n;var r=l(e);if(Array.isArray(r))return n.concat.apply(n,r);throw new Error("rest must be an array")}e.__esModule=!0;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};e.generateId=function(t){return t||u.default.generate()},e.getMethods=function(t){if("object"===(void 0===t?"undefined":o(t))){var e=void 0,n=void 0;return t.__proto__&&(n=t.__proto__.__proto__),n||(n=t),Object.getOwnPropertyNames(n).forEach(function(t){var r=Object.getOwnPropertyDescriptor(n,t);if(!(!r||"get"in r||"set"in r)){var i=n[t];"function"==typeof i&&"constructor"!==t&&(e||(e=[]),e.push({name:t||i.name||"anonymous",args:(0,a.default)(i)}))}}),e}},e.getActionsArray=function(t){return Array.isArray(t)?t:function t(e){var n=arguments.length<=1||void 0===arguments[1]?"":arguments[1],r=[];return Object.keys(e).forEach(function(i){var s=e[i];"function"==typeof s?r.push({name:n+(i||s.name||"anonymous"),func:s,args:(0,a.default)(s)}):"object"===(void 0===s?"undefined":o(s))&&(r=r.concat(t(s,n+i+".")))}),r}(t)},e.evalAction=function(t,e){if("string"==typeof t)return new Function("return "+t)();var n=e[t.selected].func,r=i(t.args,t.rest);return n.apply(void 0,r)},e.evalMethod=function(t,e){if("string"==typeof t)return new Function("return "+t).call(e);var n=i(t.args,t.rest);return new Function("args","return this."+t.name+"(args)").apply(e,n)},e.stringify=function(t,e){return void 0===e?function(t){try{return JSON.stringify(t)}catch(e){return s.default.stringify(t,null,null,{circular:"[CIRCULAR]"})}}(t):!0===e?s.default.stringify(t,function(t,e){return e&&"function"==typeof e.toJS?e.toJS():e},null,!0):s.default.stringify(t,e.replacer,null,e.options)},e.getSeralizeParameter=function(t,e){var n=t.serialize;if(n)return!0===n?{options:!0}:n.immutable?{replacer:(0,c.default)(n.immutable,n.refs).replacer,options:n.options||!0}:n.replacer?{replacer:n.replacer,options:n.options||!0}:{options:n.options};var r=t[e];return void 0!==r?(console.warn("`"+e+"` parameter for Redux DevTools Extension is deprecated. Use `serialize` parameter instead: https://github.com/zalmoxisus/redux-devtools-extension/releases/tag/v2.12.1"),"boolean"==typeof serializeState?{options:r}:"function"==typeof serializeState?{replacer:r}:r):void 0};var a=r(n(664)),s=r(n(252)),u=r(n(665)),c=r(n(674)),l=function(t){return new Function("return "+t)()}},function(t,e,n){var r=function(t){"use strict";if("function"!=typeof t)return[];var e=t.toString().replace(/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,""),n=e.slice(e.indexOf("(")+1,e.indexOf(")")).match(/([^\s,]+)/g);return null===n?[]:n};void 0!==t.exports&&(t.exports=r),"undefined"!=typeof window&&(window.GetParams=r)},function(t,e,n){"use strict";t.exports=n(666)},function(t,e,n){"use strict";function r(){return o(s)}var i=n(121),o=n(668),a=n(672),s=n(673)||0;t.exports=r,t.exports.generate=r,t.exports.seed=function(e){return i.seed(e),t.exports},t.exports.worker=function(e){return s=e,t.exports},t.exports.characters=function(t){return void 0!==t&&i.characters(t),i.shuffled()},t.exports.isValid=a},function(t,e,n){"use strict";var r=1;t.exports={nextValue:function(){return(r=(9301*r+49297)%233280)/233280},seed:function(t){r=t}}},function(t,e,n){"use strict";var r,i,o=n(669),a=(n(121),1459707606518),s=6;t.exports=function(t){var e="",n=Math.floor(.001*(Date.now()-a));return n===i?r++:(r=0,i=n),e+=o(s),e+=o(t),r>0&&(e+=o(r)),e+o(n)}},function(t,e,n){"use strict";var r=n(121),i=n(670),o=n(671);t.exports=function(t){for(var e,n=0,a="";!e;)a+=o(i,r.get(),1),e=t<Math.pow(16,n+1),n++;return a}},function(t,e,n){"use strict";var r,i="object"==typeof window&&(window.crypto||window.msCrypto);r=i&&i.getRandomValues?function(t){return i.getRandomValues(new Uint8Array(t))}:function(t){for(var e=[],n=0;n<t;n++)e.push(Math.floor(256*Math.random()));return e},t.exports=r},function(t,e){t.exports=function(t,e,n){for(var r=(2<<Math.log(e.length-1)/Math.LN2)-1,i=Math.ceil(1.6*r*n/e.length),o="";;)for(var a=t(i),s=0;s<i;s++){var u=a[s]&r;if(e[u]&&(o+=e[u]).length===n)return o}}},function(t,e,n){"use strict";var r=n(121);t.exports=function(t){return!(!t||"string"!=typeof t||t.length<6||new RegExp("[^"+r.get().replace(/[|\\{}()[\]^$+*?.-]/g,"\\$&")+"]").test(t))}},function(t,e,n){"use strict";t.exports=0},function(t,e,n){var r=n(675),i=r.mark,o=r.extract,a=r.refer;t.exports=function(t,e){return{replacer:function(n,r){return r instanceof t.Record?a(r,"ImmutableRecord","toObject",e):r instanceof t.Range?o(r,"ImmutableRange"):r instanceof t.Repeat?o(r,"ImmutableRepeat"):t.OrderedMap.isOrderedMap(r)?i(r,"ImmutableOrderedMap","toObject"):t.Map.isMap(r)?i(r,"ImmutableMap","toObject"):t.List.isList(r)?i(r,"ImmutableList","toArray"):t.OrderedSet.isOrderedSet(r)?i(r,"ImmutableOrderedSet","toArray"):t.Set.isSet(r)?i(r,"ImmutableSet","toArray"):t.Seq.isSeq(r)?i(r,"ImmutableSeq","toArray"):t.Stack.isStack(r)?i(r,"ImmutableStack","toArray"):r},reviver:function(n,r){if("object"==typeof r&&null!==r&&"__serializedType__"in r){var i=r.data;switch(r.__serializedType__){case"ImmutableMap":return t.Map(i);case"ImmutableOrderedMap":return t.OrderedMap(i);case"ImmutableList":return t.List(i);case"ImmutableRange":return t.Range(i._start,i._end,i._step);case"ImmutableRepeat":return t.Repeat(i._value,i.size);case"ImmutableSet":return t.Set(i);case"ImmutableOrderedSet":return t.OrderedSet(i);case"ImmutableSeq":return t.Seq(i);case"ImmutableStack":return t.Stack(i);case"ImmutableRecord":return e&&e[r.__serializedRef__]?new e[r.__serializedRef__](i):t.Map(i);default:return i}}return r}}}},function(t,e){function n(t,e,n){return{data:n?t[n]():t,__serializedType__:e}}t.exports={mark:n,extract:function(t,e){return{data:Object.assign({},t),__serializedType__:e}},refer:function(t,e,r,i){var o=n(t,e,r);if(!i)return o;for(var a=0;a<i.length;a++){var s=i[a];if("function"==typeof s&&t instanceof s)return o.__serializedRef__=a,o}return o}}},function(t,e,n){"use strict";(function(t){e.__esModule=!0;var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};e.default=function(e){"object"===("undefined"==typeof window?"undefined":r(window))&&"object"===r(window.onerror)?window.onerror=function(t,n,r,o,a){var s={type:i,message:t,url:n,lineNo:r,columnNo:o};return a&&a.stack&&(s.stack=a.stack),e(s),!1}:void 0!==t&&t.ErrorUtils&&t.ErrorUtils.setGlobalHandler(function(t,n){e({type:i,error:t,isFatal:n})}),"object"!==("undefined"==typeof console?"undefined":r(console))||"function"!=typeof console.error||console.beforeRemotedev||(console.beforeRemotedev=console.error.bind(console),console.error=function(){var t={type:i},r=arguments[0];t.message=r.message?r.message:r,r.sourceURL&&(t=n({},t,{sourceURL:r.sourceURL,line:r.line,column:r.column})),r.stack&&(t.stack=r.stack),e(t),console.beforeRemotedev.apply(null,arguments)})};var i="@@remotedev/ERROR"}).call(this,n(8))},function(t,e,n){"use strict";function r(t,e){return e?(0,c.default)(t,function(t,n){return u({},t,{action:e(t.action,n)})}):t}function i(t,e){return e?t.map(function(t,n){return u({},t,{state:e(t.state,n)})}):t}function o(){return"undefined"!=typeof window&&window.devToolsOptions||{}}function a(t,e){var n=(t.action||t).type,r=o();if(!e&&r.filter&&r.filter===l.DO_NOT_FILTER||n&&"function"!=typeof n.match)return!1;var i=e||r,a=i.whitelist,s=i.blacklist;return a&&!n.match(a)||s&&n.match(s)}e.__esModule=!0,e.FilterState=void 0;var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},u=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};e.arrToRegex=function(t){return"string"==typeof t?t:t.join("|")},e.getLocalFilter=function(t){if(t.actionsBlacklist||t.actionsWhitelist)return{whitelist:t.actionsWhitelist&&t.actionsWhitelist.join("|"),blacklist:t.actionsBlacklist&&t.actionsBlacklist.join("|")}},e.isFiltered=a,e.filterStagedActions=function(t,e){if(!e)return t;var n=[],r=[];return t.stagedActionIds.forEach(function(i,o){a(t.actionsById[i],e)||(n.push(i),r.push(t.computedStates[o]))}),u({},t,{stagedActionIds:n,computedStates:r})},e.filterState=function(t,e,n,c,h,f,p){if("ACTION"===e)return c?c(t,f-1):t;if("STATE"!==e)return t;var d=o().filter;if(p||n||d&&d!==l.DO_NOT_FILTER){var v=function(){var e=[],r=[],i=h&&{},o=t.actionsById,s=t.computedStates;return t.stagedActionIds.forEach(function(t,l){var f=o[t],d=f.action,v=s[l],g=v.state;if(l){if(p&&!p(g,d))return;if(a(d,n))return}e.push(t),r.push(c?u({},v,{state:c(g,l)}):v),h&&(i[t]=u({},f,{action:h(d,t)}))}),{v:u({},t,{actionsById:i||o,stagedActionIds:e,computedStates:r})}}();if("object"===(void 0===v?"undefined":s(v)))return v.v}return c||h?u({},t,{actionsById:r(t.actionsById,h),computedStates:i(t.computedStates,c)}):t};var c=function(t){return t&&t.__esModule?t:{default:t}}(n(678)),l=e.FilterState={DO_NOT_FILTER:"DO_NOT_FILTER",BLACKLIST_SPECIFIC:"BLACKLIST_SPECIFIC",WHITELIST_SPECIFIC:"WHITELIST_SPECIFIC"}},function(t,e,n){var r=n(679),i=n(680),o=n(691);t.exports=function(t,e){var n={};return e=o(e,3),i(t,function(t,i,o){r(n,i,e(t,i,o))}),n}},function(t,e,n){var r=n(272);t.exports=function(t,e,n){"__proto__"==e&&r?r(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}},function(t,e,n){var r=n(681),i=n(174);t.exports=function(t,e){return t&&r(t,e,i)}},function(t,e,n){var r=n(682)();t.exports=r},function(t,e){t.exports=function(t){return function(e,n,r){for(var i=-1,o=Object(e),a=r(e),s=a.length;s--;){var u=a[t?s:++i];if(!1===n(o[u],u,o))break}return e}}},function(t,e,n){var r=n(684),i=n(170),o=n(46),a=n(277),s=n(278),u=n(279),c=Object.prototype.hasOwnProperty;t.exports=function(t,e){var n=o(t),l=!n&&i(t),h=!n&&!l&&a(t),f=!n&&!l&&!h&&u(t),p=n||l||h||f,d=p?r(t.length,String):[],v=d.length;for(var g in t)!e&&!c.call(t,g)||p&&("length"==g||h&&("offset"==g||"parent"==g)||f&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||s(g,v))||d.push(g);return d}},function(t,e){t.exports=function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}},function(t,e){t.exports=function(){return!1}},function(t,e,n){var r=n(75),i=n(172),o=n(68),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,t.exports=function(t){return o(t)&&i(t.length)&&!!a[r(t)]}},function(t,e,n){(function(t){var r=n(262),i=e&&!e.nodeType&&e,o=i&&"object"==typeof t&&t&&!t.nodeType&&t,a=o&&o.exports===i&&r.process,s=function(){try{return o&&o.require&&o.require("util").types||a&&a.binding&&a.binding("util")}catch(t){}}();t.exports=s}).call(this,n(113)(t))},function(t,e,n){var r=n(689),i=n(690),o=Object.prototype.hasOwnProperty;t.exports=function(t){if(!r(t))return i(t);var e=[];for(var n in Object(t))o.call(t,n)&&"constructor"!=n&&e.push(n);return e}},function(t,e){var n=Object.prototype;t.exports=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||n)}},function(t,e,n){var r=n(276)(Object.keys,Object);t.exports=r},function(t,e,n){var r=n(692),i=n(715),o=n(171),a=n(46),s=n(725);t.exports=function(t){return"function"==typeof t?t:null==t?o:"object"==typeof t?a(t)?i(t[0],t[1]):r(t):s(t)}},function(t,e,n){var r=n(693),i=n(714),o=n(284);t.exports=function(t){var e=i(t);return 1==e.length&&e[0][2]?o(e[0][0],e[0][1]):function(n){return n===t||r(n,t,e)}}},function(t,e,n){var r=n(280),i=n(281),o=1,a=2;t.exports=function(t,e,n,s){var u=n.length,c=u,l=!s;if(null==t)return!c;for(t=Object(t);u--;){var h=n[u];if(l&&h[2]?h[1]!==t[h[0]]:!(h[0]in t))return!1}for(;++u<c;){var f=(h=n[u])[0],p=t[f],d=h[1];if(l&&h[2]){if(void 0===p&&!(f in t))return!1}else{var v=new r;if(s)var g=s(p,d,f,t,e,v);if(!(void 0===g?i(d,p,o|a,s,v):g))return!1}}return!0}},function(t,e,n){var r=n(118);t.exports=function(){this.__data__=new r,this.size=0}},function(t,e){t.exports=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}},function(t,e){t.exports=function(t){return this.__data__.get(t)}},function(t,e){t.exports=function(t){return this.__data__.has(t)}},function(t,e,n){var r=n(118),i=n(168),o=n(166),a=200;t.exports=function(t,e){var n=this.__data__;if(n instanceof r){var s=n.__data__;if(!i||s.length<a-1)return s.push([t,e]),this.size=++n.size,this;n=this.__data__=new o(s)}return n.set(t,e),this.size=n.size,this}},function(t,e,n){var r=n(280),i=n(282),o=n(701),a=n(704),s=n(710),u=n(46),c=n(277),l=n(279),h=1,f="[object Arguments]",p="[object Array]",d="[object Object]",v=Object.prototype.hasOwnProperty;t.exports=function(t,e,n,g,y,m){var _=u(t),b=u(e),E=_?p:s(t),w=b?p:s(e),S=(E=E==f?d:E)==d,T=(w=w==f?d:w)==d,I=E==w;if(I&&c(t)){if(!c(e))return!1;_=!0,S=!1}if(I&&!S)return m||(m=new r),_||l(t)?i(t,e,n,g,y,m):o(t,e,E,n,g,y,m);if(!(n&h)){var A=S&&v.call(t,"__wrapped__"),O=T&&v.call(e,"__wrapped__");if(A||O){var C=A?t.value():t,R=O?e.value():e;return m||(m=new r),y(C,R,n,g,m)}}return!!I&&(m||(m=new r),a(t,e,n,g,y,m))}},function(t,e){t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}},function(t,e,n){var r=n(88),i=n(702),o=n(264),a=n(282),s=n(703),u=n(173),c=1,l=2,h="[object Boolean]",f="[object Date]",p="[object Error]",d="[object Map]",v="[object Number]",g="[object RegExp]",y="[object Set]",m="[object String]",_="[object Symbol]",b="[object ArrayBuffer]",E="[object DataView]",w=r?r.prototype:void 0,S=w?w.valueOf:void 0;t.exports=function(t,e,n,r,w,T,I){switch(n){case E:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case b:return!(t.byteLength!=e.byteLength||!T(new i(t),new i(e)));case h:case f:case v:return o(+t,+e);case p:return t.name==e.name&&t.message==e.message;case g:case m:return t==e+"";case d:var A=s;case y:var O=r&c;if(A||(A=u),t.size!=e.size&&!O)return!1;var C=I.get(t);if(C)return C==e;r|=l,I.set(t,e);var R=a(A(t),A(e),r,w,T,I);return I.delete(t),R;case _:if(S)return S.call(t)==S.call(e)}return!1}},function(t,e,n){var r=n(45).Uint8Array;t.exports=r},function(t,e){t.exports=function(t){var e=-1,n=Array(t.size);return t.forEach(function(t,r){n[++e]=[r,t]}),n}},function(t,e,n){var r=n(705),i=1,o=Object.prototype.hasOwnProperty;t.exports=function(t,e,n,a,s,u){var c=n&i,l=r(t),h=l.length;if(h!=r(e).length&&!c)return!1;for(var f=h;f--;){var p=l[f];if(!(c?p in e:o.call(e,p)))return!1}var d=u.get(t);if(d&&u.get(e))return d==e;var v=!0;u.set(t,e),u.set(e,t);for(var g=c;++f<h;){var y=t[p=l[f]],m=e[p];if(a)var _=c?a(m,y,p,e,t,u):a(y,m,p,t,e,u);if(!(void 0===_?y===m||s(y,m,n,a,u):_)){v=!1;break}g||(g="constructor"==p)}if(v&&!g){var b=t.constructor,E=e.constructor;b!=E&&"constructor"in t&&"constructor"in e&&!("function"==typeof b&&b instanceof b&&"function"==typeof E&&E instanceof E)&&(v=!1)}return u.delete(t),u.delete(e),v}},function(t,e,n){var r=n(706),i=n(707),o=n(174);t.exports=function(t){return r(t,o,i)}},function(t,e,n){var r=n(270),i=n(46);t.exports=function(t,e,n){var o=e(t);return i(t)?o:r(o,n(t))}},function(t,e,n){var r=n(708),i=n(709),o=Object.prototype.propertyIsEnumerable,a=Object.getOwnPropertySymbols,s=a?function(t){return null==t?[]:(t=Object(t),r(a(t),function(e){return o.call(t,e)}))}:i;t.exports=s},function(t,e){t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length,i=0,o=[];++n<r;){var a=t[n];e(a,n,t)&&(o[i++]=a)}return o}},function(t,e){t.exports=function(){return[]}},function(t,e,n){var r=n(711),i=n(168),o=n(712),a=n(275),s=n(713),u=n(75),c=n(263),l=c(r),h=c(i),f=c(o),p=c(a),d=c(s),v=u;(r&&"[object DataView]"!=v(new r(new ArrayBuffer(1)))||i&&"[object Map]"!=v(new i)||o&&"[object Promise]"!=v(o.resolve())||a&&"[object Set]"!=v(new a)||s&&"[object WeakMap]"!=v(new s))&&(v=function(t){var e=u(t),n="[object Object]"==e?t.constructor:void 0,r=n?c(n):"";if(r)switch(r){case l:return"[object DataView]";case h:return"[object Map]";case f:return"[object Promise]";case p:return"[object Set]";case d:return"[object WeakMap]"}return e}),t.exports=v},function(t,e,n){var r=n(67)(n(45),"DataView");t.exports=r},function(t,e,n){var r=n(67)(n(45),"Promise");t.exports=r},function(t,e,n){var r=n(67)(n(45),"WeakMap");t.exports=r},function(t,e,n){var r=n(283),i=n(174);t.exports=function(t){for(var e=i(t),n=e.length;n--;){var o=e[n],a=t[o];e[n]=[o,a,r(a)]}return e}},function(t,e,n){var r=n(281),i=n(716),o=n(722),a=n(175),s=n(283),u=n(284),c=n(122),l=1,h=2;t.exports=function(t,e){return a(t)&&s(e)?u(c(t),e):function(n){var a=i(n,t);return void 0===a&&a===e?o(n,t):r(e,a,l|h)}}},function(t,e,n){var r=n(285);t.exports=function(t,e,n){var i=null==t?void 0:r(t,e);return void 0===i?n:i}},function(t,e,n){var r=n(718),i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,o=/\\(\\)?/g,a=r(function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(i,function(t,n,r,i){e.push(r?i.replace(o,"$1"):n||t)}),e});t.exports=a},function(t,e,n){var r=n(719),i=500;t.exports=function(t){var e=r(t,function(t){return n.size===i&&n.clear(),t}),n=e.cache;return e}},function(t,e,n){function r(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(o);var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=t.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(r.Cache||i),n}var i=n(166),o="Expected a function";r.Cache=i,t.exports=r},function(t,e,n){var r=n(721);t.exports=function(t){return null==t?"":r(t)}},function(t,e,n){var r=n(88),i=n(267),o=n(46),a=n(176),s=1/0,u=r?r.prototype:void 0,c=u?u.toString:void 0;t.exports=function t(e){if("string"==typeof e)return e;if(o(e))return i(e,t)+"";if(a(e))return c?c.call(e):"";var n=e+"";return"0"==n&&1/e==-s?"-0":n}},function(t,e,n){var r=n(723),i=n(724);t.exports=function(t,e){return null!=t&&i(t,e,r)}},function(t,e){t.exports=function(t,e){return null!=t&&e in Object(t)}},function(t,e,n){var r=n(286),i=n(170),o=n(46),a=n(278),s=n(172),u=n(122);t.exports=function(t,e,n){for(var c=-1,l=(e=r(e,t)).length,h=!1;++c<l;){var f=u(e[c]);if(!(h=null!=t&&n(t,f)))break;t=t[f]}return h||++c!=l?h:!!(l=null==t?0:t.length)&&s(l)&&a(f,l)&&(o(t)||i(t))}},function(t,e,n){var r=n(726),i=n(727),o=n(175),a=n(122);t.exports=function(t){return o(t)?r(a(t)):i(t)}},function(t,e){t.exports=function(t){return function(e){return null==e?void 0:e[t]}}},function(t,e,n){var r=n(285);t.exports=function(t){return function(e){return r(e,t)}}},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n(43),o=n(66),a=n(86),s=n(18),u=n(80),c=n(85),l=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.bindStore(),n.bindListeners(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i.BaseView),r(e,[{key:"handleStoreChange",value:function(){}},{key:"bindListeners",value:function(){var t=this;chrome.commands.onCommand.addListener(function(e){switch(e){case"TOGGLE_HIGHLIGHT_MODE_BY_SHORTCUT":var n=t.currentState.workspaceReducer.get("highlightMode");t.store.dispatch(s.TrackerActions.trackEvent("TOGGLE_HIGHLIGHT_MODE",{source:c.MetaConstants.SOURCE_CONSTANTS.SHORTCUT,mode:!n})),t.store.dispatch(o.updateHighlightModeSetting(t.currentState.firebaseAuthReducer.get("user"),!n)),t.store.dispatch(u.ChromeMessageAction.sendShowNotificationMessage(n?"HIGHLIGHT_MODE_OFF":"HIGHLIGHT_MODE_ON"));break;case"TOGGLE_SIDEBAR_BY_SHORTCUT":chrome.tabs.query({active:!0,currentWindow:!0},function(e){t.store.dispatch(s.TrackerActions.trackEvent("[Shortcut]TOGGLE_SIDEBAR")),chrome.extension.isAllowedFileSchemeAccess(function(n){0!==e[0].url.indexOf("file:///")||n?0===e[0].url.indexOf("file:///")&&n?chrome.tabs.update(e[0].id,{url:chrome.extension.getURL("src/pdfviewer/web/viewer.html")+"?file="+e[0].url}):t.store.dispatch(a.onIconClicked(e)):chrome.tabs.update(e[0].id,{url:chrome.extension.getURL("src/pdfviewer/web/viewer.html")+"?file="+e[0].url})})});break;case"PIN_SIDEBAR_BY_SHORTCUT":t.store.dispatch(s.TrackerActions.trackEvent("[Shortcut]PIN_SIDEBAR")),chrome.tabs.query({active:!0},function(e){e.forEach(function(e){return t.store.dispatch(o.pinSideBar(e.id))})})}})}}]),e}();e.ChromeShortcutView=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(9),i=n(86),o=n(66),a=r.fromJS({iconPathStatus:{}});e.chromeIconReducer=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,e=arguments[1],n=t;switch(e.type){case i.chromeIconActionConstants.UPDATE_ICON:return e.banned?n.setIn(["iconPathStatus",e.tabId],"../../static/images/38-banned.png"):e.highlightMode?n.setIn(["iconPathStatus",e.tabId],"../../static/images/38.png"):n.setIn(["iconPathStatus",e.tabId],"../../static/images/38-off.png");case o.workspaceActionsConstants.WORKSPACE_UPDATED:return e.workspace.highlighter||void 0===e.workspace.highlighter?n.set("iconPathStatus",n.get("iconPathStatus").map(function(t,e){return"../../static/images/38.png"})):n.set("iconPathStatus",n.get("iconPathStatus").map(function(t,e){return"../../static/images/38-off.png"}));case i.chromeIconActionConstants.REMOVE_ICON_STATUS:return n.deleteIn(["iconPathStatus",e.tabId]);default:return n}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(9),i=r.fromJS({previousActions:r.List([])}),o=[];e.loggerRedcuer=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,e=arguments[1];if(-1===o.indexOf(e.type)){var n=t.get("previousActions").push(e.type);n.size>10&&(n=n.shift()),t=t.set("previousActions",n)}return t}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(9),i=n(104),o=n(114),a=n(162),s=n(50),u=n(62),c=n(83),l=n(65),h=n(49),f=new(n(732).DataReducerRecord);e.dataReducer=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,e=arguments[1],n=t;switch(h.weavaLogger.log("Redux Action","grey","white",e.type,e),e.type){case o.folderActionConstants.SWITCH_FOLDER:return t.activeFolderMap.keySeq().first()!==e.folderId?s.switchFolderNewState(n):n;case o.folderActionConstants.RESET_SEARCH_STATE:var p=n.searchState.set("searching",!1);return p=p.set("searchResult",r.fromJS({})),n=n.set("searchState",p);case a.websiteActionConstant.ON_NEXT_PAGE:return s.websiteListNextPageNewState(n);case a.websiteActionConstant.CHANGE_WEBSITE_ORDER:return n=(n=n.set("nonActiveWebsiteBodyMap",r.Map({}))).set("websiteListPaginationMap",r.Map({endAt:20,step:5,orderBy:"date",ascending:e.ascending}));case o.folderActionConstants.ACCEPT_FOLDER_COLLABORATION:return n.setIn(["folderInvitations","info",e.invitationIndex,"status"],"Accepted");case o.folderActionConstants.DECLINE_FOLDER_COLLABORATION:return n.setIn(["folderInvitations","info",e.invitationIndex,"status"],"Declined");case o.folderActionConstants.SEARCH_IN_FOLDER_RESULT:var d=n.searchState.set("searching",!0);return d=d.set("searchResult",e.result),n=n.set("searchState",d);case l.userActionConstants.COLLABORATION_INVITATIONS_INFO:var v=e.info?r.fromJS(e.info.filter(function(t){return!t.status})):null;return n.setIn(["folderInvitations","info"],v);case l.userActionConstants.INVITATION_COUNT_UPDATED:return n.setIn(["folderInvitations","count"],e.count);case o.folderActionConstants.FOLDER_UPDATED:return s.handleFirebaseFolderUpdateNewState(n,e.uid,e.folderIds,e.activeFolderPayload);case a.websiteActionConstant.WEBSITE_UPDATED:return s.handleFirebaseWebsiteUpdateNewState(n,e.websiteId,e.website);case a.websiteActionConstant.WEBSITES_UPDATED:return e.websiteIds.forEach(function(t,r){n=s.handleFirebaseWebsiteUpdateNewState(n,t,e.websites.get(r))}),n;case i.firebaseDatabaseActionConstants.ON_ACTIVE_URLS:return s.addToActiveWebsiteIdsNewState(n,e.urls);case c.syncProcessActionsConstants.OFFLINE:case u.firebaseAuthActionsConstants.SIGN_OUT:return f;case o.folderActionConstants.RESET_SHARING_FOLDER_USER_META:return n=(n=n.set("sharingFolderUserMeta",null)).set("sharingFolderInvitedMeta",null);case o.folderActionConstants.RESET_ACTIVE_FOLDER_USER_META:return n=n.set("activeFolderUserMeta",null);case o.folderActionConstants.REMOVE_COLLABORATOR:return e.uids.forEach(function(t){n=n.deleteIn(["sharingFolderUserMeta",t])}),n;case o.folderActionConstants.ADD_INVITED:return n.setIn(["sharingFolderInvitedMeta",e.email],"write");case o.folderActionConstants.REMOVE_INVITED:return e.invitedEmails.forEach(function(t){n=n.deleteIn(["sharingFolderInvitedMeta",t])}),n;case o.folderActionConstants.FOLDER_COLLABORATION_INFO:var g=e.info.profiles;switch(g=g?g.sort(function(t){return"owner"!==t.accessRight}):[],e.destination){case o.folderConstants.destinationOpts.SHARING_FOLDER:n=n.set("sharingFolderUserMeta",r.fromJS(g));break;case o.folderConstants.destinationOpts.ACTIVE_FOLDER:n=n.set("activeFolderUserMeta",r.fromJS(g))}return null!==n.sharingFolderInvitedMeta&&0!==n.sharingFolderInvitedMeta.size||(n=n.set("sharingFolderInvitedMeta",r.fromJS(e.info.invited||{}))),n;default:return n}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(9),i=n(242),o={folderMetaMap:r.Map(),activeFolderMap:r.Map(),activeWebsiteIdList:r.fromJS([]),activeWebsiteBodyMap:r.Map(),nonActiveWebsiteBodyMap:r.Map(),websiteListPaginationMap:r.fromJS({endAt:20,step:5,orderBy:"date",ascending:!1}),searchState:new i.SearchStateRecord,folderInvitations:r.fromJS({count:0,info:null}),sharingFolderUserMeta:null,sharingFolderInvitedMeta:null,activeFolderUserMeta:null},a=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r.Record(o)),e}();e.DataReducerRecord=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(9),i=n(62),o=n(65),a=r.Map({user:null,userMeta:null,token:null,isAnonymous:!1,customToken:null,authStatus:i.firebaseAuthStatusOption.NOT_AUTHORIZED,signupError:null,loginError:null,loginForm:r.Map({email:"",password:""}),signupForm:r.Map({email:"",password:"",displayName:""}),forgetPasswordForm:r.Map({email:""})});e.firebaseAuthReducer=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,e=arguments[1],n=t;switch(n=(n=n.set("signupError",null)).set("loginError",null),e.type){case i.firebaseAuthActionsConstants.TRIGGERING:return n.set("authStatus",i.firebaseAuthStatusOption.TRIGGERING);case o.userActionConstants.USER_META_UPDATED:var s=n.get("user");return s.meta=e.userMeta,n.set("user",s);case i.firebaseAuthActionsConstants.USER_CHANGED:if(e.user){var u={providerId:e.user.providerId,uid:e.user.uid,displayName:e.user.displayName,email:e.user.email,photoURL:e.user.photoURL,isAnonymous:e.user.isAnonymous};n=n.set("user",r.fromJS(u));var c={createdAt:e.user.metadata.creationTime||e.user.metadata.createdAt,lastSignedInAt:e.user.metadata.lastSignInTime||e.user.metadata.lastSignedInAt};n=(n=n.set("userMeta",r.fromJS(c))).set("authStatus",i.firebaseAuthStatusOption.AUTHORIZED)}else n=(n=n.set("user",null)).set("authStatus",i.firebaseAuthStatusOption.NOT_AUTHORIZED);return n;case i.firebaseAuthActionsConstants.SET_TOKEN:return n.set("token",e.token);case i.firebaseAuthActionsConstants.SET_CUSTOM_TOKEN:return(n=n.set("isAnonymous",e.isAnonymous)).set("customToken",e.customToken);case i.firebaseAuthActionsConstants.ON_SIGNUP_ERROR:return n.set("signupError",e.error);case i.firebaseAuthActionsConstants.ON_LOGIN_ERROR:return n.set("loginError",e.error);case i.firebaseAuthActionsConstants.ON_SIGNUP_LOGIN_ERROR:return(n=n.set("signupError",e.error)).set("loginError",e.error);default:return n}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(9),i=n(87),o=n(62),a=r.fromJS({onboarding:{extensionGuideState:null,colorLimitReferralTest:null,firstHighlight:!1,notificationModalshown:"",webAppNotificationModalshown:"PENDING"}});e.onboardingReducer=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,e=arguments[1],n=t;switch(e.type){case o.firebaseAuthActionsConstants.SIGN_OUT:return n.set("onboarding",r.fromJS({extensionGuideState:null,colorLimitReferralTest:null,firstHighlight:!1,notificationModalshown:"",webAppNotificationModalshown:"PENDING"}));case i.onboardingActionConstant.ONBOARDING_UPDATED:return e.onboarding?n.set("onboarding",e.onboarding):n.set("onboarding",r.fromJS({extensionGuideState:null,colorLimitReferralTest:null,firstHighlight:!1,notificationModalshown:"",webAppNotificationModalshown:!1}));default:return n}}},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n(43),o=n(80),a=n(66),s=n(18),u=n(85),c=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n._highlightClickListener=function(t,e){n.currentState.firebaseAuthReducer.get("user")?n.store.dispatch(o.ChromeMessageAction.sendContextMenuCreateHighlightMessage(e.id,1)):n.store.dispatch(o.ChromeMessageAction.sendPromptLoginMessage(e.id))},n.bindStore(),n.bindListeners(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i.BaseView),r(e,[{key:"handleStoreChange",value:function(){var t=this;chrome.contextMenus.update(this.highlightModeId,{title:this.currentState.workspaceReducer.get("highlightMode")?"Disable Highlighter":"Enable Highlighter",contexts:["all"],onclick:function(){t.store.dispatch(s.TrackerActions.trackEvent("TOGGLE_HIGHLIGHT_MODE",{source:u.MetaConstants.SOURCE_CONSTANTS.EXTENSION_CONTEXT_MENU,mode:!t.currentState.workspaceReducer.get("highlightMode")})),t.store.dispatch(o.ChromeMessageAction.sendShowNotificationMessage(t.currentState.workspaceReducer.get("highlightMode")?"HIGHLIGHT_MODE_OFF":"HIGHLIGHT_MODE_ON")),t.store.dispatch(a.updateHighlightModeSetting(t.currentState.firebaseAuthReducer.get("user"),!t.currentState.workspaceReducer.get("highlightMode")))}})}},{key:"bindListeners",value:function(){var t=this,e=chrome.contextMenus.create({title:"Weava Highlighter",contexts:["all"]});chrome.contextMenus.create({title:"Highlight",contexts:["selection"],parentId:e,onclick:this._highlightClickListener}),chrome.contextMenus.create({title:"Browse highlights",contexts:["all"],parentId:e,onclick:function(){t.store.dispatch(s.TrackerActions.trackEvent("SHOW_SIDE_BAR",{source:u.MetaConstants.SOURCE_CONSTANTS.EXTENSION_CONTEXT_MENU})),t.store.dispatch(a.showAllSidebars())}}),this.highlightModeId=chrome.contextMenus.create({title:this.currentState.workspaceReducer.get("highlightMode")?"Disable Highlighter":"Enable Highlighter",contexts:["all"],parentId:e,onclick:function(){t.store.dispatch(s.TrackerActions.trackEvent("TOGGLE_HIGHLIGHT_MODE",{source:u.MetaConstants.SOURCE_CONSTANTS.EXTENSION_CONTEXT_MENU,mode:!t.currentState.workspaceReducer.get("highlightMode")})),t.store.dispatch(o.ChromeMessageAction.sendShowNotificationMessage(t.currentState.workspaceReducer.get("highlightMode")?"HIGHLIGHT_MODE_OFF":"HIGHLIGHT_MODE_ON")),t.store.dispatch(a.updateHighlightModeSetting(t.currentState.firebaseAuthReducer.get("user"),!t.currentState.workspaceReducer.get("highlightMode")))}})}}]),e}();e.ChromeContextMenuView=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(9),i=n(250),o=r.Map({answer:r.Map({})});e.questionnaireReducer=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o,e=arguments[1],n=t;switch(e.type){case i.questionnaireActionConstant.QUESTIONNAIRE_UPDATED:return n.set("answer",r.fromJS(e.answer));default:return n}}},function(t,e,n){"use strict";function r(){return Nt}function i(t){Nt=t}function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(Nt<=Ot.DEBUG){var i=(new Date).toISOString(),o=n.map(s);console.log.apply(console,["Firestore ("+Rt+") "+i+" ["+t+"]: "+e].concat(o))}}function a(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Nt<=Ot.ERROR){var r=(new Date).toISOString(),i=e.map(s);console.error.apply(console,["Firestore ("+Rt+") "+r+": "+t].concat(i))}}function s(t){if("string"==typeof t)return t;var e=kt.getPlatform();try{return e.formatJSON(t)}catch(e){return t}}function u(t){var e="FIRESTORE ("+Rt+") INTERNAL ASSERTION FAILED: "+t;throw a(e),new Error(e)}function c(t,e){t||u(e)}function l(){return kt.getPlatform().emptyByteString}function h(t,e){function n(){var t="This constructor is private.";throw e&&(t+=" ",t+=e),new xt(Dt.INVALID_ARGUMENT,t)}for(var r in n.prototype=t.prototype,t)t.hasOwnProperty(r)&&(n[r]=t[r]);return n}function f(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function p(t,e){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var r=Number(n);isNaN(r)||e(r,t[n])}}function d(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function v(t){for(var e in c(null!=t&&"object"==typeof t,"isEmpty() expects object parameter."),t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function g(t){c(t&&"object"==typeof t,"shallowCopy() expects object parameter.");var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}function y(t,e,n){if(e.length!==n)throw new xt(Dt.INVALID_ARGUMENT,"Function "+t+"() requires "+P(n,"argument")+", but was called with "+P(e.length,"argument")+".")}function m(t,e,n){if(e.length<n)throw new xt(Dt.INVALID_ARGUMENT,"Function "+t+"() requires at least "+P(n,"argument")+", but was called with "+P(e.length,"argument")+".")}function _(t,e,n,r){if(e.length<n||e.length>r)throw new xt(Dt.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+P(e.length,"argument")+".")}function b(t,e,n,r){I(t,e,k(n)+" argument",r)}function E(t,e,n,r){void 0!==r&&b(t,e,n,r)}function w(t,e,n,r){I(t,e,n+" option",r)}function S(t,e,n,r){void 0!==r&&w(t,e,n,r)}function T(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){for(var o=[],a=0,s=i;a<s.length;a++){var u=s[a];if(u===r)return;o.push(O(u))}var c=O(r);throw new xt(Dt.INVALID_ARGUMENT,"Invalid value "+c+" provided to function "+t+'() for option "'+n+'". Acceptable values: '+o.join(", "))}(t,0,n,r,i)}function I(t,e,n,r){if(typeof r!==e||"object"===e&&!A(r)){var i=O(r);throw new xt(Dt.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function A(t){return"object"==typeof t&&null!==t&&Object.getPrototypeOf(t)===Object.prototype}function O(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":u("Unknown wrong type: "+typeof t)}function C(t,e,n){if(void 0===n)throw new xt(Dt.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+k(e)+" argument, but it was undefined.")}function R(t,e,n){d(e,function(e,r){if(n.indexOf(e)<0)throw new xt(Dt.INVALID_ARGUMENT,"Unknown option '"+e+"' passed to function "+t+"(). Available options: "+n.join(", "))})}function N(t,e,n,r){var i=O(r);return new xt(Dt.INVALID_ARGUMENT,"Function "+t+"() requires its "+k(n)+" argument to be a "+e+", but it was: "+i)}function k(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function P(t,e){return t+" "+e+(1===t?"":"s")}function D(t,e){return t<e?-1:t>e?1:0}function x(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].isEqual(e[n]))return!1;return!0}function M(t){return t+"\0"}function L(){if("undefined"==typeof Uint8Array)throw new xt(Dt.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function F(){if(!kt.getPlatform().base64Available)throw new xt(Dt.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}function U(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}function j(t){return null==t}function B(t){switch(t){case Dt.OK:return u("Treated status OK as error");case Dt.CANCELLED:case Dt.UNKNOWN:case Dt.DEADLINE_EXCEEDED:case Dt.RESOURCE_EXHAUSTED:case Dt.INTERNAL:case Dt.UNAVAILABLE:case Dt.UNAUTHENTICATED:return!1;case Dt.INVALID_ARGUMENT:case Dt.NOT_FOUND:case Dt.ALREADY_EXISTS:case Dt.PERMISSION_DENIED:case Dt.FAILED_PRECONDITION:case Dt.ABORTED:case Dt.OUT_OF_RANGE:case Dt.UNIMPLEMENTED:case Dt.DATA_LOSS:return!0;default:return u("Unknown status code: "+t)}}function V(t){if(void 0===t)return a("GRPC error has no .code"),Dt.UNKNOWN;switch(t){case qe.OK:return Dt.OK;case qe.CANCELLED:return Dt.CANCELLED;case qe.UNKNOWN:return Dt.UNKNOWN;case qe.DEADLINE_EXCEEDED:return Dt.DEADLINE_EXCEEDED;case qe.RESOURCE_EXHAUSTED:return Dt.RESOURCE_EXHAUSTED;case qe.INTERNAL:return Dt.INTERNAL;case qe.UNAVAILABLE:return Dt.UNAVAILABLE;case qe.UNAUTHENTICATED:return Dt.UNAUTHENTICATED;case qe.INVALID_ARGUMENT:return Dt.INVALID_ARGUMENT;case qe.NOT_FOUND:return Dt.NOT_FOUND;case qe.ALREADY_EXISTS:return Dt.ALREADY_EXISTS;case qe.PERMISSION_DENIED:return Dt.PERMISSION_DENIED;case qe.FAILED_PRECONDITION:return Dt.FAILED_PRECONDITION;case qe.ABORTED:return Dt.ABORTED;case qe.OUT_OF_RANGE:return Dt.OUT_OF_RANGE;case qe.UNIMPLEMENTED:return Dt.UNIMPLEMENTED;case qe.DATA_LOSS:return Dt.DATA_LOSS;default:return u("Unknown status code: "+t)}}function W(t){if(void 0===t)return qe.OK;switch(t){case Dt.OK:return qe.OK;case Dt.CANCELLED:return qe.CANCELLED;case Dt.UNKNOWN:return qe.UNKNOWN;case Dt.DEADLINE_EXCEEDED:return qe.DEADLINE_EXCEEDED;case Dt.RESOURCE_EXHAUSTED:return qe.RESOURCE_EXHAUSTED;case Dt.INTERNAL:return qe.INTERNAL;case Dt.UNAVAILABLE:return qe.UNAVAILABLE;case Dt.UNAUTHENTICATED:return qe.UNAUTHENTICATED;case Dt.INVALID_ARGUMENT:return qe.INVALID_ARGUMENT;case Dt.NOT_FOUND:return qe.NOT_FOUND;case Dt.ALREADY_EXISTS:return qe.ALREADY_EXISTS;case Dt.PERMISSION_DENIED:return qe.PERMISSION_DENIED;case Dt.FAILED_PRECONDITION:return qe.FAILED_PRECONDITION;case Dt.ABORTED:return qe.ABORTED;case Dt.OUT_OF_RANGE:return qe.OUT_OF_RANGE;case Dt.UNIMPLEMENTED:return qe.UNIMPLEMENTED;case Dt.DATA_LOSS:return qe.DATA_LOSS;default:return u("Unknown status code: "+t)}}function q(){return Ze}function H(){return tn}function G(){return en}function K(){return nn}function z(t,e){e.length>0&&(t.resumeToken=e)}function Q(t,e){c(!j(t),e+" is missing")}function X(t){return"number"==typeof t?t:"string"==typeof t?Number(t):u("can't parse "+t)}function Y(t,e,n){return e===n||!e&&n in t}function J(t,e){var n=function(t){switch(t){case Tn.Added:return 1;case Tn.Modified:case Tn.Metadata:return 2;case Tn.Removed:return 0;default:return u("Unknown ChangeType: "+t)}};return n(t)-n(e)}function $(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=tt(e)),e=Z(t.get(n),e);return tt(e)}function Z(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+=$n+tr;break;case $n:n+=$n+er;break;default:n+=o}}return n}function tt(t){return t+$n+Zn}function et(t){var e=t.length;if(c(e>=2,"Invalid path "+t),2===e)return c(t.charAt(0)===$n&&t.charAt(1)===Zn,"Non-empty path "+t+" had length 2"),Ht.EMPTY_PATH;for(var n=e-2,r=[],i="",o=0;o<e;){var a=t.indexOf($n,o);switch((a<0||a>n)&&u('Invalid encoded resource path: "'+t+'"'),t.charAt(a+1)){case Zn:var s=t.substring(o,a),l=void 0;0===i.length?l=s:(l=i+=s,i=""),r.push(l);break;case tr:i+=t.substring(o,a),i+="\0";break;case er:i+=t.substring(o,a+1);break;default:u('Invalid encoded resource path: "'+t+'"')}o=a+2}return new Ht(r)}function nt(t,e){c(0===e,"Unexpected upgrade from version "+e),t.createObjectStore(ir.store,{keyPath:ir.keyPath}),t.createObjectStore(or.store,{keyPath:or.keyPath}),t.createObjectStore(lr.store,{keyPath:lr.keyPath}).createIndex(lr.documentTargetsIndex,lr.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(cr.store,{keyPath:cr.keyPath}).createIndex(cr.queryTargetsIndexName,cr.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(ar.store),t.createObjectStore(ur.store),t.createObjectStore(rr.store),t.createObjectStore(hr.store)}function rt(t){return new Ln(function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){n(t.target.error)}})}function it(t){return c("string"==typeof t,"Persisting non-string stream token not supported."),t}function ot(t){return ut(t,or.store)}function at(t){return ut(t,ar.store)}function st(t){return ut(t,ir.store)}function ut(t,e){return t instanceof vr?t.store(e):u("Invalid transaction object provided!")}function ct(t){return ft(t,cr.store)}function lt(t){return ft(t,hr.store)}function ht(t){return ft(t,lr.store)}function ft(t,e){return t instanceof vr?t.store(e):u("Invalid transaction object provided!")}function pt(t){return t instanceof vr?t.store(ur.store):u("Invalid transaction object provided!")}function dt(t){return t.path.toArray()}function vt(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=e;r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t,["next","error","complete"])}function gt(t){switch(t){case Mr.Set:case Mr.MergeSet:case Mr.Update:return!0;case Mr.QueryValue:return!1;default:throw u("Unexpected case for UserDataSource: "+t)}}function yt(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Ut||t instanceof Lt||t instanceof ci||t instanceof ei)}function mt(t,e,n){if(!yt(n)||!A(n)){var r=O(n);throw"an object"===r?e.createError(t+" a custom object"):e.createError(t+" "+r)}}function _t(t,e){if(e instanceof An)return e._internalPath;if("string"==typeof e)return bt(t,e);throw new xt(Dt.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function bt(t,e){try{return function(t){if(t.search(On)>=0)throw new xt(Dt.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(An.bind.apply(An,[void 0].concat(t.split("."))))}catch(e){throw new xt(Dt.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e)._internalPath}catch(e){var n=Et(e);throw new xt(Dt.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. "+n)}}function Et(t){return t instanceof Error?t.message:t.toString()}function wt(t,e){return void 0===e?{merge:!1}:(R(t,e,["merge"]),S(t,"boolean","merge",e.merge),e)}function St(t,e){return void 0===e?{}:(R(t,e,["serverTimestamps"]),T(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Tt(t,e,n){if(e instanceof _i){if(e.firestore!==n)throw new xt(Dt.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw N(t,"DocumentReference",1,e)}function It(t){switch(t){case Tn.Added:return"added";case Tn.Modified:case Tn.Metadata:return"modified";case Tn.Removed:return"removed";default:return u("Unknown change type: "+t)}}function At(t){!function(t){t.INTERNAL.registerService("firestore",function(t){return new gi(t)},g(Mi))}(t)}n.r(e);var Ot,Ct=n(16),Rt=Ct.default.SDK_VERSION;!function(t){t[t.DEBUG=0]="DEBUG",t[t.ERROR=1]="ERROR",t[t.SILENT=2]="SILENT"}(Ot||(Ot={}));var Nt=Ot.ERROR,kt=function(){function t(){}return t.setPlatform=function(e){t.platform&&u("Platform already defined"),t.platform=e},t.getPlatform=function(){return t.platform||u("Platform not set"),t.platform},t}(),Pt=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Dt={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},xt=function(t){function e(e,n){var r=t.call(this,n)||this;return r.code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return Pt(e,t),e}(Error),Mt=function(){function t(){}return t.newId=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e="",n=0;n<20;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return c(20===e.length,"Invalid auto ID: "+e),e},t}(),Lt=function(){function t(t){F(),this._binaryString=t}return t.fromBase64String=function(e){y("Blob.fromBase64String",arguments,1),b("Blob.fromBase64String","string",1,e),F();try{return new t(kt.getPlatform().atob(e))}catch(t){throw new xt(Dt.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},t.fromUint8Array=function(e){if(y("Blob.fromUint8Array",arguments,1),L(),!(e instanceof Uint8Array))throw N("Blob.fromUint8Array","Uint8Array",1,e);return new t(Array.prototype.map.call(e,function(t){return String.fromCharCode(t)}).join(""))},t.prototype.toBase64=function(){return y("Blob.toBase64",arguments,0),F(),kt.getPlatform().btoa(this._binaryString)},t.prototype.toUint8Array=function(){y("Blob.toUint8Array",arguments,0),L();for(var t=new Uint8Array(this._binaryString.length),e=0;e<this._binaryString.length;e++)t[e]=this._binaryString.charCodeAt(e);return t},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this._binaryString===t._binaryString},t.prototype._compareTo=function(t){return D(this._binaryString,t._binaryString)},t}(),Ft=h(Lt,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),Ut=function(){function t(t,e){if(y("GeoPoint",arguments,2),b("GeoPoint","number",1,t),b("GeoPoint","number",2,e),!isFinite(t)||t<-90||t>90)throw new xt(Dt.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new xt(Dt.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype._compareTo=function(t){return D(this._lat,t._lat)||D(this._long,t._long)},t}(),jt=function(){return function(t,e,n,r){this.databaseId=t,this.persistenceKey=e,this.host=n,this.ssl=r}}(),Bt="(default)",Vt=function(){function t(t,e){this.projectId=t,this.database=e||Bt}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return this.database===Bt},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t.prototype.compareTo=function(t){return D(this.projectId,t.projectId)||D(this.database,t.database)},t}(),Wt=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),qt=function(){function t(t,e,n){this.init(t,e,n)}return t.prototype.init=function(t,e,n){void 0===e?e=0:e>t.length&&u("offset "+e+" out of range "+t.length),void 0===n?n=t.length-e:n>t.length-e&&u("length "+n+" out of range "+(t.length-e)),this.segments=t,this.offset=e,this.len=n},t.prototype.construct=function(t,e,n){var r=Object.create(Object.getPrototypeOf(this));return r.init(t,e,n),r},Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(function(t){n.push(t)}):"string"==typeof e?n.push(e):u("Unknown parameter type for Path.child(): "+e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return t=void 0===t?1:t,c(this.length>=t,"Can't call popFirst() with less segments"),this.construct(this.segments,this.offset+t,this.length-t)},t.prototype.popLast=function(){return c(!this.isEmpty(),"Can't call popLast() on empty path"),this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return c(!this.isEmpty(),"Can't call firstSegment() on empty path"),this.segments[this.offset]},t.prototype.lastSegment=function(){return c(!this.isEmpty(),"Can't call lastSegment() on empty path"),this.segments[this.limit()-1]},t.prototype.get=function(t){return c(t<this.length,"Index out of range"),this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),Ht=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Wt(e,t),e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(t){if(t.indexOf("//")>=0)throw new xt(Dt.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new e(t.split("/").filter(function(t){return t.length>0}))},e.EMPTY_PATH=new e([]),e}(qt),Gt=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Kt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Wt(e,t),e.isValidIdentifier=function(t){return Gt.test(t)},e.prototype.canonicalString=function(){return this.toArray().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t}).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},e.keyField=function(){return new e(["__name__"])},e.fromServerFormat=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new xt(Dt.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},a=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new xt(Dt.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new xt(Dt.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===s?(a=!a,i++):"."!==s||a?(r+=s,i++):(o(),i++)}if(o(),a)throw new xt(Dt.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.EMPTY_PATH=new e([]),e}(qt),zt=function(){function t(e){this.path=e,c(t.isDocumentKey(e),"Invalid DocumentKey with an odd number of segments: "+e.toArray().join("/"))}return t.prototype.isEqual=function(t){return null!==t&&0===Ht.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return Ht.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2==0},t.fromSegments=function(e){return new t(new Ht(e.slice()))},t.fromPathString=function(e){return new t(Ht.fromString(e))},t.EMPTY=new t(new Ht([])),t}(),Qt=function(){function t(t,e,n,r){this.key=t,this.version=e,this.data=n,this.hasLocalMutations=r.hasLocalMutations}return t.prototype.field=function(t){return this.data.field(t)},t.prototype.fieldValue=function(t){var e=this.field(t);return e?e.value():void 0},t.prototype.value=function(){return this.data.value()},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.data.isEqual(e.data)&&this.hasLocalMutations===e.hasLocalMutations},t.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.data.toString()+", {hasLocalMutations: "+this.hasLocalMutations+"})"},t.compareByKey=function(t,e){return zt.comparator(t.key,e.key)},t.compareByField=function(t,e,n){var r=e.field(t),i=n.field(t);return void 0!==r&&void 0!==i?r.compareTo(i):u("Trying to compare documents on fields that don't exist")},t}(),Xt=function(){function t(t,e){this.key=t,this.version=e}return t.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},t.prototype.isEqual=function(t){return t&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},t.compareByKey=function(t,e){return zt.comparator(t.key,e.key)},t}(),Yt=function(){function t(t,e){this.comparator=t,this.root=e||$t.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,$t.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,$t.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal(function(e,n){return t(e,n),!1})},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new Jt(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new Jt(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new Jt(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new Jt(this.root,t,this.comparator,!0)},t}(),Jt=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){c(this.nodeStack.length>0,"getNext() called on iterator when hasNext() is false.");var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),$t=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw u("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed())throw u("Right child of ("+this.key+","+this.value+") is red");var t=this.left.check();if(t!==this.right.check())throw u("Black depths differ");return t+(this.isRed()?0:1)},t.EMPTY=null,t.RED=!0,t.BLACK=!1,t}(),Zt=function(){function t(){this.size=0}return t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new $t(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}();$t.EMPTY=new Zt;var te,ee,ne=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();!function(t){t[t.NullValue=0]="NullValue",t[t.BooleanValue=1]="BooleanValue",t[t.NumberValue=2]="NumberValue",t[t.TimestampValue=3]="TimestampValue",t[t.StringValue=4]="StringValue",t[t.BlobValue=5]="BlobValue",t[t.RefValue=6]="RefValue",t[t.GeoPointValue=7]="GeoPointValue",t[t.ArrayValue=8]="ArrayValue",t[t.ObjectValue=9]="ObjectValue"}(te||(te={})),function(t){t[t.Default=0]="Default",t[t.Estimate=1]="Estimate",t[t.Previous=2]="Previous"}(ee||(ee={}));var re,ie=function(){function t(t){this.serverTimestampBehavior=t}return t.fromSnapshotOptions=function(e){switch(e.serverTimestamps){case"estimate":return new t(ee.Estimate);case"previous":return new t(ee.Previous);case"none":case void 0:return t.defaultOptions;default:return u("fromSnapshotOptions() called with invalid options.")}},t.defaultOptions=new t(ee.Default),t}(),oe=function(){function t(){}return t.prototype.toString=function(){var t=this.value();return null===t?"null":t.toString()},t.prototype.defaultCompareTo=function(t){return c(this.typeOrder!==t.typeOrder,"Default compareTo should not be used for values of same type."),D(this.typeOrder,t.typeOrder)},t}(),ae=function(t){function e(){var e=t.call(this)||this;return e.typeOrder=te.NullValue,e.internalValue=null,e}return ne(e,t),e.prototype.value=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e},e.prototype.compareTo=function(t){return t instanceof e?0:this.defaultCompareTo(t)},e.INSTANCE=new e,e}(oe),se=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=te.BooleanValue,n}return ne(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue===t.internalValue},e.prototype.compareTo=function(t){return t instanceof e?D(this,t):this.defaultCompareTo(t)},e.of=function(t){return t?e.TRUE:e.FALSE},e.TRUE=new e(!0),e.FALSE=new e(!1),e}(oe),ue=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=te.NumberValue,n}return ne(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.compareTo=function(t){return t instanceof e?function(t,e){return t<e?-1:t>e?1:t===e?0:isNaN(t)?isNaN(e)?0:-1:1}(this.internalValue,t.internalValue):this.defaultCompareTo(t)},e}(oe),ce=function(t){function e(e){return t.call(this,e)||this}return ne(e,t),e.prototype.isEqual=function(t){return t instanceof e&&U(this.internalValue,t.internalValue)},e}(ue),le=function(t){function e(e){var n=t.call(this,e)||this;return n.internalValue=e,n}return ne(e,t),e.prototype.isEqual=function(t){return t instanceof e&&U(this.internalValue,t.internalValue)},e.NAN=new e(NaN),e.POSITIVE_INFINITY=new e(1/0),e.NEGATIVE_INFINITY=new e(-1/0),e}(ue),he=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=te.StringValue,n}return ne(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue===t.internalValue},e.prototype.compareTo=function(t){return t instanceof e?D(this.internalValue,t.internalValue):this.defaultCompareTo(t)},e}(oe),fe=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=te.TimestampValue,n}return ne(e,t),e.prototype.value=function(t){return this.internalValue.toDate()},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue.isEqual(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue.compareTo(t.internalValue):t instanceof pe?-1:this.defaultCompareTo(t)},e}(oe),pe=function(t){function e(e,n){var r=t.call(this)||this;return r.localWriteTime=e,r.previousValue=n,r.typeOrder=te.TimestampValue,r}return ne(e,t),e.prototype.value=function(t){return t&&t.serverTimestampBehavior===ee.Estimate?this.localWriteTime.toDate():t&&t.serverTimestampBehavior===ee.Previous&&this.previousValue?this.previousValue.value(t):null},e.prototype.isEqual=function(t){return t instanceof e&&this.localWriteTime.isEqual(t.localWriteTime)},e.prototype.compareTo=function(t){return t instanceof e?this.localWriteTime.compareTo(t.localWriteTime):t instanceof fe?1:this.defaultCompareTo(t)},e.prototype.toString=function(){return"<ServerTimestamp localTime="+this.localWriteTime.toString()+">"},e}(oe),de=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=te.BlobValue,n}return ne(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue.isEqual(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue._compareTo(t.internalValue):this.defaultCompareTo(t)},e}(oe),ve=function(t){function e(e,n){var r=t.call(this)||this;return r.databaseId=e,r.key=n,r.typeOrder=te.RefValue,r}return ne(e,t),e.prototype.value=function(t){return this.key},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.databaseId.isEqual(t.databaseId)},e.prototype.compareTo=function(t){if(t instanceof e){var n=this.databaseId.compareTo(t.databaseId);return 0!==n?n:zt.comparator(this.key,t.key)}return this.defaultCompareTo(t)},e}(oe),ge=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=te.GeoPointValue,n}return ne(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue.isEqual(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue._compareTo(t.internalValue):this.defaultCompareTo(t)},e}(oe),ye=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=te.ObjectValue,n}return ne(e,t),e.prototype.value=function(t){var e={};return this.internalValue.inorderTraversal(function(n,r){e[n]=r.value(t)}),e},e.prototype.forEach=function(t){this.internalValue.inorderTraversal(t)},e.prototype.isEqual=function(t){if(t instanceof e){for(var n=this.internalValue.getIterator(),r=t.internalValue.getIterator();n.hasNext()&&r.hasNext();){var i=n.getNext(),o=r.getNext();if(i.key!==o.key||!i.value.isEqual(o.value))return!1}return!n.hasNext()&&!r.hasNext()}return!1},e.prototype.compareTo=function(t){if(t instanceof e){for(var n=this.internalValue.getIterator(),r=t.internalValue.getIterator();n.hasNext()&&r.hasNext();){var i=n.getNext(),o=r.getNext(),a=D(i.key,o.key)||i.value.compareTo(o.value);if(a)return a}return D(n.hasNext(),r.hasNext())}return this.defaultCompareTo(t)},e.prototype.set=function(t,n){if(c(!t.isEmpty(),"Cannot set field for empty path on ObjectValue"),1===t.length)return this.setChild(t.firstSegment(),n);var r=this.child(t.firstSegment());r instanceof e||(r=e.EMPTY);var i=r.set(t.popFirst(),n);return this.setChild(t.firstSegment(),i)},e.prototype.delete=function(t){if(c(!t.isEmpty(),"Cannot delete field for empty path on ObjectValue"),1===t.length)return new e(this.internalValue.remove(t.firstSegment()));var n=this.child(t.firstSegment());if(n instanceof e){var r=n.delete(t.popFirst());return new e(this.internalValue.insert(t.firstSegment(),r))}return this},e.prototype.contains=function(t){return void 0!==this.field(t)},e.prototype.field=function(t){c(!t.isEmpty(),"Can't get field of empty path");var n=this;return t.forEach(function(t){n=n instanceof e&&n.internalValue.get(t)||void 0}),n},e.prototype.toString=function(){return JSON.stringify(this.value())},e.prototype.child=function(t){return this.internalValue.get(t)||void 0},e.prototype.setChild=function(t,n){return new e(this.internalValue.insert(t,n))},e.EMPTY=new e(new Yt(D)),e}(oe),me=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=te.ArrayValue,n}return ne(e,t),e.prototype.value=function(t){return this.internalValue.map(function(e){return e.value(t)})},e.prototype.forEach=function(t){this.internalValue.forEach(t)},e.prototype.isEqual=function(t){if(t instanceof e){if(this.internalValue.length!==t.internalValue.length)return!1;for(var n=0;n<this.internalValue.length;n++)if(!this.internalValue[n].isEqual(t.internalValue[n]))return!1;return!0}return!1},e.prototype.compareTo=function(t){if(t instanceof e){for(var n=Math.min(this.internalValue.length,t.internalValue.length),r=0;r<n;r++){var i=this.internalValue[r].compareTo(t.internalValue[r]);if(i)return i}return D(this.internalValue.length,t.internalValue.length)}return this.defaultCompareTo(t)},e.prototype.toString=function(){return JSON.stringify(this.value())},e}(oe),_e=Number,be=_e.MIN_SAFE_INTEGER||-(Math.pow(2,53)-1),Ee=_e.MAX_SAFE_INTEGER||Math.pow(2,53)-1,we=_e.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},Se=function(){function t(t,e,n,r,i,o){void 0===e&&(e=[]),void 0===n&&(n=[]),void 0===r&&(r=null),void 0===i&&(i=null),void 0===o&&(o=null),this.path=t,this.explicitOrderBy=e,this.filters=n,this.limit=r,this.startAt=i,this.endAt=o,this.memoizedCanonicalId=null,this.memoizedOrderBy=null,this.startAt&&this.assertValidBound(this.startAt),this.endAt&&this.assertValidBound(this.endAt)}return t.atPath=function(e){return new t(e)},Object.defineProperty(t.prototype,"orderBy",{get:function(){if(null===this.memoizedOrderBy){var t=this.getInequalityFilterField(),e=this.getFirstOrderByField();if(null!==t&&null===e)t.isKeyField()?this.memoizedOrderBy=[ke]:this.memoizedOrderBy=[new Ne(t),ke];else{c(null===t||null!==e&&t.isEqual(e),"First orderBy should match inequality field."),this.memoizedOrderBy=[];for(var n=!1,r=0,i=this.explicitOrderBy;r<i.length;r++){var o=i[r];this.memoizedOrderBy.push(o),o.field.isKeyField()&&(n=!0)}if(!n){var a=this.explicitOrderBy.length>0?this.explicitOrderBy[this.explicitOrderBy.length-1].dir:Ce.ASCENDING;this.memoizedOrderBy.push(a===Ce.ASCENDING?ke:Pe)}}}return this.memoizedOrderBy},enumerable:!0,configurable:!0}),t.prototype.addFilter=function(e){c(null==this.getInequalityFilterField()||!(e instanceof Ie)||!e.isInequality()||e.field.isEqual(this.getInequalityFilterField()),"Query must only have one inequality field."),c(!zt.isDocumentKey(this.path),"No filtering allowed for document query");var n=this.filters.concat([e]);return new t(this.path,this.explicitOrderBy.slice(),n,this.limit,this.startAt,this.endAt)},t.prototype.addOrderBy=function(e){c(!zt.isDocumentKey(this.path),"No ordering allowed for document query"),c(!this.startAt&&!this.endAt,"Bounds must be set after orderBy");var n=this.explicitOrderBy.concat([e]);return new t(this.path,n,this.filters.slice(),this.limit,this.startAt,this.endAt)},t.prototype.withLimit=function(e){return new t(this.path,this.explicitOrderBy.slice(),this.filters.slice(),e,this.startAt,this.endAt)},t.prototype.withStartAt=function(e){return new t(this.path,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,e,this.endAt)},t.prototype.withEndAt=function(e){return new t(this.path,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.startAt,e)},t.prototype.canonicalId=function(){if(null===this.memoizedCanonicalId){var t=this.path.canonicalString();t+="|f:";for(var e=0,n=this.filters;e<n.length;e++)t+=n[e].canonicalId(),t+=",";t+="|ob:";for(var r=0,i=this.orderBy;r<i.length;r++)t+=i[r].canonicalId(),t+=",";j(this.limit)||(t+="|l:",t+=this.limit),this.startAt&&(t+="|lb:",t+=this.startAt.canonicalId()),this.endAt&&(t+="|ub:",t+=this.endAt.canonicalId()),this.memoizedCanonicalId=t}return this.memoizedCanonicalId},t.prototype.toString=function(){var t="Query("+this.path.canonicalString();return this.filters.length>0&&(t+=", filters: ["+this.filters.join(", ")+"]"),j(this.limit)||(t+=", limit: "+this.limit),this.explicitOrderBy.length>0&&(t+=", orderBy: ["+this.explicitOrderBy.join(", ")+"]"),this.startAt&&(t+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(t+=", endAt: "+this.endAt.canonicalId()),t+")"},t.prototype.isEqual=function(t){if(this.limit!==t.limit)return!1;if(this.orderBy.length!==t.orderBy.length)return!1;for(var e=0;e<this.orderBy.length;e++)if(!this.orderBy[e].isEqual(t.orderBy[e]))return!1;if(this.filters.length!==t.filters.length)return!1;for(e=0;e<this.filters.length;e++)if(!this.filters[e].isEqual(t.filters[e]))return!1;return!!this.path.isEqual(t.path)&&!(null!==this.startAt?!this.startAt.isEqual(t.startAt):null!==t.startAt)&&(null!==this.endAt?this.endAt.isEqual(t.endAt):null===t.endAt)},t.prototype.docComparator=function(t,e){for(var n=!1,r=0,i=this.orderBy;r<i.length;r++){var o=i[r],a=o.compare(t,e);if(0!==a)return a;n=n||o.field.isKeyField()}return c(n,"orderBy used that doesn't compare on key field"),0},t.prototype.matches=function(t){return this.matchesAncestor(t)&&this.matchesOrderBy(t)&&this.matchesFilters(t)&&this.matchesBounds(t)},t.prototype.hasLimit=function(){return!j(this.limit)},t.prototype.getFirstOrderByField=function(){return this.explicitOrderBy.length>0?this.explicitOrderBy[0].field:null},t.prototype.getInequalityFilterField=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof Ie&&n.isInequality())return n.field}return null},t.prototype.isDocumentQuery=function(){return zt.isDocumentKey(this.path)&&0===this.filters.length},t.prototype.matchesAncestor=function(t){var e=t.key.path;return zt.isDocumentKey(this.path)?this.path.isEqual(e):this.path.isPrefixOf(e)&&this.path.length===e.length-1},t.prototype.matchesOrderBy=function(t){for(var e=0,n=this.explicitOrderBy;e<n.length;e++){var r=n[e];if(!r.field.isKeyField()&&void 0===t.field(r.field))return!1}return!0},t.prototype.matchesFilters=function(t){for(var e=0,n=this.filters;e<n.length;e++)if(!n[e].matches(t))return!1;return!0},t.prototype.matchesBounds=function(t){return!(this.startAt&&!this.startAt.sortsBeforeDocument(this.orderBy,t)||this.endAt&&this.endAt.sortsBeforeDocument(this.orderBy,t))},t.prototype.assertValidBound=function(t){c(t.position.length<=this.orderBy.length,"Bound is longer than orderBy")},t}(),Te=function(){function t(t){this.name=t}return t.fromString=function(e){switch(e){case"<":return t.LESS_THAN;case"<=":return t.LESS_THAN_OR_EQUAL;case"==":return t.EQUAL;case">=":return t.GREATER_THAN_OR_EQUAL;case">":return t.GREATER_THAN;default:return u("Unknown relation: "+e)}},t.prototype.toString=function(){return this.name},t.prototype.isEqual=function(t){return this.name===t.name},t.LESS_THAN=new t("<"),t.LESS_THAN_OR_EQUAL=new t("<="),t.EQUAL=new t("=="),t.GREATER_THAN=new t(">"),t.GREATER_THAN_OR_EQUAL=new t(">="),t}(),Ie=function(){function t(t,e,n){this.field=t,this.op=e,this.value=n}return t.prototype.matches=function(t){if(this.field.isKeyField()){c(this.value instanceof ve,"Comparing on key, but filter value not a RefValue");var e=this.value,n=zt.comparator(t.key,e.key);return this.matchesComparison(n)}var r=t.field(this.field);return void 0!==r&&this.matchesValue(r)},t.prototype.matchesValue=function(t){return this.value.typeOrder===t.typeOrder&&this.matchesComparison(t.compareTo(this.value))},t.prototype.matchesComparison=function(t){switch(this.op){case Te.LESS_THAN:return t<0;case Te.LESS_THAN_OR_EQUAL:return t<=0;case Te.EQUAL:return 0===t;case Te.GREATER_THAN:return t>0;case Te.GREATER_THAN_OR_EQUAL:return t>=0;default:return u("Unknown relation op"+this.op)}},t.prototype.isInequality=function(){return this.op!==Te.EQUAL},t.prototype.canonicalId=function(){return this.field.canonicalString()+this.op.toString()+this.value.toString()},t.prototype.isEqual=function(e){return e instanceof t&&this.op.isEqual(e.op)&&this.field.isEqual(e.field)&&this.value.isEqual(e.value)},t.prototype.toString=function(){return this.field.canonicalString()+" "+this.op+" "+this.value.value()},t}(),Ae=function(){function t(t){this.field=t}return t.prototype.matches=function(t){var e=t.field(this.field);return void 0!==e&&null===e.value()},t.prototype.canonicalId=function(){return this.field.canonicalString()+" IS null"},t.prototype.toString=function(){return this.field.canonicalString()+" IS null"},t.prototype.isEqual=function(e){return e instanceof t&&this.field.isEqual(e.field)},t}(),Oe=function(){function t(t){this.field=t}return t.prototype.matches=function(t){var e=t.field(this.field).value();return"number"==typeof e&&isNaN(e)},t.prototype.canonicalId=function(){return this.field.canonicalString()+" IS NaN"},t.prototype.toString=function(){return this.field.canonicalString()+" IS NaN"},t.prototype.isEqual=function(e){return e instanceof t&&this.field.isEqual(e.field)},t}(),Ce=function(){function t(t){this.name=t}return t.prototype.toString=function(){return this.name},t.ASCENDING=new t("asc"),t.DESCENDING=new t("desc"),t}(),Re=function(){function t(t,e){this.position=t,this.before=e}return t.prototype.canonicalId=function(){for(var t=this.before?"b:":"a:",e=0,n=this.position;e<n.length;e++)t+=n[e].toString();return t},t.prototype.sortsBeforeDocument=function(t,e){c(this.position.length<=t.length,"Bound has more components than query's orderBy");for(var n=0,r=0;r<this.position.length;r++){var i=t[r],o=this.position[r];if(i.field.isKeyField())c(o instanceof ve,"Bound has a non-key value where the key path is being used."),n=zt.comparator(o.key,e.key);else{var a=e.field(i.field);c(void 0!==a,"Field should exist since document matched the orderBy already."),n=o.compareTo(a)}if(i.dir===Ce.DESCENDING&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},t.prototype.isEqual=function(t){if(null===t)return!1;if(this.before!==t.before||this.position.length!==t.position.length)return!1;for(var e=0;e<this.position.length;e++){var n=this.position[e],r=t.position[e];return n.isEqual(r)}return!0},t}(),Ne=function(){function t(t,e){this.field=t,void 0===e&&(e=Ce.ASCENDING),this.dir=e,this.isKeyOrderBy=t.isKeyField()}return t.prototype.compare=function(t,e){var n=this.isKeyOrderBy?Qt.compareByKey(t,e):Qt.compareByField(this.field,t,e);switch(this.dir){case Ce.ASCENDING:return n;case Ce.DESCENDING:return-1*n;default:return u("Unknown direction: "+this.dir)}},t.prototype.canonicalId=function(){return this.field.canonicalString()+this.dir.toString()},t.prototype.toString=function(){return this.field.canonicalString()+" ("+this.dir+")"},t.prototype.isEqual=function(t){return this.dir===t.dir&&this.field.isEqual(t.field)},t}(),ke=new Ne(Kt.keyField(),Ce.ASCENDING),Pe=new Ne(Kt.keyField(),Ce.DESCENDING),De=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/),xe=function(){function t(t,e){this.seconds=t,this.nanos=e,c(e>=0,"timestamp nanoseconds out of range: "+e),c(e<1e9,"timestamp nanoseconds out of range"+e),c(t>=-62135596800,"timestamp seconds out of range: "+t),c(t<253402300800,"timestamp seconds out of range"+t)}return t.now=function(){return t.fromEpochMilliseconds(Date.now())},t.fromDate=function(e){return t.fromEpochMilliseconds(e.getTime())},t.fromEpochMilliseconds=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.fromISOString=function(e){var n=0,r=De.exec(e);if(c(!!r,"invalid timestamp: "+e),r[1]){var i=r[1];i=(i+"000000000").substr(0,9),n=Number(i)}var o=new Date(e);return new t(Math.floor(o.getTime()/1e3),n)},t.prototype.toDate=function(){return new Date(this.toEpochMilliseconds())},t.prototype.toEpochMilliseconds=function(){return 1e3*this.seconds+this.nanos/1e6},t.prototype.compareTo=function(t){return this.seconds===t.seconds?D(this.nanos,t.nanos):D(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanos===this.nanos},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanos="+this.nanos+")"},t}(),Me=function(){function t(t){this.timestamp=t}return t.fromMicroseconds=function(e){var n=Math.floor(e/1e6);return new t(new xe(n,e%1e6*1e3))},t.fromTimestamp=function(e){return new t(e)},t.forDeletedDoc=function(){return t.MIN},t.prototype.compareTo=function(t){return this.timestamp.compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanos/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t.MIN=new t(new xe(0,0)),t}();!function(t){t[t.Listen=0]="Listen",t[t.ExistenceFilterMismatch=1]="ExistenceFilterMismatch",t[t.LimboResolution=2]="LimboResolution"}(re||(re={}));var Le,Fe=function(){function t(t,e,n,r,i){void 0===r&&(r=Me.MIN),void 0===i&&(i=l()),this.query=t,this.targetId=e,this.purpose=n,this.snapshotVersion=r,this.resumeToken=i}return t.prototype.update=function(e){return new t(this.query,this.targetId,this.purpose,e.snapshotVersion,e.resumeToken)},t.prototype.isEqual=function(t){return this.targetId===t.targetId&&this.purpose===t.purpose&&this.snapshotVersion.isEqual(t.snapshotVersion)&&this.resumeToken===t.resumeToken&&this.query.isEqual(t.query)},t}(),Ue=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),je=function(){function t(t){this.fields=t}return t.prototype.isEqual=function(t){return x(this.fields,t.fields)},t}(),Be=function(){function t(){}return t.prototype.isEqual=function(e){return e instanceof t},t.instance=new t,t}(),Ve=function(){function t(t,e){this.field=t,this.transform=e}return t.prototype.isEqual=function(t){return this.field.isEqual(t.field)&&this.transform.isEqual(t.transform)},t}(),We=function(){return function(t,e){this.version=t,this.transformResults=e}}();!function(t){t[t.Set=0]="Set",t[t.Patch=1]="Patch",t[t.Transform=2]="Transform",t[t.Delete=3]="Delete"}(Le||(Le={}));var qe,He=function(){function t(t,e){this.updateTime=t,this.exists=e,c(void 0===t||void 0===e,'Precondition can specify "exists" or "updateTime" but not both')}return t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),t.prototype.isValidFor=function(t){return void 0!==this.updateTime?t instanceof Qt&&t.version.isEqual(this.updateTime):void 0!==this.exists?this.exists?t instanceof Qt:null===t||t instanceof Xt:(c(this.isNone,"Precondition should be empty"),!0)},t.prototype.isEqual=function(t){return function(t,e){return null!=t?!(!e||!t.isEqual(e)):t===e}(this.updateTime,t.updateTime)&&this.exists===t.exists},t.NONE=new t,t}(),Ge=function(){function t(){}return t.prototype.verifyKeyMatches=function(t){null!=t&&c(t.key.isEqual(this.key),"Can only apply a mutation to a document with the same key")},t.getPostMutationVersion=function(t){return t instanceof Qt?t.version:Me.MIN},t}(),Ke=function(t){function e(e,n,r){var i=t.call(this)||this;return i.key=e,i.value=n,i.precondition=r,i.type=Le.Set,i}return Ue(e,t),e.prototype.applyToRemoteDocument=function(t,e){this.verifyKeyMatches(t),c(null==e.transformResults,"Transform results received by SetMutation.");var n=Ge.getPostMutationVersion(t);return new Qt(this.key,n,this.value,{hasLocalMutations:!1})},e.prototype.applyToLocalView=function(t,e,n){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var r=Ge.getPostMutationVersion(t);return new Qt(this.key,r,this.value,{hasLocalMutations:!0})},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.value.isEqual(t.value)&&this.precondition.isEqual(t.precondition)},e}(Ge),ze=function(t){function e(e,n,r,i){var o=t.call(this)||this;return o.key=e,o.data=n,o.fieldMask=r,o.precondition=i,o.type=Le.Patch,o}return Ue(e,t),e.prototype.applyToRemoteDocument=function(t,e){if(this.verifyKeyMatches(t),c(null==e.transformResults,"Transform results received by PatchMutation."),!this.precondition.isValidFor(t))return t;var n=Ge.getPostMutationVersion(t),r=this.patchDocument(t);return new Qt(this.key,n,r,{hasLocalMutations:!1})},e.prototype.applyToLocalView=function(t,e,n){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var r=Ge.getPostMutationVersion(t),i=this.patchDocument(t);return new Qt(this.key,r,i,{hasLocalMutations:!0})},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.fieldMask.isEqual(t.fieldMask)&&this.precondition.isEqual(t.precondition)},e.prototype.patchDocument=function(t){var e;return e=t instanceof Qt?t.data:ye.EMPTY,this.patchObject(e)},e.prototype.patchObject=function(t){for(var e=0,n=this.fieldMask.fields;e<n.length;e++){var r=n[e],i=this.data.field(r);t=void 0!==i?t.set(r,i):t.delete(r)}return t},e}(Ge),Qe=function(t){function e(e,n){var r=t.call(this)||this;return r.key=e,r.fieldTransforms=n,r.type=Le.Transform,r.precondition=He.exists(!0),r}return Ue(e,t),e.prototype.applyToRemoteDocument=function(t,e){this.verifyKeyMatches(t),c(null!=e.transformResults,"Transform results missing for TransformMutation.");var n=e.transformResults;if(!this.precondition.isValidFor(t))return t;var r=this.requireDocument(t),i=this.transformObject(r.data,n);return new Qt(this.key,r.version,i,{hasLocalMutations:!1})},e.prototype.applyToLocalView=function(t,e,n){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var r=this.requireDocument(t),i=this.localTransformResults(n,e),o=this.transformObject(r.data,i);return new Qt(this.key,r.version,o,{hasLocalMutations:!0})},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&x(this.fieldTransforms,t.fieldTransforms)&&this.precondition.isEqual(t.precondition)},e.prototype.requireDocument=function(t){c(t instanceof Qt,"Unknown MaybeDocument type "+t);var e=t;return c(e.key.isEqual(this.key),"Can only transform a document with the same key"),e},e.prototype.localTransformResults=function(t,e){for(var n=[],r=0,i=this.fieldTransforms;r<i.length;r++){var o=i[r],a=o.transform;if(!(a instanceof Be))return u("Encountered unknown transform: "+a);var s=null;e instanceof Qt&&(s=e.field(o.field)||null),n.push(new pe(t,s))}return n},e.prototype.transformObject=function(t,e){c(e.length===this.fieldTransforms.length,"TransformResults length mismatch.");for(var n=0;n<this.fieldTransforms.length;n++){var r=this.fieldTransforms[n],i=r.transform,o=r.field;if(!(i instanceof Be))return u("Encountered unknown transform: "+i);t=t.set(o,e[n])}return t},e}(Ge),Xe=function(t){function e(e,n){var r=t.call(this)||this;return r.key=e,r.precondition=n,r.type=Le.Delete,r}return Ue(e,t),e.prototype.applyToRemoteDocument=function(t,e){return this.verifyKeyMatches(t),c(null==e.transformResults,"Transform results received by DeleteMutation."),new Xt(this.key,Me.MIN)},e.prototype.applyToLocalView=function(t,e,n){return this.verifyKeyMatches(t),this.precondition.isValidFor(t)?(t&&c(t.key.isEqual(this.key),"Can only apply mutation to document with same key"),new Xt(this.key,Me.forDeletedDoc())):t},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.precondition.isEqual(t.precondition)},e}(Ge),Ye=function(){function t(t){this.count=t}return t.prototype.isEqual=function(t){return t&&t.count===this.count},t}();!function(t){t[t.OK=0]="OK",t[t.CANCELLED=1]="CANCELLED",t[t.UNKNOWN=2]="UNKNOWN",t[t.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",t[t.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",t[t.NOT_FOUND=5]="NOT_FOUND",t[t.ALREADY_EXISTS=6]="ALREADY_EXISTS",t[t.PERMISSION_DENIED=7]="PERMISSION_DENIED",t[t.UNAUTHENTICATED=16]="UNAUTHENTICATED",t[t.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",t[t.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",t[t.ABORTED=10]="ABORTED",t[t.OUT_OF_RANGE=11]="OUT_OF_RANGE",t[t.UNIMPLEMENTED=12]="UNIMPLEMENTED",t[t.INTERNAL=13]="INTERNAL",t[t.UNAVAILABLE=14]="UNAVAILABLE",t[t.DATA_LOSS=15]="DATA_LOSS"}(qe||(qe={}));var Je,$e=function(){function t(t){this.comparator=t,this.data=new Yt(this.comparator)}return t.fromMapKeys=function(e){var n=new t(e.comparator);return e.forEach(function(t){n=n.add(t)}),n},t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal(function(e,n){return t(e),!1})},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return t.forEach(function(t){e=e.add(t)}),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),Ze=new Yt(zt.comparator),tn=new Yt(zt.comparator),en=new Yt(zt.comparator),nn=new $e(zt.comparator),rn=function(){function t(t,e,n){this.snapshotVersion=t,this.targetChanges=e,this.documentUpdates=n}return t.prototype.addDocumentUpdate=function(t){this.documentUpdates=this.documentUpdates.insert(t.key,t)},t.prototype.handleExistenceFilterMismatch=function(t){this.targetChanges[t]={mapping:new sn,snapshotVersion:Me.MIN,currentStatusUpdate:Je.MarkNotCurrent,resumeToken:l()}},t}();!function(t){t[t.None=0]="None",t[t.MarkNotCurrent=1]="MarkNotCurrent",t[t.MarkCurrent=2]="MarkCurrent"}(Je||(Je={}));var on,an=K(),sn=function(){function t(){this.docs=an}return Object.defineProperty(t.prototype,"documents",{get:function(){return this.docs},enumerable:!0,configurable:!0}),t.prototype.add=function(t){this.docs=this.docs.add(t)},t.prototype.delete=function(t){this.docs=this.docs.delete(t)},t.prototype.isEqual=function(t){return null!==t&&this.docs.isEqual(t.docs)},t}(),un=function(){function t(){this.addedDocuments=an,this.removedDocuments=an}return t.prototype.applyToKeySet=function(t){var e=t;return this.addedDocuments.forEach(function(t){return e=e.add(t)}),this.removedDocuments.forEach(function(t){return e=e.delete(t)}),e},t.prototype.add=function(t){this.addedDocuments=this.addedDocuments.add(t),this.removedDocuments=this.removedDocuments.delete(t)},t.prototype.delete=function(t){this.addedDocuments=this.addedDocuments.delete(t),this.removedDocuments=this.removedDocuments.add(t)},t.prototype.isEqual=function(t){return null!==t&&this.addedDocuments.isEqual(t.addedDocuments)&&this.removedDocuments.isEqual(t.removedDocuments)},t}(),cn=function(){return function(t,e,n,r){this.updatedTargetIds=t,this.removedTargetIds=e,this.key=n,this.newDoc=r}}(),ln=function(){return function(t,e){this.targetId=t,this.existenceFilter=e}}();!function(t){t[t.NoChange=0]="NoChange",t[t.Added=1]="Added",t[t.Removed=2]="Removed",t[t.Current=3]="Current",t[t.Reset=4]="Reset"}(on||(on={}));var hn=function(){return function(t,e,n,r){void 0===n&&(n=l()),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}}(),fn=function(){function t(t,e,n){this.snapshotVersion=t,this.listenTargets=e,this.existenceFilters={},this.targetChanges={},this.documentUpdates=q(),this.frozen=!1,this.pendingTargetResponses=g(n)}return t.prototype.add=function(t){c(!this.frozen,"Trying to modify frozen WatchChangeAggregator."),t instanceof cn?this.addDocumentChange(t):t instanceof hn?this.addTargetChange(t):t instanceof ln?this.addExistenceFilterChange(t):u("Unknown watch change: "+t)},t.prototype.addChanges=function(t){var e=this;c(!this.frozen,"Trying to modify frozen WatchChangeAggregator."),t.forEach(function(t){return e.add(t)})},t.prototype.createRemoteEvent=function(){var t=this,e=this.targetChanges;return p(this.targetChanges,function(n){t.isActiveTarget(n)||delete e[n]}),this.frozen=!0,new rn(this.snapshotVersion,e,this.documentUpdates)},t.prototype.ensureTargetChange=function(t){var e=this.targetChanges[t];return e||(e={currentStatusUpdate:Je.None,snapshotVersion:this.snapshotVersion,mapping:new un,resumeToken:l()},this.targetChanges[t]=e),e},t.prototype.isActiveTarget=function(t){return!f(this.pendingTargetResponses,t)&&f(this.listenTargets,t)},t.prototype.addDocumentChange=function(t){for(var e=!1,n=0,r=t.updatedTargetIds;n<r.length;n++){var i=r[n];if(this.isActiveTarget(i))this.ensureTargetChange(i).mapping.add(t.key),e=!0}for(var o=0,a=t.removedTargetIds;o<a.length;o++){i=a[o];if(this.isActiveTarget(i))this.ensureTargetChange(i).mapping.delete(t.key),e=!0}t.newDoc&&e&&(this.documentUpdates=this.documentUpdates.insert(t.key,t.newDoc))},t.prototype.addTargetChange=function(t){var e=this;t.targetIds.forEach(function(n){var r=e.ensureTargetChange(n);switch(t.state){case on.NoChange:e.isActiveTarget(n)&&z(r,t.resumeToken);break;case on.Added:e.recordTargetResponse(n),f(e.pendingTargetResponses,n)||(r.mapping=new un,r.currentStatusUpdate=Je.None,delete e.existenceFilters[n]),z(r,t.resumeToken);break;case on.Removed:e.recordTargetResponse(n),c(!t.cause,"WatchChangeAggregator does not handle errored targets");break;case on.Current:e.isActiveTarget(n)&&(r.currentStatusUpdate=Je.MarkCurrent,z(r,t.resumeToken));break;case on.Reset:e.isActiveTarget(n)&&(r.mapping=new sn,z(r,t.resumeToken));break;default:u("Unknown target watch change state: "+t.state)}})},t.prototype.recordTargetResponse=function(t){var e=(this.pendingTargetResponses[t]||0)-1;0===e?delete this.pendingTargetResponses[t]:this.pendingTargetResponses[t]=e},t.prototype.addExistenceFilterChange=function(t){this.isActiveTarget(t.targetId)&&(this.existenceFilters[t.targetId]=t.existenceFilter)},t}(),pn=function(){var t={};return t[Ce.ASCENDING.name]="ASCENDING",t[Ce.DESCENDING.name]="DESCENDING",t}(),dn=function(){var t={};return t[Te.LESS_THAN.name]="LESS_THAN",t[Te.LESS_THAN_OR_EQUAL.name]="LESS_THAN_OR_EQUAL",t[Te.GREATER_THAN.name]="GREATER_THAN",t[Te.GREATER_THAN_OR_EQUAL.name]="GREATER_THAN_OR_EQUAL",t[Te.EQUAL.name]="EQUAL",t}(),vn=function(){function t(t,e){this.databaseId=t,this.options=e}return t.prototype.emptyByteString=function(){return this.options.useProto3Json?"":new Uint8Array(0)},t.prototype.unsafeCastProtoByteString=function(t){return t},t.prototype.fromRpcStatus=function(t){var e=void 0===t.code?Dt.UNKNOWN:V(t.code);return new xt(e,t.message||"")},t.prototype.toInt32Value=function(t){return j(t)?void 0:{value:t}},t.prototype.fromInt32Value=function(t){var e;return j(e="object"==typeof t?t.value:t)?null:e},t.prototype.toTimestamp=function(t){return{seconds:t.seconds,nanos:t.nanos}},t.prototype.fromTimestamp=function(t){if("string"==typeof t)return xe.fromISOString(t);c(!!t,"Cannot deserialize null or undefined timestamp.");var e=X(t.seconds||"0"),n=t.nanos||0;return new xe(e,n)},t.prototype.toBytes=function(t){return this.options.useProto3Json?t.toBase64():this.unsafeCastProtoByteString(t.toUint8Array())},t.prototype.fromBlob=function(t){return"string"==typeof t?(c(this.options.useProto3Json,"Expected bytes to be passed in as Uint8Array, but got a string instead."),Lt.fromBase64String(t)):(c(!this.options.useProto3Json,"Expected bytes to be passed in as string, but got something else instead."),Lt.fromUint8Array(t))},t.prototype.toVersion=function(t){return this.toTimestamp(t.toTimestamp())},t.prototype.fromVersion=function(t){return c(!!t,"Trying to deserialize version that isn't set"),Me.fromTimestamp(this.fromTimestamp(t))},t.prototype.toResourceName=function(t,e){return this.fullyQualifiedPrefixPath(t).child("documents").child(e).canonicalString()},t.prototype.fromResourceName=function(t){var e=Ht.fromString(t);return c(this.isValidResourceName(e),"Tried to deserialize invalid key "+e.toString()),e},t.prototype.toName=function(t){return this.toResourceName(this.databaseId,t.path)},t.prototype.fromName=function(t){var e=this.fromResourceName(t);return c(e.get(1)===this.databaseId.projectId,"Tried to deserialize key from different project: "+e.get(1)+" vs "+this.databaseId.projectId),c(!e.get(3)&&!this.databaseId.database||e.get(3)===this.databaseId.database,"Tried to deserialize key from different database: "+e.get(3)+" vs "+this.databaseId.database),new zt(this.extractLocalPathFromResourceName(e))},t.prototype.toQueryPath=function(t){return 0===t.length?this.encodedDatabaseId:this.toResourceName(this.databaseId,t)},t.prototype.fromQueryPath=function(t){var e=this.fromResourceName(t);return 4===e.length?Ht.EMPTY_PATH:this.extractLocalPathFromResourceName(e)},Object.defineProperty(t.prototype,"encodedDatabaseId",{get:function(){return new Ht(["projects",this.databaseId.projectId,"databases",this.databaseId.database]).canonicalString()},enumerable:!0,configurable:!0}),t.prototype.fullyQualifiedPrefixPath=function(t){return new Ht(["projects",t.projectId,"databases",t.database])},t.prototype.extractLocalPathFromResourceName=function(t){return c(t.length>4&&"documents"===t.get(4),"tried to deserialize invalid key "+t.toString()),t.popFirst(5)},t.prototype.isValidResourceName=function(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)},t.prototype.toValue=function(t){if(t instanceof ae)return{nullValue:"NULL_VALUE"};if(t instanceof se)return{booleanValue:t.value()};if(t instanceof ce)return{integerValue:""+t.value()};if(t instanceof le){var e=t.value();if(this.options.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:t.value()}}return t instanceof he?{stringValue:t.value()}:t instanceof ye?{mapValue:this.toMapValue(t)}:t instanceof me?{arrayValue:this.toArrayValue(t)}:t instanceof fe?{timestampValue:this.toTimestamp(t.internalValue)}:t instanceof ge?{geoPointValue:{latitude:t.value().latitude,longitude:t.value().longitude}}:t instanceof de?{bytesValue:this.toBytes(t.value())}:t instanceof ve?{referenceValue:this.toResourceName(t.databaseId,t.key.path)}:u("Unknown FieldValue "+JSON.stringify(t))},t.prototype.fromValue=function(t){var e=this,n=t.value_type;if(Y(t,n,"nullValue"))return ae.INSTANCE;if(Y(t,n,"booleanValue"))return se.of(t.booleanValue);if(Y(t,n,"integerValue"))return new ce(X(t.integerValue));if(Y(t,n,"doubleValue")){if(this.options.useProto3Json){if("NaN"===t.doubleValue)return le.NAN;if("Infinity"===t.doubleValue)return le.POSITIVE_INFINITY;if("-Infinity"===t.doubleValue)return le.NEGATIVE_INFINITY}return new le(t.doubleValue)}if(Y(t,n,"stringValue"))return new he(t.stringValue);if(Y(t,n,"mapValue"))return this.fromFields(t.mapValue.fields||{});if(Y(t,n,"arrayValue")){Q(t.arrayValue,"arrayValue");var r=t.arrayValue.values||[];return new me(r.map(function(t){return e.fromValue(t)}))}if(Y(t,n,"timestampValue"))return Q(t.timestampValue,"timestampValue"),new fe(this.fromTimestamp(t.timestampValue));if(Y(t,n,"geoPointValue")){Q(t.geoPointValue,"geoPointValue");var i=t.geoPointValue.latitude||0,o=t.geoPointValue.longitude||0;return new ge(new Ut(i,o))}if(Y(t,n,"bytesValue")){Q(t.bytesValue,"bytesValue");var a=this.fromBlob(t.bytesValue);return new de(a)}if(Y(t,n,"referenceValue")){Q(t.referenceValue,"referenceValue");var s=this.fromResourceName(t.referenceValue),c=new Vt(s.get(1),s.get(3)),l=new zt(this.extractLocalPathFromResourceName(s));return new ve(c,l)}return u("Unknown Value proto "+JSON.stringify(t))},t.prototype.toMutationDocument=function(t,e){return{name:this.toName(t),fields:this.toFields(e)}},t.prototype.toDocument=function(t){return c(!t.hasLocalMutations,"Can't serialize documents with mutations."),{name:this.toName(t.key),fields:this.toFields(t.data),updateTime:this.toTimestamp(t.version.toTimestamp())}},t.prototype.fromDocument=function(t){return new Qt(this.fromName(t.name),this.fromVersion(t.updateTime),this.fromFields(t.fields||{}),{hasLocalMutations:!1})},t.prototype.toFields=function(t){var e=this,n={};return t.forEach(function(t,r){n[t]=e.toValue(r)}),n},t.prototype.fromFields=function(t){var e=this,n=t,r=ye.EMPTY;return d(n,function(t,n){r=r.set(new Kt([t]),e.fromValue(n))}),r},t.prototype.toMapValue=function(t){return{fields:this.toFields(t)}},t.prototype.toArrayValue=function(t){var e=this,n=[];return t.forEach(function(t){n.push(e.toValue(t))}),{values:n}},t.prototype.fromFound=function(t){c(!!t.found,"Tried to deserialize a found document from a missing document."),Q(t.found.name,"doc.found.name"),Q(t.found.updateTime,"doc.found.updateTime");var e=this.fromName(t.found.name),n=this.fromVersion(t.found.updateTime),r=this.fromFields(t.found.fields||{});return new Qt(e,n,r,{hasLocalMutations:!1})},t.prototype.fromMissing=function(t){c(!!t.missing,"Tried to deserialize a missing document from a found document."),c(!!t.readTime,"Tried to deserialize a missing document without a read time.");var e=this.fromName(t.missing),n=this.fromVersion(t.readTime);return new Xt(e,n)},t.prototype.fromMaybeDocument=function(t){var e=t.result;return Y(t,e,"found")?this.fromFound(t):Y(t,e,"missing")?this.fromMissing(t):u("invalid batch get response: "+JSON.stringify(t))},t.prototype.toWatchTargetChangeState=function(t){switch(t){case on.Added:return"ADD";case on.Current:return"CURRENT";case on.NoChange:return"NO_CHANGE";case on.Removed:return"REMOVE";case on.Reset:return"RESET";default:return u("Unknown WatchTargetChangeState: "+t)}},t.prototype.toTestWatchChange=function(t){if(t instanceof ln)return{filter:{count:t.existenceFilter.count,targetId:t.targetId}};if(t instanceof cn){if(t.newDoc instanceof Qt){var e=t.newDoc;return{documentChange:{document:{name:this.toName(e.key),fields:this.toFields(e.data),updateTime:this.toVersion(e.version)},targetIds:t.updatedTargetIds,removedTargetIds:t.removedTargetIds}}}if(t.newDoc instanceof Xt){e=t.newDoc;return{documentDelete:{document:this.toName(e.key),readTime:this.toVersion(e.version),removedTargetIds:t.removedTargetIds}}}if(null===t.newDoc)return{documentRemove:{document:this.toName(t.key),removedTargetIds:t.removedTargetIds}}}if(t instanceof hn){var n=void 0;return t.cause&&(n={code:W(t.cause.code),message:t.cause.message}),{targetChange:{targetChangeType:this.toWatchTargetChangeState(t.state),targetIds:t.targetIds,resumeToken:this.unsafeCastProtoByteString(t.resumeToken),cause:n}}}return u("Unrecognized watch change: "+JSON.stringify(t))},t.prototype.fromWatchChange=function(t){var e,n=t.response_type;if(Y(t,n,"targetChange")){Q(t.targetChange,"targetChange");var r=this.fromWatchTargetChangeState(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],o=t.targetChange.resumeToken||this.emptyByteString(),a=t.targetChange.cause,s=a&&this.fromRpcStatus(a);e=new hn(r,i,o,s||null)}else if(Y(t,n,"documentChange")){Q(t.documentChange,"documentChange"),Q(t.documentChange.document,"documentChange.name"),Q(t.documentChange.document.name,"documentChange.document.name"),Q(t.documentChange.document.updateTime,"documentChange.document.updateTime");var c=t.documentChange,l=this.fromName(c.document.name),h=this.fromVersion(c.document.updateTime),f=this.fromFields(c.document.fields||{}),p=new Qt(l,h,f,{hasLocalMutations:!1}),d=c.targetIds||[],v=c.removedTargetIds||[];e=new cn(d,v,p.key,p)}else if(Y(t,n,"documentDelete")){Q(t.documentDelete,"documentDelete"),Q(t.documentDelete.document,"documentDelete.document");var g=t.documentDelete;l=this.fromName(g.document),h=g.readTime?this.fromVersion(g.readTime):Me.forDeletedDoc(),p=new Xt(l,h),v=g.removedTargetIds||[];e=new cn([],v,p.key,p)}else if(Y(t,n,"documentRemove")){Q(t.documentRemove,"documentRemove"),Q(t.documentRemove.document,"documentRemove");var y=t.documentRemove;l=this.fromName(y.document),v=y.removedTargetIds||[];e=new cn([],v,l,null)}else{if(!Y(t,n,"filter"))return u("Unknown change type "+JSON.stringify(t));Q(t.filter,"filter"),Q(t.filter.targetId,"filter.targetId");var m=t.filter,_=m.count||0,b=new Ye(_),E=m.targetId;e=new ln(E,b)}return e},t.prototype.fromWatchTargetChangeState=function(t){return"NO_CHANGE"===t?on.NoChange:"ADD"===t?on.Added:"REMOVE"===t?on.Removed:"CURRENT"===t?on.Current:"RESET"===t?on.Reset:u("Got unexpected TargetChange.state: "+t)},t.prototype.versionFromListenResponse=function(t){if(!Y(t,t.response_type,"targetChange"))return Me.MIN;var e=t.targetChange;return e.targetIds&&e.targetIds.length?Me.MIN:e.readTime?this.fromVersion(e.readTime):Me.MIN},t.prototype.toMutation=function(t){var e,n=this;if(t instanceof Ke)e={update:this.toMutationDocument(t.key,t.value)};else if(t instanceof Xe)e={delete:this.toName(t.key)};else if(t instanceof ze)e={update:this.toMutationDocument(t.key,t.data),updateMask:this.toDocumentMask(t.fieldMask)};else{if(!(t instanceof Qe))return u("Unknown mutation type "+t.type);e={transform:{document:this.toName(t.key),fieldTransforms:t.fieldTransforms.map(function(t){return n.toFieldTransform(t)})}}}return t.precondition.isNone||(e.currentDocument=this.toPrecondition(t.precondition)),e},t.prototype.fromMutation=function(t){var e=this,n=t.currentDocument?this.fromPrecondition(t.currentDocument):He.NONE;if(t.update){Q(t.update.name,"name");var r=this.fromName(t.update.name),i=this.fromFields(t.update.fields||{});if(t.updateMask){var o=this.fromDocumentMask(t.updateMask);return new ze(r,i,o,n)}return new Ke(r,i,n)}if(t.delete){r=this.fromName(t.delete);return new Xe(r,n)}if(t.transform){r=this.fromName(t.transform.document);var a=t.transform.fieldTransforms.map(function(t){return e.fromFieldTransform(t)});return c(!0===n.exists,'Transforms only support precondition "exists == true"'),new Qe(r,a)}return u("unknown mutation proto: "+JSON.stringify(t))},t.prototype.toPrecondition=function(t){return c(!t.isNone,"Can't serialize an empty precondition"),void 0!==t.updateTime?{updateTime:this.toVersion(t.updateTime)}:void 0!==t.exists?{exists:t.exists}:u("Unknown precondition")},t.prototype.fromPrecondition=function(t){return void 0!==t.updateTime?He.updateTime(this.fromVersion(t.updateTime)):void 0!==t.exists?He.exists(t.exists):He.NONE},t.prototype.fromWriteResult=function(t){var e=this,n=t.updateTime?this.fromVersion(t.updateTime):null,r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults.map(function(t){return e.fromValue(t)})),new We(n,r)},t.prototype.fromWriteResults=function(t){var e=this;return(t||[]).map(function(t){return e.fromWriteResult(t)})},t.prototype.toFieldTransform=function(t){return c(t.transform instanceof Be,"Unknown transform: "+t.transform),{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"}},t.prototype.fromFieldTransform=function(t){c("REQUEST_TIME"===t.setToServerValue,"Unknown transform proto: "+JSON.stringify(t));var e=Kt.fromServerFormat(t.fieldPath);return new Ve(e,Be.instance)},t.prototype.toDocumentsTarget=function(t){return{documents:[this.toQueryPath(t.path)]}},t.prototype.fromDocumentsTarget=function(t){var e=t.documents.length;c(1===e,"DocumentsTarget contained other than 1 document: "+e);var n=t.documents[0];return Se.atPath(this.fromQueryPath(n))},t.prototype.toQueryTarget=function(t){var e={structuredQuery:{}};if(t.path.isEmpty())e.parent=this.toQueryPath(Ht.EMPTY_PATH);else{var n=t.path;c(n.length%2!=0,"Document queries with filters are not supported."),e.parent=this.toQueryPath(n.popLast()),e.structuredQuery.from=[{collectionId:n.lastSegment()}]}var r=this.toFilter(t.filters);r&&(e.structuredQuery.where=r);var i=this.toOrder(t.orderBy);i&&(e.structuredQuery.orderBy=i);var o=this.toInt32Value(t.limit);return void 0!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt=this.toCursor(t.startAt)),t.endAt&&(e.structuredQuery.endAt=this.toCursor(t.endAt)),e},t.prototype.fromQueryTarget=function(t){var e=this.fromQueryPath(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0;if(r>0){c(1===r,"StructuredQuery.from with more than one collection is not supported.");var i=n.from[0];e=e.child(i.collectionId)}var o=[];n.where&&(o=this.fromFilter(n.where));var a=[];n.orderBy&&(a=this.fromOrder(n.orderBy));var s=null;n.limit&&(s=this.fromInt32Value(n.limit));var u=null;n.startAt&&(u=this.fromCursor(n.startAt));var l=null;return n.endAt&&(l=this.fromCursor(n.endAt)),new Se(e,a,o,s,u,l)},t.prototype.toListenRequestLabels=function(t){var e=this.toLabel(t.purpose);return null==e?null:{"goog-listen-tags":e}},t.prototype.toLabel=function(t){switch(t){case re.Listen:return null;case re.ExistenceFilterMismatch:return"existence-filter-mismatch";case re.LimboResolution:return"limbo-document";default:return u("Unrecognized query purpose: "+t)}},t.prototype.toTarget=function(t){var e,n=t.query;return(e=n.isDocumentQuery()?{documents:this.toDocumentsTarget(n)}:{query:this.toQueryTarget(n)}).targetId=t.targetId,t.resumeToken.length>0&&(e.resumeToken=this.unsafeCastProtoByteString(t.resumeToken)),e},t.prototype.toFilter=function(t){var e=this;if(0!==t.length){var n=t.map(function(t){return t instanceof Ie?e.toRelationFilter(t):e.toUnaryFilter(t)});return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},t.prototype.fromFilter=function(t){var e=this;return t?void 0!==t.unaryFilter?[this.fromUnaryFilter(t)]:void 0!==t.fieldFilter?[this.fromRelationFilter(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e.fromFilter(t)}).reduce(function(t,e){return t.concat(e)}):u("Unknown filter: "+JSON.stringify(t)):[]},t.prototype.toOrder=function(t){var e=this;if(0!==t.length)return t.map(function(t){return e.toPropertyOrder(t)})},t.prototype.fromOrder=function(t){var e=this;return t.map(function(t){return e.fromPropertyOrder(t)})},t.prototype.toCursor=function(t){var e=this;return{before:t.before,values:t.position.map(function(t){return e.toValue(t)})}},t.prototype.fromCursor=function(t){var e=this,n=!!t.before,r=t.values.map(function(t){return e.fromValue(t)});return new Re(r,n)},t.prototype.toDirection=function(t){return pn[t.name]},t.prototype.fromDirection=function(t){switch(t){case"ASCENDING":return Ce.ASCENDING;case"DESCENDING":return Ce.DESCENDING;default:return}},t.prototype.toOperatorName=function(t){return dn[t.name]},t.prototype.fromOperatorName=function(t){switch(t){case"EQUAL":return Te.EQUAL;case"GREATER_THAN":return Te.GREATER_THAN;case"GREATER_THAN_OR_EQUAL":return Te.GREATER_THAN_OR_EQUAL;case"LESS_THAN":return Te.LESS_THAN;case"LESS_THAN_OR_EQUAL":return Te.LESS_THAN_OR_EQUAL;case"OPERATOR_UNSPECIFIED":return u("Unspecified relation");default:return u("Unknown relation")}},t.prototype.toFieldPathReference=function(t){return{fieldPath:t.canonicalString()}},t.prototype.fromFieldPathReference=function(t){return Kt.fromServerFormat(t.fieldPath)},t.prototype.toPropertyOrder=function(t){return{field:this.toFieldPathReference(t.field),direction:this.toDirection(t.dir)}},t.prototype.fromPropertyOrder=function(t){return new Ne(this.fromFieldPathReference(t.field),this.fromDirection(t.direction))},t.prototype.toRelationFilter=function(t){return t instanceof Ie?{fieldFilter:{field:this.toFieldPathReference(t.field),op:this.toOperatorName(t.op),value:this.toValue(t.value)}}:u("Unrecognized filter: "+JSON.stringify(t))},t.prototype.fromRelationFilter=function(t){return new Ie(this.fromFieldPathReference(t.fieldFilter.field),this.fromOperatorName(t.fieldFilter.op),this.fromValue(t.fieldFilter.value))},t.prototype.toUnaryFilter=function(t){return t instanceof Oe?{unaryFilter:{field:this.toFieldPathReference(t.field),op:"IS_NAN"}}:t instanceof Ae?{unaryFilter:{field:this.toFieldPathReference(t.field),op:"IS_NULL"}}:u("Unrecognized filter: "+JSON.stringify(t))},t.prototype.fromUnaryFilter=function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=this.fromFieldPathReference(t.unaryFilter.field);return new Oe(e);case"IS_NULL":var n=this.fromFieldPathReference(t.unaryFilter.field);return new Ae(n);case"OPERATOR_UNSPECIFIED":return u("Unspecified filter");default:return u("Unknown filter")}},t.prototype.toDocumentMask=function(t){return{fieldPaths:t.fields.map(function(t){return t.canonicalString()})}},t.prototype.fromDocumentMask=function(t){var e=(t.fieldPaths||[]).map(function(t){return Kt.fromServerFormat(t)});return new je(e)},t}(),gn=n(33),yn=function(){function t(t){this.sendFn=t.sendFn,this.closeFn=t.closeFn}return t.prototype.onOpen=function(t){c(!this.wrappedOnOpen,"Called onOpen on stream twice!"),this.wrappedOnOpen=t},t.prototype.onClose=function(t){c(!this.wrappedOnClose,"Called onClose on stream twice!"),this.wrappedOnClose=t},t.prototype.onMessage=function(t){c(!this.wrappedOnMessage,"Called onMessage on stream twice!"),this.wrappedOnMessage=t},t.prototype.close=function(){this.closeFn()},t.prototype.send=function(t){this.sendFn(t)},t.prototype.callOnOpen=function(){c(void 0!==this.wrappedOnOpen,"Cannot call onOpen because no callback was set"),this.wrappedOnOpen()},t.prototype.callOnClose=function(t){c(void 0!==this.wrappedOnClose,"Cannot call onClose because no callback was set"),this.wrappedOnClose(t)},t.prototype.callOnMessage=function(t){c(void 0!==this.wrappedOnMessage,"Cannot call onMessage because no callback was set"),this.wrappedOnMessage(t)},t}(),mn="Connection",_n={BatchGetDocuments:"batchGet",Commit:"commit"},bn="gl-js/ fire/"+Rt,En=function(){function t(t){this.databaseId=t.databaseId,this.pool=new gn.XhrIoPool;var e=t.ssl?"https":"http";this.baseUrl=e+"://"+t.host}return t.prototype.modifyHeadersForRequest=function(t,e){if(e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n]);t["X-Goog-Api-Client"]=bn,t["google-cloud-resource-prefix"]="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},t.prototype.invokeRPC=function(t,e,n){var r=this,i=this.makeUrl(t);return new Promise(function(a,s){r.pool.getObject(function(c){c.listenOnce(gn.EventType.COMPLETE,function(){try{switch(c.getLastErrorCode()){case gn.ErrorCode.NO_ERROR:var e=c.getResponseJson();o(mn,"XHR received:",JSON.stringify(e)),a(e);break;case gn.ErrorCode.TIMEOUT:o(mn,'RPC "'+t+'" timed out'),s(new xt(Dt.DEADLINE_EXCEEDED,"Request time out"));break;case gn.ErrorCode.HTTP_ERROR:var n=c.getStatus();o(mn,'RPC "'+t+'" failed with status:',n,"response text:",c.getResponseText()),n>0?s(new xt(function(t){switch(t){case 200:return Dt.OK;case 400:return Dt.INVALID_ARGUMENT;case 401:return Dt.UNAUTHENTICATED;case 403:return Dt.PERMISSION_DENIED;case 404:return Dt.NOT_FOUND;case 409:return Dt.ABORTED;case 416:return Dt.OUT_OF_RANGE;case 429:return Dt.RESOURCE_EXHAUSTED;case 499:return Dt.CANCELLED;case 500:return Dt.UNKNOWN;case 501:return Dt.UNIMPLEMENTED;case 503:return Dt.UNAVAILABLE;case 504:return Dt.DEADLINE_EXCEEDED;default:return t>=200&&t<300?Dt.OK:t>=400&&t<500?Dt.FAILED_PRECONDITION:t>=500&&t<600?Dt.INTERNAL:Dt.UNKNOWN}}(n),"Server responded with status "+c.getStatusText())):(o(mn,'RPC "'+t+'" failed'),s(new xt(Dt.UNAVAILABLE,"Connection failed.")));break;default:u('RPC "'+t+'" failed with unanticipated webchannel error '+c.getLastErrorCode()+": "+c.getLastError()+", giving up.")}}finally{o(mn,'RPC "'+t+'" completed.'),r.pool.releaseObject(c)}});var l=JSON.stringify(e);o(mn,"XHR sending: ",i+" "+l);var h={"Content-Type":"text/plain"};r.modifyHeadersForRequest(h,n),c.send(i,"POST",l,h,15)})})},t.prototype.invokeStreamingRPC=function(t,e,n){return this.invokeRPC(t,e,n)},t.prototype.openStream=function(t,e){var n=[this.baseUrl,"/","google.firestore.v1beta1.Firestore","/",t,"/channel"],r=Object(gn.createWebChannelTransport)(),i={backgroundChannelTest:!0,httpSessionIdParam:"gsessionid",initMessageHeaders:{},httpHeadersOverwriteParam:"$httpHeaders",sendRawJson:!0,supportsCrossDomainXhr:!0};this.modifyHeadersForRequest(i.initMessageHeaders,e);var a=n.join("");o(mn,"Creating WebChannel: "+a+" "+i);var s=r.createWebChannel(a,i),u=!1,l=!1,h=new yn({sendFn:function(t){l?o(mn,"Not sending because WebChannel is closed:",t):(u||(o(mn,"Opening WebChannel transport."),s.open(),u=!0),o(mn,"WebChannel sending:",t),s.send(t))},closeFn:function(){return s.close()}}),f=function(t,e){s.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})};return f(gn.WebChannel.EventType.OPEN,function(){l||o(mn,"WebChannel transport opened.")}),f(gn.WebChannel.EventType.CLOSE,function(){l||(l=!0,o(mn,"WebChannel transport closed"),h.callOnClose())}),f(gn.WebChannel.EventType.ERROR,function(t){l||(l=!0,o(mn,"WebChannel transport errored:",t),h.callOnClose(new xt(Dt.UNAVAILABLE,"The operation could not be completed")))}),f(gn.WebChannel.EventType.MESSAGE,function(t){if(!l){var e=t.data[0];c(!!e,"Got a webchannel message without data.");var n=e.error||e[0]&&e[0].error;if(n){o(mn,"WebChannel received error:",n);var r=n.status,i=function(t){var e=qe[t];if(void 0!==e)return V(e)}(r),a=n.message;void 0===i&&(i=Dt.INTERNAL,a="Unknown error status: "+r+" with message "+n.message),l=!0,h.callOnClose(new xt(i,a)),s.close()}else o(mn,"WebChannel received:",e),h.callOnMessage(e)}}),setTimeout(function(){h.callOnOpen()},0),h},t.prototype.makeUrl=function(t){var e=_n[t];c(void 0!==e,"Unknown REST mapping for: "+t);var n=[this.baseUrl,"/","v1beta1"];return n.push("/projects/"),n.push(this.databaseId.projectId),n.push("/databases/"),n.push(this.databaseId.database),n.push("/documents"),n.push(":"),n.push(e),n.join("")},t}(),wn=function(){function t(){this.emptyByteString="",this.base64Available="undefined"!=typeof atob}return t.prototype.loadConnection=function(t){return Promise.resolve(new En(t))},t.prototype.newSerializer=function(t){return new vn(t,{useProto3Json:!0})},t.prototype.formatJSON=function(t){return JSON.stringify(t)},t.prototype.atob=function(t){return atob(t)},t.prototype.btoa=function(t){return btoa(t)},t}();kt.setPlatform(new wn);var Sn,Tn,In,An=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];!function(t,e,n,r){if(!(e instanceof Array)||e.length<r)throw new xt(Dt.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" argument to be an array with at least "+P(r,"element")+".")}("FieldPath",t,"fieldNames",1);for(var n=0;n<t.length;++n)if(b("FieldPath","string",n,t[n]),0===t[n].length)throw new xt(Dt.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Kt(t)}return t.documentId=function(){return t._DOCUMENT_ID},t.prototype.isEqual=function(e){if(!(e instanceof t))throw N("isEqual","FieldPath",1,e);return this._internalPath.isEqual(e._internalPath)},t._DOCUMENT_ID=new t(Kt.keyField().canonicalString()),t}(),On=new RegExp("[~\\*/\\[\\]]");!function(t){t[t.Unknown=0]="Unknown",t[t.Healthy=1]="Healthy",t[t.Failed=2]="Failed"}(Sn||(Sn={})),function(t){t[t.Added=0]="Added",t[t.Removed=1]="Removed",t[t.Modified=2]="Modified",t[t.Metadata=3]="Metadata"}(Tn||(Tn={})),function(t){t[t.Local=0]="Local",t[t.Synced=1]="Synced"}(In||(In={}));var Cn,Rn=function(){function t(){this.changeMap=new Yt(zt.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.changeMap.get(e);n?t.type!==Tn.Added&&n.type===Tn.Metadata?this.changeMap=this.changeMap.insert(e,t):t.type===Tn.Metadata&&n.type!==Tn.Removed?this.changeMap=this.changeMap.insert(e,{type:n.type,doc:t.doc}):t.type===Tn.Modified&&n.type===Tn.Modified?this.changeMap=this.changeMap.insert(e,{type:Tn.Modified,doc:t.doc}):t.type===Tn.Modified&&n.type===Tn.Added?this.changeMap=this.changeMap.insert(e,{type:Tn.Added,doc:t.doc}):t.type===Tn.Removed&&n.type===Tn.Added?this.changeMap=this.changeMap.remove(e):t.type===Tn.Removed&&n.type===Tn.Modified?this.changeMap=this.changeMap.insert(e,{type:Tn.Removed,doc:n.doc}):t.type===Tn.Added&&n.type===Tn.Removed?this.changeMap=this.changeMap.insert(e,{type:Tn.Modified,doc:t.doc}):u("unsupported combination of changes: "+JSON.stringify(t)+" after "+JSON.stringify(n)):this.changeMap=this.changeMap.insert(e,t)},t.prototype.getChanges=function(){var t=[];return this.changeMap.inorderTraversal(function(e,n){t.push(n)}),t},t}(),Nn=function(){function t(t,e,n,r,i,o,a){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.fromCache=i,this.hasPendingWrites=o,this.syncStateChanged=a}return t.prototype.isEqual=function(t){if(this.fromCache!==t.fromCache||this.hasPendingWrites!==t.hasPendingWrites||this.syncStateChanged!==t.syncStateChanged||!this.query.isEqual(t.query)||!this.docs.isEqual(t.docs)||!this.oldDocs.isEqual(t.oldDocs))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),kn=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||zt.comparator(e.key,n.key)}:function(t,e){return zt.comparator(t.key,e.key)},this.keyedMap=H(),this.sortedSet=new Yt(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal(function(e,n){return t(e),!1})},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}(),Pn=function(){function t(t){this.mapKeyFn=t,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];if(a.isEqual(t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(r[i][0].isEqual(t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(n[r][0].isEqual(t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){d(this.inner,function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];t(a,s)}})},t.prototype.isEmpty=function(){return v(this.inner)},t}(),Dn=function(){return function(){this.listeners=[]}}(),xn=function(){function t(t){this.syncEngine=t,this.queries=new Pn(function(t){return t.canonicalId()}),this.onlineState=Sn.Unknown,this.syncEngine.subscribe(this.onChange.bind(this),this.onError.bind(this))}return t.prototype.listen=function(t){var e=t.query,n=!1,r=this.queries.get(e);return r||(n=!0,r=new Dn,this.queries.set(e,r)),r.listeners.push(t),t.applyOnlineStateChange(this.onlineState),r.viewSnap&&t.onViewSnapshot(r.viewSnap),n?this.syncEngine.listen(e).then(function(t){return r.targetId=t,t}):Promise.resolve(r.targetId)},t.prototype.unlisten=function(t){var e=t.query,n=!1,r=this.queries.get(e);if(r){var i=r.listeners.indexOf(t);i>=0&&(r.listeners.splice(i,1),n=0===r.listeners.length)}return n?(this.queries.delete(e),this.syncEngine.unlisten(e)):Promise.resolve()},t.prototype.onChange=function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e],i=r.query,o=this.queries.get(i);if(o){for(var a=0,s=o.listeners;a<s.length;a++)s[a].onViewSnapshot(r);o.viewSnap=r}}},t.prototype.onError=function(t,e){var n=this.queries.get(t);if(n)for(var r=0,i=n.listeners;r<i.length;r++){i[r].onError(e)}this.queries.delete(t)},t.prototype.applyOnlineStateChange=function(t){this.onlineState=t,this.queries.forEach(function(e,n){for(var r=0,i=n.listeners;r<i.length;r++)i[r].applyOnlineStateChange(t)})},t}(),Mn=function(){function t(t,e,n){this.query=t,this.queryObserver=e,this.raisedInitialEvent=!1,this.onlineState=Sn.Unknown,this.options=n||{}}return t.prototype.onViewSnapshot=function(t){if(c(t.docChanges.length>0||t.syncStateChanged,"We got a new snapshot with no changes?"),!this.options.includeDocumentMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];i.type!==Tn.Metadata&&e.push(i)}t=new Nn(t.query,t.docs,t.oldDocs,e,t.fromCache,t.hasPendingWrites,t.syncStateChanged)}this.raisedInitialEvent?this.shouldRaiseEvent(t)&&this.queryObserver.next(t):this.shouldRaiseInitialEvent(t,this.onlineState)&&this.raiseInitialEvent(t),this.snap=t},t.prototype.onError=function(t){this.queryObserver.error(t)},t.prototype.applyOnlineStateChange=function(t){this.onlineState=t,this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,t)&&this.raiseInitialEvent(this.snap)},t.prototype.shouldRaiseInitialEvent=function(t,e){if(c(!this.raisedInitialEvent,"Determining whether to raise first event but already had first event"),!t.fromCache)return!0;var n=e!==Sn.Failed;return this.options.waitForSyncWhenOnline&&n?(c(t.fromCache,"Waiting for sync, but snapshot is not from cache"),!1):!t.docs.isEmpty()||e===Sn.Failed},t.prototype.shouldRaiseEvent=function(t){if(t.docChanges.length>0)return!0;var e=this.snap&&this.snap.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeQueryMetadataChanges},t.prototype.raiseInitialEvent=function(e){c(!this.raisedInitialEvent,"Trying to raise initial events for second time"),e=new Nn(e.query,e.docs,kn.emptySet(e.docs),t.getInitialViewChanges(e),e.fromCache,e.hasPendingWrites,!0),this.raisedInitialEvent=!0,this.queryObserver.next(e)},t.getInitialViewChanges=function(t){var e=[];return t.docs.forEach(function(t){e.push({type:Tn.Added,doc:t})}),e},t}(),Ln=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)},function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)})}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&u("Called next() or catch() twice for PersistencePromise"),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t(function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}})},t.prototype.toPromise=function(){var t=this;return new Promise(function(e,n){t.next(e,n)})},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.reject(n)},t.resolve=function(e){return new t(function(t,n){t(e)})},t.reject=function(e){return new t(function(t,n){n(e)})},t.waitFor=function(e){return e.reduce(function(t,e,n){return t.next(function(){return e})},t.resolve())},t.map=function(e){var n=[],r=!0,i=t.resolve(null);return e.reduce(function(t,e){return t.next(function(t){return r||n.push(t),r=!1,e})},i).next(function(t){return n.push(t),n})},t}(),Fn=function(){function t(){this.isEager=!0,this.sources=[],this.potentialGarbage=K()}return t.prototype.addGarbageSource=function(t){this.sources.push(t),t.setGarbageCollector(this)},t.prototype.removeGarbageSource=function(t){this.sources.splice(this.sources.indexOf(t),1),t.setGarbageCollector(null)},t.prototype.addPotentialGarbageKey=function(t){this.potentialGarbage=this.potentialGarbage.add(t)},t.prototype.collectGarbage=function(t){var e=this,n=[],r=K();return this.potentialGarbage.forEach(function(i){var o=e.documentHasAnyReferences(t,i);n.push(o.next(function(t){return t||(r=r.add(i)),Ln.resolve()}))}),this.potentialGarbage=K(),Ln.waitFor(n).next(function(){return r})},t.prototype.documentHasAnyReferences=function(t,e){var n=Ln.resolve(!1);return this.sources.map(function(n){return function(){return n.containsKey(t,e)}}).reduce(function(t,e){return t.next(function(t){return t?Ln.resolve(!0):e()})},n)},t}(),Un=function(){function t(t,e,n){this.query=t,this.addedKeys=e,this.removedKeys=n}return t.fromSnapshot=function(e){for(var n=K(),r=K(),i=0,o=e.docChanges;i<o.length;i++){var a=o[i];switch(a.type){case Tn.Added:n=n.add(a.doc.key);break;case Tn.Removed:r=r.add(a.doc.key)}}return new t(e.query,n,r)},t}(),jn=function(){function t(){this.refsByKey=new $e(Bn.compareByKey),this.refsByTarget=new $e(Bn.compareByTargetId),this.garbageCollector=null}return t.prototype.isEmpty=function(){return this.refsByKey.isEmpty()},t.prototype.addReference=function(t,e){var n=new Bn(t,e);this.refsByKey=this.refsByKey.add(n),this.refsByTarget=this.refsByTarget.add(n)},t.prototype.addReferences=function(t,e){var n=this;t.forEach(function(t){return n.addReference(t,e)})},t.prototype.removeReference=function(t,e){this.removeRef(new Bn(t,e))},t.prototype.removeReferences=function(t,e){var n=this;t.forEach(function(t){return n.removeReference(t,e)})},t.prototype.removeReferencesForId=function(t){var e=this,n=zt.EMPTY,r=new Bn(n,t),i=new Bn(n,t+1);this.refsByTarget.forEachInRange([r,i],function(t){e.removeRef(t)})},t.prototype.removeAllReferences=function(){var t=this;this.refsByKey.forEach(function(e){return t.removeRef(e)})},t.prototype.removeRef=function(t){this.refsByKey=this.refsByKey.delete(t),this.refsByTarget=this.refsByTarget.delete(t),null!==this.garbageCollector&&this.garbageCollector.addPotentialGarbageKey(t.key)},t.prototype.referencesForId=function(t){var e=zt.EMPTY,n=new Bn(e,t),r=new Bn(e,t+1),i=K();return this.refsByTarget.forEachInRange([n,r],function(t){i=i.add(t.key)}),i},t.prototype.setGarbageCollector=function(t){this.garbageCollector=t},t.prototype.containsKey=function(t,e){var n=new Bn(e,0),r=this.refsByKey.firstAfterOrEqual(n);return Ln.resolve(null!==r&&e.isEqual(r.key))},t}(),Bn=function(){function t(t,e){this.key=t,this.targetOrBatchId=e}return t.compareByKey=function(t,e){return zt.comparator(t.key,e.key)||D(t.targetOrBatchId,e.targetOrBatchId)},t.compareByTargetId=function(t,e){return D(t.targetOrBatchId,e.targetOrBatchId)||zt.comparator(t.key,e.key)},t}(),Vn=1;!function(t){t[t.LocalStore=0]="LocalStore",t[t.SyncEngine=1]="SyncEngine"}(Cn||(Cn={}));var Wn,qn=function(){function t(t,e){void 0===e&&(e=0),this.generatorId=t;var n=e>>Vn<<Vn,r=e-n;this.previousId=r>=t?n|this.generatorId:(n|this.generatorId)-(1<<Vn)}return t.prototype.next=function(){return this.previousId+=1<<Vn,this.previousId},t.forLocalStore=function(e){return void 0===e&&(e=0),new t(Cn.LocalStore,e)},t.forSyncEngine=function(){return new t(Cn.SyncEngine)},t}(),Hn=function(){return function(t){this.key=t}}(),Gn=function(){return function(t){this.key=t}}(),Kn=function(){function t(t,e){this.query=t,this.syncedDocuments=e,this.syncState=null,this.current=!1,this.limboDocuments=K(),this.mutatedKeys=K(),this.documentSet=new kn(t.docComparator.bind(t))}return t.prototype.computeDocChanges=function(t,e){var n=this,r=e?e.changeSet:new Rn,i=e?e.documentSet:this.documentSet,o=e?e.mutatedKeys:this.mutatedKeys,a=i,s=!1,u=this.query.hasLimit()&&i.size===this.query.limit?i.last():null;if(t.inorderTraversal(function(t,e){var l=i.get(t),h=e instanceof Qt?e:null;if(h&&(c(t.isEqual(h.key),"Mismatching keys found in document changes: "+t+" != "+h.key),h=n.query.matches(h)?h:null),h?(a=a.add(h),o=h.hasLocalMutations?o.add(t):o.delete(t)):(a=a.delete(t),o=o.delete(t)),l&&h){var f=l.data.isEqual(h.data);f&&l.hasLocalMutations===h.hasLocalMutations||(f?r.track({type:Tn.Metadata,doc:h}):r.track({type:Tn.Modified,doc:h}),u&&n.query.docComparator(h,u)>0&&(s=!0))}else!l&&h?r.track({type:Tn.Added,doc:h}):l&&!h&&(r.track({type:Tn.Removed,doc:l}),u&&(s=!0))}),this.query.hasLimit())for(;a.size>this.query.limit;){var l=a.last();a=a.delete(l.key),r.track({type:Tn.Removed,doc:l})}return c(!s||!e,"View was refilled using docs that themselves needed refilling."),{documentSet:a,changeSet:r,needsRefill:s,mutatedKeys:o}},t.prototype.applyChanges=function(t,e){var n=this;c(!t.needsRefill,"Cannot apply changes that need a refill");var r=this.documentSet;this.documentSet=t.documentSet,this.mutatedKeys=t.mutatedKeys;var i=t.changeSet.getChanges();i.sort(function(t,e){return J(t.type,e.type)||n.query.docComparator(t.doc,e.doc)}),this.applyTargetChange(e);var o=this.updateLimboDocuments(),a=0===this.limboDocuments.size&&this.current?In.Synced:In.Local,s=a!==this.syncState;return this.syncState=a,0!==i.length||s?{snapshot:new Nn(this.query,t.documentSet,r,i,a===In.Local,!t.mutatedKeys.isEmpty(),s),limboChanges:o}:{limboChanges:o}},t.prototype.applyOnlineStateChange=function(t){return this.current&&t===Sn.Failed?(this.current=!1,this.applyChanges({documentSet:this.documentSet,changeSet:new Rn,mutatedKeys:this.mutatedKeys,needsRefill:!1})):{limboChanges:[]}},t.prototype.shouldBeInLimbo=function(t){return!this.syncedDocuments.has(t)&&!!this.documentSet.has(t)&&!this.documentSet.get(t).hasLocalMutations},t.prototype.applyTargetChange=function(t){if(t){var e=t.mapping;switch(e instanceof sn?this.syncedDocuments=e.documents:e instanceof un&&(this.syncedDocuments=e.applyToKeySet(this.syncedDocuments)),t.currentStatusUpdate){case Je.MarkCurrent:this.current=!0;break;case Je.MarkNotCurrent:this.current=!1;break;case Je.None:break;default:u("Unknown current status update: "+t.currentStatusUpdate)}}},t.prototype.updateLimboDocuments=function(){var t=this;if(!this.current)return[];var e=this.limboDocuments;this.limboDocuments=K(),this.documentSet.forEach(function(e){t.shouldBeInLimbo(e.key)&&(t.limboDocuments=t.limboDocuments.add(e.key))});var n=[];return e.forEach(function(e){t.limboDocuments.has(e)||n.push(new Gn(e))}),this.limboDocuments.forEach(function(t){e.has(t)||n.push(new Hn(t))}),n},t}(),zn=function(){return function(t,e,n,r){this.query=t,this.targetId=e,this.resumeToken=n,this.view=r}}(),Qn=function(){function t(t,e,n){this.localStore=t,this.remoteStore=e,this.currentUser=n,this.viewHandler=null,this.errorHandler=null,this.queryViewsByQuery=new Pn(function(t){return t.canonicalId()}),this.queryViewsByTarget={},this.limboTargetsByKey=new Yt(zt.comparator),this.limboKeysByTarget={},this.limboDocumentRefs=new jn,this.limboCollector=new Fn,this.mutationUserCallbacks={},this.targetIdGenerator=qn.forSyncEngine()}return t.prototype.subscribe=function(t,e){c(null!==t&&null!==e,"View and error handlers cannot be null"),c(null===this.viewHandler&&null===this.errorHandler,"SyncEngine already has a subscriber."),this.viewHandler=t,this.errorHandler=e,this.limboCollector.addGarbageSource(this.limboDocumentRefs)},t.prototype.listen=function(t){var e=this;return this.assertSubscribed("listen()"),c(!this.queryViewsByQuery.has(t),"We already listen to the query: "+t),this.localStore.allocateQuery(t).then(function(n){return e.localStore.executeQuery(t).then(function(r){return e.localStore.remoteDocumentKeys(n.targetId).then(function(i){var o=new Kn(t,i),a=o.computeDocChanges(r),s=o.applyChanges(a);c(0===s.limboChanges.length,"View returned limbo docs before target ack from the server."),c(!!s.snapshot,"applyChanges for new view should always return a snapshot");var u=new zn(t,n.targetId,n.resumeToken,o);e.queryViewsByQuery.set(t,u),e.queryViewsByTarget[n.targetId]=u,e.viewHandler([s.snapshot]),e.remoteStore.listen(n)})}).then(function(){return n.targetId})})},t.prototype.unlisten=function(t){var e=this;this.assertSubscribed("unlisten()");var n=this.queryViewsByQuery.get(t);return c(!!n,"Trying to unlisten on query not found:"+t),this.localStore.releaseQuery(t).then(function(){return e.remoteStore.unlisten(n.targetId),e.removeAndCleanupQuery(n).then(function(){return e.localStore.collectGarbage()})})},t.prototype.write=function(t,e){var n=this;return this.assertSubscribed("write()"),this.localStore.localWrite(t).then(function(t){return n.addMutationCallback(t.batchId,e),n.emitNewSnapsAndNotifyLocalStore(t.changes)}).then(function(){return n.remoteStore.fillWritePipeline()})},t.prototype.wrapUpdateFunctionError=function(t){return t},t.prototype.runTransaction=function(t,e){var n=this;void 0===e&&(e=5),c(e>=0,"Got negative number of retries for transaction.");var r=this.remoteStore.createTransaction();return function(){try{var e=t(r);return!j(e)&&e.catch&&e.then?e.catch(function(t){return Promise.reject(n.wrapUpdateFunctionError(t))}):Promise.reject(Error("Transaction callback must return a Promise"))}catch(t){return Promise.reject(n.wrapUpdateFunctionError(t))}}().then(function(i){return r.commit().then(function(){return i}).catch(function(r){return 0===e?Promise.reject(r):n.runTransaction(t,e-1)})})},t.prototype.applyRemoteEvent=function(t){var e=this;return this.assertSubscribed("applyRemoteEvent()"),p(t.targetChanges,function(n,r){var i=e.limboKeysByTarget[n];i&&r.currentStatusUpdate===Je.MarkCurrent&&!t.documentUpdates.get(i)&&t.addDocumentUpdate(new Xt(i,t.snapshotVersion))}),this.localStore.applyRemoteEvent(t).then(function(n){return e.emitNewSnapsAndNotifyLocalStore(n,t)})},t.prototype.applyOnlineStateChange=function(t){var e=[];this.queryViewsByQuery.forEach(function(n,r){var i=r.view.applyOnlineStateChange(t);c(0===i.limboChanges.length,"OnlineState should not affect limbo documents."),i.snapshot&&e.push(i.snapshot)}),this.viewHandler(e)},t.prototype.rejectListen=function(t,e){var n=this;this.assertSubscribed("rejectListens()");var r=this.limboKeysByTarget[t];if(r){this.limboTargetsByKey=this.limboTargetsByKey.remove(r),delete this.limboKeysByTarget[t];var i=new Yt(zt.comparator);i=i.insert(r,new Xt(r,Me.forDeletedDoc()));var o=new rn(Me.MIN,{},i);return this.applyRemoteEvent(o)}var a=this.queryViewsByTarget[t];return c(!!a,"Unknown targetId: "+t),this.localStore.releaseQuery(a.query).then(function(){return n.removeAndCleanupQuery(a).then(function(){n.errorHandler(a.query,e)})})},t.prototype.applySuccessfulWrite=function(t){var e=this;return this.assertSubscribed("applySuccessfulWrite()"),this.processUserCallback(t.batch.batchId,null),this.localStore.acknowledgeBatch(t).then(function(t){return e.emitNewSnapsAndNotifyLocalStore(t)})},t.prototype.rejectFailedWrite=function(t,e){var n=this;return this.assertSubscribed("rejectFailedWrite()"),this.processUserCallback(t,e),this.localStore.rejectBatch(t).then(function(t){return n.emitNewSnapsAndNotifyLocalStore(t)})},t.prototype.addMutationCallback=function(t,e){var n=this.mutationUserCallbacks[this.currentUser.toKey()];n||(n=new Yt(D)),n=n.insert(t,e),this.mutationUserCallbacks[this.currentUser.toKey()]=n},t.prototype.processUserCallback=function(t,e){var n=this.mutationUserCallbacks[this.currentUser.toKey()];if(n){var r=n.get(t);r&&(c(t===n.minKey(),"Mutation callbacks processed out-of-order?"),e?r.reject(e):r.resolve(),n=n.remove(t)),this.mutationUserCallbacks[this.currentUser.toKey()]=n}},t.prototype.removeAndCleanupQuery=function(t){return this.queryViewsByQuery.delete(t.query),delete this.queryViewsByTarget[t.targetId],this.limboDocumentRefs.removeReferencesForId(t.targetId),this.gcLimboDocuments()},t.prototype.updateTrackedLimbos=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof Hn?(this.limboDocumentRefs.addReference(i.key,t),this.trackLimboChange(i)):i instanceof Gn?(o("SyncEngine","Document no longer in limbo: "+i.key),this.limboDocumentRefs.removeReference(i.key,t)):u("Unknown limbo change: "+JSON.stringify(i))}return this.gcLimboDocuments()},t.prototype.trackLimboChange=function(t){var e=t.key;if(!this.limboTargetsByKey.get(e)){o("SyncEngine","New document in limbo: "+e);var n=this.targetIdGenerator.next(),r=Se.atPath(e.path);this.limboKeysByTarget[n]=e,this.remoteStore.listen(new Fe(r,n,re.Listen)),this.limboTargetsByKey=this.limboTargetsByKey.insert(e,n)}},t.prototype.gcLimboDocuments=function(){var t=this;return this.limboCollector.collectGarbage(null).next(function(e){e.forEach(function(e){var n=t.limboTargetsByKey.get(e);null!==n&&(t.remoteStore.unlisten(n),t.limboTargetsByKey=t.limboTargetsByKey.remove(e),delete t.limboKeysByTarget[n])})}).toPromise()},t.prototype.currentLimboDocs=function(){return this.limboTargetsByKey},t.prototype.emitNewSnapsAndNotifyLocalStore=function(t,e){var n=this,r=[],i=[],o=[];return this.queryViewsByQuery.forEach(function(a,s){o.push(Promise.resolve().then(function(){var e=s.view.computeDocChanges(t);return e.needsRefill?n.localStore.executeQuery(s.query).then(function(t){return s.view.computeDocChanges(t,e)}):e}).then(function(t){var o=e&&e.targetChanges[s.targetId],a=s.view.applyChanges(t,o);return n.updateTrackedLimbos(s.targetId,a.limboChanges).then(function(){if(a.snapshot){r.push(a.snapshot);var t=Un.fromSnapshot(a.snapshot);i.push(t)}})}))}),Promise.all(o).then(function(){return n.viewHandler(r),n.localStore.notifyLocalViewChanges(i)}).then(function(){return n.localStore.collectGarbage()})},t.prototype.assertSubscribed=function(t){c(null!==this.viewHandler&&null!==this.errorHandler,"Trying to call "+t+" before calling subscribe().")},t.prototype.handleUserChange=function(t){var e=this;return this.currentUser=t,this.localStore.handleUserChange(t).then(function(t){return e.emitNewSnapsAndNotifyLocalStore(t)}).then(function(){return e.remoteStore.handleUserChange(t)})},t}(),Xn=-1,Yn=function(){function t(t,e,n){this.batchId=t,this.localWriteTime=e,this.mutations=n}return t.prototype.applyToRemoteDocument=function(t,e,n){e&&c(e.key.isEqual(t),"applyToRemoteDocument: key "+t+" should match maybeDoc key\n        "+e.key);var r=n.mutationResults;c(r.length===this.mutations.length,"Mismatch between mutations length\n      ("+this.mutations.length+") and mutation results length\n      ("+r.length+").");for(var i=0;i<this.mutations.length;i++){var o=this.mutations[i];if(o.key.isEqual(t)){var a=r[i];e=o.applyToRemoteDocument(e,a)}}return e},t.prototype.applyToLocalView=function(t,e){e&&c(e.key.isEqual(t),"applyToLocalDocument: key "+t+" should match maybeDoc key\n        "+e.key);for(var n=e,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(t)&&(e=i.applyToLocalView(e,n,this.localWriteTime))}return e},t.prototype.keys=function(){for(var t=K(),e=0,n=this.mutations;e<n.length;e++){var r=n[e];t=t.add(r.key)}return t},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&x(this.mutations,t.mutations)},t.prototype.isTombstone=function(){return 0===this.mutations.length},t.prototype.toTombstone=function(){return new t(this.batchId,this.localWriteTime,[])},t}(),Jn=function(){function t(t,e,n,r,i){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.streamToken=r,this.docVersions=i}return t.from=function(e,n,r,i){c(e.mutations.length===r.length,"Mutations sent "+e.mutations.length+" must equal results received "+r.length);for(var o=G(),a=e.mutations,s=0;s<a.length;s++){var u=r[s].version;null===u&&(u=n),o=o.insert(a[s].key,u)}return new t(e,n,r,i,o)},t}(),$n="",Zn="",tr="",er="",nr=function(){return function(t,e){this.seconds=t,this.nanos=e}}(),rr=function(){function t(t,e){this.ownerId=t,this.leaseTimestampMs=e}return t.store="owner",t}(),ir=function(){function t(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n}return t.store="mutationQueues",t.keyPath="userId",t}(),or=function(){function t(t,e,n,r){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.mutations=r}return t.store="mutations",t.keyPath=["userId","batchId"],t}(),ar=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,$(e)]},t.key=function(t,e,n){return[t,$(e),n]},t.store="documentMutations",t.PLACEHOLDER=new t,t}(),sr=function(){return function(t,e){this.path=t,this.readTime=e}}(),ur=function(){function t(t,e){this.noDocument=t,this.document=e}return t.store="remoteDocuments",t}(),cr=function(){function t(t,e,n,r,i,o){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.query=o}return t.store="targets",t.keyPath="targetId",t.queryTargetsIndexName="queryTargetsIndex",t.queryTargetsKeyPath=["canonicalId","targetId"],t}(),lr=function(){function t(t,e){this.targetId=t,this.path=e}return t.store="targetDocuments",t.keyPath=["targetId","path"],t.documentTargetsIndex="documentTargetsIndex",t.documentTargetsKeyPath=["path","targetId"],t}(),hr=function(){function t(t,e,n){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n}return t.key="targetGlobalKey",t.store="targetGlobal",t}(),fr=[ir.store,or.store,ar.store,ur.store,cr.store,rr.store,hr.store,lr.store],pr=function(){function t(t){this.db=t}return t.openOrCreate=function(e,n,r){return c(t.isAvailable(),"IndexedDB not supported in current environment."),o("SimpleDb","Opening database:",e),new Ln(function(i,a){var s=window.indexedDB.open(e,n);s.onsuccess=function(e){var n=e.target.result;i(new t(n))},s.onerror=function(t){a(t.target.error)},s.onupgradeneeded=function(t){o("SimpleDb",'Database "'+e+'" requires upgrade from version:',t.oldVersion);var n=t.target.result;r(n,t.oldVersion)}}).toPromise()},t.delete=function(t){return o("SimpleDb","Removing database:",t),rt(window.indexedDB.deleteDatabase(t)).toPromise()},t.isAvailable=function(){if("undefined"==typeof window||null==window.indexedDB)return!1;var t=window.navigator.userAgent;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0)},t.prototype.runTransaction=function(t,e,n){var r=new vr(this.db,t,e),i=n(r).catch(function(t){return r.abort(),Ln.reject(t)}).toPromise();return r.completionPromise.then(function(){return i})},t.prototype.close=function(){this.db.close()},t}(),dr=function(){function t(t){this.dbCursor=t,this.shouldStop=!1,this.nextKey=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.shouldStop},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"skipToKey",{get:function(){return this.nextKey},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.dbCursor=t},enumerable:!0,configurable:!0}),t.prototype.done=function(){this.shouldStop=!0},t.prototype.skip=function(t){this.nextKey=t},t.prototype.delete=function(){return rt(this.dbCursor.delete())},t}(),vr=function(){function t(t,e,n){var r=this;this.aborted=!1,this.transaction=t.transaction(n,e),this.completionPromise=new Promise(function(t,e){r.transaction.onabort=r.transaction.oncomplete=function(e){t()},r.transaction.onerror=function(t){e(t.target.error)}})}return t.prototype.abort=function(){this.aborted||(o("SimpleDb","Aborting transaction."),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return c(!!e,"Object store not part of transaction: "+t),new gr(e)},t}(),gr=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(o("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(o("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),rt(n)},t.prototype.get=function(t){var e=this;return rt(this.store.get(t)).next(function(n){return void 0===n&&(n=null),o("SimpleDb","GET",e.store.name,t,n),n})},t.prototype.delete=function(t){return o("SimpleDb","DELETE",this.store.name,t),rt(this.store.delete(t))},t.prototype.loadAll=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.iterateCursor(n,function(t,e){r.push(e)}).next(function(){return r})},t.prototype.deleteAll=function(t,e){o("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.keysOnly=!1;var r=this.cursor(n);return this.iterateCursor(r,function(t,e,n){return n.delete()})},t.prototype.iterate=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.iterateCursor(r,e)},t.prototype.iterateCursor=function(t,e){var n=[];return new Ln(function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new dr(i),a=e(i.primaryKey,i.value,o);a instanceof Ln&&n.push(a),o.isDone?r():null===o.skipToKey?i.continue():i.continue(o.skipToKey)}else r()}}).next(function(){return Ln.waitFor(n)})},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:(c(void 0===e,"3rd argument must not be defined if 2nd is a range."),e=t)),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.keysOnly?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}(),yr=function(){function t(t,e){this.userId=t,this.serializer=e,this.garbageCollector=null}return t.forUser=function(e,n){return c(""!==e.uid,"UserID must not be an empty string."),new t(e.isUnauthenticated()?"":e.uid,n)},t.prototype.start=function(e){var n=this;return t.loadNextBatchIdFromDb(e).next(function(t){return n.nextBatchId=t,st(e).get(n.userId)}).next(function(t){return t||(t=new ir(n.userId,Xn,"")),n.metadata=t,n.metadata.lastAcknowledgedBatchId>=n.nextBatchId?n.checkEmpty(e).next(function(t){return c(t,"Reset nextBatchID is only possible when the queue is empty"),n.metadata.lastAcknowledgedBatchId=Xn,st(e).put(n.metadata)}):Ln.resolve()})},t.loadNextBatchIdFromDb=function(t){var e=Xn;return ot(t).iterate({reverse:!0},function(t,n,r){var i=t[0];if(t[1]>e&&(e=n.batchId),""===i)r.done();else{var o=function(t){var e=t.length-1;return 0===t.length?"":"\0"===t.charAt(e)?t.substring(0,e):t.substring(0,e)+String.fromCharCode(t.charCodeAt(e)-1)}(i);r.skip([o])}}).next(function(){return e+1})},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound(this.keyForBatchId(Number.NEGATIVE_INFINITY),this.keyForBatchId(Number.POSITIVE_INFINITY));return ot(t).iterate({range:n},function(t,n,r){e=!1,r.done()}).next(function(){return e})},t.prototype.getNextBatchId=function(t){return Ln.resolve(this.nextBatchId)},t.prototype.getHighestAcknowledgedBatchId=function(t){return Ln.resolve(this.metadata.lastAcknowledgedBatchId)},t.prototype.acknowledgeBatch=function(t,e,n){var r=e.batchId;return c(r>this.metadata.lastAcknowledgedBatchId,"Mutation batchIDs must be acknowledged in order"),this.metadata.lastAcknowledgedBatchId=r,this.metadata.lastStreamToken=it(n),st(t).put(this.metadata)},t.prototype.getLastStreamToken=function(t){return Ln.resolve(this.metadata.lastStreamToken)},t.prototype.setLastStreamToken=function(t,e){return this.metadata.lastStreamToken=it(e),st(t).put(this.metadata)},t.prototype.addMutationBatch=function(t,e,n){var r=this,i=this.nextBatchId;this.nextBatchId++;var o=new Yn(i,e,n),a=this.serializer.toDbMutationBatch(this.userId,o);return ot(t).put(a).next(function(){for(var e=0,o=n;e<o.length;e++){var a=o[e],s=($(a.key.path),ar.key(r.userId,a.key.path,i));at(t).put(s,ar.PLACEHOLDER)}return Ln.waitFor([])}).next(function(){return o})},t.prototype.lookupMutationBatch=function(t,e){var n=this;return ot(t).get(this.keyForBatchId(e)).next(function(t){return t?n.serializer.fromDbMutationBatch(t):null})},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=IDBKeyRange.lowerBound(this.keyForBatchId(e+1)),i=null;return ot(t).iterate({range:r},function(t,r,o){r.userId===n.userId&&(c(r.batchId>e,"Should have found mutation after "+e),i=n.serializer.fromDbMutationBatch(r)),o.done()}).next(function(){return i})},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound(this.keyForBatchId(Xn),this.keyForBatchId(Number.POSITIVE_INFINITY));return ot(t).loadAll(n).next(function(t){return t.map(function(t){return e.serializer.fromDbMutationBatch(t)})})},t.prototype.getAllMutationBatchesThroughBatchId=function(t,e){var n=this,r=IDBKeyRange.bound(this.keyForBatchId(Xn),this.keyForBatchId(e));return ot(t).loadAll(r).next(function(t){return t.map(function(t){return n.serializer.fromDbMutationBatch(t)})})},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=ar.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return at(t).iterate({range:i},function(r,i,a){var s=r[0],c=r[1],l=r[2],h=et(c);if(s===n.userId&&e.path.isEqual(h)){var f=n.keyForBatchId(l);return ot(t).get(f).next(function(t){null===t&&u("Dangling document-mutation reference found: "+r+" which points to "+f),o.push(n.serializer.fromDbMutationBatch(t))})}a.done()}).next(function(){return o})},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this;c(!e.isDocumentQuery(),"Document queries shouldn't go down this path");var r=e.path,i=r.length+1,o=ar.prefixForPath(this.userId,r),a=(o[1],IDBKeyRange.lowerBound(o)),s=new $e(D);return at(t).iterate({range:a},function(t,e,o){var a=t[0],u=t[1],c=t[2],l=et(u);a===n.userId&&r.isPrefixOf(l)?l.length===i&&(s=s.add(c)):o.done()}).next(function(){var e=[],r=[];return s.forEach(function(i){var o=n.keyForBatchId(i);r.push(ot(t).get(o).next(function(t){null===t&&u("Dangling document-mutation reference found, which points to "+o),e.push(n.serializer.fromDbMutationBatch(t))}))}),Ln.waitFor(r).next(function(){return e})})},t.prototype.removeMutationBatches=function(t,e){for(var n=ot(t),r=at(t),i=[],o=this,a=0,s=e;a<s.length;a++){!function(t){var e=IDBKeyRange.only(o.keyForBatchId(t.batchId)),a=0,s=n.iterate({range:e},function(t,e,n){return a++,n.delete()});i.push(s.next(function(){c(1===a,"Dangling document-mutation reference found: Missing batch "+t.batchId)}));for(var u=0,l=t.mutations;u<l.length;u++){var h=l[u],f=ar.key(o.userId,h.key.path,t.batchId);i.push(r.delete(f)),null!==o.garbageCollector&&o.garbageCollector.addPotentialGarbageKey(h.key)}}(s[a])}return Ln.waitFor(i)},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next(function(n){if(!n)return Ln.resolve();var r=IDBKeyRange.lowerBound(ar.prefixForUser(e.userId)),i=[];return at(t).iterate({range:r},function(t,n,r){if(t[0]===e.userId){var o=et(t[1]);i.push(o)}else r.done()}).next(function(){c(0===i.length,"Document leak -- detected dangling mutation references when queue is empty. Dangling keys: "+i.map(function(t){return t.canonicalString()}))})})},t.prototype.setGarbageCollector=function(t){this.garbageCollector=t},t.prototype.containsKey=function(t,e){var n=this,r=ar.prefixForPath(this.userId,e.path),i=r[1],o=IDBKeyRange.lowerBound(r),a=!1;return at(t).iterate({range:o,keysOnly:!0},function(t,e,r){var o=t[0],s=t[1];t[2],o===n.userId&&s===i&&(a=!0),r.done()}).next(function(){return a})},t.prototype.keyForBatchId=function(t){return[this.userId,t]},t}(),mr=function(){function t(t){this.serializer=t,this.lastRemoteSnapshotVersion=Me.MIN,this.metadata=new hr(0,0,Me.MIN.toTimestamp()),this.garbageCollector=null}return t.prototype.start=function(t){var e=this;return lt(t).get(hr.key).next(function(t){if(null!==t){e.metadata=t;var n=t.lastRemoteSnapshotVersion;e.lastRemoteSnapshotVersion=Me.fromTimestamp(new xe(n.seconds,n.nanos))}return Ln.resolve()})},t.prototype.getHighestTargetId=function(){return this.metadata.highestTargetId},t.prototype.getLastRemoteSnapshotVersion=function(){return this.lastRemoteSnapshotVersion},t.prototype.setLastRemoteSnapshotVersion=function(t,e){return this.lastRemoteSnapshotVersion=e,this.metadata.lastRemoteSnapshotVersion=e.toTimestamp(),lt(t).put(hr.key,this.metadata)},t.prototype.addQueryData=function(t,e){var n=this,r=e.targetId,i=ct(t).put(this.serializer.toDbTarget(e));return r>this.metadata.highestTargetId?(this.metadata.highestTargetId=r,i.next(function(){return lt(t).put(hr.key,n.metadata)})):i},t.prototype.removeQueryData=function(t,e){return this.removeMatchingKeysForTargetId(t,e.targetId).next(function(){ct(t).delete(e.targetId)})},t.prototype.getQueryData=function(t,e){var n=this,r=e.canonicalId(),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),o=null;return ct(t).iterate({range:i,index:cr.queryTargetsIndexName},function(t,r,i){var a=n.serializer.fromDbTarget(r);e.isEqual(a.query)&&(o=a,i.done())}).next(function(){return o})},t.prototype.addMatchingKeys=function(t,e,n){var r=[],i=ht(t);return e.forEach(function(t){var e=$(t.path);r.push(i.put(new lr(n,e)))}),Ln.waitFor(r)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=[],o=ht(t);return e.forEach(function(t){var e=$(t.path);i.push(o.delete([n,e])),null!==r.garbageCollector&&r.garbageCollector.addPotentialGarbageKey(t)}),Ln.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=ht(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return this.notifyGCForRemovedKeys(t,r).next(function(){return n.delete(r)})},t.prototype.notifyGCForRemovedKeys=function(t,e){var n=this,r=ht(t);return null!==this.garbageCollector&&this.garbageCollector.isEager?r.iterate({range:e,keysOnly:!0},function(t,e,r){var i=et(t[1]),o=new zt(i);c(null!==n.garbageCollector,"GarbageCollector for query cache set to null during key removal."),n.garbageCollector.addPotentialGarbageKey(o)}):Ln.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=ht(t),i=K();return r.iterate({range:n,keysOnly:!0},function(t,e,n){var r=et(t[1]),o=new zt(r);i=i.add(o)}).next(function(){return i})},t.prototype.setGarbageCollector=function(t){this.garbageCollector=t},t.prototype.containsKey=function(t,e){c(null!==t,"Persistence Transaction cannot be null for query cache containsKey");var n=$(e.path),r=IDBKeyRange.bound([n],[M(n)],!1,!0),i=0;return ht(t).iterate({index:lr.documentTargetsIndex,keysOnly:!0,range:r},function(t,e,n){i++,n.done()}).next(function(){return i>0})},t}(),_r=function(){function t(t){this.serializer=t}return t.prototype.addEntry=function(t,e){return pt(t).put(dt(e.key),this.serializer.toDbRemoteDocument(e))},t.prototype.removeEntry=function(t,e){return pt(t).delete(dt(e))},t.prototype.getEntry=function(t,e){var n=this;return pt(t).get(dt(e)).next(function(t){return t?n.serializer.fromDbRemoteDocument(t):null})},t.prototype.getDocumentsMatchingQuery=function(t,e){var n=this,r=H(),i=e.path.toArray(),o=IDBKeyRange.lowerBound(i);return pt(t).iterate({range:o},function(t,i,o){var a=n.serializer.fromDbRemoteDocument(i);e.path.isPrefixOf(a.key.path)?a instanceof Qt&&e.matches(a)&&(r=r.insert(a.key,a)):o.done()}).next(function(){return r})},t}(),br=function(){function t(t){this.remoteSerializer=t}return t.prototype.fromDbRemoteDocument=function(t){if(t.document)return this.remoteSerializer.fromDocument(t.document);if(t.noDocument){var e=zt.fromSegments(t.noDocument.path),n=t.noDocument.readTime,r=new xe(n.seconds,n.nanos);return new Xt(e,Me.fromTimestamp(r))}return u("Unexpected DbRemoteDocument")},t.prototype.toDbRemoteDocument=function(t){if(t instanceof Qt){var e=this.remoteSerializer.toDocument(t);return new ur(null,e)}var n=t.key.path.toArray(),r=t.version.toTimestamp(),i=new nr(r.seconds,r.nanos);return new ur(new sr(n,i),null)},t.prototype.toDbMutationBatch=function(t,e){var n=this,r=e.mutations.map(function(t){return n.remoteSerializer.toMutation(t)});return new or(t,e.batchId,e.localWriteTime.toEpochMilliseconds(),r)},t.prototype.fromDbMutationBatch=function(t){var e=this,n=t.mutations.map(function(t){return e.remoteSerializer.fromMutation(t)}),r=xe.fromEpochMilliseconds(t.localWriteTimeMs);return new Yn(t.batchId,r,n)},t.prototype.fromDbTarget=function(t){var e,n=new xe(t.readTime.seconds,t.readTime.nanos),r=Me.fromTimestamp(n);return e=function(t){return void 0!==t.documents}(t.query)?this.remoteSerializer.fromDocumentsTarget(t.query):this.remoteSerializer.fromQueryTarget(t.query),new Fe(e,t.targetId,re.Listen,r,t.resumeToken)},t.prototype.toDbTarget=function(t){c(re.Listen===t.purpose,"Only queries with purpose "+re.Listen+" may be stored, got "+t.purpose);var e,n=t.snapshotVersion.toTimestamp(),r=new nr(n.seconds,n.nanos);e=t.query.isDocumentQuery()?this.remoteSerializer.toDocumentsTarget(t.query):this.remoteSerializer.toQueryTarget(t.query),c("string"==typeof t.resumeToken,"Persisting non-string resume token not supported.");var i=t.resumeToken;return new cr(t.targetId,t.query.canonicalId(),r,i,0,e)},t}(),Er="There is another tab open with offline persistence enabled. Only one such tab is allowed at a time. The other tab must be closed or persistence must be disabled.",wr=function(){function t(e,n){this.ownerId=this.generateOwnerId(),this.dbName=e+t.MAIN_DATABASE,this.serializer=new br(n),this.localStoragePrefix=e}return t.prototype.start=function(){var e=this;return t.isAvailable()?(c(!this.started,"IndexedDbPersistence double-started!"),this.started=!0,pr.openOrCreate(this.dbName,1,nt).then(function(t){e.simpleDb=t}).then(function(){return e.tryAcquireOwnerLease()}).then(function(){e.scheduleOwnerLeaseRefreshes(),e.attachWindowUnloadHook()})):(this.persistenceError=new xt(Dt.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled."),Promise.reject(this.persistenceError))},t.prototype.shutdown=function(){var t=this;return c(this.started,"IndexedDbPersistence shutdown without start!"),this.started=!1,this.detachWindowUnloadHook(),this.stopOwnerLeaseRefreshes(),this.releaseOwnerLease().then(function(){t.simpleDb.close()})},t.prototype.getMutationQueue=function(t){return yr.forUser(t,this.serializer)},t.prototype.getQueryCache=function(){return new mr(this.serializer)},t.prototype.getRemoteDocumentCache=function(){return new _r(this.serializer)},t.prototype.runTransaction=function(t,e){var n=this;return this.persistenceError?Promise.reject(this.persistenceError):(o("IndexedDbPersistence","Starting transaction:",t),this.simpleDb.runTransaction("readwrite",fr,function(t){return n.ensureOwnerLease(t).next(function(){return e(t)})}))},t.isAvailable=function(){return pr.isAvailable()},t.buildStoragePrefix=function(t){var e=t.databaseId.projectId;return t.databaseId.isDefaultDatabase||(e+="."+t.databaseId.database),"firestore/"+t.persistenceKey+"/"+e+"/"},t.prototype.tryAcquireOwnerLease=function(){var t=this;return this.simpleDb.runTransaction("readwrite",[rr.store],function(e){var n=e.store(rr.store);return n.get("owner").next(function(e){if(t.validOwner(e))return o("IndexedDbPersistence","Valid owner already. Failing. Current owner:",e),t.persistenceError=new xt(Dt.FAILED_PRECONDITION,Er),Ln.reject(t.persistenceError);var r=new rr(t.ownerId,Date.now());return o("IndexedDbPersistence","No valid owner. Acquiring owner lease. Current owner:",e,"New owner:",r),n.put("owner",r)})})},t.prototype.releaseOwnerLease=function(){var t=this;return this.simpleDb.runTransaction("readwrite",[rr.store],function(e){var n=e.store(rr.store);return n.get("owner").next(function(e){return null!==e&&e.ownerId===t.ownerId?(o("IndexedDbPersistence","Releasing owner lease."),n.delete("owner")):Ln.resolve()})})},t.prototype.ensureOwnerLease=function(t){var e=this;return t.store(rr.store).get("owner").next(function(t){return null===t||t.ownerId!==e.ownerId?(e.persistenceError=new xt(Dt.FAILED_PRECONDITION,Er),Ln.reject(e.persistenceError)):Ln.resolve()})},t.prototype.validOwner=function(t){var e=Date.now(),n=e-5e3,r=e;return!(null===t||t.leaseTimestampMs<n||(t.leaseTimestampMs>r?(a("Persistence owner-lease is in the future. Discarding.",t),1):t.ownerId===this.getZombiedOwnerId()))},t.prototype.scheduleOwnerLeaseRefreshes=function(){var t=this;this.ownerLeaseRefreshHandle=setInterval(function(){t.runTransaction("Refresh owner timestamp",function(e){return e.store(rr.store).put("owner",new rr(t.ownerId,Date.now()))}).catch(function(e){a(e),t.stopOwnerLeaseRefreshes()})},4e3)},t.prototype.stopOwnerLeaseRefreshes=function(){this.ownerLeaseRefreshHandle&&(clearInterval(this.ownerLeaseRefreshHandle),this.ownerLeaseRefreshHandle=null)},t.prototype.attachWindowUnloadHook=function(){var t=this;this.windowUnloadHandler=function(){t.setZombiedOwnerId(t.ownerId),t.shutdown()},window.addEventListener("unload",this.windowUnloadHandler)},t.prototype.detachWindowUnloadHook=function(){this.windowUnloadHandler&&(window.removeEventListener("unload",this.windowUnloadHandler),this.windowUnloadHandler=null)},t.prototype.getZombiedOwnerId=function(){try{var t=window.localStorage.getItem(this.zombiedOwnerLocalStorageKey());return o("IndexedDbPersistence","Zombied ownerID from LocalStorage:",t),t}catch(t){return a("Failed to get zombie owner id.",t),null}},t.prototype.setZombiedOwnerId=function(t){try{null===t?window.localStorage.removeItem(this.zombiedOwnerLocalStorageKey()):window.localStorage.setItem(this.zombiedOwnerLocalStorageKey(),t)}catch(t){a("Failed to set zombie owner id.",t)}},t.prototype.zombiedOwnerLocalStorageKey=function(){return this.localStoragePrefix+"zombiedOwnerId"},t.prototype.generateOwnerId=function(){return Mt.newId()},t.MAIN_DATABASE="main",t}(),Sr=function(){function t(t,e){this.remoteDocumentCache=t,this.mutationQueue=e}return t.prototype.getDocument=function(t,e){var n=this;return this.remoteDocumentCache.getEntry(t,e).next(function(r){return n.computeLocalDocument(t,e,r)})},t.prototype.getDocuments=function(t,e){var n=this,r=[],i=q();return e.forEach(function(e){r.push(n.getDocument(t,e).next(function(t){t||(t=new Xt(e,Me.forDeletedDoc())),i=i.insert(e,t)}))}),Ln.waitFor(r).next(function(){return i})},t.prototype.getDocumentsMatchingQuery=function(t,e){return zt.isDocumentKey(e.path)?this.getDocumentsMatchingDocumentQuery(t,e.path):this.getDocumentsMatchingCollectionQuery(t,e)},t.prototype.getDocumentsMatchingDocumentQuery=function(t,e){return this.getDocument(t,new zt(e)).next(function(t){var e=H();return t instanceof Qt&&(e=e.insert(t.key,t)),e})},t.prototype.getDocumentsMatchingCollectionQuery=function(t,e){var n,r=this;return this.remoteDocumentCache.getDocumentsMatchingQuery(t,e).next(function(e){return r.computeLocalDocuments(t,e)}).next(function(i){return n=i,r.mutationQueue.getAllMutationBatchesAffectingQuery(t,e)}).next(function(e){for(var i=K(),o=0,a=e;o<a.length;o++)for(var s=0,u=a[o].mutations;s<u.length;s++){var c=u[s];n.get(c.key)||(i=i.add(c.key))}var l=[];return i.forEach(function(e){l.push(r.getDocument(t,e).next(function(t){t instanceof Qt&&(n=n.insert(t.key,t))}))}),Ln.waitFor(l)}).next(function(){return n.forEach(function(t,r){e.matches(r)||(n=n.remove(t))}),n})},t.prototype.computeLocalDocument=function(t,e,n){return this.mutationQueue.getAllMutationBatchesAffectingDocumentKey(t,e).next(function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];n=o.applyToLocalView(e,n)}return n})},t.prototype.computeLocalDocuments=function(t,e){var n=this,r=[];return e.forEach(function(i,o){r.push(n.computeLocalDocument(t,i,o).next(function(t){t instanceof Qt?e=e.insert(t.key,t):t instanceof Xt?e=e.remove(t.key):u("Unknown MaybeDocument: "+t)}))}),Ln.waitFor(r).next(function(){return e})},t}(),Tr=function(){function t(t){this.remoteDocumentCache=t,this.changes=q()}return t.prototype.addEntry=function(t){var e=this.assertChanges();this.changes=e.insert(t.key,t)},t.prototype.getEntry=function(t,e){var n=this.assertChanges().get(e);return n?Ln.resolve(n):this.remoteDocumentCache.getEntry(t,e)},t.prototype.apply=function(t){var e=this,n=this.assertChanges(),r=[];return n.forEach(function(n,i){r.push(e.remoteDocumentCache.addEntry(t,i))}),this.changes=null,Ln.waitFor(r)},t.prototype.assertChanges=function(){return c(null!==this.changes,"Changes have already been applied."),this.changes},t}(),Ir=function(){function t(t,e,n){this.persistence=t,this.garbageCollector=n,this.localViewReferences=new jn,this.targetIds={},this.targetIdGenerator=qn.forLocalStore(),this.heldBatchResults=[],this.mutationQueue=t.getMutationQueue(e),this.remoteDocuments=t.getRemoteDocumentCache(),this.queryCache=t.getQueryCache(),this.localDocuments=new Sr(this.remoteDocuments,this.mutationQueue),this.garbageCollector.addGarbageSource(this.localViewReferences),this.garbageCollector.addGarbageSource(this.queryCache),this.garbageCollector.addGarbageSource(this.mutationQueue)}return t.prototype.start=function(){var t=this;return this.persistence.runTransaction("Start LocalStore",function(e){return t.startMutationQueue(e).next(function(){return t.startQueryCache(e)})})},t.prototype.handleUserChange=function(t){var e=this;return this.persistence.runTransaction("Handle user change",function(n){var r;return e.mutationQueue.getAllMutationBatches(n).next(function(i){return r=i,e.garbageCollector.removeGarbageSource(e.mutationQueue),e.mutationQueue=e.persistence.getMutationQueue(t),e.garbageCollector.addGarbageSource(e.mutationQueue),e.startMutationQueue(n)}).next(function(){return e.localDocuments=new Sr(e.remoteDocuments,e.mutationQueue),e.mutationQueue.getAllMutationBatches(n)}).next(function(t){for(var i=K(),o=0,a=[r,t];o<a.length;o++)for(var s=0,u=a[o];s<u.length;s++)for(var c=0,l=u[s].mutations;c<l.length;c++){var h=l[c];i=i.add(h.key)}return e.localDocuments.getDocuments(n,i)})})},t.prototype.startQueryCache=function(t){var e=this;return this.queryCache.start(t).next(function(){var t=e.queryCache.getHighestTargetId();e.targetIdGenerator=qn.forLocalStore(t)})},t.prototype.startMutationQueue=function(t){var e=this;return this.mutationQueue.start(t).next(function(){return e.heldBatchResults=[],e.mutationQueue.getHighestAcknowledgedBatchId(t)}).next(function(n){return n!==Xn?e.mutationQueue.getAllMutationBatchesThroughBatchId(t,n):Ln.resolve([])}).next(function(n){return n.length>0?e.mutationQueue.removeMutationBatches(t,n):Ln.resolve()})},t.prototype.localWrite=function(t){var e=this;return this.persistence.runTransaction("Locally write mutations",function(n){var r,i=xe.now();return e.mutationQueue.addMutationBatch(n,i,t).next(function(t){var i=(r=t).keys();return e.localDocuments.getDocuments(n,i)}).next(function(t){return{batchId:r.batchId,changes:t}})})},t.prototype.acknowledgeBatch=function(t){var e=this;return this.persistence.runTransaction("Acknowledge batch",function(n){var r;return e.mutationQueue.acknowledgeBatch(n,t.batch,t.streamToken).next(function(){if(e.shouldHoldBatchResult(t.commitVersion))return e.heldBatchResults.push(t),r=K(),Ln.resolve();var i=new Tr(e.remoteDocuments);return e.releaseBatchResults(n,[t],i).next(function(t){return r=t,i.apply(n)})}).next(function(){return e.mutationQueue.performConsistencyCheck(n)}).next(function(){return e.localDocuments.getDocuments(n,r)})})},t.prototype.rejectBatch=function(t){var e=this;return this.persistence.runTransaction("Reject batch",function(n){var r,i;return e.mutationQueue.lookupMutationBatch(n,t).next(function(i){return c(null!=i,"Attempt to reject nonexistent batch!"),r=i,e.mutationQueue.getHighestAcknowledgedBatchId(n).next(function(e){return c(t>e,"Acknowledged batches can't be rejected."),r})}).next(function(){return e.removeMutationBatch(n,r)}).next(function(t){return i=t,e.mutationQueue.performConsistencyCheck(n)}).next(function(){return e.localDocuments.getDocuments(n,i)})})},t.prototype.getLastStreamToken=function(){var t=this;return this.persistence.runTransaction("Get last stream token",function(e){return t.mutationQueue.getLastStreamToken(e)})},t.prototype.setLastStreamToken=function(t){var e=this;return this.persistence.runTransaction("Set last stream token",function(n){return e.mutationQueue.setLastStreamToken(n,t)})},t.prototype.getLastRemoteSnapshotVersion=function(){return this.queryCache.getLastRemoteSnapshotVersion()},t.prototype.applyRemoteEvent=function(t){var e=this,n=new Tr(this.remoteDocuments);return this.persistence.runTransaction("Apply remote event",function(r){var i=[];p(t.targetChanges,function(t,n){var o=e.targetIds[t];if(o){var a=n.mapping;if(a)if(a instanceof sn)i.push(e.queryCache.removeMatchingKeysForTargetId(r,t).next(function(){return e.queryCache.addMatchingKeys(r,a.documents,t)}));else{if(!(a instanceof un))return u("Unknown mapping type: "+JSON.stringify(a));i.push(e.queryCache.removeMatchingKeys(r,a.removedDocuments,t).next(function(){return e.queryCache.addMatchingKeys(r,a.addedDocuments,t)}))}var s=n.resumeToken;s.length>0&&(o=o.update({resumeToken:s,snapshotVersion:n.snapshotVersion}),e.targetIds[t]=o,i.push(e.queryCache.addQueryData(r,o)))}});var a=K();t.documentUpdates.forEach(function(t,s){a=a.add(t),i.push(n.getEntry(r,t).next(function(r){null==r||s.version.isEqual(Me.MIN)||s.version.compareTo(r.version)>=0?n.addEntry(s):o("LocalStore","Ignoring outdated watch update for ",t,". Current version:",r.version," Watch version:",s.version),e.garbageCollector.addPotentialGarbageKey(t)}))});var s,l=e.queryCache.getLastRemoteSnapshotVersion(),h=t.snapshotVersion;return h.isEqual(Me.MIN)||(c(h.compareTo(l)>=0,"Watch stream reverted to previous snapshot?? "+h+" < "+l),i.push(e.queryCache.setLastRemoteSnapshotVersion(r,h))),Ln.waitFor(i).next(function(){return e.releaseHeldBatchResults(r,n)}).next(function(t){return s=t,n.apply(r)}).next(function(){return e.localDocuments.getDocuments(r,a.unionWith(s))})})},t.prototype.notifyLocalViewChanges=function(t){var e=this;return this.persistence.runTransaction("Notify local view changes",function(n){for(var r=[],i=0,o=t;i<o.length;i++){!function(t){r.push(e.queryCache.getQueryData(n,t.query).next(function(n){c(null!==n,"Local view changes contain unallocated query.");var r=n.targetId;e.localViewReferences.addReferences(t.addedKeys,r),e.localViewReferences.removeReferences(t.removedKeys,r)}))}(o[i])}return Ln.waitFor(r)})},t.prototype.nextMutationBatch=function(t){var e=this;return this.persistence.runTransaction("Get next mutation batch",function(n){return void 0===t&&(t=Xn),e.mutationQueue.getNextMutationBatchAfterBatchId(n,t)})},t.prototype.readDocument=function(t){var e=this;return this.persistence.runTransaction("read document",function(n){return e.localDocuments.getDocument(n,t)})},t.prototype.allocateQuery=function(t){var e=this;return this.persistence.runTransaction("Allocate query",function(n){var r;return e.queryCache.getQueryData(n,t).next(function(i){if(i)return r=i,Ln.resolve();var o=e.targetIdGenerator.next();return r=new Fe(t,o,re.Listen),e.queryCache.addQueryData(n,r)}).next(function(){return c(!e.targetIds[r.targetId],"Tried to allocate an already allocated query: "+t),e.targetIds[r.targetId]=r,r})})},t.prototype.releaseQuery=function(t){var e=this;return this.persistence.runTransaction("Release query",function(n){return e.queryCache.getQueryData(n,t).next(function(r){return c(null!=r,"Tried to release nonexistent query: "+t),e.localViewReferences.removeReferencesForId(r.targetId),delete e.targetIds[r.targetId],e.garbageCollector.isEager?e.queryCache.removeQueryData(n,r):Ln.resolve()}).next(function(){if(v(e.targetIds)){var t=new Tr(e.remoteDocuments);return e.releaseHeldBatchResults(n,t).next(function(){t.apply(n)})}return Ln.resolve()})})},t.prototype.executeQuery=function(t){var e=this;return this.persistence.runTransaction("Execute query",function(n){return e.localDocuments.getDocumentsMatchingQuery(n,t)})},t.prototype.remoteDocumentKeys=function(t){var e=this;return this.persistence.runTransaction("Remote document keys",function(n){return e.queryCache.getMatchingKeysForTargetId(n,t)})},t.prototype.collectGarbage=function(){var t=this;return this.persistence.runTransaction("Garbage collection",function(e){return t.garbageCollector.collectGarbage(e).next(function(n){var r=[];return n.forEach(function(n){r.push(t.remoteDocuments.removeEntry(e,n))}),Ln.waitFor(r)})})},t.prototype.releaseHeldBatchResults=function(t,e){for(var n=[],r=0,i=this.heldBatchResults;r<i.length;r++){var o=i[r];if(!this.isRemoteUpToVersion(o.commitVersion))break;n.push(o)}return 0===n.length?Ln.resolve(K()):(this.heldBatchResults.splice(0,n.length),this.releaseBatchResults(t,n,e))},t.prototype.isRemoteUpToVersion=function(t){var e=this.queryCache.getLastRemoteSnapshotVersion();return t.compareTo(e)<=0||v(this.targetIds)},t.prototype.shouldHoldBatchResult=function(t){return!this.isRemoteUpToVersion(t)||this.heldBatchResults.length>0},t.prototype.releaseBatchResults=function(t,e,n){for(var r=this,i=Ln.resolve(),o=0,a=e;o<a.length;o++){!function(e){i=i.next(function(){return r.applyWriteToRemoteDocuments(t,e,n)})}(a[o])}return i.next(function(){return r.removeMutationBatches(t,e.map(function(t){return t.batch}))})},t.prototype.removeMutationBatch=function(t,e){return this.removeMutationBatches(t,[e])},t.prototype.removeMutationBatches=function(t,e){for(var n=K(),r=0,i=e;r<i.length;r++)for(var o=0,a=i[r].mutations;o<a.length;o++){var s=a[o].key;n=n.add(s)}return this.mutationQueue.removeMutationBatches(t,e).next(function(){return n})},t.prototype.applyWriteToRemoteDocuments=function(t,e,n){var r=e.batch,i=r.keys(),o=Ln.resolve();return i.forEach(function(i){o=o.next(function(){return n.getEntry(t,i)}).next(function(t){var o=t,a=e.docVersions.get(i);c(null!==a,"ackVersions should contain every doc in the write."),(!o||o.version.compareTo(a)<0)&&((o=r.applyToRemoteDocument(i,o,e))?n.addEntry(o):c(!t,"Mutation batch "+r+" applied to document "+t+" resulted in null"))})}),o},t}(),Ar=function(){function t(){this.mutationQueue=[],this.nextBatchId=1,this.highestAcknowledgedBatchId=Xn,this.lastStreamToken=l(),this.garbageCollector=null,this.batchesByDocumentKey=new $e(Bn.compareByKey)}return t.prototype.start=function(t){return 0===this.mutationQueue.length&&(this.nextBatchId=1,this.highestAcknowledgedBatchId=Xn),c(this.highestAcknowledgedBatchId<this.nextBatchId,"highestAcknowledgedBatchId must be less than the nextBatchId"),Ln.resolve()},t.prototype.checkEmpty=function(t){return Ln.resolve(0===this.mutationQueue.length)},t.prototype.getNextBatchId=function(t){return Ln.resolve(this.nextBatchId)},t.prototype.getHighestAcknowledgedBatchId=function(t){return Ln.resolve(this.highestAcknowledgedBatchId)},t.prototype.acknowledgeBatch=function(t,e,n){var r=e.batchId;c(r>this.highestAcknowledgedBatchId,"Mutation batchIDs must be acknowledged in order");var i=this.indexOfExistingBatchId(r,"acknowledged"),o=this.mutationQueue[i];return c(r===o.batchId,"Queue ordering failure: expected batch "+r+", got batch "+o.batchId),c(!o.isTombstone(),"Can't acknowledge a previously removed batch"),this.highestAcknowledgedBatchId=r,this.lastStreamToken=n,Ln.resolve()},t.prototype.getLastStreamToken=function(t){return Ln.resolve(this.lastStreamToken)},t.prototype.setLastStreamToken=function(t,e){return this.lastStreamToken=e,Ln.resolve()},t.prototype.addMutationBatch=function(t,e,n){c(0!==n.length,"Mutation batches should not be empty");var r=this.nextBatchId;this.nextBatchId++,this.mutationQueue.length>0&&c(this.mutationQueue[this.mutationQueue.length-1].batchId<r,"Mutation batchIDs must be monotonically increasing order");var i=new Yn(r,e,n);this.mutationQueue.push(i);for(var o=0,a=n;o<a.length;o++){var s=a[o];this.batchesByDocumentKey=this.batchesByDocumentKey.add(new Bn(s.key,r))}return Ln.resolve(i)},t.prototype.lookupMutationBatch=function(t,e){return Ln.resolve(this.findMutationBatch(e))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this.mutationQueue.length;e=Math.max(e+1,this.highestAcknowledgedBatchId);for(var r=this.indexOfBatchId(e),i=r<0?0:r;i<n;i++){var o=this.mutationQueue[i];if(!o.isTombstone())return Ln.resolve(o)}return Ln.resolve(null)},t.prototype.getAllMutationBatches=function(t){return Ln.resolve(this.getAllLiveMutationBatchesBeforeIndex(this.mutationQueue.length))},t.prototype.getAllMutationBatchesThroughBatchId=function(t,e){var n=this.mutationQueue.length,r=this.indexOfBatchId(e);return r<0?r=0:r>=n?r=n:r++,Ln.resolve(this.getAllLiveMutationBatchesBeforeIndex(r))},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new Bn(e,0),i=new Bn(e,Number.POSITIVE_INFINITY),o=[];return this.batchesByDocumentKey.forEachInRange([r,i],function(t){c(e.isEqual(t.key),"Should only iterate over a single key's batches");var r=n.findMutationBatch(t.targetOrBatchId);c(null!==r,"Batches in the index must exist in the main table"),o.push(r)}),Ln.resolve(o)},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this,r=e.path,i=r.length+1,o=r;zt.isDocumentKey(o)||(o=o.child(""));var a=new Bn(new zt(o),0),s=new $e(D);this.batchesByDocumentKey.forEachWhile(function(t){var e=t.key.path;return!!r.isPrefixOf(e)&&(e.length===i&&(s=s.add(t.targetOrBatchId)),!0)},a);var u=[];return s.forEach(function(t){var e=n.findMutationBatch(t);null!==e&&u.push(e)}),Ln.resolve(u)},t.prototype.removeMutationBatches=function(t,e){var n=e.length;c(n>0,"Should not remove mutations when none exist.");var r=e[0].batchId,i=this.mutationQueue.length,o=this.indexOfExistingBatchId(r,"removed");c(this.mutationQueue[o].batchId===r,"Removed batches must exist in the queue");for(var a=1,s=o+1;a<n&&s<i;){(d=this.mutationQueue[s]).isTombstone()?s++:(c(d.batchId===e[a].batchId,"Removed batches must be contiguous in the queue"),a++,s++)}if(0===o){for(;s<i;s++){if(!(d=this.mutationQueue[s]).isTombstone())break}var u=s-o;this.mutationQueue.splice(o,u)}else for(var l=o;l<s;l++)this.mutationQueue[l]=this.mutationQueue[l].toTombstone();for(var h=this.batchesByDocumentKey,f=0,p=e;f<p.length;f++)for(var d,v=(d=p[f]).batchId,g=0,y=d.mutations;g<y.length;g++){var m=y[g].key;null!==this.garbageCollector&&this.garbageCollector.addPotentialGarbageKey(m);var _=new Bn(m,v);h=h.delete(_)}return this.batchesByDocumentKey=h,Ln.resolve()},t.prototype.setGarbageCollector=function(t){this.garbageCollector=t},t.prototype.containsKey=function(t,e){var n=new Bn(e,0),r=this.batchesByDocumentKey.firstAfterOrEqual(n);return Ln.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return 0===this.mutationQueue.length&&c(this.batchesByDocumentKey.isEmpty(),"Document leak -- detected dangling mutation references when queue is empty."),Ln.resolve()},t.prototype.getAllLiveMutationBatchesBeforeIndex=function(t){for(var e=[],n=0;n<t;n++){var r=this.mutationQueue[n];r.isTombstone()||e.push(r)}return e},t.prototype.indexOfExistingBatchId=function(t,e){var n=this.indexOfBatchId(t);return c(n>=0&&n<this.mutationQueue.length,"Batches must exist to be "+e),n},t.prototype.indexOfBatchId=function(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId},t.prototype.findMutationBatch=function(t){var e=this.indexOfBatchId(t);if(e<0||e>=this.mutationQueue.length)return null;var n=this.mutationQueue[e];return c(n.batchId===t,"If found batch must match"),n.isTombstone()?null:n},t}(),Or=function(){function t(){this.queries=new Pn(function(t){return t.canonicalId()}),this.lastRemoteSnapshotVersion=Me.MIN,this.highestTargetId=0,this.references=new jn}return t.prototype.start=function(t){return Ln.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(){return this.lastRemoteSnapshotVersion},t.prototype.getHighestTargetId=function(){return this.highestTargetId},t.prototype.setLastRemoteSnapshotVersion=function(t,e){return this.lastRemoteSnapshotVersion=e,Ln.resolve()},t.prototype.addQueryData=function(t,e){this.queries.set(e.query,e);var n=e.targetId;return n>this.highestTargetId&&(this.highestTargetId=n),Ln.resolve()},t.prototype.removeQueryData=function(t,e){return this.queries.delete(e.query),this.references.removeReferencesForId(e.targetId),Ln.resolve()},t.prototype.getQueryData=function(t,e){var n=this.queries.get(e)||null;return Ln.resolve(n)},t.prototype.addMatchingKeys=function(t,e,n){return this.references.addReferences(e,n),Ln.resolve()},t.prototype.removeMatchingKeys=function(t,e,n){return this.references.removeReferences(e,n),Ln.resolve()},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this.references.removeReferencesForId(e),Ln.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this.references.referencesForId(e);return Ln.resolve(n)},t.prototype.setGarbageCollector=function(t){this.references.setGarbageCollector(t)},t.prototype.containsKey=function(t,e){return this.references.containsKey(t,e)},t}(),Cr=function(){function t(){this.docs=q()}return t.prototype.addEntry=function(t,e){return this.docs=this.docs.insert(e.key,e),Ln.resolve()},t.prototype.removeEntry=function(t,e){return this.docs=this.docs.remove(e),Ln.resolve()},t.prototype.getEntry=function(t,e){return Ln.resolve(this.docs.get(e))},t.prototype.getDocumentsMatchingQuery=function(t,e){for(var n=H(),r=new zt(e.path.child("")),i=this.docs.getIteratorFrom(r);i.hasNext();){var o=i.getNext(),a=o.key,s=o.value;if(!e.path.isPrefixOf(a.path))break;s instanceof Qt&&e.matches(s)&&(n=n.insert(s.key,s))}return Ln.resolve(n)},t}(),Rr=function(){function t(){this.mutationQueues={},this.remoteDocumentCache=new Cr,this.queryCache=new Or,this.started=!1}return t.prototype.start=function(){return c(!this.started,"MemoryPersistence double-started!"),this.started=!0,Promise.resolve()},t.prototype.shutdown=function(){return c(this.started,"MemoryPersistence shutdown without start!"),this.started=!1,Promise.resolve()},t.prototype.getMutationQueue=function(t){var e=this.mutationQueues[t.toKey()];return e||(e=new Ar,this.mutationQueues[t.toKey()]=e),e},t.prototype.getQueryCache=function(){return this.queryCache},t.prototype.getRemoteDocumentCache=function(){return this.remoteDocumentCache},t.prototype.runTransaction=function(t,e){return o("MemoryPersistence","Starting transaction:",t),e(new Nr).toPromise()},t}(),Nr=function(){return function(){}}(),kr=function(){function t(){this.isEager=!1}return t.prototype.addGarbageSource=function(t){},t.prototype.removeGarbageSource=function(t){},t.prototype.addPotentialGarbageKey=function(t){},t.prototype.collectGarbage=function(t){return Ln.resolve(K())},t}(),Pr=function(){return function(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}}(),Dr=function(){function t(t,e,n){this.initialDelayMs=t,this.backoffFactor=e,this.maxDelayMs=n,this.reset()}return t.prototype.reset=function(){this.currentBaseMs=0},t.prototype.resetToMax=function(){this.currentBaseMs=this.maxDelayMs},t.prototype.backoffAndWait=function(){var t=new Pr,e=this.currentBaseMs+this.jitterDelayMs();return this.currentBaseMs>0&&o("ExponentialBackoff","Backing off for "+e+" ms (base delay: "+this.currentBaseMs+" ms)"),setTimeout(function(){t.resolve()},e),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs),t.promise},t.prototype.jitterDelayMs=function(){return(Math.random()-.5)*this.currentBaseMs},t}(),xr=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();!function(t){t[t.Initial=0]="Initial",t[t.Auth=1]="Auth",t[t.Open=2]="Open",t[t.Error=3]="Error",t[t.Backoff=4]="Backoff",t[t.Stopped=5]="Stopped"}(Wn||(Wn={}));var Mr,Lr=1e3,Fr=6e4,Ur=1.5,jr=function(){function t(t,e,n,r){this.queue=t,this.connection=e,this.credentialsProvider=n,this.idle=!1,this.stream=null,this.listener=null,this.backoff=new Dr(r||Lr,Ur,Fr),this.state=Wn.Initial}return t.prototype.isStarted=function(){return this.state===Wn.Backoff||this.state===Wn.Auth||this.state===Wn.Open},t.prototype.isOpen=function(){return this.state===Wn.Open},t.prototype.start=function(t){this.state!==Wn.Error?(c(this.state===Wn.Initial,"Already started"),this.listener=t,this.auth()):this.performBackoff(t)},t.prototype.stop=function(){this.isStarted()&&this.close(Wn.Stopped)},t.prototype.inhibitBackoff=function(){c(!this.isStarted(),"Can only inhibit backoff in a stopped state"),this.state=Wn.Initial,this.backoff.reset()},t.prototype.markIdle=function(){var t=this;this.idle=!0,this.queue.schedule(function(){return t.handleIdleCloseTimer()},6e4).catch(function(t){c(t.code===Dt.CANCELLED,"Received unexpected error in idle timeout closure. Expected CANCELLED, but was: "+t)})},t.prototype.sendRequest=function(t){this.cancelIdleCheck(),this.stream.send(t)},t.prototype.handleIdleCloseTimer=function(){return this.isOpen()&&this.idle?this.close(Wn.Initial):Promise.resolve()},t.prototype.cancelIdleCheck=function(){this.idle=!1},t.prototype.close=function(t,e){c(t===Wn.Error||j(e),"Can't provide an error when not in an error state."),this.cancelIdleCheck(),t!==Wn.Error?this.backoff.reset():e&&e.code===Dt.RESOURCE_EXHAUSTED&&(a(e.toString()),a("Using maximum backoff delay to prevent overloading the backend."),this.backoff.resetToMax()),null!==this.stream&&(this.tearDown(),this.stream.close(),this.stream=null),this.state=t;var n=this.listener;return this.listener=null,t!==Wn.Stopped?n.onClose(e):Promise.resolve()},t.prototype.tearDown=function(){},t.prototype.auth=function(){var t=this;c(this.state===Wn.Initial,"Must be in initial state to auth"),this.state=Wn.Auth,this.credentialsProvider.getToken(!1).then(function(e){t.startStream(e)},function(e){t.queue.schedule(function(){if(t.state!==Wn.Stopped){var n=new xt(Dt.UNKNOWN,"Fetching auth token failed: "+e.message);return t.handleStreamClose(n)}return Promise.resolve()})})},t.prototype.startStream=function(t){var e=this;if(this.state!==Wn.Stopped){c(this.state===Wn.Auth,"Trying to start stream in a non-auth state");var n=function(t,n){e.queue.schedule(function(){return e.stream===t?n():Promise.resolve()})};if(null!==this.listener){var r=this.startRpc(t);this.stream=r,this.stream.onOpen(function(){n(r,function(){return c(e.state===Wn.Auth,"Expected stream to be in state auth, but was "+e.state),e.state=Wn.Open,e.listener.onOpen()})}),this.stream.onClose(function(t){n(r,function(){return e.handleStreamClose(t)})}),this.stream.onMessage(function(t){n(r,function(){return e.onMessage(t)})})}}},t.prototype.performBackoff=function(t){var e=this;c(this.state===Wn.Error,"Should only perform backoff in an error case"),this.state=Wn.Backoff,this.backoff.backoffAndWait().then(function(){e.queue.schedule(function(){return e.state===Wn.Stopped?Promise.resolve():(e.state=Wn.Initial,e.start(t),c(e.isStarted(),"PersistentStream should have started"),Promise.resolve())})})},t.prototype.handleStreamClose=function(t){return c(this.isStarted(),"Can't handle server close on non-started stream"),o("PersistentStream","close with error: "+t),this.stream=null,this.close(Wn.Error,t)},t}(),Br=function(t){function e(e,n,r,i,o,a){var s=t.call(this,n,r,i,a)||this;return s.databaseInfo=e,s.serializer=o,s}return xr(e,t),e.prototype.startRpc=function(t){return this.connection.openStream("Listen",t)},e.prototype.onMessage=function(t){this.backoff.reset();var e=this.serializer.fromWatchChange(t),n=this.serializer.versionFromListenResponse(t);return this.listener.onWatchChange(e,n)},e.prototype.watch=function(t){var e={};e.database=this.serializer.encodedDatabaseId,e.addTarget=this.serializer.toTarget(t);var n=this.serializer.toListenRequestLabels(t);n&&(e.labels=n),this.sendRequest(e)},e.prototype.unwatch=function(t){var e={};e.database=this.serializer.encodedDatabaseId,e.removeTarget=t,this.sendRequest(e)},e}(jr),Vr=function(t){function e(e,n,r,i,o,a){var s=t.call(this,n,r,i,a)||this;return s.databaseInfo=e,s.serializer=o,s.handshakeComplete_=!1,s}return xr(e,t),Object.defineProperty(e.prototype,"handshakeComplete",{get:function(){return this.handshakeComplete_},enumerable:!0,configurable:!0}),e.prototype.start=function(e){this.handshakeComplete_=!1,t.prototype.start.call(this,e)},e.prototype.tearDown=function(){this.handshakeComplete_&&this.writeMutations([])},e.prototype.startRpc=function(t){return this.connection.openStream("Write",t)},e.prototype.onMessage=function(t){if(c(!!t.streamToken,"Got a write response without a stream token"),this.lastStreamToken=t.streamToken,this.handshakeComplete_){this.backoff.reset();var e=this.serializer.fromWriteResults(t.writeResults),n=this.serializer.fromVersion(t.commitTime);return this.listener.onMutationResult(n,e)}return c(!t.writeResults||0===t.writeResults.length,"Got mutation results for handshake"),this.handshakeComplete_=!0,this.listener.onHandshakeComplete()},e.prototype.writeHandshake=function(){c(this.isOpen(),"Writing handshake requires an opened stream"),c(!this.handshakeComplete_,"Handshake already completed");var t={};t.database=this.serializer.encodedDatabaseId,this.sendRequest(t)},e.prototype.writeMutations=function(t){var e=this;c(this.isOpen(),"Writing mutations requires an opened stream"),c(this.handshakeComplete_,"Handshake must be complete before writing mutations"),c(this.lastStreamToken.length>0,"Trying to write mutation without a token");var n={streamToken:this.lastStreamToken,writes:t.map(function(t){return e.serializer.toMutation(t)})};this.sendRequest(n)},e}(jr),Wr=function(){function t(t,e,n,r,i,o){this.databaseInfo=t,this.queue=e,this.connection=n,this.credentials=r,this.serializer=i,this.initialBackoffDelay=o}return t.prototype.newPersistentWriteStream=function(){return new Vr(this.databaseInfo,this.queue,this.connection,this.credentials,this.serializer,this.initialBackoffDelay)},t.prototype.newPersistentWatchStream=function(){return new Br(this.databaseInfo,this.queue,this.connection,this.credentials,this.serializer,this.initialBackoffDelay)},t.prototype.commit=function(t){var e=this,n={database:this.serializer.encodedDatabaseId,writes:t.map(function(t){return e.serializer.toMutation(t)})};return this.invokeRPC("Commit",n).then(function(t){return e.serializer.fromWriteResults(t.writeResults)})},t.prototype.lookup=function(t){var e=this,n={database:this.serializer.encodedDatabaseId,documents:t.map(function(t){return e.serializer.toName(t)})};return this.invokeStreamingRPC("BatchGetDocuments",n).then(function(n){var r=q();n.forEach(function(t){var n=e.serializer.fromMaybeDocument(t);r=r.insert(n.key,n)});var i=[];return t.forEach(function(t){var e=r.get(t);c(!!e,"Missing entity in write response for "+t),i.push(e)}),i})},t.prototype.invokeRPC=function(t,e){var n=this;return this.credentials.getToken(!1).then(function(r){return n.connection.invokeRPC(t,e,r)})},t.prototype.invokeStreamingRPC=function(t,e){var n=this;return this.credentials.getToken(!1).then(function(r){return n.connection.invokeStreamingRPC(t,e,r)})},t}(),qr=function(){function t(t){this.datastore=t,this.readVersions=G(),this.mutations=[],this.committed=!1}return t.prototype.recordVersion=function(t){var e=t.version;t instanceof Xt&&(e=Me.forDeletedDoc());var n=this.readVersions.get(t.key);if(null!==n){if(!e.isEqual(n))throw new xt(Dt.ABORTED,"Document version changed between two reads.")}else this.readVersions=this.readVersions.insert(t.key,e)},t.prototype.lookup=function(t){var e=this;return this.committed?Promise.reject("Transaction has already completed."):this.mutations.length>0?Promise.reject("Transactions lookups are invalid after writes."):this.datastore.lookup(t).then(function(t){return t.forEach(function(t){return e.recordVersion(t)}),t})},t.prototype.write=function(t){if(this.committed)throw new xt(Dt.FAILED_PRECONDITION,"Transaction has already completed.");this.mutations=this.mutations.concat(t)},t.prototype.precondition=function(t){var e=this.readVersions.get(t);return e?He.updateTime(e):He.NONE},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t);if(e&&e.isEqual(Me.forDeletedDoc()))throw new xt(Dt.FAILED_PRECONDITION,"Can't update a document that doesn't exist.");return e?He.updateTime(e):He.exists(!0)},t.prototype.set=function(t,e){this.write(e.toMutations(t,this.precondition(t)))},t.prototype.update=function(t,e){this.write(e.toMutations(t,this.preconditionForUpdate(t)))},t.prototype.delete=function(t){this.write([new Xe(t,this.precondition(t))]),this.readVersions=this.readVersions.insert(t,Me.forDeletedDoc())},t.prototype.commit=function(){var t=this,e=this.readVersions;return this.mutations.forEach(function(t){e=e.remove(t.key)}),e.isEmpty()?this.datastore.commit(this.mutations).then(function(){t.committed=!0}):Promise.reject(Error("Every document read in a transaction must also be written."))},t}(),Hr=function(){function t(t,e,n){this.localStore=t,this.datastore=e,this.onlineStateHandler=n,this.pendingWrites=[],this.lastBatchSeen=Xn,this.listenTargets={},this.pendingTargetResponses={},this.accumulatedWatchChanges=[],this.watchStream=null,this.writeStream=null,this.watchStreamOnlineState=Sn.Unknown,this.watchStreamFailures=0,this.shouldWarnOffline=!0}return t.prototype.start=function(){return this.enableNetwork()},t.prototype.updateOnlineState=function(t){t!==this.watchStreamOnlineState&&(t===Sn.Healthy?this.shouldWarnOffline=!1:t===Sn.Unknown&&(this.watchStreamFailures=0),this.watchStreamOnlineState=t,this.onlineStateHandler(t))},t.prototype.updateOnlineStateAfterFailure=function(){this.watchStreamOnlineState===Sn.Healthy?this.updateOnlineState(Sn.Unknown):++this.watchStreamFailures>=2&&(this.shouldWarnOffline&&(a("Could not reach Firestore backend."),this.shouldWarnOffline=!1),this.updateOnlineState(Sn.Failed))},t.prototype.isNetworkEnabled=function(){return c(null==this.watchStream==(null==this.writeStream),"WatchStream and WriteStream should both be null or non-null"),null!=this.watchStream},t.prototype.enableNetwork=function(){var t=this;return this.isNetworkEnabled()?Promise.resolve():(this.watchStream=this.datastore.newPersistentWatchStream(),this.writeStream=this.datastore.newPersistentWriteStream(),this.localStore.getLastStreamToken().then(function(e){return t.writeStream.lastStreamToken=e,t.shouldStartWatchStream()&&t.startWatchStream(),t.updateOnlineState(Sn.Unknown),t.fillWritePipeline()}))},t.prototype.disableNetwork=function(){return this.disableNetworkInternal(),this.updateOnlineState(Sn.Failed),Promise.resolve()},t.prototype.disableNetworkInternal=function(){this.isNetworkEnabled()&&(this.watchStream.stop(),this.writeStream.stop(),this.cleanUpWatchStreamState(),this.cleanUpWriteStreamState(),this.writeStream=null,this.watchStream=null)},t.prototype.shutdown=function(){return o("RemoteStore","RemoteStore shutting down."),this.disableNetworkInternal(),this.updateOnlineState(Sn.Unknown),Promise.resolve()},t.prototype.listen=function(t){c(!f(this.listenTargets,t.targetId),"listen called with duplicate targetId!"),this.listenTargets[t.targetId]=t,this.shouldStartWatchStream()?this.startWatchStream():this.isNetworkEnabled()&&this.watchStream.isOpen()&&this.sendWatchRequest(t)},t.prototype.unlisten=function(t){c(f(this.listenTargets,t),"unlisten called without assigned target ID!"),this.listenTargets[t],delete this.listenTargets[t],this.isNetworkEnabled()&&this.watchStream.isOpen()&&(this.sendUnwatchRequest(t),v(this.listenTargets)&&this.watchStream.markIdle())},t.prototype.sendWatchRequest=function(t){this.recordPendingTargetRequest(t.targetId),this.watchStream.watch(t)},t.prototype.sendUnwatchRequest=function(t){this.recordPendingTargetRequest(t),this.watchStream.unwatch(t)},t.prototype.recordPendingTargetRequest=function(t){this.pendingTargetResponses[t]=(this.pendingTargetResponses[t]||0)+1},t.prototype.startWatchStream=function(){c(this.shouldStartWatchStream(),"startWriteStream() called when shouldStartWatchStream() is false."),this.watchStream.start({onOpen:this.onWatchStreamOpen.bind(this),onClose:this.onWatchStreamClose.bind(this),onWatchChange:this.onWatchStreamChange.bind(this)})},t.prototype.shouldStartWatchStream=function(){return this.isNetworkEnabled()&&!this.watchStream.isStarted()&&!v(this.listenTargets)},t.prototype.cleanUpWatchStreamState=function(){this.accumulatedWatchChanges=[],this.pendingTargetResponses={}},t.prototype.onWatchStreamOpen=function(){var t=this;return p(this.listenTargets,function(e,n){t.sendWatchRequest(n)}),Promise.resolve()},t.prototype.onWatchStreamClose=function(t){return c(this.isNetworkEnabled(),"onWatchStreamClose() should only be called when the network is enabled"),this.cleanUpWatchStreamState(),this.shouldStartWatchStream()?(this.updateOnlineStateAfterFailure(),this.startWatchStream()):this.updateOnlineState(Sn.Unknown),Promise.resolve()},t.prototype.onWatchStreamChange=function(t,e){if(this.updateOnlineState(Sn.Healthy),t instanceof hn&&t.state===on.Removed&&t.cause)return this.handleTargetError(t);if(this.accumulatedWatchChanges.push(t),!e.isEqual(Me.MIN)&&e.compareTo(this.localStore.getLastRemoteSnapshotVersion())>=0){var n=this.accumulatedWatchChanges;return this.accumulatedWatchChanges=[],this.handleWatchChangeBatch(e,n)}return Promise.resolve()},t.prototype.handleWatchChangeBatch=function(t,e){var n=this,r=new fn(t,this.listenTargets,this.pendingTargetResponses);r.addChanges(e);var i=r.createRemoteEvent();this.pendingTargetResponses=r.pendingTargetResponses;var o=[];return p(r.existenceFilters,function(e,r){var a=n.listenTargets[e];if(a){var s=a.query;if(s.isDocumentQuery())if(0===r.count){var u=new zt(s.path),l=new Xt(u,t);i.addDocumentUpdate(l)}else c(1===r.count,"Single document existence filter with count: "+r.count);else{var h=n.localStore.remoteDocumentKeys(e).then(function(t){if(i.targetChanges[e]){var o=i.targetChanges[e].mapping;null!==o&&(o instanceof un?t=o.applyToKeySet(t):(c(o instanceof sn,"Expected either reset or update mapping but got something else: "+o),t=o.documents))}if(t.size!==r.count){i.handleExistenceFilterMismatch(e);var u=new Fe(s,e,a.purpose);n.listenTargets[e]=u,n.sendUnwatchRequest(e);var l=new Fe(s,e,re.ExistenceFilterMismatch);n.sendWatchRequest(l)}});o.push(h)}}}),Promise.all(o).then(function(){return p(i.targetChanges,function(t,e){if(e.resumeToken.length>0){var r=n.listenTargets[t];r&&(n.listenTargets[t]=r.update({resumeToken:e.resumeToken,snapshotVersion:e.snapshotVersion}))}}),n.syncEngine.applyRemoteEvent(i)})},t.prototype.handleTargetError=function(t){var e=this;c(!!t.cause,"Handling target error without a cause");var n=t.cause,r=Promise.resolve();return t.targetIds.forEach(function(t){r=r.then(function(){return f(e.listenTargets,t)?(delete e.listenTargets[t],e.syncEngine.rejectListen(t,n)):Promise.resolve()})}),r},t.prototype.cleanUpWriteStreamState=function(){this.lastBatchSeen=Xn,o("RemoteStore","Stopping write stream with "+this.pendingWrites.length+" pending writes"),this.pendingWrites=[]},t.prototype.fillWritePipeline=function(){var t=this;return this.canWriteMutations()?this.localStore.nextMutationBatch(this.lastBatchSeen).then(function(e){return null===e?(0===t.pendingWrites.length&&t.writeStream.markIdle(),Promise.resolve()):(t.commit(e),t.fillWritePipeline())}):Promise.resolve()},t.prototype.canWriteMutations=function(){return this.isNetworkEnabled()&&this.pendingWrites.length<10},t.prototype.outstandingWrites=function(){return this.pendingWrites.length},t.prototype.commit=function(t){c(this.canWriteMutations(),"commit called when batches can't be written"),this.lastBatchSeen=t.batchId,this.pendingWrites.push(t),this.shouldStartWriteStream()?this.startWriteStream():this.isNetworkEnabled()&&this.writeStream.handshakeComplete&&this.writeStream.writeMutations(t.mutations)},t.prototype.shouldStartWriteStream=function(){return this.isNetworkEnabled()&&!this.writeStream.isStarted()&&this.pendingWrites.length>0},t.prototype.startWriteStream=function(){c(this.shouldStartWriteStream(),"startWriteStream() called when shouldStartWriteStream() is false."),this.writeStream.start({onOpen:this.onWriteStreamOpen.bind(this),onClose:this.onWriteStreamClose.bind(this),onHandshakeComplete:this.onWriteHandshakeComplete.bind(this),onMutationResult:this.onMutationResult.bind(this)})},t.prototype.onWriteStreamOpen=function(){return this.writeStream.writeHandshake(),Promise.resolve()},t.prototype.onWriteHandshakeComplete=function(){var t=this;return this.localStore.setLastStreamToken(this.writeStream.lastStreamToken).then(function(){for(var e=0,n=t.pendingWrites;e<n.length;e++){var r=n[e];t.writeStream.writeMutations(r.mutations)}})},t.prototype.onMutationResult=function(t,e){var n=this;c(this.pendingWrites.length>0,"Got result for empty pending writes");var r=this.pendingWrites.shift(),i=Jn.from(r,t,e,this.writeStream.lastStreamToken);return this.syncEngine.applySuccessfulWrite(i).then(function(){return n.fillWritePipeline()})},t.prototype.onWriteStreamClose=function(t){var e=this;if(c(this.isNetworkEnabled(),"onWriteStreamClose() should only be called when the network is enabled"),t&&this.pendingWrites.length>0){c(!!t,"We have pending writes, but the write stream closed without an error");return(this.writeStream.handshakeComplete?this.handleWriteError(t):this.handleHandshakeError(t)).then(function(){e.shouldStartWriteStream()&&e.startWriteStream()})}return Promise.resolve()},t.prototype.handleHandshakeError=function(t){return B(t.code)||t.code===Dt.ABORTED?(o("RemoteStore","RemoteStore error before completed handshake; resetting stream token: ",this.writeStream.lastStreamToken),this.writeStream.lastStreamToken=l(),this.localStore.setLastStreamToken(l())):Promise.resolve()},t.prototype.handleWriteError=function(t){var e=this;if(B(t.code)){var n=this.pendingWrites.shift();return this.writeStream.inhibitBackoff(),this.syncEngine.rejectFailedWrite(n.batchId,t).then(function(){return e.fillWritePipeline()})}return Promise.resolve()},t.prototype.createTransaction=function(){return new qr(this.datastore)},t.prototype.handleUserChange=function(t){if(o("RemoteStore","RemoteStore changing users: uid=",t.uid),this.isNetworkEnabled())return this.disableNetworkInternal(),this.updateOnlineState(Sn.Unknown),this.enableNetwork()},t}(),Gr=function(){function t(t,e,n,r){this.platform=t,this.databaseInfo=e,this.credentials=n,this.asyncQueue=r}return t.prototype.start=function(t){var e=this,n=new Pr,r=new Pr,i=!1;return this.credentials.setUserChangeListener(function(o){i?e.asyncQueue.schedule(function(){return e.handleUserChange(o)}):(i=!0,e.initializePersistence(t,r).then(function(){return e.initializeRest(o)}).then(n.resolve,n.reject))}),this.asyncQueue.schedule(function(){return n.promise}),r.promise},t.prototype.enableNetwork=function(){var t=this;return this.asyncQueue.schedule(function(){return t.remoteStore.enableNetwork()})},t.prototype.initializePersistence=function(t,e){var n=this;return t?this.startIndexedDbPersistence().then(e.resolve).catch(function(t){return e.reject(t),n.canFallback(t)?(console.warn("Error enabling offline storage. Falling back to storage disabled: "+t),n.startMemoryPersistence()):Promise.reject(t)}):(e.resolve(),this.startMemoryPersistence())},t.prototype.canFallback=function(t){return t.code===Dt.FAILED_PRECONDITION||t.code===Dt.UNIMPLEMENTED},t.prototype.startIndexedDbPersistence=function(){this.garbageCollector=new kr;var t=wr.buildStoragePrefix(this.databaseInfo),e=new vn(this.databaseInfo.databaseId,{useProto3Json:!0});return this.persistence=new wr(t,e),this.persistence.start()},t.prototype.startMemoryPersistence=function(){return this.garbageCollector=new Fn,this.persistence=new Rr,this.persistence.start()},t.prototype.initializeRest=function(t){var e=this;return this.platform.loadConnection(this.databaseInfo).then(function(n){e.localStore=new Ir(e.persistence,t,e.garbageCollector);var r=e.platform.newSerializer(e.databaseInfo.databaseId),i=new Wr(e.databaseInfo,e.asyncQueue,n,e.credentials,r);return e.remoteStore=new Hr(e.localStore,i,function(t){e.syncEngine.applyOnlineStateChange(t),e.eventMgr.applyOnlineStateChange(t)}),e.syncEngine=new Qn(e.localStore,e.remoteStore,t),e.remoteStore.syncEngine=e.syncEngine,e.eventMgr=new xn(e.syncEngine),e.localStore.start()}).then(function(){return e.remoteStore.start()})},t.prototype.handleUserChange=function(t){return this.asyncQueue.verifyOperationInProgress(),o("FirestoreClient","User Changed: "+t.uid),this.syncEngine.handleUserChange(t)},t.prototype.disableNetwork=function(){var t=this;return this.asyncQueue.schedule(function(){return t.remoteStore.disableNetwork()})},t.prototype.shutdown=function(){var t=this;return this.asyncQueue.schedule(function(){return t.credentials.removeUserChangeListener(),t.remoteStore.shutdown()}).then(function(){return t.persistence.shutdown()})},t.prototype.listen=function(t,e,n){var r=this,i=new Mn(t,e,n);return this.asyncQueue.schedule(function(){return r.eventMgr.listen(i)}),i},t.prototype.unlisten=function(t){var e=this;this.asyncQueue.schedule(function(){return e.eventMgr.unlisten(t)})},t.prototype.write=function(t){var e=this,n=new Pr;return this.asyncQueue.schedule(function(){return e.syncEngine.write(t,n)}),n.promise},t.prototype.databaseId=function(){return this.databaseInfo.databaseId},t.prototype.transaction=function(t){var e=this;return this.asyncQueue.schedule(function(){return Promise.resolve()}).then(function(){return e.syncEngine.runTransaction(t)})},t}(),Kr=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.scheduleEvent(this.observer.next,t)},t.prototype.error=function(t){this.scheduleEvent(this.observer.error,t)},t.prototype.mute=function(){this.muted=!0},t.prototype.scheduleEvent=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},t}(),zr=function(){function t(){this.tail=Promise.resolve(),this.delayedOperations=[],this.delayedOperationsCount=0,this.operationInProgress=!1}return t.prototype.schedule=function(t,e){var n=this;if(this.failure&&u("AsyncQueue is already failed: "+(this.failure.stack||this.failure.message)),(e||0)>0){this.delayedOperationsCount++;var r={handle:null,op:t,deferred:new Pr};return r.handle=setTimeout(function(){n.scheduleInternal(function(){return r.op().then(function(t){r.deferred.resolve(t)})}),r.handle=null,0==--n.delayedOperationsCount&&(n.delayedOperations=[])},e),this.delayedOperations.push(r),r.deferred.promise}return this.scheduleInternal(t)},t.prototype.scheduleInternal=function(t){var e=this;return this.tail=this.tail.then(function(){return e.operationInProgress=!0,t().catch(function(t){e.failure=t,e.operationInProgress=!1;var n=t.stack||t.message||"";throw a("INTERNAL UNHANDLED ERROR: ",n),n.indexOf("Firestore Test Simulated Error")<0&&setTimeout(function(){throw t},0),t}).then(function(){e.operationInProgress=!1})}),this.tail},t.prototype.verifyOperationInProgress=function(){c(this.operationInProgress,"verifyOpInProgress() called when no op in progress on this queue.")},t.prototype.drain=function(t){var e=this;return this.delayedOperations.forEach(function(n){n.handle&&(clearTimeout(n.handle),t?e.scheduleInternal(n.op).then(n.deferred.resolve,n.deferred.reject):n.deferred.reject(new xt(Dt.CANCELLED,"Operation cancelled by shutdown")))}),this.delayedOperations=[],this.delayedOperationsCount=0,this.schedule(function(){return Promise.resolve()})},t}(),Qr=function(){function t(t){this.uid=t}return t.prototype.isUnauthenticated=function(){return null==this.uid},t.prototype.toKey=function(){return this.isUnauthenticated()?"anonymous-user":"uid:"+this.uid},t.prototype.isEqual=function(t){return t.uid===this.uid},t.UNAUTHENTICATED=new t(null),t.GOOGLE_CREDENTIALS=new t("google-credentials-uid"),t.FIRST_PARTY=new t("first-party-uid"),t}(),Xr=function(){return function(t,e){this.user=e,this.type="OAuth",this.authHeaders={Authorization:"Bearer "+t}}}(),Yr=function(){function t(){this.userListener=null}return t.prototype.getToken=function(t){return Promise.resolve(null)},t.prototype.setUserChangeListener=function(t){c(!this.userListener,"Can only call setUserChangeListener() once."),this.userListener=t,t(Qr.UNAUTHENTICATED)},t.prototype.removeUserChangeListener=function(){c(null!==this.userListener,"removeUserChangeListener() when no listener registered"),this.userListener=null},t}(),Jr=function(){function t(t){var e=this;this.app=t,this.tokenListener=null,this.userCounter=0,this.userListener=null,this.tokenListener=function(){var t=e.getUser();e.currentUser&&t.isEqual(e.currentUser)||(e.currentUser=t,e.userCounter++,e.userListener&&e.userListener(e.currentUser))},this.userCounter=0,this.app.INTERNAL.addAuthTokenListener(this.tokenListener)}return t.prototype.getToken=function(t){var e=this;c(null!=this.tokenListener,"getToken cannot be called after listener removed.");var n=this.userCounter;return this.app.INTERNAL.getToken(t).then(function(t){if(e.userCounter!==n)throw new xt(Dt.ABORTED,"getToken aborted due to uid change.");return t?(c("string"==typeof t.accessToken,"Invalid tokenData returned from getToken():"+t),new Xr(t.accessToken,e.currentUser)):null})},t.prototype.setUserChangeListener=function(t){c(!this.userListener,"Can only call setUserChangeListener() once."),this.userListener=t,this.currentUser&&t(this.currentUser)},t.prototype.removeUserChangeListener=function(){c(null!=this.tokenListener,"removeUserChangeListener() called twice"),c(null!==this.userListener,"removeUserChangeListener() called when no listener registered"),this.app.INTERNAL.removeAuthTokenListener(this.tokenListener),this.tokenListener=null,this.userListener=null},t.prototype.getUser=function(){"function"!=typeof this.app.INTERNAL.getUid&&u("This version of the Firestore SDK requires at least version 3.7.0 of firebase.js.");var t=this.app.INTERNAL.getUid();return c(null===t||"string"==typeof t,"Received invalid UID: "+t),new Qr(t)},t}(),$r=function(){function t(t,e){this.gapi=t,this.sessionIndex=e,this.type="FirstParty",this.user=Qr.FIRST_PARTY,c(this.gapi&&this.gapi.auth&&this.gapi.auth.getAuthHeaderValueForFirstParty,"unexpected gapi interface")}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){return{Authorization:this.gapi.auth.getAuthHeaderValueForFirstParty([]),"X-Goog-AuthUser":this.sessionIndex}},enumerable:!0,configurable:!0}),t}(),Zr=function(){function t(t,e){this.gapi=t,this.sessionIndex=e,c(this.gapi&&this.gapi.auth&&this.gapi.auth.getAuthHeaderValueForFirstParty,"unexpected gapi interface")}return t.prototype.getToken=function(t){return Promise.resolve(new $r(this.gapi,this.sessionIndex))},t.prototype.setUserChangeListener=function(t){t(Qr.FIRST_PARTY)},t.prototype.removeUserChangeListener=function(){},t}(),ti=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ei=function(){function t(){}return t.delete=function(){return ni.instance},t.serverTimestamp=function(){return ri.instance},t.prototype.isEqual=function(t){return this===t},t}(),ni=function(t){function e(){return t.call(this)||this}return ti(e,t),e.instance=new e,e}(ei),ri=function(t){function e(){return t.call(this)||this}return ti(e,t),e.instance=new e,e}(ei),ii=h(ei,"Use FieldValue.<field>() instead."),oi=/^__.*__$/,ai=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutations=function(t,e){var n=[];return null!==this.fieldMask?n.push(new ze(t,this.data,this.fieldMask,e)):n.push(new Ke(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new Qe(t,this.fieldTransforms)),n},t}(),si=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutations=function(t,e){var n=[new ze(t,this.data,this.fieldMask,e)];return this.fieldTransforms.length>0&&n.push(new Qe(t,this.fieldTransforms)),n},t}();!function(t){t[t.Set=0]="Set",t[t.Update=1]="Update",t[t.MergeSet=2]="MergeSet",t[t.QueryValue=3]="QueryValue"}(Mr||(Mr={}));var ui=function(){function t(t,e,n,r,i,o){this.dataSource=t,this.methodName=e,this.path=n,this.arrayElement=r,void 0===i&&this.validatePath(),this.arrayElement=void 0!==r&&r,this.fieldTransforms=i||[],this.fieldMask=o||[]}return t.prototype.childContextForField=function(e){var n=null==this.path?null:this.path.child(e),r=new t(this.dataSource,this.methodName,n,!1,this.fieldTransforms,this.fieldMask);return r.validatePathSegment(e),r},t.prototype.childContextForFieldPath=function(e){var n=null==this.path?null:this.path.child(e),r=new t(this.dataSource,this.methodName,n,!1,this.fieldTransforms,this.fieldMask);return r.validatePath(),r},t.prototype.childContextForArray=function(e){return new t(this.dataSource,this.methodName,null,!0,this.fieldTransforms,this.fieldMask)},t.prototype.createError=function(t){var e=null===this.path||this.path.isEmpty()?"":" (found in field "+this.path.toString()+")";return new xt(Dt.INVALID_ARGUMENT,"Function "+this.methodName+"() called with invalid data. "+t+e)},t.prototype.validatePath=function(){if(null!==this.path)for(var t=0;t<this.path.length;t++)this.validatePathSegment(this.path.get(t))},t.prototype.validatePathSegment=function(t){if(gt(this.dataSource)&&oi.test(t))throw this.createError("Document fields cannot begin and end with __")},t.prototype.isWrite=function(){return this.dataSource===Mr.Set||this.dataSource===Mr.Update},t}(),ci=function(){return function(t,e){this.databaseId=t,this.key=e}}(),li=function(){function t(t){this.preConverter=t}return t.prototype.parseSetData=function(t,e){var n=new ui(Mr.Set,t,Kt.EMPTY_PATH);mt("Data must be an object, but it was:",n,e);var r=this.parseData(e,n);return new ai(r,null,n.fieldTransforms)},t.prototype.parseMergeData=function(t,e){var n=new ui(Mr.MergeSet,t,Kt.EMPTY_PATH);mt("Data must be an object, but it was:",n,e);var r=this.parseData(e,n),i=new je(n.fieldMask);return new ai(r,i,n.fieldTransforms)},t.prototype.parseUpdateData=function(t,e){var n=this,r=new ui(Mr.Update,t,Kt.EMPTY_PATH);mt("Data must be an object, but it was:",r,e);var i=[],o=ye.EMPTY;d(e,function(e,a){var s=bt(t,e),u=r.childContextForFieldPath(s);if((a=n.runPreConverter(a,u))instanceof ni)i.push(s);else{var c=n.parseData(a,u);null!=c&&(i.push(s),o=o.set(s,c))}});var a=new je(i);return new si(o,a,r.fieldTransforms)},t.prototype.parseUpdateVarargs=function(t,e,n,r){var i=new ui(Mr.Update,t,Kt.EMPTY_PATH),o=[_t(t,e)],a=[n];if(r.length%2!=0)throw new xt(Dt.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var s=0;s<r.length;s+=2)o.push(_t(t,r[s])),a.push(r[s+1]);var u=[],c=ye.EMPTY;for(s=0;s<o.length;++s){var l=o[s],h=i.childContextForFieldPath(l),f=this.runPreConverter(a[s],h);if(f instanceof ni)u.push(l);else{var p=this.parseData(f,h);null!=p&&(u.push(l),c=c.set(l,p))}}var d=new je(u);return new si(c,d,i.fieldTransforms)},t.prototype.parseQueryValue=function(t,e){var n=new ui(Mr.QueryValue,t,Kt.EMPTY_PATH),r=this.parseData(e,n);return c(null!=r,"Parsed data should not be null."),c(0===n.fieldTransforms.length,"Field transforms should have been disallowed."),r},t.prototype.runPreConverter=function(t,e){try{return this.preConverter(t)}catch(t){var n=Et(t);throw e.createError(n)}},t.prototype.parseData=function(t,e){if((t=this.runPreConverter(t,e))instanceof Array){if(e.arrayElement)throw e.createError("Nested arrays are not supported");return e.path&&e.fieldMask.push(e.path),this.parseArray(t,e)}return yt(t)?(mt("Unsupported field value:",e,t),this.parseObject(t,e)):(e.path&&e.fieldMask.push(e.path),this.parseScalarValue(t,e))},t.prototype.parseArray=function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var a=o[i],s=this.parseData(a,e.childContextForArray(r));null==s&&(s=ae.INSTANCE),n.push(s),r++}return new me(n)},t.prototype.parseObject=function(t,e){var n=this,r=new Yt(D);return d(t,function(t,i){var o=n.parseData(i,e.childContextForField(t));null!=o&&(r=r.insert(t,o))}),new ye(r)},t.prototype.parseScalarValue=function(t,e){if(null===t)return ae.INSTANCE;if("number"==typeof t)return function(t){return we(t)&&t<=Ee&&t>=be}(t)?new ce(t):new le(t);if("boolean"==typeof t)return se.of(t);if("string"==typeof t)return new he(t);if(t instanceof Date)return new fe(xe.fromDate(t));if(t instanceof Ut)return new ge(t);if(t instanceof Lt)return new de(t);if(t instanceof ci)return new ve(t.databaseId,t.key);if(t instanceof ei){if(t instanceof ni){if(e.dataSource===Mr.MergeSet)return null;throw e.dataSource===Mr.Update?(c(null==e.path||e.path.length>0,"FieldValue.delete() at the top level should have already been handled."),e.createError("FieldValue.delete() can only appear at the top level of your update data")):e.createError("FieldValue.delete() can only be used with update() and set() with {merge:true}")}if(t instanceof ri){if(!gt(e.dataSource))throw e.createError("FieldValue.serverTimestamp() can only be used with set() and update()");if(null===e.path)throw e.createError("FieldValue.serverTimestamp() is not currently supported inside arrays");return e.fieldTransforms.push(new Ve(e.path,Be.instance)),null}return u("Unknown FieldValue type: "+t)}throw e.createError("Unsupported field value: "+O(t))},t}(),hi=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),fi="firestore.googleapis.com",pi=!0,di=function(){function t(t){if(void 0===t.host){if(void 0!==t.ssl)throw new xt(Dt.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=fi,this.ssl=pi}else w("settings","string","host",t.host),this.host=t.host,S("settings","boolean","ssl",t.ssl),this.ssl=function(t,e){return void 0!==t?t:e}(t.ssl,pi);R("settings",t,["host","ssl","credentials"]),S("settings","object","credentials",t.credentials),this.credentials=t.credentials}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials},t}(),vi=function(){return function(){}}(),gi=function(){function t(e){var n=this;this._queue=new zr,this.INTERNAL={delete:function(){return n._firestoreClient?n._firestoreClient.shutdown():Promise.resolve()}};var r=new vi;if("object"==typeof e.options){var i=e;r.firebaseApp=i,r.databaseId=t.databaseIdFromApp(i),r.persistenceKey=r.firebaseApp.name,r.credentials=new Jr(i)}else{var o=e;if(!o.projectId)throw new xt(Dt.INVALID_ARGUMENT,"Must provide projectId");r.databaseId=new Vt(o.projectId,o.database),r.persistenceKey="[DEFAULT]",r.credentials=new Yr}r.settings=new di({}),this._config=r,this._databaseId=r.databaseId}return t.prototype.settings=function(t){if(y("Firestore.settings",arguments,1),b("Firestore.settings","object",1,t),f(t,"persistence"))throw new xt(Dt.INVALID_ARGUMENT,'"persistence" is now specified with a separate call to firestore.enablePersistence().');var e=new di(t);if(this._firestoreClient&&!this._config.settings.isEqual(e))throw new xt(Dt.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");this._config.settings=e,void 0!==e.credentials&&(this._config.credentials=function(t){if(!t)return new Yr;switch(t.type){case"gapi":return new Zr(t.client,t.sessionIndex||"0");case"provider":return t.client;default:throw new xt(Dt.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},t.prototype.enableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.enableNetwork()},t.prototype.disableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.disableNetwork()},t.prototype.enablePersistence=function(){if(this._firestoreClient)throw new xt(Dt.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");return this.configureClient(!0)},t.prototype.ensureClientConfigured=function(){return this._firestoreClient||this.configureClient(!1),this._firestoreClient},t.prototype.configureClient=function(t){var e=this;c(!!this._config.settings.host,"FirestoreSettings.host cannot be falsey"),c(!this._firestoreClient,"configureClient() called multiple times");var n=new jt(this._config.databaseId,this._config.persistenceKey,this._config.settings.host,this._config.settings.ssl);return this._dataConverter=new li(function(t){if(t instanceof _i){var n=e._config.databaseId,r=t.firestore._config.databaseId;if(!r.isEqual(n))throw new xt(Dt.INVALID_ARGUMENT,"Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return new ci(e._config.databaseId,t._key)}return t}),this._firestoreClient=new Gr(kt.getPlatform(),n,this._config.credentials,this._queue),this._firestoreClient.start(t)},t.databaseIdFromApp=function(t){var e=t.options;if(!f(e,"projectId")){if(f(e,"firestoreId"))throw new xt(Dt.INVALID_ARGUMENT,'"firestoreId" is now specified as "projectId" in firebase.initializeApp.');throw new xt(Dt.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.')}if(f(e,"firestoreOptions"))throw new xt(Dt.INVALID_ARGUMENT,'"firestoreOptions" values are now specified with Firestore.settings()');var n=e.projectId;if(!n||"string"!=typeof n)throw new xt(Dt.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Vt(n)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this._config.firebaseApp)throw new xt(Dt.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._config.firebaseApp},enumerable:!0,configurable:!0}),t.prototype.collection=function(t){if(y("Firestore.collection",arguments,1),b("Firestore.collection","string",1,t),!t)throw new xt(Dt.INVALID_ARGUMENT,"Must provide a non-empty collection path to collection()");return this.ensureClientConfigured(),new Ii(Ht.fromString(t),this)},t.prototype.doc=function(t){if(y("Firestore.doc",arguments,1),b("Firestore.doc","string",1,t),!t)throw new xt(Dt.INVALID_ARGUMENT,"Must provide a non-empty document path to doc()");return this.ensureClientConfigured(),_i.forPath(Ht.fromString(t),this)},t.prototype.runTransaction=function(t){var e=this;return y("Firestore.runTransaction",arguments,1),b("Firestore.runTransaction","function",1,t),this.ensureClientConfigured().transaction(function(n){return t(new yi(e,n))})},t.prototype.batch=function(){return this.ensureClientConfigured(),new mi(this)},Object.defineProperty(t,"logLevel",{get:function(){switch(r()){case Ot.DEBUG:return"debug";case Ot.ERROR:return"error";case Ot.SILENT:return"silent";default:return u("Unknown log level: "+r())}},enumerable:!0,configurable:!0}),t.setLogLevel=function(t){switch(y("Firestore.setLogLevel",arguments,1),b("Firestore.setLogLevel","string",1,t),t){case"debug":i(Ot.DEBUG);break;case"error":i(Ot.ERROR);break;case"silent":i(Ot.SILENT);break;default:throw new xt(Dt.INVALID_ARGUMENT,"Invalid log level: "+t)}},t}(),yi=function(){function t(t,e){this._firestore=t,this._transaction=e}return t.prototype.get=function(t){var e=this;y("Transaction.get",arguments,1);var n=Tt("Transaction.get",t,this._firestore);return this._transaction.lookup([n._key]).then(function(t){if(!t||1!==t.length)return u("Mismatch in docs returned from document lookup.");var r=t[0];return new Ei(e._firestore,n._key,r instanceof Xt?null:r,!1)})},t.prototype.set=function(t,e,n){_("Transaction.set",arguments,2,3);var r=Tt("Transaction.set",t,this._firestore),i=(n=wt("Transaction.set",n)).merge?this._firestore._dataConverter.parseMergeData("Transaction.set",e):this._firestore._dataConverter.parseSetData("Transaction.set",e);return this._transaction.set(r._key,i),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,a;return"string"==typeof e||e instanceof An?(m("Transaction.update",arguments,3),o=Tt("Transaction.update",t,this._firestore),a=this._firestore._dataConverter.parseUpdateVarargs("Transaction.update",e,n,r)):(y("Transaction.update",arguments,2),o=Tt("Transaction.update",t,this._firestore),a=this._firestore._dataConverter.parseUpdateData("Transaction.update",e)),this._transaction.update(o._key,a),this},t.prototype.delete=function(t){y("Transaction.delete",arguments,1);var e=Tt("Transaction.delete",t,this._firestore);return this._transaction.delete(e._key),this},t}(),mi=function(){function t(t){this._firestore=t,this._mutations=[],this._committed=!1}return t.prototype.set=function(t,e,n){_("WriteBatch.set",arguments,2,3),this.verifyNotCommitted();var r=Tt("WriteBatch.set",t,this._firestore),i=(n=wt("WriteBatch.set",n)).merge?this._firestore._dataConverter.parseMergeData("WriteBatch.set",e):this._firestore._dataConverter.parseSetData("WriteBatch.set",e);return this._mutations=this._mutations.concat(i.toMutations(r._key,He.NONE)),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,a;return this.verifyNotCommitted(),"string"==typeof e||e instanceof An?(m("WriteBatch.update",arguments,3),o=Tt("WriteBatch.update",t,this._firestore),a=this._firestore._dataConverter.parseUpdateVarargs("WriteBatch.update",e,n,r)):(y("WriteBatch.update",arguments,2),o=Tt("WriteBatch.update",t,this._firestore),a=this._firestore._dataConverter.parseUpdateData("WriteBatch.update",e)),this._mutations=this._mutations.concat(a.toMutations(o._key,He.exists(!0))),this},t.prototype.delete=function(t){y("WriteBatch.delete",arguments,1),this.verifyNotCommitted();var e=Tt("WriteBatch.delete",t,this._firestore);return this._mutations=this._mutations.concat(new Xe(e._key,He.NONE)),this},t.prototype.commit=function(){return this.verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._firestore.ensureClientConfigured().write(this._mutations):Promise.resolve()},t.prototype.verifyNotCommitted=function(){if(this._committed)throw new xt(Dt.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}(),_i=function(){function t(t,e){this._key=t,this.firestore=e,this._firestoreClient=this.firestore.ensureClientConfigured()}return t.forPath=function(e,n){if(e.length%2!=0)throw new xt(Dt.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(new zt(e),n)},Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Ii(this._key.path.popLast(),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!0,configurable:!0}),t.prototype.collection=function(t){if(y("DocumentReference.collection",arguments,1),b("DocumentReference.collection","string",1,t),!t)throw new xt(Dt.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=Ht.fromString(t);return new Ii(this._key.path.child(e),this.firestore)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw N("isEqual","DocumentReference",1,e);return this.firestore===e.firestore&&this._key.isEqual(e._key)},t.prototype.set=function(t,e){_("DocumentReference.set",arguments,1,2);var n=(e=wt("DocumentReference.set",e)).merge?this.firestore._dataConverter.parseMergeData("DocumentReference.set",t):this.firestore._dataConverter.parseSetData("DocumentReference.set",t);return this._firestoreClient.write(n.toMutations(this._key,He.NONE))},t.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i;return"string"==typeof t||t instanceof An?(m("DocumentReference.update",arguments,2),i=this.firestore._dataConverter.parseUpdateVarargs("DocumentReference.update",t,e,n)):(y("DocumentReference.update",arguments,1),i=this.firestore._dataConverter.parseUpdateData("DocumentReference.update",t)),this._firestoreClient.write(i.toMutations(this._key,He.exists(!0)))},t.prototype.delete=function(){return y("DocumentReference.delete",arguments,0),this._firestoreClient.write([new Xe(this._key,He.NONE)])},t.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];_("DocumentReference.onSnapshot",arguments,1,4);var n,r={includeMetadataChanges:!1},i=0;"object"!=typeof t[i]||vt(t[i])||(R("DocumentReference.onSnapshot",r=t[i],["includeMetadataChanges"]),S("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var o={includeDocumentMetadataChanges:r.includeMetadataChanges,includeQueryMetadataChanges:r.includeMetadataChanges};return vt(t[i])?n=t[i]:(b("DocumentReference.onSnapshot","function",i,t[i]),E("DocumentReference.onSnapshot","function",i+1,t[i+1]),E("DocumentReference.onSnapshot","function",i+2,t[i+2]),n={next:t[i],error:t[i+1],complete:t[i+2]}),this.onSnapshotInternal(o,n)},t.prototype.onSnapshotInternal=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new Kr({next:function(t){if(e.next){c(t.docs.size<=1,"Too many documents returned on a document query");var r=t.docs.get(n._key);e.next(new Ei(n.firestore,n._key,r,t.fromCache))}},error:r}),o=this._firestoreClient.listen(Se.atPath(this._key.path),i,t);return function(){i.mute(),n._firestoreClient.unlisten(o)}},t.prototype.get=function(){var t=this;return y("DocumentReference.get",arguments,0),new Promise(function(e,n){var r=t.onSnapshotInternal({includeQueryMetadataChanges:!0,includeDocumentMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(t){r(),!t.exists&&t.metadata.fromCache?n(new xt(Dt.ABORTED,"Failed to get document because the client is offline.")):e(t)},error:n})})},t}(),bi=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Ei=function(){function t(t,e,n,r){this._firestore=t,this._key=e,this._document=n,this._fromCache=r}return t.prototype.data=function(t){return _("DocumentSnapshot.data",arguments,0,1),t=St("DocumentSnapshot.data",t),this._document?this.convertObject(this._document.data,ie.fromSnapshotOptions(t)):void 0},t.prototype.get=function(t,e){if(_("DocumentSnapshot.get",arguments,1,2),e=St("DocumentSnapshot.get",e),this._document){var n=this._document.data.field(_t("DocumentSnapshot.get",t));if(void 0!==n)return this.convertValue(n,ie.fromSnapshotOptions(e))}},Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new _i(this._key,this._firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return null!==this._document},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return new bi(null!==this._document&&this._document.hasLocalMutations,this._fromCache)},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){if(!(e instanceof t))throw N("isEqual","DocumentSnapshot",1,e);return this._firestore===e._firestore&&this._fromCache===e._fromCache&&this._key.isEqual(e._key)&&(null===this._document?null===e._document:this._document.isEqual(e._document))},t.prototype.convertObject=function(t,e){var n=this,r={};return t.forEach(function(t,i){r[t]=n.convertValue(i,e)}),r},t.prototype.convertValue=function(t,e){if(t instanceof ye)return this.convertObject(t,e);if(t instanceof me)return this.convertArray(t,e);if(t instanceof ve){var n=t.value(e),r=this._firestore.ensureClientConfigured().databaseId();return t.databaseId.isEqual(r)||a("Document "+this._key.path+" contains a document reference within a different database ("+t.databaseId.projectId+"/"+t.databaseId.database+") which is not supported. It will be treated as a reference in the current database ("+r.projectId+"/"+r.database+") instead."),new _i(n,this._firestore)}return t.value(e)},t.prototype.convertArray=function(t,e){var n=this;return t.internalValue.map(function(t){return n.convertValue(t,e)})},t}(),wi=function(t){function e(e,n,r,i){return t.call(this,e,n,r,i)||this}return hi(e,t),e.prototype.data=function(e){var n=t.prototype.data.call(this,e);return c("object"==typeof n,"Document in a QueryDocumentSnapshot should exist"),n},e}(Ei),Si=function(){function t(t,e){this._query=t,this.firestore=e}return t.prototype.where=function(e,n,r){y("Query.where",arguments,3),b("Query.where","string",2,n),C("Query.where",3,r);var i,o=_t("Query.where",e);if(o.isKeyField())if("string"==typeof r){if(-1!==r.indexOf("/"))throw new xt(Dt.INVALID_ARGUMENT,"Function Query.where() requires its third parameter to be a valid document ID if the first parameter is FieldPath.documentId(), but it contains a slash.");if(""===r)throw new xt(Dt.INVALID_ARGUMENT,"Function Query.where() requires its third parameter to be a valid document ID if the first parameter is FieldPath.documentId(), but it was an empty string.");var a=this._query.path.child(new Ht([r]));c(a.length%2==0,"Path should be a document key"),i=new ve(this.firestore._databaseId,new zt(a))}else{if(!(r instanceof _i))throw new xt(Dt.INVALID_ARGUMENT,"Function Query.where() requires its third parameter to be a string or a DocumentReference if the first parameter is FieldPath.documentId(), but it was: "+O(r)+".");var s=r;i=new ve(this.firestore._databaseId,s._key)}else i=this.firestore._dataConverter.parseQueryValue("Query.where",r);var u=function(t,e,n){if(n.isEqual(ae.INSTANCE)){if(e!==Te.EQUAL)throw new xt(Dt.INVALID_ARGUMENT,"Invalid query. You can only perform equals comparisons on null.");return new Ae(t)}if(n.isEqual(le.NAN)){if(e!==Te.EQUAL)throw new xt(Dt.INVALID_ARGUMENT,"Invalid query. You can only perform equals comparisons on NaN.");return new Oe(t)}return new Ie(t,e,n)}(o,Te.fromString(n),i);return this.validateNewFilter(u),new t(this._query.addFilter(u),this.firestore)},t.prototype.orderBy=function(e,n){var r;if(_("Query.orderBy",arguments,1,2),E("Query.orderBy","string",2,n),void 0===n||"asc"===n)r=Ce.ASCENDING;else{if("desc"!==n)throw new xt(Dt.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+n+"', expected 'asc' or 'desc'.");r=Ce.DESCENDING}if(null!==this._query.startAt)throw new xt(Dt.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this._query.endAt)throw new xt(Dt.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var i=_t("Query.orderBy",e),o=new Ne(i,r);return this.validateNewOrderBy(o),new t(this._query.addOrderBy(o),this.firestore)},t.prototype.limit=function(e){if(y("Query.limit",arguments,1),b("Query.limit","number",1,e),e<=0)throw new xt(Dt.INVALID_ARGUMENT,"Invalid Query. Query limit ("+e+") is invalid. Limit must be positive.");return new t(this._query.withLimit(e),this.firestore)},t.prototype.startAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];m("Query.startAt",arguments,1);var i=this.boundFromDocOrFields("Query.startAt",e,n,!0);return new t(this._query.withStartAt(i),this.firestore)},t.prototype.startAfter=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];m("Query.startAfter",arguments,1);var i=this.boundFromDocOrFields("Query.startAfter",e,n,!1);return new t(this._query.withStartAt(i),this.firestore)},t.prototype.endBefore=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];m("Query.endBefore",arguments,1);var i=this.boundFromDocOrFields("Query.endBefore",e,n,!0);return new t(this._query.withEndAt(i),this.firestore)},t.prototype.endAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];m("Query.endAt",arguments,1);var i=this.boundFromDocOrFields("Query.endAt",e,n,!1);return new t(this._query.withEndAt(i),this.firestore)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw N("isEqual","Query",1,e);return this.firestore===e.firestore&&this._query.isEqual(e._query)},t.prototype.boundFromDocOrFields=function(t,e,n,r){if(C(t,1,e),e instanceof Ei){if(n.length>0)throw new xt(Dt.INVALID_ARGUMENT,"Too many arguments provided to "+t+"().");var i=e;if(!i.exists)throw new xt(Dt.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");return this.boundFromDocument(t,i._document,r)}var o=[e].concat(n);return this.boundFromFields(t,o,r)},t.prototype.boundFromDocument=function(t,e,n){for(var r=[],i=0,o=this._query.orderBy;i<o.length;i++){var a=o[i];if(a.field.isKeyField())r.push(new ve(this.firestore._databaseId,e.key));else{var s=e.field(a.field);if(void 0===s){var u=a.field.canonicalString();throw new xt(Dt.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}r.push(s)}}return new Re(r,n)},t.prototype.boundFromFields=function(t,e,n){var r=this._query.explicitOrderBy;if(e.length>r.length)throw new xt(Dt.INVALID_ARGUMENT,"Too many arguments provided to "+t+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var i=[],o=0;o<e.length;o++){var a=e[o];if(r[o].field.isKeyField()){if("string"!=typeof a)throw new xt(Dt.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+t+"(), but got a "+typeof a);if(-1!==a.indexOf("/"))throw new xt(Dt.INVALID_ARGUMENT,"Invalid query. Document ID '"+a+"' contains a slash in "+t+"()");var s=new zt(this._query.path.child(a));i.push(new ve(this.firestore._databaseId,s))}else{var u=this.firestore._dataConverter.parseQueryValue(t,a);i.push(u)}}return new Re(i,n)},t.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];_("Query.onSnapshot",arguments,1,4);var n,r={},i=0;return"object"!=typeof t[i]||vt(t[i])||(R("Query.onSnapshot",r=t[i],["includeQueryMetadataChanges","includeDocumentMetadataChanges"]),S("Query.onSnapshot","boolean","includeDocumentMetadataChanges",r.includeDocumentMetadataChanges),S("Query.onSnapshot","boolean","includeQueryMetadataChanges",r.includeQueryMetadataChanges),i++),vt(t[i])?n=t[i]:(b("Query.onSnapshot","function",i,t[i]),E("Query.onSnapshot","function",i+1,t[i+1]),E("Query.onSnapshot","function",i+2,t[i+2]),n={next:t[i],error:t[i+1],complete:t[i+2]}),this.onSnapshotInternal(r,n)},t.prototype.onSnapshotInternal=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new Kr({next:function(t){e.next&&e.next(new Ti(n.firestore,n._query,t))},error:r}),o=this.firestore.ensureClientConfigured(),a=o.listen(this._query,i,t);return function(){i.mute(),o.unlisten(a)}},t.prototype.get=function(){var t=this;return y("Query.get",arguments,0),new Promise(function(e,n){var r=t.onSnapshotInternal({includeDocumentMetadataChanges:!1,includeQueryMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(t){r(),e(t)},error:n})})},t.prototype.validateNewFilter=function(t){if(t instanceof Ie&&t.isInequality()){var e=this._query.getInequalityFilterField();if(null!==e&&!e.isEqual(t.field))throw new xt(Dt.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+e.toString()+"' and '"+t.field.toString()+"'");var n=this._query.getFirstOrderByField();null!==n&&this.validateOrderByAndInequalityMatch(t.field,n)}},t.prototype.validateNewOrderBy=function(t){if(null===this._query.getFirstOrderByField()){var e=this._query.getInequalityFilterField();null!==e&&this.validateOrderByAndInequalityMatch(e,t.field)}},t.prototype.validateOrderByAndInequalityMatch=function(t,e){if(!e.isEqual(t))throw new xt(Dt.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e.toString()+"' instead.")},t}(),Ti=function(){function t(t,e,n){this._firestore=t,this._originalQuery=e,this._snapshot=n,this._cachedChanges=null,this.metadata=new bi(n.hasPendingWrites,n.fromCache)}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._snapshot.docs.isEmpty()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;_("QuerySnapshot.forEach",arguments,1,2),b("QuerySnapshot.forEach","function",1,t),this._snapshot.docs.forEach(function(r){t.call(e,n.convertToDocumentImpl(r))})},Object.defineProperty(t.prototype,"query",{get:function(){return new Si(this._originalQuery,this._firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"docChanges",{get:function(){return this._cachedChanges||(this._cachedChanges=function(t,e){if(e.oldDocs.isEmpty()){var n,r=0;return e.docChanges.map(function(i){var o=new wi(t,i.doc.key,i.doc,e.fromCache);return c(i.type===Tn.Added,"Invalid event type for first snapshot"),c(!n||e.query.docComparator(n,i.doc)<0,"Got added events in wrong order"),n=i.doc,{type:"added",doc:o,oldIndex:-1,newIndex:r++}})}var i=e.oldDocs;return e.docChanges.map(function(n){var r=new wi(t,n.doc.key,n.doc,e.fromCache),o=-1,a=-1;return n.type!==Tn.Added&&(c((o=i.indexOf(n.doc.key))>=0,"Index for document not found"),i=i.delete(n.doc.key)),n.type!==Tn.Removed&&(a=(i=i.add(n.doc)).indexOf(n.doc.key)),{type:It(n.type),doc:r,oldIndex:o,newIndex:a}})}(this._firestore,this._snapshot)),this._cachedChanges},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){if(!(e instanceof t))throw N("isEqual","QuerySnapshot",1,e);return this._firestore===e._firestore&&this._originalQuery.isEqual(e._originalQuery)&&this._snapshot.isEqual(e._snapshot)},t.prototype.convertToDocumentImpl=function(t){return new wi(this._firestore,t.key,t,this.metadata.fromCache)},t}(),Ii=function(t){function e(e,n){var r=t.call(this,Se.atPath(e),n)||this;if(e.length%2!=1)throw new xt(Dt.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+e.canonicalString()+" has "+e.length);return r}return hi(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._query.path.popLast();return t.isEmpty()?null:new _i(new zt(t),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!0,configurable:!0}),e.prototype.doc=function(t){if(_("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Mt.newId()),b("CollectionReference.doc","string",1,t),""===t)throw new xt(Dt.INVALID_ARGUMENT,"Document path must be a non-empty string");var e=Ht.fromString(t);return _i.forPath(this._query.path.child(e),this.firestore)},e.prototype.add=function(t){y("CollectionReference.add",arguments,1),b("CollectionReference.add","object",1,t);var e=this.doc();return e.set(t).then(function(){return e})},e}(Si),Ai=h(gi,"Use firebase.firestore() instead."),Oi=h(yi,"Use firebase.firestore().runTransaction() instead."),Ci=h(mi,"Use firebase.firestore().batch() instead."),Ri=h(_i,"Use firebase.firestore().doc() instead."),Ni=h(Ei),ki=h(wi),Pi=h(Si),Di=h(Ti),xi=h(Ii,"Use firebase.firestore().collection() instead."),Mi={Firestore:Ai,GeoPoint:Ut,Blob:Ft,Transaction:Oi,WriteBatch:Ci,DocumentReference:Ri,DocumentSnapshot:Ni,Query:Pi,QueryDocumentSnapshot:ki,QuerySnapshot:Di,CollectionReference:xi,FieldPath:An,FieldValue:ii,setLogLevel:gi.setLogLevel};n.d(e,"registerFirestore",function(){return At}),At(Ct.default)},function(t,e,n){"use strict";function r(t){return"storage/"+t}function i(){return new vt(gt.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function o(){return new vt(gt.CANCELED,"User canceled the upload/download.")}function a(){return new vt(gt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function s(t,e,n){return new vt(gt.INVALID_ARGUMENT,"Invalid argument in `"+e+"` at index "+t+": "+n)}function u(){return new vt(gt.APP_DELETED,"The Firebase app was deleted.")}function c(t,e){return new vt(gt.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function l(t){throw new vt(gt.INTERNAL_ERROR,"Internal error: "+t)}function h(t){switch(t){case yt.RAW:case yt.BASE64:case yt.BASE64URL:case yt.DATA_URL:return;default:throw"Expected one of the event types: ["+yt.RAW+", "+yt.BASE64+", "+yt.BASE64URL+", "+yt.DATA_URL+"]."}}function f(t,e){switch(t){case yt.RAW:return new mt(p(e));case yt.BASE64:case yt.BASE64URL:return new mt(d(t,e));case yt.DATA_URL:return new mt(function(t){var e=new _t(t);return e.base64?d(yt.BASE64,e.rest):function(t){var e;try{e=decodeURIComponent(t)}catch(t){throw c(yt.DATA_URL,"Malformed data URL.")}return p(e)}(e.rest)}(e),function(t){return new _t(t).contentType}(e))}throw i()}function p(t){for(var e=[],n=0;n<t.length;n++){var r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|63&r);else if(55296==(64512&r)){if(n<t.length-1&&56320==(64512&t.charCodeAt(n+1)))r=65536|(1023&r)<<10|1023&t.charCodeAt(++n),e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r);else e.push(239,191,189)}else 56320==(64512&r)?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(e)}function d(t,e){switch(t){case yt.BASE64:var n=-1!==e.indexOf("-"),r=-1!==e.indexOf("_");if(n||r)throw c(t,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?");break;case yt.BASE64URL:var i=-1!==e.indexOf("+"),o=-1!==e.indexOf("/");if(i||o)throw c(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/")}var a;try{a=atob(e)}catch(e){throw c(t,"Invalid character found")}for(var s=new Uint8Array(a.length),u=0;u<a.length;u++)s[u]=a.charCodeAt(u);return s}function v(t){switch(t){case Et.RUNNING:case Et.PAUSING:case Et.CANCELING:return wt.RUNNING;case Et.PAUSED:return wt.PAUSED;case Et.SUCCESS:return wt.SUCCESS;case Et.CANCELED:return wt.CANCELED;case Et.ERROR:default:return wt.ERROR}}function g(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function y(t,e){for(var n in t)g(t,n)&&e(n,t[n])}function m(t){if(null==t)return{};var e={};return y(t,function(t,n){e[t]=n}),e}function _(t){return new Promise(t)}function b(t){return Promise.resolve(t)}function E(t){return null!=t}function w(t){return void 0!==t}function S(t){return"function"==typeof t}function T(t){return"object"==typeof t}function I(t){return T(t)&&null!==t}function A(t){return"string"==typeof t||t instanceof String}function O(t){return C()&&t instanceof Blob}function C(){return"undefined"!=typeof Blob}function R(t){var e;try{e=JSON.parse(t)}catch(t){return null}return function(t){return T(t)&&!Array.isArray(t)}(e)?e:null}function N(t){var e=t.lastIndexOf("/",t.length-2);return-1===e?t:t.slice(e+1)}function k(t){return ut+lt+t}function P(t){return ut+ht+t}function D(t){var e=encodeURIComponent,n="?";return y(t,function(t,r){var i=e(t)+"="+e(r);n=n+i+"&"}),n=n.slice(0,-1)}function x(t,e){return e}function M(){if(Ot)return Ot;var t=[];t.push(new At("bucket")),t.push(new At("generation")),t.push(new At("metageneration")),t.push(new At("name","fullPath",!0));var e=new At("name");e.xform=function(t,e){return function(t){return!A(t)||t.length<2?t:N(t=t)}(e)},t.push(e);var n=new At("size");return n.xform=function(t,e){return E(e)?+e:e},t.push(n),t.push(new At("timeCreated")),t.push(new At("updated")),t.push(new At("md5Hash",null,!0)),t.push(new At("cacheControl",null,!0)),t.push(new At("contentDisposition",null,!0)),t.push(new At("contentEncoding",null,!0)),t.push(new At("contentLanguage",null,!0)),t.push(new At("contentType",null,!0)),t.push(new At("metadata","customMetadata",!0)),t.push(new At("downloadTokens","downloadURLs",!1,function(t,e){if(!(A(e)&&e.length>0))return[];var n=encodeURIComponent;return e.split(",").map(function(e){var r=t.bucket,i=t.fullPath;return function(t){return ct+lt+t}("/b/"+n(r)+"/o/"+n(i))+D({alt:"media",token:e})})})),Ot=t}function L(t,e,n){for(var r={type:"file"},i=n.length,o=0;o<i;o++){var a=n[o];r[a.local]=a.xform(r,e[a.server])}return function(t,e){Object.defineProperty(t,"ref",{get:function(){var n=t.bucket,r=t.fullPath,i=new It(n,r);return e.makeStorageReference(i)}})}(r,t),r}function F(t,e){for(var n={},r=e.length,i=0;i<r;i++){var o=e[i];o.writable&&(n[o.server]=t[o.local])}return JSON.stringify(n)}function U(t){if(!t||!T(t))throw"Expected Metadata object.";for(var e in t){var n=t[e];if("customMetadata"===e){if(!T(n))throw"Expected object for 'customMetadata' mapping."}else if(I(n))throw"Mapping for '"+e+"' cannot be an object."}}function j(t,e,n){for(var r=e.length,i=e.length,o=0;o<e.length;o++)if(e[o].optional){r=o;break}if(!(r<=n.length&&n.length<=i))throw function(t,e,n,r){var i,o;return t===e?(i=t,o=1===t?"argument":"arguments"):(i="between "+t+" and "+e,o="arguments"),new vt(gt.INVALID_ARGUMENT_COUNT,"Invalid argument count in `"+n+"`: Expected "+i+" "+o+", received "+r+".")}(r,i,t,n.length);for(o=0;o<n.length;o++)try{e[o].validator(n[o])}catch(e){throw e instanceof Error?s(o,t,e.message):s(o,t,e)}}function B(t,e){function n(t){if(!A(t))throw"Expected string."}var r;return r=t?function(t,e){return function(n){t(n),e(n)}}(n,t):n,new Ct(r,e)}function V(){return new Ct(function(t){if(!(t instanceof Uint8Array||t instanceof ArrayBuffer||C()&&t instanceof Blob))throw"Expected Blob or File."})}function W(t){return new Ct(U,t)}function q(){return new Ct(function(t){if(!(function(t){return"number"==typeof t||t instanceof Number}(t)&&t>=0))throw"Expected a number 0 or greater."})}function H(t,e){return new Ct(function(e){if(!(null===e||E(e)&&e instanceof Object))throw"Expected an Object.";null!=t&&t(e)},e)}function G(t){return new Ct(function(t){if(null!==t&&!S(t))throw"Expected a Function."},t)}function K(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0;if(void 0!==n){for(var r=new n,i=0;i<t.length;i++)r.append(t[i]);return r.getBlob()}if(C())return new Blob(t);throw Error("This browser doesn't seem to support creating Blobs")}function z(t,e){return-1!==t.indexOf(e)}function Q(t){if(!t)throw i()}function X(t,e){return function(n,r){var i=function(t,e,n){var r=R(e);return null===r?null:L(t,r,n)}(t,r,e);return Q(null!==i),i}}function Y(t){return function(e,n){var r;return(r=401===e.getStatus()?new vt(gt.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again."):402===e.getStatus()?function(t){return new vt(gt.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}(t.bucket):403===e.getStatus()?function(t){return new vt(gt.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}(t.path):n).setServerResponseProp(n.serverResponseProp()),r}}function J(t){var e=Y(t);return function(n,r){var i=e(n,r);return 404===n.getStatus()&&(i=function(t){return new vt(gt.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}(t.path)),i.setServerResponseProp(r.serverResponseProp()),i}}function $(t,e,n){var r=k(e.fullServerUrl()),i=t.maxOperationRetryTime(),o=new Nt(r,"GET",X(t,n),i);return o.errorHandler=J(e),o}function Z(t,e,n){var r=m(n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=function(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}(null,e)),r}function tt(t,e){var n;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch(t){Q(!1)}return Q(z(e||["active"],n)),n}function et(t,e,n,r,i,o,s,u){var c=new kt(0,0);if(s?(c.current=s.current,c.total=s.total):(c.current=0,c.total=r.size()),r.size()!==c.total)throw new vt(gt.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.");var l=c.total-c.current,h=l;i>0&&(h=Math.min(h,i));var f=c.current,p=f+h,d={"X-Goog-Upload-Command":h===l?"upload, finalize":"upload","X-Goog-Upload-Offset":c.current},v=r.slice(f,p);if(null===v)throw a();var g=e.maxUploadRetryTime(),y=new Nt(n,"POST",function(t,n){var i,a=tt(t,["active","final"]),s=c.current+h,u=r.size();return i="final"===a?X(e,o)(t,n):null,new kt(s,u,"final"===a,i)},g);return y.headers=d,y.body=v.uploadData(),y.progressCallback=u||null,y.errorHandler=Y(t),y}function nt(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];b(!0).then(function(){t.apply(null,e)})}}function rt(t,e,n){var r=D(t.urlParams),i=t.url+r,o=m(t.headers);return function(t,e){null!==e&&e.length>0&&(t.Authorization="Firebase "+e)}(o,e),function(t){var e=void 0!==st.default?st.default.SDK_VERSION:"AppManager";t["X-Firebase-Storage-Version"]="webjs/"+e}(o),new jt(i,t.method,o,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,n)}function it(t,e,n){return new Vt(t,new Tt,n)}function ot(t){var e={TaskState:wt,TaskEvent:bt,StringFormat:yt,Storage:Vt,Reference:Mt};t.INTERNAL.registerService(qt,it,e,void 0,!0)}n.r(e);var at,st=n(16),ut="https://firebasestorage.googleapis.com",ct="https://firebasestorage.googleapis.com",lt="/v0",ht="/v0",ft=12e4,pt=6e4,dt=-9007199254740991,vt=function(){function t(t,e){this.code_=r(t),this.message_="Firebase Storage: "+e,this.serverResponse_=null,this.name_="FirebaseError"}return t.prototype.codeProp=function(){return this.code},t.prototype.codeEquals=function(t){return r(t)===this.codeProp()},t.prototype.serverResponseProp=function(){return this.serverResponse_},t.prototype.setServerResponseProp=function(t){this.serverResponse_=t},Object.defineProperty(t.prototype,"name",{get:function(){return this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"code",{get:function(){return this.code_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"message",{get:function(){return this.message_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serverResponse",{get:function(){return this.serverResponse_},enumerable:!0,configurable:!0}),t}(),gt={UNKNOWN:"unknown",OBJECT_NOT_FOUND:"object-not-found",BUCKET_NOT_FOUND:"bucket-not-found",PROJECT_NOT_FOUND:"project-not-found",QUOTA_EXCEEDED:"quota-exceeded",UNAUTHENTICATED:"unauthenticated",UNAUTHORIZED:"unauthorized",RETRY_LIMIT_EXCEEDED:"retry-limit-exceeded",INVALID_CHECKSUM:"invalid-checksum",CANCELED:"canceled",INVALID_EVENT_NAME:"invalid-event-name",INVALID_URL:"invalid-url",INVALID_DEFAULT_BUCKET:"invalid-default-bucket",NO_DEFAULT_BUCKET:"no-default-bucket",CANNOT_SLICE_BLOB:"cannot-slice-blob",SERVER_FILE_WRONG_SIZE:"server-file-wrong-size",NO_DOWNLOAD_URL:"no-download-url",INVALID_ARGUMENT:"invalid-argument",INVALID_ARGUMENT_COUNT:"invalid-argument-count",APP_DELETED:"app-deleted",INVALID_ROOT_OPERATION:"invalid-root-operation",INVALID_FORMAT:"invalid-format",INTERNAL_ERROR:"internal-error"},yt={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},mt=function(){return function(t,e){this.data=t,this.contentType=e||null}}(),_t=function(){return function(t){this.base64=!1,this.contentType=null;var e=t.match(/^data:([^,]+)?,/);if(null===e)throw c(yt.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");var n=e[1]||null;null!=n&&(this.base64=function(t,e){return!!(t.length>=e.length)&&t.substring(t.length-e.length)===e}(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-";base64".length):n),this.rest=t.substring(t.indexOf(",")+1)}}(),bt={STATE_CHANGED:"state_changed"},Et={RUNNING:"running",PAUSING:"pausing",PAUSED:"paused",SUCCESS:"success",CANCELING:"canceling",CANCELED:"canceled",ERROR:"error"},wt={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};!function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"}(at||(at={}));var St=function(){function t(){var t=this;this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=at.NO_ERROR,this.sendPromise_=_(function(e,n){t.xhr_.addEventListener("abort",function(n){t.errorCode_=at.ABORT,e(t)}),t.xhr_.addEventListener("error",function(n){t.errorCode_=at.NETWORK_ERROR,e(t)}),t.xhr_.addEventListener("load",function(n){e(t)})})}return t.prototype.send=function(t,e,n,r){var i=this;if(this.sent_)throw l("cannot .send() more than once");return this.sent_=!0,this.xhr_.open(e,t,!0),E(r)&&y(r,function(t,e){i.xhr_.setRequestHeader(t,e.toString())}),E(n)?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_},t.prototype.getErrorCode=function(){if(!this.sent_)throw l("cannot .getErrorCode() before sending");return this.errorCode_},t.prototype.getStatus=function(){if(!this.sent_)throw l("cannot .getStatus() before sending");try{return this.xhr_.status}catch(t){return-1}},t.prototype.getResponseText=function(){if(!this.sent_)throw l("cannot .getResponseText() before sending");return this.xhr_.responseText},t.prototype.abort=function(){this.xhr_.abort()},t.prototype.getResponseHeader=function(t){return this.xhr_.getResponseHeader(t)},t.prototype.addUploadProgressListener=function(t){E(this.xhr_.upload)&&this.xhr_.upload.addEventListener("progress",t)},t.prototype.removeUploadProgressListener=function(t){E(this.xhr_.upload)&&this.xhr_.upload.removeEventListener("progress",t)},t}(),Tt=function(){function t(){}return t.prototype.createXhrIo=function(){return new St},t}(),It=function(){function t(t,e){this.bucket=t,this.path_=e}return Object.defineProperty(t.prototype,"path",{get:function(){return this.path_},enumerable:!0,configurable:!0}),t.prototype.fullServerUrl=function(){var t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)},t.prototype.bucketOnlyServerUrl=function(){return"/b/"+encodeURIComponent(this.bucket)+"/o"},t.makeFromBucketSpec=function(e){var n;try{n=t.makeFromUrl(e)}catch(n){return new t(e,"")}if(""===n.path)return n;throw function(t){return new vt(gt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}(e)},t.makeFromUrl=function(e){for(var n=null,r=[{regex:new RegExp("^gs://([A-Za-z0-9.\\-]+)(/(.*))?$","i"),indices:{bucket:1,path:3},postModify:function(t){"/"===t.path.charAt(t.path.length-1)&&(t.path_=t.path_.slice(0,-1))}},{regex:new RegExp("^https?://firebasestorage\\.googleapis\\.com/v[A-Za-z0-9_]+/b/([A-Za-z0-9.\\-]+)/o(/([^?#]*).*)?$","i"),indices:{bucket:1,path:3},postModify:function(t){t.path_=decodeURIComponent(t.path)}}],i=0;i<r.length;i++){var o=r[i],a=o.regex.exec(e);if(a){var s=a[o.indices.bucket],u=a[o.indices.path];u||(u=""),n=new t(s,u),o.postModify(n);break}}if(null==n)throw function(t){return new vt(gt.INVALID_URL,"Invalid URL '"+t+"'.")}(e);return n},t}(),At=function(){return function(t,e,n,r){this.server=t,this.local=e||t,this.writable=!!n,this.xform=r||x}}(),Ot=null,Ct=function(){return function(t,e){var n=this;this.validator=function(e){n.optional&&!w(e)||t(e)},this.optional=!!e}}(),Rt=function(){function t(t,e){var n=0,r="";O(t)?(this.data_=t,n=t.size,r=t.type):t instanceof ArrayBuffer?(e?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),n=this.data_.length):t instanceof Uint8Array&&(e?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),n=t.length),this.size_=n,this.type_=r}return t.prototype.size=function(){return this.size_},t.prototype.type=function(){return this.type_},t.prototype.slice=function(e,n){if(O(this.data_)){var r=function(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}(this.data_,e,n);return null===r?null:new t(r)}return new t(new Uint8Array(this.data_.buffer,e,n-e),!0)},t.getBlob=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(C()){var r=e.map(function(e){return e instanceof t?e.data_:e});return new t(K.apply(null,r))}var i=e.map(function(t){return A(t)?f(yt.RAW,t).data:t.data_}),o=0;i.forEach(function(t){o+=t.byteLength});var a=new Uint8Array(o),s=0;return i.forEach(function(t){for(var e=0;e<t.length;e++)a[s++]=t[e]}),new t(a,!0)},t.prototype.uploadData=function(){return this.data_},t}(),Nt=function(){return function(t,e,n,r){this.url=t,this.method=e,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}(),kt=function(){return function(t,e,n,r){this.current=t,this.total=e,this.finalized=!!n,this.metadata=r||null}}(),Pt=function(){return function(t,e,n){if(S(t)||E(e)||E(n))this.next=t,this.error=e||null,this.complete=n||null;else{var r=t;this.next=r.next||null,this.error=r.error||null,this.complete=r.complete||null}}}(),Dt=function(){function t(t,e,n,r,i,o){this.bytesTransferred=t,this.totalBytes=e,this.state=n,this.metadata=r,this.task=i,this.ref=o}return Object.defineProperty(t.prototype,"downloadURL",{get:function(){if(null!==this.metadata){var t=this.metadata.downloadURLs;return null!=t&&null!=t[0]?t[0]:null}return null},enumerable:!0,configurable:!0}),t}(),xt=function(){function t(t,e,n,r,i,o){void 0===o&&(o=null);var a=this;this.transferred_=0,this.needToFetchStatus_=!1,this.needToFetchMetadata_=!1,this.observers_=[],this.error_=null,this.uploadUrl_=null,this.request_=null,this.chunkMultiplier_=1,this.resolve_=null,this.reject_=null,this.ref_=t,this.authWrapper_=e,this.location_=n,this.blob_=i,this.metadata_=o,this.mappings_=r,this.resumable_=this.shouldDoResumable_(this.blob_),this.state_=Et.RUNNING,this.errorHandler_=function(t){a.request_=null,a.chunkMultiplier_=1,t.codeEquals(gt.CANCELED)?(a.needToFetchStatus_=!0,a.completeTransitions_()):(a.error_=t,a.transition_(Et.ERROR))},this.metadataErrorHandler_=function(t){a.request_=null,t.codeEquals(gt.CANCELED)?a.completeTransitions_():(a.error_=t,a.transition_(Et.ERROR))},this.promise_=_(function(t,e){a.resolve_=t,a.reject_=e,a.start_()}),this.promise_.then(null,function(){})}return t.prototype.makeProgressCallback_=function(){var t=this,e=this.transferred_;return function(n,r){t.updateProgress_(e+n)}},t.prototype.shouldDoResumable_=function(t){return t.size()>262144},t.prototype.start_=function(){this.state_===Et.RUNNING&&null===this.request_&&(this.resumable_?null===this.uploadUrl_?this.createResumable_():this.needToFetchStatus_?this.fetchStatus_():this.needToFetchMetadata_?this.fetchMetadata_():this.continueUpload_():this.oneShotUpload_())},t.prototype.resolveToken_=function(t){var e=this;this.authWrapper_.getAuthToken().then(function(n){switch(e.state_){case Et.RUNNING:t(n);break;case Et.CANCELING:e.transition_(Et.CANCELED);break;case Et.PAUSING:e.transition_(Et.PAUSED)}})},t.prototype.createResumable_=function(){var t=this;this.resolveToken_(function(e){var n=function(t,e,n,r,i){var o=e.bucketOnlyServerUrl(),a=Z(e,r,i),s={name:a.fullPath},u=P(o),c={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":r.size(),"X-Goog-Upload-Header-Content-Type":a.contentType,"Content-Type":"application/json; charset=utf-8"},l=F(a,n),h=t.maxUploadRetryTime(),f=new Nt(u,"POST",function(t,e){var n;tt(t);try{n=t.getResponseHeader("X-Goog-Upload-URL")}catch(t){Q(!1)}return Q(A(n)),n},h);return f.urlParams=s,f.headers=c,f.body=l,f.errorHandler=Y(e),f}(t.authWrapper_,t.location_,t.mappings_,t.blob_,t.metadata_),r=t.authWrapper_.makeRequest(n,e);t.request_=r,r.getPromise().then(function(e){t.request_=null,t.uploadUrl_=e,t.needToFetchStatus_=!1,t.completeTransitions_()},t.errorHandler_)})},t.prototype.fetchStatus_=function(){var t=this,e=this.uploadUrl_;this.resolveToken_(function(n){var r=function(t,e,n,r){var i=t.maxUploadRetryTime(),o=new Nt(n,"POST",function(t,e){var n,i=tt(t,["active","final"]);try{n=t.getResponseHeader("X-Goog-Upload-Size-Received")}catch(t){Q(!1)}var o=parseInt(n,10);return Q(!isNaN(o)),new kt(o,r.size(),"final"===i)},i);return o.headers={"X-Goog-Upload-Command":"query"},o.errorHandler=Y(e),o}(t.authWrapper_,t.location_,e,t.blob_),i=t.authWrapper_.makeRequest(r,n);t.request_=i,i.getPromise().then(function(e){e=e,t.request_=null,t.updateProgress_(e.current),t.needToFetchStatus_=!1,e.finalized&&(t.needToFetchMetadata_=!0),t.completeTransitions_()},t.errorHandler_)})},t.prototype.continueUpload_=function(){var t=this,e=262144*this.chunkMultiplier_,n=new kt(this.transferred_,this.blob_.size()),r=this.uploadUrl_;this.resolveToken_(function(i){var o;try{o=et(t.location_,t.authWrapper_,r,t.blob_,e,t.mappings_,n,t.makeProgressCallback_())}catch(e){return t.error_=e,void t.transition_(Et.ERROR)}var a=t.authWrapper_.makeRequest(o,i);t.request_=a,a.getPromise().then(function(e){t.increaseMultiplier_(),t.request_=null,t.updateProgress_(e.current),e.finalized?(t.metadata_=e.metadata,t.transition_(Et.SUCCESS)):t.completeTransitions_()},t.errorHandler_)})},t.prototype.increaseMultiplier_=function(){262144*this.chunkMultiplier_<33554432&&(this.chunkMultiplier_*=2)},t.prototype.fetchMetadata_=function(){var t=this;this.resolveToken_(function(e){var n=$(t.authWrapper_,t.location_,t.mappings_),r=t.authWrapper_.makeRequest(n,e);t.request_=r,r.getPromise().then(function(e){t.request_=null,t.metadata_=e,t.transition_(Et.SUCCESS)},t.metadataErrorHandler_)})},t.prototype.oneShotUpload_=function(){var t=this;this.resolveToken_(function(e){var n=function(t,e,n,r,i){var o=e.bucketOnlyServerUrl(),s={"X-Goog-Upload-Protocol":"multipart"},u=function(){for(var t="",e=0;e<2;e++)t+=Math.random().toString().slice(2);return t}();s["Content-Type"]="multipart/related; boundary="+u;var c=Z(e,r,i),l="--"+u+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+F(c,n)+"\r\n--"+u+"\r\nContent-Type: "+c.contentType+"\r\n\r\n",h="\r\n--"+u+"--",f=Rt.getBlob(l,r,h);if(null===f)throw a();var p={name:c.fullPath},d=P(o),v=t.maxUploadRetryTime(),g=new Nt(d,"POST",X(t,n),v);return g.urlParams=p,g.headers=s,g.body=f.uploadData(),g.errorHandler=Y(e),g}(t.authWrapper_,t.location_,t.mappings_,t.blob_,t.metadata_),r=t.authWrapper_.makeRequest(n,e);t.request_=r,r.getPromise().then(function(e){t.request_=null,t.metadata_=e,t.updateProgress_(t.blob_.size()),t.transition_(Et.SUCCESS)},t.errorHandler_)})},t.prototype.updateProgress_=function(t){var e=this.transferred_;this.transferred_=t,this.transferred_!==e&&this.notifyObservers_()},t.prototype.transition_=function(t){if(this.state_!==t)switch(t){case Et.CANCELING:case Et.PAUSING:this.state_=t,null!==this.request_&&this.request_.cancel();break;case Et.RUNNING:var e=this.state_===Et.PAUSED;this.state_=t,e&&(this.notifyObservers_(),this.start_());break;case Et.PAUSED:this.state_=t,this.notifyObservers_();break;case Et.CANCELED:this.error_=o(),this.state_=t,this.notifyObservers_();break;case Et.ERROR:case Et.SUCCESS:this.state_=t,this.notifyObservers_()}},t.prototype.completeTransitions_=function(){switch(this.state_){case Et.PAUSING:this.transition_(Et.PAUSED);break;case Et.CANCELING:this.transition_(Et.CANCELED);break;case Et.RUNNING:this.start_()}},Object.defineProperty(t.prototype,"snapshot",{get:function(){var t=v(this.state_);return new Dt(this.transferred_,this.blob_.size(),t,this.metadata_,this,this.ref_)},enumerable:!0,configurable:!0}),t.prototype.on=function(t,e,n,r){function i(t){try{return void s(t)}catch(t){}try{if(u(t),!(w(t.next)||w(t.error)||w(t.complete)))throw"";return}catch(t){throw a}}function o(t){return function(e,n,i){null!==t&&j("on",t,arguments);var o=new Pt(e,n,r);return c.addObserver_(o),function(){c.removeObserver_(o)}}}void 0===e&&(e=void 0),void 0===n&&(n=void 0),void 0===r&&(r=void 0);var a="Expected a function or an Object with one of `next`, `error`, `complete` properties.",s=G(!0).validator,u=H(null,!0).validator;j("on",[B(function(e){if(t!==bt.STATE_CHANGED)throw"Expected one of the event types: ["+bt.STATE_CHANGED+"]."}),H(i,!0),G(!0),G(!0)],arguments);var c=this,l=[H(function(t){if(null===t)throw a;i(t)}),G(!0),G(!0)];return w(e)||w(n)||w(r)?o(null)(e,n,r):o(l)},t.prototype.then=function(t,e){return this.promise_.then(t,e)},t.prototype.catch=function(t){return this.then(null,t)},t.prototype.addObserver_=function(t){this.observers_.push(t),this.notifyObserver_(t)},t.prototype.removeObserver_=function(t){!function(t,e){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}(this.observers_,t)},t.prototype.notifyObservers_=function(){var t=this;this.finishPromise_(),function(t){return Array.prototype.slice.call(t)}(this.observers_).forEach(function(e){t.notifyObserver_(e)})},t.prototype.finishPromise_=function(){if(null!==this.resolve_){var t=!0;switch(v(this.state_)){case wt.SUCCESS:nt(this.resolve_.bind(null,this.snapshot))();break;case wt.CANCELED:case wt.ERROR:nt(this.reject_.bind(null,this.error_))();break;default:t=!1}t&&(this.resolve_=null,this.reject_=null)}},t.prototype.notifyObserver_=function(t){switch(v(this.state_)){case wt.RUNNING:case wt.PAUSED:null!==t.next&&nt(t.next.bind(t,this.snapshot))();break;case wt.SUCCESS:null!==t.complete&&nt(t.complete.bind(t))();break;case wt.CANCELED:case wt.ERROR:null!==t.error&&nt(t.error.bind(t,this.error_))();break;default:null!==t.error&&nt(t.error.bind(t,this.error_))()}},t.prototype.resume=function(){j("resume",[],arguments);var t=this.state_===Et.PAUSED||this.state_===Et.PAUSING;return t&&this.transition_(Et.RUNNING),t},t.prototype.pause=function(){j("pause",[],arguments);var t=this.state_===Et.RUNNING;return t&&this.transition_(Et.PAUSING),t},t.prototype.cancel=function(){j("cancel",[],arguments);var t=this.state_===Et.RUNNING||this.state_===Et.PAUSING;return t&&this.transition_(Et.CANCELING),t},t}(),Mt=function(){function t(t,e){this.authWrapper=t,this.location=e instanceof It?e:It.makeFromUrl(e)}return t.prototype.toString=function(){return j("toString",[],arguments),"gs://"+this.location.bucket+"/"+this.location.path},t.prototype.newRef=function(e,n){return new t(e,n)},t.prototype.mappings=function(){return M()},t.prototype.child=function(t){j("child",[B()],arguments);var e=function(t,e){var n=e.split("/").filter(function(t){return t.length>0}).join("/");return 0===t.length?n:t+"/"+n}(this.location.path,t),n=new It(this.location.bucket,e);return this.newRef(this.authWrapper,n)},Object.defineProperty(t.prototype,"parent",{get:function(){var t=function(t){if(0==t.length)return null;var e=t.lastIndexOf("/");return-1===e?"":t.slice(0,e)}(this.location.path);if(null===t)return null;var e=new It(this.location.bucket,t);return this.newRef(this.authWrapper,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){var t=new It(this.location.bucket,"");return this.newRef(this.authWrapper,t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bucket",{get:function(){return this.location.bucket},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fullPath",{get:function(){return this.location.path},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return N(this.location.path)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"storage",{get:function(){return this.authWrapper.service()},enumerable:!0,configurable:!0}),t.prototype.put=function(t,e){return void 0===e&&(e=null),j("put",[V(),W(!0)],arguments),this.throwIfRoot_("put"),new xt(this,this.authWrapper,this.location,this.mappings(),new Rt(t),e)},t.prototype.putString=function(t,e,n){void 0===e&&(e=yt.RAW),j("putString",[B(),B(h,!0),W(!0)],arguments),this.throwIfRoot_("putString");var r=f(e,t),i=m(n);return!E(i.contentType)&&E(r.contentType)&&(i.contentType=r.contentType),new xt(this,this.authWrapper,this.location,this.mappings(),new Rt(r.data,!0),i)},t.prototype.delete=function(){j("delete",[],arguments),this.throwIfRoot_("delete");var t=this;return this.authWrapper.getAuthToken().then(function(e){var n=function(t,e){var n=k(e.fullServerUrl()),r=t.maxOperationRetryTime(),i=new Nt(n,"DELETE",function(t,e){},r);return i.successCodes=[200,204],i.errorHandler=J(e),i}(t.authWrapper,t.location);return t.authWrapper.makeRequest(n,e).getPromise()})},t.prototype.getMetadata=function(){j("getMetadata",[],arguments),this.throwIfRoot_("getMetadata");var t=this;return this.authWrapper.getAuthToken().then(function(e){var n=$(t.authWrapper,t.location,t.mappings());return t.authWrapper.makeRequest(n,e).getPromise()})},t.prototype.updateMetadata=function(t){j("updateMetadata",[W()],arguments),this.throwIfRoot_("updateMetadata");var e=this;return this.authWrapper.getAuthToken().then(function(n){var r=function(t,e,n,r){var i=k(e.fullServerUrl()),o=F(n,r),a=t.maxOperationRetryTime(),s=new Nt(i,"PATCH",X(t,r),a);return s.headers={"Content-Type":"application/json; charset=utf-8"},s.body=o,s.errorHandler=J(e),s}(e.authWrapper,e.location,t,e.mappings());return e.authWrapper.makeRequest(r,n).getPromise()})},t.prototype.getDownloadURL=function(){return j("getDownloadURL",[],arguments),this.throwIfRoot_("getDownloadURL"),this.getMetadata().then(function(t){var e=t.downloadURLs[0];if(E(e))return e;throw new vt(gt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")})},t.prototype.throwIfRoot_=function(t){if(""===this.location.path)throw function(t){return new vt(gt.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(t)},t}(),Lt=function(){function t(t){this.promise_=function(t){return Promise.reject(t)}(t)}return t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){void 0===t&&(t=!1)},t}(),Ft=function(){function t(){this.map_={},this.id_=dt}return t.prototype.addRequest=function(t){function e(){delete r.map_[n]}var n=this.id_;this.id_++,this.map_[n]=t;var r=this;t.getPromise().then(e,e)},t.prototype.clear=function(){y(this.map_,function(t,e){e&&e.cancel(!0)}),this.map_={}},t}(),Ut=function(){function t(e,n,r,i,o){if(this.bucket_=null,this.deleted_=!1,this.app_=e,null!==this.app_){var a=this.app_.options;E(a)&&(this.bucket_=t.extractBucket_(a))}this.storageRefMaker_=n,this.requestMaker_=r,this.pool_=o,this.service_=i,this.maxOperationRetryTime_=ft,this.maxUploadRetryTime_=pt,this.requestMap_=new Ft}return t.extractBucket_=function(t){var e=t.storageBucket||null;return null==e?null:It.makeFromBucketSpec(e).bucket},t.prototype.getAuthToken=function(){return null!==this.app_&&E(this.app_.INTERNAL)&&E(this.app_.INTERNAL.getToken)?this.app_.INTERNAL.getToken().then(function(t){return null!==t?t.accessToken:null},function(t){return null}):b(null)},t.prototype.bucket=function(){if(this.deleted_)throw u();return this.bucket_},t.prototype.service=function(){return this.service_},t.prototype.makeStorageReference=function(t){return this.storageRefMaker_(this,t)},t.prototype.makeRequest=function(t,e){if(this.deleted_)return new Lt(u());var n=this.requestMaker_(t,e,this.pool_);return this.requestMap_.addRequest(n),n},t.prototype.deleteApp=function(){this.deleted_=!0,this.app_=null,this.requestMap_.clear()},t.prototype.maxUploadRetryTime=function(){return this.maxUploadRetryTime_},t.prototype.setMaxUploadRetryTime=function(t){this.maxUploadRetryTime_=t},t.prototype.maxOperationRetryTime=function(){return this.maxOperationRetryTime_},t.prototype.setMaxOperationRetryTime=function(t){this.maxOperationRetryTime_=t},t}(),jt=function(){function t(t,e,n,r,i,o,a,s,u,c,l){this.pendingXhr_=null,this.backoffId_=null,this.resolve_=null,this.reject_=null,this.canceled_=!1,this.appDelete_=!1,this.url_=t,this.method_=e,this.headers_=n,this.body_=r,this.successCodes_=i.slice(),this.additionalRetryCodes_=o.slice(),this.callback_=a,this.errorCallback_=s,this.progressCallback_=c,this.timeout_=u,this.pool_=l;var h=this;this.promise_=_(function(t,e){h.resolve_=t,h.reject_=e,h.start_()})}return t.prototype.start_=function(){function t(t,n){var r=e.resolve_,a=e.reject_,s=n.xhr;if(n.wasSuccessCode)try{var c=e.callback_(s,s.getResponseText());w(c)?r(c):r()}catch(t){a(t)}else if(null!==s){(l=i()).setServerResponseProp(s.getResponseText()),a(e.errorCallback_?e.errorCallback_(s,l):l)}else if(n.canceled){a(l=e.appDelete_?u():o())}else{var l;a(l=new vt(gt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again."))}}var e=this;this.canceled_?t(!1,new Bt(!1,null,!0)):this.backoffId_=function(t,e,n){function r(){return 2===h}function i(){f||(f=!0,e.apply(null,arguments))}function o(e){c=setTimeout(function(){c=null,t(a,r())},e)}function a(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(!f){if(t)return void i.apply(null,arguments);if(r()||l)return void i.apply(null,arguments);var a;u<64&&(u*=2),1===h?(h=2,a=0):a=1e3*(u+Math.random()),o(a)}}function s(t){p||(p=!0,f||(null!==c?(t||(h=2),clearTimeout(c),o(0)):t||(h=1)))}var u=1,c=null,l=!1,h=0,f=!1,p=!1;return o(0),setTimeout(function(){l=!0,s(!0)},n),s}(function(t,n){function r(t){var n=t.loaded,r=t.lengthComputable?t.total:-1;null!==e.progressCallback_&&e.progressCallback_(n,r)}if(n)t(!1,new Bt(!1,null,!0));else{var i=e.pool_.createXhrIo();e.pendingXhr_=i,null!==e.progressCallback_&&i.addUploadProgressListener(r),i.send(e.url_,e.method_,e.body_,e.headers_).then(function(n){null!==e.progressCallback_&&n.removeUploadProgressListener(r),e.pendingXhr_=null;var i=(n=n).getErrorCode()===at.NO_ERROR,o=n.getStatus();if(i&&!e.isRetryStatusCode_(o)){var a=z(e.successCodes_,o);t(!0,new Bt(a,n))}else{var s=n.getErrorCode()===at.ABORT;t(!1,new Bt(!1,null,s))}})}},t,this.timeout_)},t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){this.canceled_=!0,this.appDelete_=t||!1,null!==this.backoffId_&&function(t){t(!1)}(this.backoffId_),null!==this.pendingXhr_&&this.pendingXhr_.abort()},t.prototype.isRetryStatusCode_=function(t){var e=t>=500&&t<600,n=z([408,429],t),r=z(this.additionalRetryCodes_,t);return e||n||r},t}(),Bt=function(){return function(t,e,n){this.wasSuccessCode=t,this.xhr=e,this.canceled=!!n}}(),Vt=function(){function t(t,e,n){if(this.bucket_=null,this.authWrapper_=new Ut(t,function(t,e){return new Mt(t,e)},rt,this,e),this.app_=t,null!=n)this.bucket_=It.makeFromBucketSpec(n);else{var r=this.authWrapper_.bucket();null!=r&&(this.bucket_=new It(r,""))}this.internals_=new Wt(this)}return t.prototype.ref=function(t){if(j("ref",[B(function(t){if(/^[A-Za-z]+:\/\//.test(t))throw"Expected child path but got a URL, use refFromURL instead."},!0)],arguments),null==this.bucket_)throw new Error("No Storage Bucket defined in Firebase Options.");var e=new Mt(this.authWrapper_,this.bucket_);return null!=t?e.child(t):e},t.prototype.refFromURL=function(t){return j("refFromURL",[B(function(t){if(!/^[A-Za-z]+:\/\//.test(t))throw"Expected full URL but got a child path, use ref instead.";try{It.makeFromUrl(t)}catch(t){throw"Expected valid full URL but got an invalid one."}},!1)],arguments),new Mt(this.authWrapper_,t)},Object.defineProperty(t.prototype,"maxUploadRetryTime",{get:function(){return this.authWrapper_.maxUploadRetryTime()},enumerable:!0,configurable:!0}),t.prototype.setMaxUploadRetryTime=function(t){j("setMaxUploadRetryTime",[q()],arguments),this.authWrapper_.setMaxUploadRetryTime(t)},Object.defineProperty(t.prototype,"maxOperationRetryTime",{get:function(){return this.authWrapper_.maxOperationRetryTime()},enumerable:!0,configurable:!0}),t.prototype.setMaxOperationRetryTime=function(t){j("setMaxOperationRetryTime",[q()],arguments),this.authWrapper_.setMaxOperationRetryTime(t)},Object.defineProperty(t.prototype,"app",{get:function(){return this.app_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"INTERNAL",{get:function(){return this.internals_},enumerable:!0,configurable:!0}),t}(),Wt=function(){function t(t){this.service_=t}return t.prototype.delete=function(){return this.service_.authWrapper_.deleteApp(),b(void 0)},t}();n.d(e,"registerStorage",function(){return ot});var qt="storage";ot(st.default)},function(t,e,n){"use strict";function r(t,e,n){function i(){f===h&&(f=h.slice())}function o(){return l}function a(t){if("function"!=typeof t)throw new Error("Expected listener to be a function.");var e=!0;return i(),f.push(t),function(){if(e){e=!1,i();var n=f.indexOf(t);f.splice(n,1)}}}function s(t){if(!P(t))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===t.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(p)throw new Error("Reducers may not dispatch actions.");try{p=!0,l=c(l,t)}finally{p=!1}for(var e=h=f,n=0;n<e.length;n++)(0,e[n])();return t}var u;if("function"==typeof e&&void 0===n&&(n=e,e=void 0),void 0!==n){if("function"!=typeof n)throw new Error("Expected the enhancer to be a function.");return n(r)(t,e)}if("function"!=typeof t)throw new Error("Expected the reducer to be a function.");var c=t,l=e,h=[],f=h,p=!1;return s({type:x.INIT}),(u={dispatch:s,subscribe:a,getState:o,replaceReducer:function(t){if("function"!=typeof t)throw new Error("Expected the nextReducer to be a function.");c=t,s({type:x.INIT})}})[D.default]=function(){var t,e=a;return(t={subscribe:function(t){function n(){t.next&&t.next(o())}if("object"!=typeof t)throw new TypeError("Expected the observer to be an object.");return n(),{unsubscribe:e(n)}}})[D.default]=function(){return this},t},u}function i(t,e){var n=e&&e.type;return"Given action "+(n&&'"'+n.toString()+'"'||"an action")+', reducer "'+t+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function o(t){for(var e=Object.keys(t),n={},r=0;r<e.length;r++){var o=e[r];"function"==typeof t[o]&&(n[o]=t[o])}var a=Object.keys(n),s=void 0;try{!function(t){Object.keys(t).forEach(function(e){var n=t[e];if(void 0===n(void 0,{type:x.INIT}))throw new Error('Reducer "'+e+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if(void 0===n(void 0,{type:"@@redux/PROBE_UNKNOWN_ACTION_"+Math.random().toString(36).substring(7).split("").join(".")}))throw new Error('Reducer "'+e+"\" returned undefined when probed with a random type. Don't try to handle "+x.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')})}(n)}catch(t){s=t}return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1];if(s)throw s;for(var r=!1,o={},u=0;u<a.length;u++){var c=a[u],l=n[c],h=t[c],f=l(h,e);if(void 0===f){var p=i(c,e);throw new Error(p)}o[c]=f,r=r||f!==h}return r?o:t}}function a(t,e){return function(){return e(t.apply(void 0,arguments))}}function s(t,e){if("function"==typeof t)return a(t,e);if("object"!=typeof t||null===t)throw new Error("bindActionCreators expected an object or a function, instead received "+(null===t?"null":typeof t)+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');for(var n=Object.keys(t),r={},i=0;i<n.length;i++){var o=n[i],s=t[o];"function"==typeof s&&(r[o]=a(s,e))}return r}function u(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return 0===e.length?function(t){return t}:1===e.length?e[0]:e.reduce(function(t,e){return function(){return t(e.apply(void 0,arguments))}})}function c(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(t){return function(n,r,i){var o,a=t(n,r,i),s=a.dispatch,c={getState:a.getState,dispatch:function(t){return s(t)}};return o=e.map(function(t){return t(c)}),s=u.apply(void 0,o)(a.dispatch),M({},a,{dispatch:s})}}}n.r(e);var l=n(288),h="object"==typeof self&&self&&self.Object===Object&&self,f=(l.a||h||Function("return this")()).Symbol,p=Object.prototype,d=p.hasOwnProperty,v=p.toString,g=f?f.toStringTag:void 0,y=function(t){var e=d.call(t,g),n=t[g];try{t[g]=void 0;var r=!0}catch(t){}var i=v.call(t);return r&&(e?t[g]=n:delete t[g]),i},m=Object.prototype.toString,_=function(t){return m.call(t)},b="[object Null]",E="[object Undefined]",w=f?f.toStringTag:void 0,S=function(t){return null==t?void 0===t?E:b:w&&w in Object(t)?y(t):_(t)},T=function(t,e){return function(n){return t(e(n))}}(Object.getPrototypeOf,Object),I=function(t){return null!=t&&"object"==typeof t},A="[object Object]",O=Function.prototype,C=Object.prototype,R=O.toString,N=C.hasOwnProperty,k=R.call(Object),P=function(t){if(!I(t)||S(t)!=A)return!1;var e=T(t);if(null===e)return!0;var n=N.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&R.call(n)==k},D=n(123),x={INIT:"@@redux/INIT"},M=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};n.d(e,"createStore",function(){return r}),n.d(e,"combineReducers",function(){return o}),n.d(e,"bindActionCreators",function(){return s}),n.d(e,"applyMiddleware",function(){return c}),n.d(e,"compose",function(){return u})},function(t,e,n){"use strict";function r(t){var e={Messaging:T};t.INTERNAL.registerService("messaging",function(t){return self&&"ServiceWorkerGlobalScope"in self?new A(t):new T(t)},e)}n.r(e);var i,o=n(1),a={AVAILABLE_IN_WINDOW:"only-available-in-window",AVAILABLE_IN_SW:"only-available-in-sw",SHOULD_BE_INHERITED:"should-be-overriden",BAD_SENDER_ID:"bad-sender-id",INCORRECT_GCM_SENDER_ID:"incorrect-gcm-sender-id",PERMISSION_DEFAULT:"permission-default",PERMISSION_BLOCKED:"permission-blocked",UNSUPPORTED_BROWSER:"unsupported-browser",NOTIFICATIONS_BLOCKED:"notifications-blocked",FAILED_DEFAULT_REGISTRATION:"failed-serviceworker-registration",SW_REGISTRATION_EXPECTED:"sw-registration-expected",GET_SUBSCRIPTION_FAILED:"get-subscription-failed",INVALID_SAVED_TOKEN:"invalid-saved-token",SW_REG_REDUNDANT:"sw-reg-redundant",TOKEN_SUBSCRIBE_FAILED:"token-subscribe-failed",TOKEN_SUBSCRIBE_NO_TOKEN:"token-subscribe-no-token",TOKEN_SUBSCRIBE_NO_PUSH_SET:"token-subscribe-no-push-set",USE_SW_BEFORE_GET_TOKEN:"use-sw-before-get-token",INVALID_DELETE_TOKEN:"invalid-delete-token",DELETE_TOKEN_NOT_FOUND:"delete-token-not-found",DELETE_SCOPE_NOT_FOUND:"delete-scope-not-found",BG_HANDLER_FUNCTION_EXPECTED:"bg-handler-function-expected",NO_WINDOW_CLIENT_TO_MSG:"no-window-client-to-msg",UNABLE_TO_RESUBSCRIBE:"unable-to-resubscribe",NO_FCM_TOKEN_FOR_RESUBSCRIBE:"no-fcm-token-for-resubscribe",FAILED_TO_DELETE_TOKEN:"failed-to-delete-token",NO_SW_IN_REG:"no-sw-in-reg",BAD_SCOPE:"bad-scope",BAD_VAPID_KEY:"bad-vapid-key",BAD_SUBSCRIPTION:"bad-subscription",BAD_TOKEN:"bad-token",BAD_PUSH_SET:"bad-push-set",FAILED_DELETE_VAPID_KEY:"failed-delete-vapid-key"},s={codes:a,map:((i={})[a.AVAILABLE_IN_WINDOW]="This method is available in a Window context.",i[a.AVAILABLE_IN_SW]="This method is available in a service worker context.",i[a.SHOULD_BE_INHERITED]="This method should be overriden by extended classes.",i[a.BAD_SENDER_ID]="Please ensure that 'messagingSenderId' is set correctly in the options passed into firebase.initializeApp().",i[a.PERMISSION_DEFAULT]="The required permissions were not granted and dismissed instead.",i[a.PERMISSION_BLOCKED]="The required permissions were not granted and blocked instead.",i[a.UNSUPPORTED_BROWSER]="This browser doesn't support the API's required to use the firebase SDK.",i[a.NOTIFICATIONS_BLOCKED]="Notifications have been blocked.",i[a.FAILED_DEFAULT_REGISTRATION]="We are unable to register the default service worker. {$browserErrorMessage}",i[a.SW_REGISTRATION_EXPECTED]="A service worker registration was the expected input.",i[a.GET_SUBSCRIPTION_FAILED]="There was an error when trying to get any existing Push Subscriptions.",i[a.INVALID_SAVED_TOKEN]="Unable to access details of the saved token.",i[a.SW_REG_REDUNDANT]="The service worker being used for push was made redundant.",i[a.TOKEN_SUBSCRIBE_FAILED]="A problem occured while subscribing the user to FCM: {$message}",i[a.TOKEN_SUBSCRIBE_NO_TOKEN]="FCM returned no token when subscribing the user to push.",i[a.TOKEN_SUBSCRIBE_NO_PUSH_SET]="FCM returned an invalid response when getting an FCM token.",i[a.USE_SW_BEFORE_GET_TOKEN]="You must call useServiceWorker() before calling getToken() to ensure your service worker is used.",i[a.INVALID_DELETE_TOKEN]="You must pass a valid token into deleteToken(), i.e. the token from getToken().",i[a.DELETE_TOKEN_NOT_FOUND]="The deletion attempt for token could not be performed as the token was not found.",i[a.DELETE_SCOPE_NOT_FOUND]="The deletion attempt for service worker scope could not be performed as the scope was not found.",i[a.BG_HANDLER_FUNCTION_EXPECTED]="The input to setBackgroundMessageHandler() must be a function.",i[a.NO_WINDOW_CLIENT_TO_MSG]="An attempt was made to message a non-existant window client.",i[a.UNABLE_TO_RESUBSCRIBE]="There was an error while re-subscribing the FCM token for push messaging. Will have to resubscribe the user on next visit. {$message}",i[a.NO_FCM_TOKEN_FOR_RESUBSCRIBE]="Could not find an FCM token and as a result, unable to resubscribe. Will have to resubscribe the user on next visit.",i[a.FAILED_TO_DELETE_TOKEN]="Unable to delete the currently saved token.",i[a.NO_SW_IN_REG]="Even though the service worker registration was successful, there was a problem accessing the service worker itself.",i[a.INCORRECT_GCM_SENDER_ID]="Please change your web app manifest's 'gcm_sender_id' value to '103953800507' to use Firebase messaging.",i[a.BAD_SCOPE]="The service worker scope must be a string with at least one character.",i[a.BAD_VAPID_KEY]="The public VAPID key must be a string with at least one character.",i[a.BAD_SUBSCRIPTION]="The subscription must be a valid PushSubscription.",i[a.BAD_TOKEN]="The FCM Token used for storage / lookup was not a valid token string.",i[a.BAD_PUSH_SET]="The FCM push set used for storage / lookup was not not a valid push set string.",i[a.FAILED_DELETE_VAPID_KEY]="The VAPID key could not be deleted.",i)},u=function(t){return function(t){var e=new Uint8Array(t);return window.btoa(String.fromCharCode.apply(null,e))}(t).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},c=[4,51,148,247,223,161,235,177,220,3,162,94,21,113,219,72,211,46,237,237,178,52,219,183,71,58,12,143,196,204,225,111,60,140,132,223,171,182,102,62,242,12,212,139,254,227,249,118,47,20,28,99,8,106,111,45,177,26,149,176,206,55,192,156,110],l={ENDPOINT:"https://fcm.googleapis.com",APPLICATION_SERVER_KEY:c,SUBSCRIPTION_OPTIONS:{userVisibleOnly:!0,applicationServerKey:new Uint8Array(c)}},h="fcm_token_object_Store",f=function(){function t(){this.errorFactory_=new o.ErrorFactory("messaging","Messaging",s.map),this.openDbPromise_=null}return t.prototype.openDatabase_=function(){return this.openDbPromise_?this.openDbPromise_:(this.openDbPromise_=new Promise(function(e,n){var r=indexedDB.open(t.DB_NAME,1);r.onerror=function(t){n(t.target.error)},r.onsuccess=function(t){e(t.target.result)},r.onupgradeneeded=function(t){var e=t.target.result.createObjectStore(h,{keyPath:"swScope"});e.createIndex("fcmSenderId","fcmSenderId",{unique:!1}),e.createIndex("fcmToken","fcmToken",{unique:!0})}}),this.openDbPromise_)},t.prototype.closeDatabase=function(){var t=this;return this.openDbPromise_?this.openDbPromise_.then(function(e){e.close(),t.openDbPromise_=null}):Promise.resolve()},t.prototype.getTokenDetailsFromToken=function(t){return this.openDatabase_().then(function(e){return new Promise(function(n,r){var i=e.transaction([h]).objectStore(h).index("fcmToken").get(t);i.onerror=function(t){r(t.target.error)},i.onsuccess=function(t){n(t.target.result)}})})},t.prototype.getTokenDetailsFromSWScope_=function(t){return this.openDatabase_().then(function(e){return new Promise(function(n,r){var i=e.transaction([h]).objectStore(h).get(t);i.onerror=function(t){r(t.target.error)},i.onsuccess=function(t){n(t.target.result)}})})},t.prototype.getAllTokenDetailsForSenderId_=function(t){return this.openDatabase_().then(function(e){return new Promise(function(n,r){var i=e.transaction([h]).objectStore(h),o=[],a=i.openCursor();a.onerror=function(t){r(t.target.error)},a.onsuccess=function(e){var r=e.target.result;r?(r.value.fcmSenderId===t&&o.push(r.value),r.continue()):n(o)}})})},t.prototype.subscribeToFCM=function(t,e,n){var r=this,i=u(e.getKey("p256dh")),o=u(e.getKey("auth")),a="authorized_entity="+t+"&endpoint="+e.endpoint+"&encryption_key="+i+"&encryption_auth="+o;n&&(a+="&pushSet="+n);var c=new Headers;return c.append("Content-Type","application/x-www-form-urlencoded"),fetch(l.ENDPOINT+"/fcm/connect/subscribe",{method:"POST",headers:c,body:a}).then(function(t){return t.json()}).then(function(t){var e=t;if(e.error){var n=e.error.message;throw r.errorFactory_.create(s.codes.TOKEN_SUBSCRIBE_FAILED,{message:n})}if(!e.token)throw r.errorFactory_.create(s.codes.TOKEN_SUBSCRIBE_NO_TOKEN);if(!e.pushSet)throw r.errorFactory_.create(s.codes.TOKEN_SUBSCRIBE_NO_PUSH_SET);return{token:e.token,pushSet:e.pushSet}})},t.prototype.isSameSubscription_=function(t,e){return t.endpoint===e.endpoint&&u(t.getKey("auth"))===e.auth&&u(t.getKey("p256dh"))===e.p256dh},t.prototype.saveTokenDetails_=function(t,e,n,r,i){var o={swScope:e.scope,endpoint:n.endpoint,auth:u(n.getKey("auth")),p256dh:u(n.getKey("p256dh")),fcmToken:r,fcmPushSet:i,fcmSenderId:t};return this.openDatabase_().then(function(t){return new Promise(function(e,n){var r=t.transaction([h],"readwrite").objectStore(h).put(o);r.onerror=function(t){n(t.target.error)},r.onsuccess=function(t){e()}})})},t.prototype.getSavedToken=function(t,e){var n=this;return e instanceof ServiceWorkerRegistration?"string"!=typeof t||0===t.length?Promise.reject(this.errorFactory_.create(s.codes.BAD_SENDER_ID)):this.getAllTokenDetailsForSenderId_(t).then(function(n){if(0!==n.length){var r=n.findIndex(function(n){return e.scope===n.swScope&&t===n.fcmSenderId});if(-1!==r)return n[r]}}).then(function(t){if(t)return e.pushManager.getSubscription().catch(function(t){throw n.errorFactory_.create(s.codes.GET_SUBSCRIPTION_FAILED)}).then(function(e){if(e&&n.isSameSubscription_(e,t))return t.fcmToken})}):Promise.reject(this.errorFactory_.create(s.codes.SW_REGISTRATION_EXPECTED))},t.prototype.createToken=function(t,e){var n,r,i=this;return"string"!=typeof t||0===t.length?Promise.reject(this.errorFactory_.create(s.codes.BAD_SENDER_ID)):e instanceof ServiceWorkerRegistration?e.pushManager.getSubscription().then(function(t){return t||e.pushManager.subscribe(l.SUBSCRIPTION_OPTIONS)}).then(function(e){return n=e,i.subscribeToFCM(t,n)}).then(function(o){return r=o,i.saveTokenDetails_(t,e,n,r.token,r.pushSet)}).then(function(){return r.token}):Promise.reject(this.errorFactory_.create(s.codes.SW_REGISTRATION_EXPECTED))},t.prototype.deleteToken=function(t){var e=this;return"string"!=typeof t||0===t.length?Promise.reject(this.errorFactory_.create(s.codes.INVALID_DELETE_TOKEN)):this.getTokenDetailsFromToken(t).then(function(t){if(!t)throw e.errorFactory_.create(s.codes.DELETE_TOKEN_NOT_FOUND);return e.openDatabase_().then(function(n){return new Promise(function(r,i){var o=n.transaction([h],"readwrite").objectStore(h).delete(t.swScope);o.onerror=function(t){i(t.target.error)},o.onsuccess=function(n){0!==n.target.result?r(t):i(e.errorFactory_.create(s.codes.FAILED_TO_DELETE_TOKEN))}})})})},t}(),p="granted",d="denied",v="messagingSenderId",g=function(){function t(t){var e=this;if(this.errorFactory_=new o.ErrorFactory("messaging","Messaging",s.map),!t.options[v]||"string"!=typeof t.options[v])throw this.errorFactory_.create(s.codes.BAD_SENDER_ID);this.messagingSenderId_=t.options[v],this.tokenManager_=new f,this.app=t,this.INTERNAL={},this.INTERNAL.delete=function(){return e.delete}}return t.prototype.getToken=function(){var t=this,e=this.getNotificationPermission_();return e!==p?e===d?Promise.reject(this.errorFactory_.create(s.codes.NOTIFICATIONS_BLOCKED)):Promise.resolve(null):this.getSWRegistration_().then(function(e){return t.tokenManager_.getSavedToken(t.messagingSenderId_,e).then(function(n){return n||t.tokenManager_.createToken(t.messagingSenderId_,e)})})},t.prototype.deleteToken=function(t){var e=this;return this.tokenManager_.deleteToken(t).then(function(){return e.getSWRegistration_().then(function(t){if(t)return t.pushManager.getSubscription()}).then(function(t){if(t)return t.unsubscribe()})})},t.prototype.getSWRegistration_=function(){throw this.errorFactory_.create(s.codes.SHOULD_BE_INHERITED)},t.prototype.requestPermission=function(){throw this.errorFactory_.create(s.codes.AVAILABLE_IN_WINDOW)},t.prototype.useServiceWorker=function(t){throw this.errorFactory_.create(s.codes.AVAILABLE_IN_WINDOW)},t.prototype.onMessage=function(t,e,n){throw this.errorFactory_.create(s.codes.AVAILABLE_IN_WINDOW)},t.prototype.onTokenRefresh=function(t,e,n){throw this.errorFactory_.create(s.codes.AVAILABLE_IN_WINDOW)},t.prototype.setBackgroundMessageHandler=function(t){throw this.errorFactory_.create(s.codes.AVAILABLE_IN_SW)},t.prototype.delete=function(){return this.tokenManager_.closeDatabase()},t.prototype.getNotificationPermission_=function(){return Notification.permission},t.prototype.getTokenManager=function(){return this.tokenManager_},t}(),y={TYPE_OF_MSG:"firebase-messaging-msg-type",DATA:"firebase-messaging-msg-data"},m=y,_={PUSH_MSG_RECEIVED:"push-msg-received",NOTIFICATION_CLICKED:"notification-clicked"},b=function(t,e){return(n={})[y.TYPE_OF_MSG]=t,n[y.DATA]=e,n;var n},E="/firebase-messaging-sw.js",w="/firebase-cloud-messaging-push-scope",S=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),T=function(t){function e(e){var n=t.call(this,e)||this;return n.messageObserver_=null,n.onMessage_=Object(o.createSubscribe)(function(t){n.messageObserver_=t}),n.tokenRefreshObserver_=null,n.onTokenRefresh_=Object(o.createSubscribe)(function(t){n.tokenRefreshObserver_=t}),n.setupSWMessageListener_(),n}return S(e,t),e.prototype.getToken=function(){var e=this;return this.isSupported_()?this.manifestCheck_().then(function(){return t.prototype.getToken.call(e)}):Promise.reject(this.errorFactory_.create(s.codes.UNSUPPORTED_BROWSER))},e.prototype.manifestCheck_=function(){var t=this;if(this.manifestCheckPromise_)return this.manifestCheckPromise_;var e=document.querySelector('link[rel="manifest"]');return this.manifestCheckPromise_=e?fetch(e.href).then(function(t){return t.json()}).catch(function(){return Promise.resolve()}).then(function(e){if(e&&e.gcm_sender_id&&"103953800507"!==e.gcm_sender_id)throw t.errorFactory_.create(s.codes.INCORRECT_GCM_SENDER_ID)}):Promise.resolve(),this.manifestCheckPromise_},e.prototype.requestPermission=function(){var t=this;return Notification.permission===p?Promise.resolve():new Promise(function(e,n){var r=function(r){return r===p?e():n(r===d?t.errorFactory_.create(s.codes.PERMISSION_BLOCKED):t.errorFactory_.create(s.codes.PERMISSION_DEFAULT))},i=Notification.requestPermission(function(t){i||r(t)});i&&i.then(r)})},e.prototype.useServiceWorker=function(t){if(!(t instanceof ServiceWorkerRegistration))throw this.errorFactory_.create(s.codes.SW_REGISTRATION_EXPECTED);if(void 0!==this.registrationToUse_)throw this.errorFactory_.create(s.codes.USE_SW_BEFORE_GET_TOKEN);this.registrationToUse_=t},e.prototype.onMessage=function(t,e,n){return this.onMessage_(t,e,n)},e.prototype.onTokenRefresh=function(t,e,n){return this.onTokenRefresh_(t,e,n)},e.prototype.waitForRegistrationToActivate_=function(t){var e=this,n=t.installing||t.waiting||t.active;return new Promise(function(r,i){if(n)if("activated"!==n.state)if("redundant"!==n.state){var o=function(){if("activated"===n.state)r(t);else{if("redundant"!==n.state)return;i(e.errorFactory_.create(s.codes.SW_REG_REDUNDANT))}n.removeEventListener("statechange",o)};n.addEventListener("statechange",o)}else i(e.errorFactory_.create(s.codes.SW_REG_REDUNDANT));else r(t);else i(e.errorFactory_.create(s.codes.NO_SW_IN_REG))})},e.prototype.getSWRegistration_=function(){var t=this;return this.registrationToUse_?this.waitForRegistrationToActivate_(this.registrationToUse_):(this.registrationToUse_=null,navigator.serviceWorker.register(E,{scope:w}).catch(function(e){throw t.errorFactory_.create(s.codes.FAILED_DEFAULT_REGISTRATION,{browserErrorMessage:e.message})}).then(function(e){return t.waitForRegistrationToActivate_(e).then(function(){return t.registrationToUse_=e,e.update(),e})}))},e.prototype.setupSWMessageListener_=function(){var t=this;"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",function(e){if(e.data&&e.data[m.TYPE_OF_MSG]){var n=e.data;switch(n[m.TYPE_OF_MSG]){case _.PUSH_MSG_RECEIVED:case _.NOTIFICATION_CLICKED:var r=n[m.DATA];t.messageObserver_.next(r)}}},!1)},e.prototype.isSupported_=function(){return"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")},e}(g),I=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),A=function(t){function e(e){var n=t.call(this,e)||this;return self.addEventListener("push",function(t){return n.onPush_(t)},!1),self.addEventListener("pushsubscriptionchange",function(t){return n.onSubChange_(t)},!1),self.addEventListener("notificationclick",function(t){return n.onNotificationClick_(t)},!1),n.bgMessageHandler_=null,n}return I(e,t),e.prototype.onPush_=function(t){var e,n=this;try{e=t.data.json()}catch(t){return}var r=this.hasVisibleClients_().then(function(t){if(t){if(e.notification||n.bgMessageHandler_)return n.sendMessageToWindowClients_(e)}else{var r=n.getNotificationData_(e);if(r){var i=r.title||"";return self.registration.showNotification(i,r)}if(n.bgMessageHandler_)return n.bgMessageHandler_(e)}});t.waitUntil(r)},e.prototype.onSubChange_=function(t){var e=this,n=this.getToken().then(function(t){if(!t)throw e.errorFactory_.create(s.codes.NO_FCM_TOKEN_FOR_RESUBSCRIBE);var n=null,r=e.getTokenManager();return r.getTokenDetailsFromToken(t).then(function(t){if(!(n=t))throw e.errorFactory_.create(s.codes.INVALID_SAVED_TOKEN);return self.registration.pushManager.subscribe(l.SUBSCRIPTION_OPTIONS)}).then(function(t){return r.subscribeToFCM(n.fcmSenderId,t,n.fcmPushSet)}).catch(function(t){return r.deleteToken(n.fcmToken).then(function(){throw e.errorFactory_.create(s.codes.UNABLE_TO_RESUBSCRIBE,{message:t})})})});t.waitUntil(n)},e.prototype.onNotificationClick_=function(t){var e=this;if(t.notification&&t.notification.data&&t.notification.data.FCM_MSG){t.stopImmediatePropagation(),t.notification.close();var n=t.notification.data.FCM_MSG,r=n.notification.click_action;if(r){var i=this.getWindowClient_(r).then(function(t){return t||self.clients.openWindow(r)}).then(function(t){if(t){n.notification,delete n.notification;var r=b(_.NOTIFICATION_CLICKED,n);return e.attemptToMessageClient_(t,r)}});t.waitUntil(i)}}},e.prototype.getNotificationData_=function(t){if(t&&"object"==typeof t.notification){var e,n=Object.assign({},t.notification);return n.data=((e={}).FCM_MSG=t,e),n}},e.prototype.setBackgroundMessageHandler=function(t){if(t&&"function"!=typeof t)throw this.errorFactory_.create(s.codes.BG_HANDLER_FUNCTION_EXPECTED);this.bgMessageHandler_=t},e.prototype.getWindowClient_=function(t){var e=new URL(t).href;return self.clients.matchAll({type:"window",includeUncontrolled:!0}).then(function(t){for(var n=null,r=0;r<t.length;r++)if(new URL(t[r].url).href===e){n=t[r];break}if(n)return n.focus(),n})},e.prototype.attemptToMessageClient_=function(t,e){var n=this;return new Promise(function(r,i){if(!t)return i(n.errorFactory_.create(s.codes.NO_WINDOW_CLIENT_TO_MSG));t.postMessage(e),r()})},e.prototype.hasVisibleClients_=function(){return self.clients.matchAll({type:"window",includeUncontrolled:!0}).then(function(t){return t.some(function(t){return"visible"===t.visibilityState})})},e.prototype.sendMessageToWindowClients_=function(t){var e=this;return self.clients.matchAll({type:"window",includeUncontrolled:!0}).then(function(n){var r=b(_.PUSH_MSG_RECEIVED,t);return Promise.all(n.map(function(t){return e.attemptToMessageClient_(t,r)}))})},e.prototype.getSWRegistration_=function(){return Promise.resolve(self.registration)},e}(g),O=n(16);n.d(e,"registerMessaging",function(){return r}),r(O.firebase)}]);